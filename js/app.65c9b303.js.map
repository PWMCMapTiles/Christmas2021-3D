{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/components/Menu/TextInput.vue?c504","webpack:///./src/components/Menu/MarkerItem.vue?7540","webpack:///./src/components/ControlBar/ControlsSwitch.vue?e247","webpack:///./src/components/ControlBar/SvgButton.vue?c3a8","webpack:///./src/components/ControlBar/MenuButton.vue?7380","webpack:///./src/components/ControlBar/NumberInput.vue?6553","webpack:///./src/components/ControlBar/DayNightSwitch.vue?4902","webpack:///./src/components/Menu/MapButton.vue?7706","webpack:///./src/components/Controls/FreeFlightMobileControls.vue?4b1f","webpack:///./src/components/ControlBar/Compass.vue?c968","webpack:///./src/components/Menu/SideMenu.vue?d295","webpack:///src/components/ControlBar/Compass.vue","webpack:///src/components/ControlBar/DayNightSwitch.vue","webpack:///./src/App.vue?a49c","webpack:///./src/components/ControlBar/ControlBar.vue?1440","webpack:///./src/components/ControlBar/PositionInput.vue?9dbd","webpack:///./src/components/ControlBar/NumberInput.vue?8b5c","webpack:///src/components/ControlBar/NumberInput.vue","webpack:///./src/components/ControlBar/NumberInput.vue?6840","webpack:///./src/components/ControlBar/NumberInput.vue?ca83","webpack:///src/components/ControlBar/PositionInput.vue","webpack:///./src/components/ControlBar/PositionInput.vue?0771","webpack:///./src/components/ControlBar/PositionInput.vue?a802","webpack:///./src/components/ControlBar/Compass.vue?4776","webpack:///./BlueMapWeb/src/util/Utils.js","webpack:///./src/components/ControlBar/SvgButton.vue?caab","webpack:///src/components/ControlBar/SvgButton.vue","webpack:///./src/components/ControlBar/SvgButton.vue?ad68","webpack:///./src/components/ControlBar/SvgButton.vue?446c","webpack:///./src/components/ControlBar/Compass.vue?f42a","webpack:///./src/components/ControlBar/Compass.vue?c753","webpack:///./src/components/ControlBar/DayNightSwitch.vue?0ca2","webpack:///./src/components/ControlBar/DayNightSwitch.vue?29aa","webpack:///./src/components/ControlBar/DayNightSwitch.vue?d8ca","webpack:///./src/components/ControlBar/ControlsSwitch.vue?0657","webpack:///src/components/ControlBar/ControlsSwitch.vue","webpack:///./src/components/ControlBar/ControlsSwitch.vue?96e3","webpack:///./src/components/ControlBar/ControlsSwitch.vue?f8d9","webpack:///./src/components/ControlBar/MenuButton.vue?70c3","webpack:///src/components/ControlBar/MenuButton.vue","webpack:///./src/components/ControlBar/MenuButton.vue?a402","webpack:///./src/components/ControlBar/MenuButton.vue?efd7","webpack:///src/components/ControlBar/ControlBar.vue","webpack:///./src/components/ControlBar/ControlBar.vue?441a","webpack:///./src/components/ControlBar/ControlBar.vue?19ef","webpack:///./src/components/Menu/MainMenu.vue?19d5","webpack:///./src/components/Menu/SideMenu.vue?2c95","webpack:///src/components/Menu/SideMenu.vue","webpack:///./src/components/Menu/SideMenu.vue?7e03","webpack:///./src/components/Menu/SideMenu.vue?0b06","webpack:///./src/components/Menu/SimpleButton.vue?6b0f","webpack:///src/components/Menu/SimpleButton.vue","webpack:///./src/components/Menu/SimpleButton.vue?1e98","webpack:///./src/components/Menu/SimpleButton.vue?c5cd","webpack:///./src/components/Menu/SettingsMenu.vue?9cb3","webpack:///./src/components/Menu/Group.vue?a980","webpack:///src/components/Menu/Group.vue","webpack:///./src/components/Menu/Group.vue?f1cd","webpack:///./src/components/Menu/Group.vue?422b","webpack:///./src/components/Menu/Slider.vue?2ccc","webpack:///src/components/Menu/Slider.vue","webpack:///./src/components/Menu/Slider.vue?f28a","webpack:///./src/components/Menu/Slider.vue?56fd","webpack:///./src/components/Menu/SwitchButton.vue?7c99","webpack:///./src/components/Menu/SwitchHandle.vue?d3e2","webpack:///src/components/Menu/SwitchHandle.vue","webpack:///./src/components/Menu/SwitchHandle.vue?9339","webpack:///./src/components/Menu/SwitchHandle.vue?86f3","webpack:///src/components/Menu/SwitchButton.vue","webpack:///./src/components/Menu/SwitchButton.vue?a6d7","webpack:///./src/components/Menu/SwitchButton.vue?232e","webpack:///./src/i18n/fallback.js","webpack:///./src/i18n/index.js","webpack:///src/components/Menu/SettingsMenu.vue","webpack:///./src/components/Menu/SettingsMenu.vue?e413","webpack:///./src/components/Menu/SettingsMenu.vue","webpack:///./src/js/MainMenu.js","webpack:///./src/components/Menu/MarkerSetMenu.vue?7c6e","webpack:///./src/components/Menu/MarkerItem.vue?aee9","webpack:///src/components/Menu/MarkerItem.vue","webpack:///./src/components/Menu/MarkerItem.vue?e3b2","webpack:///./src/components/Menu/MarkerItem.vue?ef38","webpack:///./src/components/Menu/TextInput.vue?4481","webpack:///src/components/Menu/TextInput.vue","webpack:///./src/components/Menu/TextInput.vue?951e","webpack:///./src/components/Menu/TextInput.vue?f431","webpack:///./src/components/Menu/MarkerSet.vue?7861","webpack:///src/components/Menu/MarkerSet.vue","webpack:///./src/components/Menu/MarkerSet.vue?a0ed","webpack:///./src/components/Menu/MarkerSet.vue?daef","webpack:///src/components/Menu/MarkerSetMenu.vue","webpack:///./src/components/Menu/MarkerSetMenu.vue?8c7b","webpack:///./src/components/Menu/MarkerSetMenu.vue","webpack:///./src/components/Menu/MapButton.vue?f2fc","webpack:///src/components/Menu/MapButton.vue","webpack:///./src/components/Menu/MapButton.vue?a414","webpack:///./src/components/Menu/MapButton.vue?31c6","webpack:///src/components/Menu/MainMenu.vue","webpack:///./src/components/Menu/MainMenu.vue?aa64","webpack:///./src/components/Menu/MainMenu.vue?6ef8","webpack:///./src/components/Controls/FreeFlightMobileControls.vue?80c4","webpack:///src/components/Controls/FreeFlightMobileControls.vue","webpack:///./src/components/Controls/FreeFlightMobileControls.vue?e14c","webpack:///./src/components/Controls/FreeFlightMobileControls.vue?d47c","webpack:///src/App.vue","webpack:///./src/App.vue?1160","webpack:///./src/App.vue?bff9","webpack:///./BlueMapWeb/src/map/Tile.js","webpack:///./BlueMapWeb/src/map/TileMap.js","webpack:///./BlueMapWeb/src/map/TileManager.js","webpack:///./BlueMapWeb/src/map/TileLoader.js","webpack:///./BlueMapWeb/src/markers/MarkerSet.js","webpack:///./BlueMapWeb/src/util/lines/LineMaterial.js","webpack:///./BlueMapWeb/src/markers/MarkerFillVertexShader.js","webpack:///./BlueMapWeb/src/markers/MarkerFillFragmentShader.js","webpack:///./BlueMapWeb/src/util/lines/LineSegmentsGeometry.js","webpack:///./BlueMapWeb/src/util/lines/LineGeometry.js","webpack:///./BlueMapWeb/src/util/lines/LineSegments2.js","webpack:///./BlueMapWeb/src/util/lines/Line2.js","webpack:///./BlueMapWeb/src/markers/Marker.js","webpack:///./BlueMapWeb/src/util/CSS2DRenderer.js","webpack:///./BlueMapWeb/src/markers/ObjectMarker.js","webpack:///./BlueMapWeb/src/markers/ShapeMarker.js","webpack:///./BlueMapWeb/src/markers/ExtrudeMarker.js","webpack:///./BlueMapWeb/src/markers/LineMarker.js","webpack:///./BlueMapWeb/src/markers/HtmlMarker.js","webpack:///./BlueMapWeb/src/markers/PoiMarker.js","webpack:///./BlueMapWeb/src/markers/MarkerManager.js","webpack:///./BlueMapWeb/src/markers/MarkerFileManager.js","webpack:///./BlueMapWeb/src/markers/PlayerMarker.js","webpack:///./BlueMapWeb/src/markers/PlayerMarkerManager.js","webpack:///./BlueMapWeb/src/map/Map.js","webpack:///./BlueMapWeb/src/skybox/SkyFragmentShader.js","webpack:///./BlueMapWeb/src/skybox/SkyVertexShader.js","webpack:///./BlueMapWeb/src/skybox/SkyboxScene.js","webpack:///./BlueMapWeb/src/controls/ControlsManager.js","webpack:///./BlueMapWeb/src/util/Stats.js","webpack:///./BlueMapWeb/src/map/hires/HiresVertexShader.js","webpack:///./BlueMapWeb/src/map/hires/HiresFragmentShader.js","webpack:///./BlueMapWeb/src/map/lowres/LowresVertexShader.js","webpack:///./BlueMapWeb/src/map/lowres/LowresFragmentShader.js","webpack:///./BlueMapWeb/src/util/CombinedCamera.js","webpack:///./BlueMapWeb/src/MapViewer.js","webpack:///./BlueMapWeb/src/controls/map/mouse/MouseMoveControls.js","webpack:///./BlueMapWeb/src/controls/map/mouse/MouseZoomControls.js","webpack:///./BlueMapWeb/src/controls/map/mouse/MouseRotateControls.js","webpack:///./BlueMapWeb/src/controls/map/mouse/MouseAngleControls.js","webpack:///./BlueMapWeb/src/controls/map/MapHeightControls.js","webpack:///./BlueMapWeb/src/controls/KeyCombination.js","webpack:///./BlueMapWeb/src/controls/map/keyboard/KeyMoveControls.js","webpack:///./BlueMapWeb/src/controls/map/keyboard/KeyAngleControls.js","webpack:///./BlueMapWeb/src/controls/map/keyboard/KeyRotateControls.js","webpack:///./BlueMapWeb/src/controls/map/keyboard/KeyZoomControls.js","webpack:///./BlueMapWeb/src/controls/map/touch/TouchMoveControls.js","webpack:///./BlueMapWeb/src/controls/map/touch/TouchRotateControls.js","webpack:///./BlueMapWeb/src/controls/map/touch/TouchAngleControls.js","webpack:///./BlueMapWeb/src/controls/map/touch/TouchZoomControls.js","webpack:///./BlueMapWeb/src/controls/map/MapControls.js","webpack:///./BlueMapWeb/src/controls/freeflight/keyboard/KeyMoveControls.js","webpack:///./BlueMapWeb/src/controls/freeflight/mouse/MouseRotateControls.js","webpack:///./BlueMapWeb/src/controls/freeflight/mouse/MouseAngleControls.js","webpack:///./BlueMapWeb/src/controls/freeflight/keyboard/KeyHeightControls.js","webpack:///./BlueMapWeb/src/controls/freeflight/touch/TouchPanControls.js","webpack:///./BlueMapWeb/src/controls/freeflight/FreeFlightControls.js","webpack:///./BlueMapWeb/src/BlueMap.js","webpack:///./src/js/PopupMarker.js","webpack:///./src/js/Utils.js","webpack:///./src/js/BlueMapApp.js","webpack:///./src/main.js","webpack:///./src/App.vue?c650","webpack:///./src/components/Menu/SwitchButton.vue?d90e","webpack:///./src/components/ControlBar/ControlBar.vue?b095","webpack:///./src/components/ControlBar/PositionInput.vue?d13b","webpack:///./src/components/Menu/SimpleButton.vue?d014","webpack:///./src/components/Menu/MarkerSet.vue?c495","webpack:///./src/components/Menu/Slider.vue?a3fd","webpack:///./src/components/Menu/MainMenu.vue?a86a","webpack:///./src/components/Menu/SwitchHandle.vue?afcc","webpack:///./src/components/Menu/Group.vue?e7b6"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","_vm","this","_h","$createElement","_c","_self","class","appState","theme","attrs","controls","state","_e","menu","staticRenderFns","staticClass","isOpen","$t","on","$event","reOpenPage","maps","openPage","markers","markerSets","markerSet","playerMarkerSet","fake","openPlayerList","$bluemap","resetCamera","position","x","parseFloat","target","y","z","_v","_s","label","domProps","_f","$emit","stopPropagation","props","String","Number","filters","format","Math","floor","component","action","style","VEC2_ZERO","Vector2","stringToImage","Vector3","string","image","document","createElementNS","src","pathFromCoords","path","splitNumberToPath","substring","num","toString","charAt","hashTile","generateCacheHash","round","random","dispatchEvent","element","event","detail","CustomEvent","alert","message","level","printToConsole","console","log","warn","error","debug","htmlToElement","html","template","createElement","innerHTML","trim","content","firstChild","animate","animationFrame","durationMs","postAnimation","animation","animationStart","lastFrame","cancelled","frame","time","progress","MathUtils","clamp","deltaTime","requestAnimationFrame","cancel","EasingFunctions","linear","easeInQuad","easeOutQuad","easeInOutQuad","easeInCubic","easeOutCubic","easeInOutCubic","easeInQuart","easeOutQuart","easeInOutQuart","easeInQuint","easeOutQuint","easeInOutQuint","elementOffset","rect","getBoundingClientRect","scrollLeft","pageXOffset","documentElement","scrollTop","pageYOffset","top","left","deepEquals","object1","object2","is","type","Array","isArray","len","softMin","min","stiffness","delta","softMax","max","softClamp","active","_t","isDay","components","isPerspectiveView","setPerspectiveView","isFlatView","setFlatView","isFreeFlight","setFreeFlight","close","back","Boolean","set","id","currentPage","title","pageStack","closePage","closeAll","goFullscreen","updateMap","_l","map","buttonEnterAnimation","open","rendered","default","methods","submenu","mapViewer","uniforms","sunlightStrength","ambientLight","stage","superSampling","saveUserSettings","loadedHiresViewDistance","updateLoadedMapArea","loadedLowresViewDistance","mouseSensitivity","updateControlsSettings","invertMouse","setTheme","$i18n","languages","lang","locale","setLanguage","switchDebug","resetSettings","formattedValue","step","countDecimals","split","computed","toFixed","pageTitle","tooltip","button","marker","searchPlaceholder","followPlayerTitle","settings","lighting","dayNightSwitch","sunlight","resolution","high","normal","low","freeFlightControls","invertMouseY","renderDistance","hiresLayer","lowersLayer","dark","light","resetAllSettings","players","compass","perspective","flatView","freeFlight","language","blockTooltip","block","chunk","region","file","sun","info","VueI18n","messages","import","setLocaleMessage","querySelector","setAttribute","loadLanguageSettings","Vue","use","i18n","fallbackLocale","silentFallbackWarn","fallback","qualityStages","themes","setDebug","MainMenu","NULL_PAGE","openMore","filteredMarkerSets","thisMarkerSet","filter","search","visible","click","playerUuid","steve","markerLabel","followingPlayer","controlsManager","strippedLabel","v","toggle","$tc","toggleable","filteredMarkers","a","b","includesCI","selected","selectedMapId","switchMap","color","skyColor","g","mapId","body","requestFullscreen","disabled","enabled","forward","forwardPointer","changedTouches","identifier","preventDefault","up","upPointer","onTouchStop","evt","onFrame","cm","sin","rotation","cos","enable","mounted","addEventListener","events","beforeDestroy","removeEventListener","FreeFlightMobileControls","ControlBar","Tile","onLoad","onUnload","model","unloaded","loading","tileLoader","Promise","reject","unload","load","then","geometry","dispose","finally","TileMap","width","height","canvas","tileMapContext","getContext","alpha","willReadFrequently","texture","Texture","generateMipmaps","magFilter","LinearFilter","minFilter","wrapS","ClampToEdgeWrapping","wrapT","flipY","needsUpdate","fillStyle","fillRect","TileManager","scene","onTileLoad","onTileUnload","loadNextTile","loadTimeout","clearTimeout","currentlyLoading","setTimeout","loadCloseTiles","tile","add","tileMap","setTile","centerTile","tileMapHalfSize","EMPTY","remove","viewDistanceX","viewDistanceZ","tiles","Map","tileMapSize","unloadTiles","removeFarTiles","setAll","forEach","LOADED","removeAllTiles","hash","delete","clear","tryLoadTile","abs","tileHash","undefined","handleLoadedTile","handleUnloadedTile","catch","status","TileLoader","tilePath","material","tileSettings","tileCacheHash","layer","tileX","tileZ","tileUrl","resolve","fileLoader","geometryJson","bufferGeometryLoader","parse","Mesh","layers","tileSize","translate","scale","userData","updateMatrixWorld","FileLoader","setResponseType","BufferGeometryLoader","MarkerSet","defaultHide","isMarkerSet","isMarker","indexOf","children","child","Scene","UniformsLib","line","linewidth","dashScale","dashSize","gapSize","opacity","ShaderLib","UniformsUtils","merge","common","fog","vertexShader","fragmentShader","LineMaterial","parameters","ShaderMaterial","clone","clipping","dashed","defineProperties","diffuse","copy","setValues","constructor","isLineMaterial","MARKER_FILL_VERTEX_SHADER","ShaderChunk","logdepthbuf_pars_vertex","logdepthbuf_vertex","MARKER_FILL_FRAGMENT_SHADER","logdepthbuf_pars_fragment","logdepthbuf_fragment","LineSegmentsGeometry","InstancedBufferGeometry","positions","uvs","index","setIndex","Float32BufferAttribute","assign","isLineSegmentsGeometry","applyMatrix4","matrix","start","attributes","instanceStart","end","instanceEnd","boundingBox","computeBoundingBox","boundingSphere","computeBoundingSphere","setPositions","array","lineSegments","Float32Array","instanceBuffer","InstancedInterleavedBuffer","InterleavedBufferAttribute","setColors","colors","instanceColorBuffer","fromWireframeGeometry","fromEdgesGeometry","fromMesh","mesh","WireframeGeometry","fromLineSegments","isGeometry","vertices","isBufferGeometry","box","Box3","setFromBufferAttribute","union","vector","Sphere","center","getCenter","maxRadiusSq","il","count","fromBufferAttribute","distanceToSquared","radius","sqrt","isNaN","toJSON","applyMatrix","LineGeometry","isLineGeometry","points","fromLine","LineSegments2","isLineSegments2","computeLineDistances","lineDistances","distanceTo","instanceDistanceBuffer","raycast","Vector4","ssOrigin","ssOrigin3","mvMatrix","Matrix4","Line3","closestPoint","raycaster","intersects","camera","threshold","params","Line2","ray","projectionMatrix","lineWidth","at","w","matrixWorldInverse","multiplyScalar","matrixWorld","multiplyMatrices","isBehindCameraNear","isPastCameraFar","param","closestPointToPointParameter","zPos","lerp","isInClipSpace","isInside","pointOnLine","point","distanceSqToSegment","distance","origin","face","faceIndex","uv","uv2","isLine2","Marker","markerId","markerData","fadeDistanceMin","fadeDistanceMax","calculateDistanceToCameraPlane","minDelta","maxDelta","_posRelativeToCamera","subVectors","getWorldDirection","_cameraDirection","dot","Object3D","CSS2DObject","parent","parentNode","replaceChild","appendChild","anchor","traverse","Element","removeChild","lastClick","handleClick","doubleTap","now","Date","onClick","CSS2DRenderer","_width","_height","_widthHalf","_heightHalf","_this","viewMatrix","viewProjectionMatrix","cache","objects","WeakMap","domElement","overflow","getSize","setSize","renderObject","parentVisible","onBeforeRender","setFromMatrixPosition","WebkitTransform","MozTransform","oTransform","transform","display","objectData","distanceToCameraSquared","getDistanceToSquared","onAfterRender","filterAndFlatten","zOrder","sorted","sort","distanceA","distanceB","zMax","zIndex","render","autoUpdate","ObjectMarker","link","newTab","pos","intersection","sub","popup","LabelPopup","setX","setY","setZ","autoClose","targetOpacity","inAnimation","removeHandler","composedPath","includes","startOpacity","completed","ShapeMarker","zero","shape","Shape","fill","ShapeMarkerFill","border","ShapeMarkerBorder","renderOrder","_markerData","relativeY","updateGeometry","setShape","createShapeFromData","setShapeY","shapeY","depthTest","bc","lineColor","borderColor","setRGB","fc","fillColor","minDist","minDistance","maxDist","maxDistance","MAX_VALUE","shapeData","createGeometry","side","DoubleSide","transparent","markerColor","Color","markerOpacity","test","ShapeBufferGeometry","rotateX","PI","createLinePoints","vertexColors","innerWidth","innerHeight","renderer","points3d","getPoints","ExtrudeMarker","ExtrudeMarkerFill","ExtrudeMarkerBorder","minY","maxY","shapeMinY","shapeMaxY","ExtrudeBufferGeometry","depth","steps","bevelEnabled","prevPoint","LineMarker","LineMarkerLine","Error","isVector3","setLine","createPointsFromData","lc","HtmlMarker","elementObject","calculateDistanceOpacity","getElementsByTagName","anch","PoiMarker","iconElement","item","labelElement","_lastIcon","highlight","eventHandler","classList","contains","iconAnchor","icon","MarkerManager","markerScene","fileUrl","_updateInterval","ms","update","success","e","loadMarkerFile","markerFileData","updateFromData","setAutoUpdateInterval","removeMarkerSet","setId","removeMarker","loader","MarkerFileManager","updatedMarkerSets","Set","markerSetData","updateMarkerSetFromData","err","has","addMarkerSet","updatedMarkers","updateMarkerFromData","addMarker","PlayerMarker","world","playerHeadElement","playerNameElement","once","startPos","deltaPos","ease","PlayerMarkerManager","playerDataUrl","worldId","getPlayerMarkerSet","updatedPlayerMarkers","playerData","playerMarker","updatePlayerMarkerFromData","uuid","isPlayerMarker","dataUrl","settingsUrl","texturesUrl","hires","lowres","Raycaster","hiresMaterial","lowresMaterial","loadedTextures","hiresTileManager","lowresTileManager","hiresVertexShader","hiresFragmentShader","lowresVertexShader","lowresFragmentShader","settingsPromise","loadSettings","textureFilePromise","loadTexturesFile","createLowresMaterial","all","values","textures","createHiresMaterial","loadSettingsFile","worldSettings","hiresViewDistance","lowresViewDistance","isLoaded","hiresX","hiresZ","hiresViewX","hiresViewZ","lowresX","lowresZ","lowresViewX","lowresViewZ","loadAroundTile","materials","textureSettings","opaque","anisotropy","NearestFilter","NearestMipMapLinearFilter","flatShading","textureImage","depthWrite","VertexColors","FrontSide","wireframe","near","far","enableAll","hiresTileHash","lowresTileHash","intersectObjects","SKY_FRAGMENT_SHADER","SKY_VERTEX_SHADER","SkyboxScene","SphereGeometry","BackSide","skybox","ControlsManager","angle","tilt","lastPosition","lastRotation","lastAngle","lastDistance","lastOrtho","ortho","lastTilt","lastMapUpdatePosition","averageDeltaTime","_controls","updateCamera","valueChanged","isValueChanged","resetValueChanged","rotatableAngle","rotatableDistance","pow","rotationVector","angleRotationAxis","cross","applyAxisAngle","lookAt","rotateZ","triggerDistance","loadMapArea","screenPosition","handleMapInteraction","equals","stop","_mapViewer","_camera","Stats","container","addPanel","panel","dom","showPanel","hide","cssText","beginTime","performance","prevTime","frames","prevFrameTime","fpsPanel","Panel","msPanel","lastFrameMsPanel","memPanel","self","memory","REVISION","begin","usedJSHeapSize","jsHeapSizeLimit","setMode","fg","bg","Infinity","PR","devicePixelRatio","WIDTH","HEIGHT","TEXT_X","TEXT_Y","GRAPH_X","GRAPH_Y","GRAPH_WIDTH","GRAPH_HEIGHT","context","font","textBaseline","fillText","globalAlpha","maxValue","drawImage","HIRES_VERTEX_SHADER","HIRES_FRAGMENT_SHADER","LOWRES_VERTEX_SHADER","LOWRES_FRAGMENT_SHADER","CombinedCamera","fov","aspect","zoom","updateProjectionMatrix","ortographicProjection","perspectiveProjection","tan","DEG2RAD","view","fullWidth","fullHeight","offsetX","offsetY","skew","filmOffset","getFilmWidth","normalizedOrtho","orthoTop","orthoHeight","orthoWidth","orthoLeft","makePerspective","makeOrthographic","elements","projectionMatrixInverse","invert","isPerspectiveCamera","PerspectiveCamera","MapViewer","rootElement","clientWidth","clientHeight","setPixelRatio","css2dRenderer","renderLoop","stats","loadedCenter","hiresTileMap","size","WebGLRenderer","antialias","sortObjects","preserveDrawingBuffer","logarithmicDepthBuffer","autoClear","skyboxScene","skyboxCamera","initializeRootElement","handleContainerResize","outerDiv","pointerEvents","rootOffset","normalizedScreenPos","setFromCamera","hit","lowresHit","hiresHit","covered","parentRoot","intersections","clearDepth","isMap","initTexture","centerX","centerZ","newTileCacheHash","_controlsManager","_map","MouseMoveControls","speed","buttons","altKey","moving","deltaPosition","tempVec2_1","pixelToSpeedMultiplierX","pixelToSpeedMultiplierY","manager","updatePixelToSpeedMultiplier","onMouseDown","onMouseMove","onMouseUp","smoothing","directionDelta","rotateAround","lengthSq","MouseZoomControls","deltaY","deltaMode","WheelEvent","DOM_DELTA_PIXEL","DOM_DELTA_LINE","deltaZoom","onMouseWheel","passive","MouseRotateControls","ctrlKey","deltaRotation","lastX","MouseAngleControls","deltaAngle","lastY","MapHeightControls","cameraHeightStiffness","targetHeightStiffness","maxAngle","targetHeight","cameraHeight","minCameraHeight","distanceTagretHeight","updateHeights","getSuggestedHeight","targetSmoothing","targetTerrainHeight","terrainHeightAt","targetDelta","cameraSmoothing","cameraTerrainHeight","cameraDelta","maxAngleHeight","KeyCombination","code","modifiers","ctrl","CTRL","SHIFT","alt","ALT","shiftKey","combinations","combination","testDown","testUp","KeyMoveControls","oneDown","KEYS","UP","DOWN","down","LEFT","RIGHT","right","oneUp","onKeyDown","onKeyUp","rotatedDelta","temp_v2","KeyAngleControls","KeyRotateControls","KeyZoomControls","IN","in","OUT","out","TouchMoveControls","hammer","pointerType","onTouchDown","onTouchMove","onTouchUp","off","TouchRotateControls","TouchAngleControls","TouchZoomControls","lastZoom","HALF_PI","MapControls","lastTap","lastTapCenter","Manager","initializeHammer","mouseMove","mouseRotate","mouseAngle","mouseZoom","keyMove","keyRotate","keyAngle","keyZoom","touchMove","touchRotate","touchAngle","touchZoom","mapHeight","onContextMenu","onTap","stopFollowingPlayerMarker","_beforeMoveTemp","maxAngleForZoom","getMaxPerspectiveAngleForDistance","reset","touchTap","Tap","pointers","taps","Pan","direction","DIRECTION_ALL","touchTilt","DIRECTION_VERTICAL","Rotate","Pinch","recognizeWith","speedLeft","speedRight","speedCapture","pointerLockElement","movementX","pixelToSpeedMultiplier","movementY","KeyHeightControls","TouchPanControls","FreeFlightControls","clickStart","requestPointerLock","moveSpeed","keyHeight","touchPan","started","animationTargetHeight","onWheel","eventStack","PopupMarker","isHires","int","chunkCoords","divideScalar","regionCoords","regionFile","blocklight","hrPath","lrPath","cubeGeo","BoxGeometry","cubeMaterial","MeshBasicMaterial","cube","onMapInteraction","finished","setLocalStorage","localStorage","setItem","JSON","stringify","getLocalStorage","getItem","precision","f","BlueMapApp","followPlayerMarkerWorld","updateLoop","hashUpdateTimeout","updatePageAddress","history","replaceState","location","substr","getWorldPosition","startDistance","targetDistance","startX","targetX","startZ","targetZ","viewAnimation","ep","mapControls","playerMarkerManager","markerFileManager","savedUserSettings","mapsMap","mainMenu","freeFlightEnabled","initGeneralEvents","popupMarkerSet","popupMarker","oldMaps","getSettings","loadMaps","loadPageAddress","cameraMoved","mapInteraction","loadUserSettings","player","matchingMap","resetCameraIfNewWorld","oldWorld","initPlayerMarkerManager","initMarkerFileManager","mapSettings","BlueMapMap","map1","map2","ordinal","mouseInvert","fullscreen","transition","startY","targetY","startAngle","targetAngle","startOrtho","startTilt","startRotation","clearTileCache","saveUserSetting","reload","useCookies","loadUserSetting","defaultValue","val","toLowerCase","bluemap","getElementById","config","productionTip","vue","h","App","$mount","$nextTick"],"mappings":"aACE,SAASA,EAAqBC,GAQ7B,IAPA,IAMIC,EAAUC,EANVC,EAAWH,EAAK,GAChBI,EAAcJ,EAAK,GACnBK,EAAiBL,EAAK,GAIHM,EAAI,EAAGC,EAAW,GACpCD,EAAIH,EAASK,OAAQF,IACzBJ,EAAUC,EAASG,GAChBG,OAAOC,UAAUC,eAAeC,KAAKC,EAAiBX,IAAYW,EAAgBX,IACpFK,EAASO,KAAKD,EAAgBX,GAAS,IAExCW,EAAgBX,GAAW,EAE5B,IAAID,KAAYG,EACZK,OAAOC,UAAUC,eAAeC,KAAKR,EAAaH,KACpDc,EAAQd,GAAYG,EAAYH,IAG/Be,GAAqBA,EAAoBhB,GAE5C,MAAMO,EAASC,OACdD,EAASU,OAATV,GAOD,OAHAW,EAAgBJ,KAAKK,MAAMD,EAAiBb,GAAkB,IAGvDe,IAER,SAASA,IAER,IADA,IAAIC,EACIf,EAAI,EAAGA,EAAIY,EAAgBV,OAAQF,IAAK,CAG/C,IAFA,IAAIgB,EAAiBJ,EAAgBZ,GACjCiB,GAAY,EACRC,EAAI,EAAGA,EAAIF,EAAed,OAAQgB,IAAK,CAC9C,IAAIC,EAAQH,EAAeE,GACG,IAA3BX,EAAgBY,KAAcF,GAAY,GAE3CA,IACFL,EAAgBQ,OAAOpB,IAAK,GAC5Be,EAASM,EAAoBA,EAAoBC,EAAIN,EAAe,KAItE,OAAOD,EAIR,IAAIQ,EAAmB,GAKnBhB,EAAkB,CACrB,IAAO,GAGJK,EAAkB,GAGtB,SAASS,EAAoB1B,GAG5B,GAAG4B,EAAiB5B,GACnB,OAAO4B,EAAiB5B,GAAU6B,QAGnC,IAAIC,EAASF,EAAiB5B,GAAY,CACzCK,EAAGL,EACH+B,GAAG,EACHF,QAAS,IAUV,OANAf,EAAQd,GAAUW,KAAKmB,EAAOD,QAASC,EAAQA,EAAOD,QAASH,GAG/DI,EAAOC,GAAI,EAGJD,EAAOD,QAKfH,EAAoBM,EAAIlB,EAGxBY,EAAoBO,EAAIL,EAGxBF,EAAoBQ,EAAI,SAASL,EAASM,EAAMC,GAC3CV,EAAoBW,EAAER,EAASM,IAClC3B,OAAO8B,eAAeT,EAASM,EAAM,CAAEI,YAAY,EAAMC,IAAKJ,KAKhEV,EAAoBe,EAAI,SAASZ,GACX,qBAAXa,QAA0BA,OAAOC,aAC1CnC,OAAO8B,eAAeT,EAASa,OAAOC,YAAa,CAAEC,MAAO,WAE7DpC,OAAO8B,eAAeT,EAAS,aAAc,CAAEe,OAAO,KAQvDlB,EAAoBmB,EAAI,SAASD,EAAOE,GAEvC,GADU,EAAPA,IAAUF,EAAQlB,EAAoBkB,IAC/B,EAAPE,EAAU,OAAOF,EACpB,GAAW,EAAPE,GAA8B,kBAAVF,GAAsBA,GAASA,EAAMG,WAAY,OAAOH,EAChF,IAAII,EAAKxC,OAAOyC,OAAO,MAGvB,GAFAvB,EAAoBe,EAAEO,GACtBxC,OAAO8B,eAAeU,EAAI,UAAW,CAAET,YAAY,EAAMK,MAAOA,IACtD,EAAPE,GAA4B,iBAATF,EAAmB,IAAI,IAAIM,KAAON,EAAOlB,EAAoBQ,EAAEc,EAAIE,EAAK,SAASA,GAAO,OAAON,EAAMM,IAAQC,KAAK,KAAMD,IAC9I,OAAOF,GAIRtB,EAAoB0B,EAAI,SAAStB,GAChC,IAAIM,EAASN,GAAUA,EAAOiB,WAC7B,WAAwB,OAAOjB,EAAO,YACtC,WAA8B,OAAOA,GAEtC,OADAJ,EAAoBQ,EAAEE,EAAQ,IAAKA,GAC5BA,GAIRV,EAAoBW,EAAI,SAASgB,EAAQC,GAAY,OAAO9C,OAAOC,UAAUC,eAAeC,KAAK0C,EAAQC,IAGzG5B,EAAoB6B,EAAI,GAExB,IAAIC,EAAaC,OAAO,gBAAkBA,OAAO,iBAAmB,GAChEC,EAAmBF,EAAW3C,KAAKsC,KAAKK,GAC5CA,EAAW3C,KAAOf,EAClB0D,EAAaA,EAAWG,QACxB,IAAI,IAAItD,EAAI,EAAGA,EAAImD,EAAWjD,OAAQF,IAAKP,EAAqB0D,EAAWnD,IAC3E,IAAIU,EAAsB2C,EAI1BzC,EAAgBJ,KAAK,CAAC,EAAE,kBAEjBM,K,oGCvJT,W,oCCAA,W,oCCAA,W,oCCAA,W,kCCAA,W,oCCAA,W,oCCAA,W,oCCAA,W,oCCAA,W,oFCAA,W,6DCAA,W,2GCeA,ECGA,E,YClBI,EAAS,WAAa,IAAIyC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,MAAM,CAAC,cAAsC,UAAvBN,EAAIO,SAASC,MAAmB,aAAqC,SAAvBR,EAAIO,SAASC,OAAkBC,MAAM,CAAC,GAAK,QAAQ,CAAkC,SAAhCT,EAAIO,SAASG,SAASC,MAAkBP,EAAG,4BAA4BJ,EAAIY,KAAKR,EAAG,cAAcA,EAAG,WAAW,CAACK,MAAM,CAAC,KAAOT,EAAIO,SAASM,SAAS,IACnXC,EAAkB,GCDlB,EAAS,WAAa,IAAId,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACW,YAAY,eAAe,CAACX,EAAG,aAAa,CAACK,MAAM,CAAC,MAAQT,EAAIO,SAASM,KAAKG,OAAO,MAAO,EAAM,MAAQhB,EAAIiB,GAAG,iBAAiBC,GAAG,CAAC,OAAS,SAASC,GAAQ,OAAOnB,EAAIO,SAASM,KAAKO,iBAAiBhB,EAAG,MAAM,CAACW,YAAY,oBAAqBf,EAAIO,SAASc,KAAK1E,OAAS,EAAGyD,EAAG,YAAY,CAACW,YAAY,YAAYN,MAAM,CAAC,MAAQT,EAAIiB,GAAG,iBAAiBC,GAAG,CAAC,OAAS,SAASC,GAAQnB,EAAIO,SAASM,KAAKS,SAAS,OAAQtB,EAAIiB,GAAG,kBAAkB,CAACb,EAAG,MAAM,CAACK,MAAM,CAAC,QAAU,cAAc,CAACL,EAAG,UAAU,CAACK,MAAM,CAAC,OAAS,mHAAmHT,EAAIY,KAAMZ,EAAIuB,QAAQC,WAAW7E,OAAS,GAAKqD,EAAIuB,QAAQA,QAAQ5E,OAAS,EAAGyD,EAAG,YAAY,CAACW,YAAY,YAAYN,MAAM,CAAC,MAAQT,EAAIiB,GAAG,oBAAoBC,GAAG,CAAC,OAAS,SAASC,GAAQnB,EAAIO,SAASM,KAAKS,SAAS,UAAWtB,EAAIiB,GAAG,iBAAkB,CAACQ,UAAWzB,EAAIuB,aAAa,CAACnB,EAAG,MAAM,CAACK,MAAM,CAAC,QAAU,cAAc,CAACL,EAAG,OAAO,CAACK,MAAM,CAAC,EAAI,sTAAsTT,EAAIY,KAAOZ,EAAI0B,gBAAgBC,KAAsyE3B,EAAIY,KAApyER,EAAG,YAAY,CAACW,YAAY,YAAYN,MAAM,CAAC,MAAQT,EAAIiB,GAAG,oBAAoBC,GAAG,CAAC,OAASlB,EAAI4B,iBAAiB,CAACxB,EAAG,MAAM,CAACK,MAAM,CAAC,QAAU,cAAc,CAACL,EAAG,IAAI,CAACA,EAAG,OAAO,CAACK,MAAM,CAAC,EAAI,8qBAA8qBL,EAAG,OAAO,CAACK,MAAM,CAAC,EAAI,grBAAgrBL,EAAG,OAAO,CAACK,MAAM,CAAC,EAAI,ytBAAkuBL,EAAG,MAAM,CAACW,YAAY,2BAA2BX,EAAG,iBAAiB,CAACW,YAAY,YAAYN,MAAM,CAAC,MAAQT,EAAIiB,GAAG,sCAAsCb,EAAG,MAAM,CAACW,YAAY,oBAAoBX,EAAG,iBAAiB,CAACW,YAAY,cAAcX,EAAG,MAAM,CAACW,YAAY,oBAAoBX,EAAG,YAAY,CAACW,YAAY,YAAYN,MAAM,CAAC,MAAQT,EAAIiB,GAAG,wBAAwBC,GAAG,CAAC,OAAS,SAASC,GAAQ,OAAOnB,EAAI6B,SAASC,iBAAiB,CAAC1B,EAAG,MAAM,CAACK,MAAM,CAAC,QAAU,cAAc,CAACL,EAAG,OAAO,CAACK,MAAM,CAAC,EAAI,QAAQ,EAAI,QAAQ,UAAY,qDAAqD,MAAQ,QAAQ,OAAS,YAAYL,EAAG,OAAO,CAACK,MAAM,CAAC,EAAI,4QAA4QL,EAAG,gBAAgB,CAACW,YAAY,cAAcX,EAAG,UAAU,CAACK,MAAM,CAAC,MAAQT,EAAIiB,GAAG,uBAAuB,IAC1rJ,EAAkB,G,YCDlB,EAAS,WAAa,IAAIjB,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACW,YAAY,kBAAkB,CAACX,EAAG,cAAc,CAACK,MAAM,CAAC,MAAQ,IAAI,MAAQT,EAAIU,SAASqB,SAASC,GAAGd,GAAG,CAAC,MAAQ,SAASC,GAAQnB,EAAIU,SAASqB,SAASC,EAAIC,WAAWd,EAAOe,OAAOlD,WAA6C,SAAhCgB,EAAIO,SAASG,SAASC,MAAkBP,EAAG,cAAc,CAACK,MAAM,CAAC,MAAQ,IAAI,MAAQT,EAAIU,SAASqB,SAASI,GAAGjB,GAAG,CAAC,MAAQ,SAASC,GAAQnB,EAAIU,SAASqB,SAASI,EAAIF,WAAWd,EAAOe,OAAOlD,WAAYgB,EAAIY,KAAKR,EAAG,cAAc,CAACK,MAAM,CAAC,MAAQ,IAAI,MAAQT,EAAIU,SAASqB,SAASK,GAAGlB,GAAG,CAAC,MAAQ,SAASC,GAAQnB,EAAIU,SAASqB,SAASK,EAAIH,WAAWd,EAAOe,OAAOlD,YAAa,IAC9pB,EAAkB,GCDlB,EAAS,WAAa,IAAIgB,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACW,YAAY,gBAAgB,CAACX,EAAG,QAAQ,CAACA,EAAG,OAAO,CAACW,YAAY,SAAS,CAACf,EAAIqC,GAAGrC,EAAIsC,GAAGtC,EAAIuC,OAAO,OAAOnC,EAAG,QAAQ,CAACK,MAAM,CAAC,KAAO,UAAU+B,SAAS,CAAC,MAAQxC,EAAIyC,GAAG,SAAPzC,CAAiBA,EAAIhB,QAAQkC,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOnB,EAAI0C,MAAM,QAASvB,IAAS,QAAU,SAASA,GAAQ,OAAOA,EAAOwB,2BAC5Y,EAAkB,GCatB,G,UAAA,CACEpE,KAAM,cACNqE,MAAO,CACLL,MAAOM,OACP7D,MAAO8D,QAETC,QAAS,CACPC,OADJ,SACA,GACM,OAAOC,KAAKC,MAAMlE,OCtB4U,I,wBCQhWmE,EAAY,eACd,EACA,EACA,GACA,EACA,KACA,KACA,MAIa,EAAAA,E,QCRf,GACE,KAAF,gBACE,WAAF,CACI,YAAJ,GAEE,KALF,WAMI,MAAJ,CACM,SAAN,6CACM,SAAN,0BCnBsW,ICQlW,G,UAAY,eACd,EACA,EACA,GACA,EACA,KACA,KACA,OAIa,I,QCnBX,EAAS,WAAa,IAAInD,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,YAAY,CAACW,YAAY,UAAUG,GAAG,CAAC,OAASlB,EAAIoD,SAAS,CAAChD,EAAG,MAAM,CAACiD,MAAOrD,EAAS,MAAES,MAAM,CAAC,QAAU,cAAc,CAACL,EAAG,OAAO,CAACW,YAAY,QAAQN,MAAM,CAAC,EAAI,sKAAsKL,EAAG,OAAO,CAACW,YAAY,QAAQN,MAAM,CAAC,EAAI,6KACnd,EAAkB,G,0GCyBT6C,EAAY,IAAIC,OAAQ,EAAG,GAW3BC,GAVY,IAAIC,OAAQ,EAAG,EAAG,GACrB,IAAIA,OAAQ,EAAG,EAAG,GAClB,IAAIA,OAAQ,EAAG,EAAG,GAClB,IAAIA,OAAQ,EAAG,EAAG,GAOX,SAAAC,GACzB,IAAIC,EAAQC,SAASC,gBAAgB,+BAAgC,OAErE,OADAF,EAAMG,IAAMJ,EACLC,IASEI,EAAiB,SAAC/B,EAAGI,GAC9B,IAAI4B,EAAO,IAQX,OAPAA,GAAQC,EAAkBjC,GAE1BgC,GAAQ,IACRA,GAAQC,EAAkB7B,GAE1B4B,EAAOA,EAAKE,UAAU,EAAGF,EAAKrH,OAAS,GAEhCqH,GAQLC,EAAoB,SAAAE,GACtB,IAAIH,EAAO,GAEPG,EAAM,IACNA,GAAOA,EACPH,GAAQ,KAKZ,IAFA,IAAIjG,EAAIoG,EAAIC,WAEH3H,EAAI,EAAGA,EAAIsB,EAAEpB,OAAQF,IAC1BuH,GAAQjG,EAAEsG,OAAO5H,GAAK,IAG1B,OAAOuH,GASEM,EAAW,SAACtC,EAAGI,GAAJ,iBAAcJ,EAAd,YAAmBI,IAE9BmC,EAAoB,WAC7B,OAAOtB,KAAKuB,MAAsB,IAAhBvB,KAAKwB,WAUdC,EAAgB,SAACC,EAASC,GAAuB,IAAhBC,EAAgB,uDAAP,GACnD,GAAKF,GAAYA,EAAQD,cAEzB,OAAOC,EAAQD,cAAc,IAAII,YAAYF,EAAO,CAChDC,OAAQA,MAgBHE,EAAQ,SAACJ,EAASK,GAA4B,IAAnBC,EAAmB,uDAAX,OAGxCC,EAAiBR,EAAcC,EAAS,eAAgB,CACxDK,QAASA,EACTC,MAAOA,IAIPC,IACc,SAAVD,EACAE,QAAQC,IAAR,mBAAwBH,EAAxB,KAAkCD,GACjB,YAAVC,EACPE,QAAQE,KAAR,mBAAyBJ,EAAzB,KAAmCD,GAClB,UAAVC,EACPE,QAAQG,MAAR,mBAA0BL,EAA1B,KAAoCD,GAEpCG,QAAQI,MAAR,mBAA0BN,EAA1B,KAAoCD,KAWnCQ,EAAgB,SAAAC,GACzB,IAAIC,EAAW9B,SAAS+B,cAAc,YAEtC,OADAD,EAASE,UAAYH,EAAKI,OACnBH,EAASI,QAAQC,YAsBfC,EAAU,SAAUC,GAAyD,IAAzCC,EAAyC,uDAA5B,IAAMC,EAAsB,uDAAN,KAC5EC,EAAY,CACZC,gBAAiB,EACjBC,WAAY,EACZC,WAAW,EAEXC,MAAO,SAAUC,GAAM,WACnB,IAAIxG,KAAKsG,UAAT,EAE6B,IAAzBtG,KAAKoG,iBACLpG,KAAKoG,eAAiBI,EACtBxG,KAAKqG,UAAYG,GAGrB,IAAIC,EAA0B,IAAfR,EAAmB,EAAIS,OAAUC,OAAOH,EAAOxG,KAAKoG,gBAAkBH,EAAY,EAAG,GAChGW,EAAYJ,EAAOxG,KAAKqG,UAE5BL,EAAeS,EAAUG,GAErBH,EAAW,EAAG7G,OAAOiH,uBAAsB,SAAAL,GAAI,OAAI,EAAKD,MAAMC,MACzDN,GAAeA,GAAc,GAEtClG,KAAKqG,UAAYG,IAGrBM,OAAQ,WACJ9G,KAAKsG,WAAY,EACbJ,GAAeA,GAAc,KAMzC,OAFAtG,OAAOiH,uBAAsB,SAAAL,GAAI,OAAIL,EAAUI,MAAMC,MAE9CL,GAqBEY,EAAkB,CAE3BC,OAAQ,SAAAhI,GAAC,OAAIA,GAEbiI,WAAY,SAAAjI,GAAC,OAAIA,EAAEA,GAEnBkI,YAAa,SAAAlI,GAAC,OAAIA,GAAG,EAAEA,IAEvBmI,cAAe,SAAAnI,GAAC,OAAIA,EAAE,GAAK,EAAEA,EAAEA,GAAQ,EAAE,EAAEA,GAAGA,EAAV,GAEpCoI,YAAa,SAAApI,GAAC,OAAIA,EAAEA,EAAEA,GAEtBqI,aAAc,SAAArI,GAAC,QAAOA,EAAGA,EAAEA,EAAE,GAE7BsI,eAAgB,SAAAtI,GAAC,OAAIA,EAAE,GAAK,EAAEA,EAAEA,EAAEA,GAAKA,EAAE,IAAI,EAAEA,EAAE,IAAI,EAAEA,EAAE,GAAG,GAE5DuI,YAAa,SAAAvI,GAAC,OAAIA,EAAEA,EAAEA,EAAEA,GAExBwI,aAAc,SAAAxI,GAAC,OAAI,KAAKA,EAAGA,EAAEA,EAAEA,GAE/ByI,eAAgB,SAAAzI,GAAC,OAAIA,EAAE,GAAK,EAAEA,EAAEA,EAAEA,EAAEA,EAAI,EAAE,IAAKA,EAAGA,EAAEA,EAAEA,GAEtD0I,YAAa,SAAA1I,GAAC,OAAIA,EAAEA,EAAEA,EAAEA,EAAEA,GAE1B2I,aAAc,SAAA3I,GAAC,OAAI,IAAKA,EAAGA,EAAEA,EAAEA,EAAEA,GAEjC4I,eAAgB,SAAA5I,GAAC,OAAIA,EAAE,GAAK,GAAGA,EAAEA,EAAEA,EAAEA,EAAEA,EAAI,EAAE,KAAMA,EAAGA,EAAEA,EAAEA,EAAEA,IAWnD6I,EAAgB,SAAAnD,GACzB,IAAIoD,EAAOpD,EAAQqD,wBACfC,EAAapI,OAAOqI,aAAetE,SAASuE,gBAAgBF,WAC5DG,EAAYvI,OAAOwI,aAAezE,SAASuE,gBAAgBC,UAC/D,MAAO,CAAEE,IAAKP,EAAKO,IAAMF,EAAWG,KAAMR,EAAKQ,KAAON,IAS7CO,EAAa,SAAbA,EAAcC,EAASC,GAChC,GAAI9L,OAAO+L,GAAGF,EAASC,GAAU,OAAO,EAExC,IAAIE,EAAO,eAAOH,GAClB,GAAIG,IAAS,eAAOF,GAAS,OAAO,EAEpC,GAAa,WAATE,GAA8B,YAATA,GAA+B,WAATA,EAAmB,OAAO,EAEzE,GAAIC,MAAMC,QAAQL,GAAS,CACvB,IAAIM,EAAMN,EAAQ9L,OAClB,GAAIoM,IAAQL,EAAQ/L,OAAQ,OAAO,EACnC,IAAK,IAAIF,EAAI,EAAGA,EAAIsM,EAAKtM,IACrB,IAAK+L,EAAWC,EAAQhM,GAAIiM,EAAQjM,IAAK,OAAO,EAGpD,OAAO,EAGX,IAAK,IAAIiD,KAAY+I,EACjB,GAAKA,EAAQ3L,eAAe4C,KACvB8I,EAAWC,EAAQ/I,GAAWgJ,EAAQhJ,IAAY,OAAO,EAGlE,OAAO,GAwCEsJ,EAAU,SAAChK,EAAOiK,EAAKC,GAChC,GAAIlK,GAASiK,EAAK,OAAOjK,EACzB,IAAImK,EAAQF,EAAMjK,EAClB,OAAImK,EAAQ,KAAeF,EACpBjK,EAAQmK,EAAQD,GAUdE,EAAU,SAACpK,EAAOqK,EAAKH,GAChC,GAAIlK,GAASqK,EAAK,OAAOrK,EACzB,IAAImK,EAAQnK,EAAQqK,EACpB,OAAIF,EAAQ,KAAeE,EACpBrK,EAAQmK,EAAQD,GAWdI,EAAY,SAACtK,EAAOiK,EAAKI,EAAKH,GACvC,OAAOE,EAAQJ,EAAQhK,EAAOiK,EAAKC,GAAYG,EAAKH,ICpXpD,EAAS,WAAa,IAAIlJ,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACW,YAAY,aAAaT,MAAM,CAACiJ,OAAQvJ,EAAIuJ,QAAQrI,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOnB,EAAI0C,MAAM,SAAUvB,MAAW,CAACnB,EAAIwJ,GAAG,YAAY,IACjP,EAAkB,GCMtB,GACE,KAAF,YACE,MAAF,CACI,OAAJ,UCVkW,ICQ9V,G,UAAY,eACd,EACA,EACA,GACA,EACA,KACA,KACA,OAIa,I,QjBFf,GACE,KAAF,UACE,WAAF,CAAI,UAAJ,GACE,KAHF,WAII,MAAJ,CACM,SAAN,+CAGE,SAAF,CACI,MADJ,WAEM,MAAN,CAAQ,UAAR,kEAGE,QAAF,CACI,OADJ,SACA,GAAM,IAAN,OACM,EAAN,iBAEA,cAEM,IAAN,yBACM,EAAN,eACQ,EAAR,2CACA,QkBvCgW,ICQ5V,G,UAAY,eACd,EACA,EACA,GACA,EACA,KACA,KACA,OAIa,I,QCnBX,GAAS,WAAa,IAAIxJ,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,YAAY,CAACW,YAAY,mBAAmBN,MAAM,CAAC,QAAUT,EAAIyJ,OAAOvI,GAAG,CAAC,OAASlB,EAAIoD,SAAS,CAAChD,EAAG,MAAM,CAACK,MAAM,CAAC,QAAU,cAAc,CAACL,EAAG,OAAO,CAACK,MAAM,CAAC,EAAI,sQAAsQL,EAAG,SAAS,CAACK,MAAM,CAAC,GAAK,QAAQ,GAAK,OAAO,EAAI,WAAWL,EAAG,SAAS,CAACK,MAAM,CAAC,GAAK,SAAS,GAAK,QAAQ,EAAI,WAAWL,EAAG,SAAS,CAACK,MAAM,CAAC,GAAK,SAAS,GAAK,SAAS,EAAI,WAAWL,EAAG,SAAS,CAACK,MAAM,CAAC,GAAK,SAAS,GAAK,SAAS,EAAI,gBACrvB,GAAkB,GnBmBtB,IACE,KAAF,iBACEiJ,WAAY,CAAd,aACEvN,KAHF,WAII,MAAJ,CACM,UAAN,+BAGE,SAAF,CACI,MADJ,WAEM,OAAN,oDAGE,QAAF,CACI,OADJ,SACA,GAAM,IAAN,OAEM,EAAN,iBAEA,cAEM,IAAN,iDACA,mBACM,EAAN,eACQ,IAAR,mBACQ,EAAR,wDACA,QoB7CuW,MCQnW,I,UAAY,eACd,GACA,GACA,IACA,EACA,KACA,KACA,OAIa,M,QCnBX,GAAS,WAAa,IAAI6D,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACW,YAAY,mBAAmB,CAACX,EAAG,YAAY,CAACK,MAAM,CAAC,OAAST,EAAI2J,kBAAkB,MAAQ3J,EAAIiB,GAAG,iCAAiCC,GAAG,CAAC,OAASlB,EAAI4J,qBAAqB,CAACxJ,EAAG,MAAM,CAACK,MAAM,CAAC,QAAU,cAAc,CAACL,EAAG,OAAO,CAACK,MAAM,CAAC,EAAI,w+BAAw+BL,EAAG,YAAY,CAACK,MAAM,CAAC,OAAST,EAAI6J,WAAW,MAAQ7J,EAAIiB,GAAG,8BAA8BC,GAAG,CAAC,OAASlB,EAAI8J,cAAc,CAAC1J,EAAG,MAAM,CAACK,MAAM,CAAC,QAAU,cAAc,CAACL,EAAG,OAAO,CAACK,MAAM,CAAC,EAAI,2HAA4HT,EAAIU,SAA0B,kBAAEN,EAAG,YAAY,CAACK,MAAM,CAAC,OAAST,EAAI+J,aAAa,MAAQ/J,EAAIiB,GAAG,gCAAgCC,GAAG,CAAC,OAASlB,EAAIgK,gBAAgB,CAAC5J,EAAG,MAAM,CAACK,MAAM,CAAC,QAAU,cAAc,CAACL,EAAG,OAAO,CAACK,MAAM,CAAC,EAAI,6tBAA6tBT,EAAIY,MAAM,IAC5jF,GAAkB,GCmCtB,IACE,KAAF,iBACE,WAAF,CAAI,UAAJ,GACE,KAHF,WAII,MAAJ,CACM,SAAN,kCAGE,SAAF,CACI,kBADJ,WAEM,MAAN,qCAEI,WAJJ,WAKM,MAAN,8BAEI,aAPJ,WAQM,MAAN,+BAGE,QAAF,CACI,mBADJ,WAEM,KAAN,0DAEI,YAJJ,WAKM,KAAN,mDAEI,cAPJ,WAQM,KAAN,+BC/DuW,MCQnW,I,UAAY,eACd,GACA,GACA,IACA,EACA,KACA,KACA,OAIa,M,QCnBX,GAAS,WAAa,IAAIZ,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,YAAY,CAACW,YAAY,cAAcT,MAAM,CAAC2J,MAAOjK,EAAIiK,MAAOC,KAAMlK,EAAIkK,MAAMhJ,GAAG,CAAC,OAAS,SAASC,GAAQ,OAAOnB,EAAI0C,MAAM,SAAUvB,MAAW,CAACf,EAAG,MAAM,CAACK,MAAM,CAAC,QAAU,cAAc,CAACL,EAAG,IAAI,CAACA,EAAG,OAAO,CAACK,MAAM,CAAC,EAAI,0LAA0LL,EAAG,OAAO,CAACK,MAAM,CAAC,EAAI,sLAAsLL,EAAG,OAAO,CAACK,MAAM,CAAC,EAAI,yMACxtB,GAAkB,GCgBtB,IACElC,KAAM,aACNmL,WAAY,CAAd,aACE9G,MAAO,CACLqH,MAAOE,QACPD,KAAMC,UCtByV,MCQ/V,I,UAAY,eACd,GACA,GACA,IACA,EACA,KACA,KACA,OAIa,M,QCmDf,IACE,KAAF,aACE,WAAF,CACI,UAAJ,EACI,WAAJ,GACI,eAAJ,GACI,eAAJ,GACI,cAAJ,EACI,QAAJ,GAEE,KAVF,WAWI,MAAJ,CACM,SAAN,uBACM,QAAN,uCAGE,SAAF,CACI,gBADJ,WACM,IAAN,mBACA,yBADM,IACE,IAAK,EAAb,oCACU,GAAe,eAAXC,EAAIC,GAAqB,OAAOD,GAF9C,8BAKM,MAAN,CACQ,GAAR,aACQ,MAAR,UACQ,WAAR,GACQ,QAAR,GACQ,MAAR,KAIE,QAAF,CACI,eADJ,WAEM,IAAN,uBACM,KAAN,2DAAQ,UAAR,OCxGmW,MCQ/V,I,UAAY,eACd,GACA,EACA,GACA,EACA,KACA,KACA,OAIa,M,QCnBX,GAAS,WAAa,IAAIpK,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,WAAW,CAACK,MAAM,CAAC,KAAOT,EAAIa,KAAKG,OAAO,MAAQhB,EAAIa,KAAKyJ,cAAcC,MAAM,KAAOvK,EAAIa,KAAK2J,UAAU7N,OAAS,GAAGuE,GAAG,CAAC,KAAO,SAASC,GAAQ,OAAOnB,EAAIa,KAAK4J,aAAa,MAAQ,SAAStJ,GAAQ,OAAOnB,EAAIa,KAAK6J,cAAc,CAAgC,SAA9B1K,EAAIa,KAAKyJ,cAAcD,GAAejK,EAAG,MAAM,CAACA,EAAG,eAAe,CAACK,MAAM,CAAC,SAAU,GAAMS,GAAG,CAAC,OAAS,SAASC,GAAQnB,EAAIa,KAAKS,SAAS,QAAQ,WAAc,OAAOtB,EAAIiB,GAAG,oBAAqB,CAACjB,EAAIqC,GAAGrC,EAAIsC,GAAGtC,EAAIiB,GAAG,mBAAmBb,EAAG,eAAe,CAACK,MAAM,CAAC,SAAU,GAAMS,GAAG,CAAC,OAAS,SAASC,GAAQnB,EAAIa,KAAKS,SAAS,WAAW,WAAc,OAAOtB,EAAIiB,GAAG,mBAAqB,CAACQ,UAAWzB,EAAIuB,aAAa,CAACvB,EAAIqC,GAAGrC,EAAIsC,GAAGtC,EAAIiB,GAAG,sBAAsBb,EAAG,eAAe,CAACK,MAAM,CAAC,SAAU,GAAMS,GAAG,CAAC,OAAS,SAASC,GAAQnB,EAAIa,KAAKS,SAAS,YAAY,WAAc,OAAOtB,EAAIiB,GAAG,wBAAyB,CAACjB,EAAIqC,GAAGrC,EAAIsC,GAAGtC,EAAIiB,GAAG,uBAAuBb,EAAG,eAAe,CAACK,MAAM,CAAC,SAAU,GAAMS,GAAG,CAAC,OAAS,SAASC,GAAQnB,EAAIa,KAAKS,SAAS,QAAQ,WAAc,OAAOtB,EAAIiB,GAAG,oBAAqB,CAACjB,EAAIqC,GAAGrC,EAAIsC,GAAGtC,EAAIiB,GAAG,mBAAmBb,EAAG,MAAMA,EAAG,eAAe,CAACc,GAAG,CAAC,OAASlB,EAAI2K,eAAe,CAAC3K,EAAIqC,GAAGrC,EAAIsC,GAAGtC,EAAIiB,GAAG,2BAA2Bb,EAAG,eAAe,CAACc,GAAG,CAAC,OAAS,SAASC,GAAQ,OAAOnB,EAAI6B,SAASC,iBAAiB,CAAC9B,EAAIqC,GAAGrC,EAAIsC,GAAGtC,EAAIiB,GAAG,0BAA0Bb,EAAG,eAAe,CAACK,MAAM,CAAC,MAAQT,EAAIiB,GAAG,sBAAsBC,GAAG,CAAC,OAAS,SAASC,GAAQ,OAAOnB,EAAI6B,SAAS+I,eAAe,CAAC5K,EAAIqC,GAAGrC,EAAIsC,GAAGtC,EAAIiB,GAAG,yBAAyB,GAAGjB,EAAIY,KAAoC,SAA9BZ,EAAIa,KAAKyJ,cAAcD,GAAejK,EAAG,MAAMJ,EAAI6K,GAAI7K,EAAIO,SAAa,MAAE,SAASuK,GAAK,OAAO1K,EAAG,YAAY,CAACd,IAAIwL,EAAIT,GAAG5J,MAAM,CAAC,IAAMqK,QAAS,GAAG9K,EAAIY,KAAoC,YAA9BZ,EAAIa,KAAKyJ,cAAcD,GAAkBjK,EAAG,gBAAgB,CAACK,MAAM,CAAC,KAAOT,EAAIa,QAAQb,EAAIY,KAAoC,aAA9BZ,EAAIa,KAAKyJ,cAAcD,GAAmBjK,EAAG,gBAAgBJ,EAAIY,KAAoC,SAA9BZ,EAAIa,KAAKyJ,cAAcD,GAAejK,EAAG,MAAM,CAACW,YAAY,eAAeyB,SAAS,CAAC,UAAYxC,EAAIsC,GAAGtC,EAAIiB,GAAG,oBAAoBjB,EAAIY,MAAM,IACthE,GAAkB,GCDlB,GAAS,WAAa,IAAIZ,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,aAAa,CAACK,MAAM,CAAC,KAAO,aAAaS,GAAG,CAAC,MAAQ,SAASC,GAAQnB,EAAI+K,uBAAwB/K,EAAI0C,MAAM,QAASvB,MAAW,CAAEnB,EAAQ,KAAEI,EAAG,MAAM,CAACW,YAAY,aAAa,CAACX,EAAG,aAAa,CAACK,MAAM,CAAC,MAAQT,EAAIgL,MAAQhL,EAAIiL,SAAS,KAAOjL,EAAIkK,MAAMhJ,GAAG,CAAC,OAAS,SAASC,GAAQ,OAAOnB,EAAI0C,MAAM,OAAQvB,OAAanB,EAAIgL,MAAQhL,EAAIkK,KAAM9J,EAAG,aAAa,CAACW,YAAY,aAAaN,MAAM,CAAC,OAAQ,GAAMS,GAAG,CAAC,OAAS,SAASC,GAAQ,OAAOnB,EAAI0C,MAAM,QAASvB,OAAYnB,EAAIY,KAAKR,EAAG,MAAM,CAACW,YAAY,SAAS,CAACf,EAAIqC,GAAGrC,EAAIsC,GAAGtC,EAAIuK,UAAUnK,EAAG,MAAM,CAACW,YAAY,WAAW,CAACf,EAAIwJ,GAAG,YAAY,IAAI,GAAGxJ,EAAIY,QAC3rB,GAAkB,G,yBCetB,IACErC,KAAM,WACNmL,WAAY,CAAd,eACE9G,MAAO,CACL2H,MAAO,CACL3B,KAAM/F,OACNqI,QAAS,QAEXF,KAAM,CACJpC,KAAMuB,QACNe,SAAS,GAEXhB,KAAMC,SAERhO,KAdF,WAeI,MAAO,CACL8O,UAAU,IAGdE,QAAS,CACP,qBADJ,WACA,gKACA,cADA,SAEA,cAFA,uBAGA,cAHA,OAIA,cAJA,gDCpCiW,MCQ7V,I,UAAY,eACd,GACA,GACA,IACA,EACA,KACA,KACA,OAIa,M,QCnBX,GAAS,WAAa,IAAInL,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACW,YAAY,gBAAgBT,MAAM,CAACiJ,OAAQvJ,EAAIuJ,QAAQrI,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOnB,EAAI0C,MAAM,aAAa,CAACtC,EAAG,MAAM,CAACW,YAAY,SAAS,CAACf,EAAIwJ,GAAG,YAAY,GAAIxJ,EAAW,QAAEI,EAAG,MAAM,CAACW,YAAY,gBAAgB,CAACX,EAAG,MAAM,CAACK,MAAM,CAAC,QAAU,cAAc,CAACL,EAAG,OAAO,CAACK,MAAM,CAAC,EAAI,0LAA0LL,EAAG,OAAO,CAACK,MAAM,CAAC,EAAI,sMAAsMT,EAAIY,QAC9xB,GAAkB,GCctB,IACErC,KAAM,eACNqE,MAAO,CACLwI,QAASjB,QACTZ,OAAQ,CACNX,KAAMuB,QACNe,SAAS,KCrBsV,MCQjW,I,UAAY,eACd,GACA,GACA,IACA,EACA,KACA,KACA,OAIa,M,QCnBX,GAAS,WAAa,IAAIlL,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACA,EAAG,QAAQ,CAACK,MAAM,CAAC,MAAQT,EAAIiB,GAAG,oBAAoB,CAACb,EAAG,eAAe,CAACK,MAAM,CAAC,OAAyC,gBAAhCT,EAAIO,SAASG,SAASC,OAAyBO,GAAG,CAAC,OAAS,SAASC,GAAQ,OAAOnB,EAAI6B,SAAS+H,mBAAmB,IAAqC,SAAhC5J,EAAIO,SAASG,SAASC,MAAmB,IAAM,MAAM,CAACX,EAAIqC,GAAGrC,EAAIsC,GAAGtC,EAAIiB,GAAG,mCAAmCb,EAAG,eAAe,CAACK,MAAM,CAAC,OAAyC,SAAhCT,EAAIO,SAASG,SAASC,OAAkBO,GAAG,CAAC,OAAS,SAASC,GAAQ,OAAOnB,EAAI6B,SAASiI,YAAY,IAAqC,SAAhC9J,EAAIO,SAASG,SAASC,MAAmB,IAAM,MAAM,CAACX,EAAIqC,GAAGrC,EAAIsC,GAAGtC,EAAIiB,GAAG,gCAAgCb,EAAG,eAAe,CAACK,MAAM,CAAC,OAAyC,SAAhCT,EAAIO,SAASG,SAASC,OAAkBO,GAAG,CAAC,OAAS,SAASC,GAAQ,OAAOnB,EAAI6B,SAASmI,cAAc,QAAQ,CAAChK,EAAIqC,GAAGrC,EAAIsC,GAAGtC,EAAIiB,GAAG,mCAAmC,GAAGb,EAAG,QAAQ,CAACK,MAAM,CAAC,MAAQT,EAAIiB,GAAG,oBAAoB,CAACb,EAAG,SAAS,CAACK,MAAM,CAAC,MAAQT,EAAIqL,UAAUC,SAASC,iBAAiBvM,MAAM,IAAM,EAAE,IAAM,EAAE,KAAO,KAAMkC,GAAG,CAAC,OAAS,SAASC,GAAQnB,EAAIqL,UAAUC,SAASC,iBAAiBvM,MAAQmC,KAAU,CAACnB,EAAIqC,GAAGrC,EAAIsC,GAAGtC,EAAIiB,GAAG,yBAAyBb,EAAG,SAAS,CAACK,MAAM,CAAC,MAAQT,EAAIqL,UAAUC,SAASE,aAAaxM,MAAM,IAAM,EAAE,IAAM,EAAE,KAAO,KAAMkC,GAAG,CAAC,OAAS,SAASC,GAAQnB,EAAIqL,UAAUC,SAASE,aAAaxM,MAAQmC,KAAU,CAACnB,EAAIqC,GAAGrC,EAAIsC,GAAGtC,EAAIiB,GAAG,8BAA8B,GAAGb,EAAG,QAAQ,CAACK,MAAM,CAAC,MAAQT,EAAIiB,GAAG,sBAAsBjB,EAAI6K,GAAI7K,EAAiB,eAAE,SAASyL,GAAO,OAAOrL,EAAG,eAAe,CAACd,IAAImM,EAAMlN,KAAKkC,MAAM,CAAC,OAAST,EAAIqL,UAAUK,gBAAkBD,EAAMzM,OAAOkC,GAAG,CAAC,OAAS,SAASC,GAAQnB,EAAI6B,SAASwJ,UAAUK,cAAgBD,EAAMzM,MAAOgB,EAAI6B,SAAS8J,sBAAuB,CAAC3L,EAAIqC,GAAGrC,EAAIsC,GAAGmJ,EAAMlN,YAAW,GAAG6B,EAAG,QAAQ,CAACK,MAAM,CAAC,MAAQT,EAAIiB,GAAG,0BAA0B,CAACb,EAAG,SAAS,CAACK,MAAM,CAAC,MAAQT,EAAIqL,UAAUO,wBAAwB,IAAM,GAAG,IAAM,IAAI,KAAO,IAAI1K,GAAG,CAAC,OAAS,SAASC,GAAQnB,EAAIqL,UAAUO,wBAA0BzK,EAAQnB,EAAI6B,SAASwJ,UAAUQ,uBAAuB,KAAO,SAAS1K,GAAQ,OAAOnB,EAAI6B,SAAS8J,sBAAsB,CAAC3L,EAAIqC,GAAGrC,EAAIsC,GAAGtC,EAAIiB,GAAG,iCAAiCb,EAAG,SAAS,CAACK,MAAM,CAAC,MAAQT,EAAIqL,UAAUS,yBAAyB,IAAM,IAAI,IAAM,IAAM,KAAO,KAAK5K,GAAG,CAAC,OAAS,SAASC,GAAQnB,EAAIqL,UAAUS,yBAA2B3K,EAAQnB,EAAI6B,SAASwJ,UAAUQ,uBAAuB,KAAO,SAAS1K,GAAQ,OAAOnB,EAAI6B,SAAS8J,sBAAsB,CAAC3L,EAAIqC,GAAGrC,EAAIsC,GAAGtC,EAAIiB,GAAG,mCAAmC,GAAGb,EAAG,QAAQ,CAACK,MAAM,CAAC,MAAQT,EAAIiB,GAAG,8BAA8B,CAACb,EAAG,SAAS,CAACK,MAAM,CAAC,MAAQT,EAAIO,SAASG,SAASqL,iBAAiB,IAAM,GAAI,IAAM,EAAE,KAAO,KAAM7K,GAAG,CAAC,OAAS,SAASC,GAAQnB,EAAIO,SAASG,SAASqL,iBAAmB5K,EAAQnB,EAAI6B,SAASmK,0BAA2B,KAAO,SAAS7K,GAAQ,OAAOnB,EAAI6B,SAAS8J,sBAAsB,CAAC3L,EAAIqC,GAAGrC,EAAIsC,GAAGtC,EAAIiB,GAAG,2CAA2Cb,EAAG,eAAe,CAACK,MAAM,CAAC,GAAKT,EAAIO,SAASG,SAASuL,aAAa/K,GAAG,CAAC,OAAS,SAASC,GAAQnB,EAAIO,SAASG,SAASuL,aAAejM,EAAIO,SAASG,SAASuL,YAAajM,EAAI6B,SAASmK,yBAA0BhM,EAAI6B,SAAS8J,sBAAsB,CAAC3L,EAAIqC,GAAGrC,EAAIsC,GAAGtC,EAAIiB,GAAG,wCAAwC,GAAGb,EAAG,QAAQ,CAACK,MAAM,CAAC,MAAQT,EAAIiB,GAAG,iBAAiBjB,EAAI6K,GAAI7K,EAAU,QAAE,SAASQ,GAAO,OAAOJ,EAAG,eAAe,CAACd,IAAIkB,EAAMjC,KAAKkC,MAAM,CAAC,OAAST,EAAIO,SAASC,QAAUA,EAAMxB,OAAOkC,GAAG,CAAC,OAAS,SAASC,GAAQnB,EAAI6B,SAASqK,SAAS1L,EAAMxB,OAAQgB,EAAI6B,SAAS8J,sBAAuB,CAAC3L,EAAIqC,GAAGrC,EAAIsC,GAAG9B,EAAMjC,YAAW,GAAIyB,EAAImM,MAAMC,UAAUzP,OAAS,EAAGyD,EAAG,QAAQ,CAACK,MAAM,CAAC,MAAQT,EAAIiB,GAAG,oBAAoBjB,EAAI6K,GAAI7K,EAAImM,MAAe,WAAE,SAASE,GAAM,OAAOjM,EAAG,eAAe,CAACd,IAAI+M,EAAKC,OAAO7L,MAAM,CAAC,OAAS4L,EAAKC,SAAWtM,EAAImM,MAAMG,QAAQpL,GAAG,CAAC,OAAS,SAASC,GAAQnB,EAAImM,MAAMI,YAAYF,EAAKC,QAAStM,EAAI6B,SAAS8J,sBAAuB,CAAC3L,EAAIqC,GAAGrC,EAAIsC,GAAG+J,EAAK9N,YAAW,GAAGyB,EAAIY,KAAKR,EAAG,eAAe,CAACK,MAAM,CAAC,GAAKT,EAAIO,SAASgF,OAAOrE,GAAG,CAAC,OAAS,SAASC,GAAQnB,EAAIwM,cAAexM,EAAI6B,SAAS8J,sBAAuB,CAAC3L,EAAIqC,GAAGrC,EAAIsC,GAAGtC,EAAIiB,GAAG,oBAAoBb,EAAG,eAAe,CAACc,GAAG,CAAC,OAAS,SAASC,GAAQ,OAAOnB,EAAI6B,SAAS4K,mBAAmB,CAACzM,EAAIqC,GAAGrC,EAAIsC,GAAGtC,EAAIiB,GAAG,gCAAgC,IACnpI,GAAkB,GCDlB,GAAS,WAAa,IAAIjB,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACW,YAAY,SAAS,CAACX,EAAG,OAAO,CAACW,YAAY,SAAS,CAACf,EAAIqC,GAAGrC,EAAIsC,GAAGtC,EAAIuK,UAAUnK,EAAG,MAAM,CAACW,YAAY,WAAW,CAACf,EAAIwJ,GAAG,YAAY,MAC9O,GAAkB,GCStB,IACEjL,KAAM,QACNqE,MAAO,CACL2H,MAAO1H,SCbmV,MCQ1V,I,UAAY,eACd,GACA,GACA,IACA,EACA,KACA,KACA,OAIa,M,QCnBX,GAAS,WAAa,IAAI7C,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACW,YAAY,UAAU,CAACX,EAAG,MAAM,CAACW,YAAY,SAAS,CAACf,EAAIwJ,GAAG,WAAWxJ,EAAIqC,GAAG,MAAMjC,EAAG,OAAO,CAACW,YAAY,SAAS,CAACf,EAAIqC,GAAGrC,EAAIsC,GAAGtC,EAAI0M,oBAAoB,GAAGtM,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACK,MAAM,CAAC,KAAO,QAAQ,IAAMT,EAAIiJ,IAAI,IAAMjJ,EAAIqJ,IAAI,KAAOrJ,EAAI2M,MAAMnK,SAAS,CAAC,MAAQxC,EAAIhB,OAAOkC,GAAG,CAAC,MAAQ,SAASC,GAAQnB,EAAI0C,MAAM,SAAUT,WAAWd,EAAOe,OAAOlD,SAAS,OAAS,SAASmC,GAAQnB,EAAI0C,MAAM,OAAQT,WAAWd,EAAOe,OAAOlD,iBACthB,GAAkB,G,UCUtB,SAAS4N,GAAc5N,GACrB,OAAF,oBACSA,EAAMoF,WAAWyI,MAAM,KAAK,GAAGlQ,QAAU,EAGlD,QACE4B,KAAM,SACNqE,MAAO,CACL5D,MAAO8D,OACPmG,IAAKnG,OACLuG,IAAKvG,OACL6J,KAAM7J,QAERgK,SAAU,CACRJ,eADJ,WAEM,OAAOzK,WAAWhC,KAAKjB,OAAO+N,QAAQH,GAAc3M,KAAK0M,UC1BgS,MCQ3V,I,UAAY,eACd,GACA,GACA,IACA,EACA,KACA,KACA,OAIa,M,QCnBX,GAAS,WAAa,IAAI3M,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACW,YAAY,gBAAgBG,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOnB,EAAI0C,MAAM,aAAa,CAACtC,EAAG,MAAM,CAACW,YAAY,SAAS,CAACf,EAAIwJ,GAAG,YAAY,GAAGpJ,EAAG,eAAe,CAACK,MAAM,CAAC,GAAKT,EAAIkB,OAAO,IAC9R,GAAkB,GCDlB,GAAS,WAAa,IAAIlB,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACW,YAAY,SAAST,MAAM,CAACY,GAAIlB,EAAIkB,OAC1I,GAAkB,GCItB,IACE3C,KAAM,eACNqE,MAAO,CACL1B,GAAIiJ,UCR6V,MCQjW,I,UAAY,eACd,GACA,GACA,IACA,EACA,KACA,KACA,OAIa,M,QCVf,IACE5L,KAAM,eACNmL,WAAY,CAAd,iBACE9G,MAAO,CACL1B,GAAIiJ,UCb6V,MCQjW,I,UAAY,eACd,GACA,GACA,IACA,EACA,KACA,KACA,OAIa,M,qBCnBA,IACd6C,UAAW,kBACXnM,KAAM,CACL0J,MAAO,OACP0C,QAAS,QAEV5L,KAAM,CACLkJ,MAAO,OACP2C,OAAQ,OACRD,QAAS,YAEV1L,QAAS,CACRgJ,MAAO,UACP2C,OAAQ,UACRD,QAAS,cACTE,OAAQ,mBACR1L,UAAW,2BACX2L,kBAAmB,YACnBC,kBAAmB,iBAEpBC,SAAU,CACT/C,MAAO,WACP2C,OAAQ,YAETvC,aAAc,CACbuC,OAAQ,iBAETpL,YAAa,CACZoL,OAAQ,eACRD,QAAS,2BAEVrC,UAAW,CACVsC,OAAQ,aACRD,QAAS,oBAEVM,SAAU,CACThD,MAAO,WACPiD,eAAgB,CACfP,QAAS,aAEVQ,SAAU,WACVjC,aAAc,iBAEfkC,WAAY,CACXnD,MAAO,aACPoD,KAAM,kBACNC,OAAQ,sBACRC,IAAK,yBAENC,mBAAoB,CACnBvD,MAAO,uBACPwB,iBAAkB,oBAClBgC,aAAc,kBAEfC,eAAgB,CACfzD,MAAO,kBACP0D,WAAY,cACZC,YAAa,gBAEd1N,MAAO,CACN+J,MAAO,QACPW,QAAS,2BACTiD,KAAM,OACNC,MAAO,SAER7I,MAAO,CACN2H,OAAQ,SAETmB,iBAAkB,CACjBnB,OAAQ,sBAEToB,QAAS,CACR/D,MAAO,UACP0C,QAAS,eAEVsB,QAAS,CACRtB,QAAS,wBAEVvM,SAAU,CACT6J,MAAO,kBACPiE,YAAa,CACZtB,OAAQ,cACRD,QAAS,oBAEVwB,SAAU,CACTvB,OAAQ,OACRD,QAAS,4BAEVyB,WAAY,CACXxB,OAAQ,cACRD,QAAS,iCAGX0B,SAAU,CACTpE,MAAO,YAERqE,aAAc,CACbC,MAAO,QACP9M,SAAU,WACV+M,MAAO,QACPC,OAAQ,CACPA,OAAQ,SACRC,KAAM,QAEPZ,MAAO,CACNA,MAAO,QACPa,IAAK,MACLJ,MAAO,UAGTK,KAAM,CACL3E,MAAO,OACP2C,OAAQ,OACRpH,QAAS,mrCC7GXqJ,QAAQtS,UAAU0P,YAAlB,0DAAgC,WAAeF,GAAf,mGAEzBpM,KAAKmP,SAAS/C,GAFW,uBAGzB+C,EAAW,GAHc,SAIXC,OAAA,kBAA4ChD,EAA5C,QAJW,OAI7B+C,EAJ6B,OAI6ClE,QAE1EjL,KAAKqP,iBAAiBjD,EAAM+C,GANC,OAS9BnP,KAAKqM,OAASD,EACdzI,SAAS2L,cAAc,QAAQC,aAAa,OAAQnD,GAVtB,qDAY9BlH,QAAQG,MAAR,mCAA0C+G,EAA1C,YAZ8B,0DAAhC,sDAgBA8C,QAAQtS,UAAU4S,qBAAlB,yCAAyC,oHAClBJ,OAAiC,uBADf,OACpC/B,EADoC,OACuCpC,QAC/EjL,KAAKmM,UAAYkB,EAASlB,UAC1BnM,KAAKsM,YAAYe,EAASpC,SAHc,gDAMzCwE,OAAIC,IAAIR,SAER,IAAMS,GAAO,IAAIT,QAAQ,CACxB7C,OAAQ,WACRuD,eAAgB,WAChBC,oBAAoB,EACpBV,SAAU,CAAEW,eAGEH,MC2Bf,IACA,CAAE,WAAF,8BAAE,MAAF,MACA,CAAE,WAAF,2BAAE,MAAF,QACA,CAAE,WAAF,4BAAE,MAAF,UAGA,IACA,CAAE,WAAF,gCAAE,MAAF,GACA,CAAE,WAAF,kCAAE,MAAF,GACA,CAAE,WAAF,+BAAE,MAAF,KAGA,IACArR,KAAA,eACEmL,WAAY,CAAd,oDACEvN,KAHF,WAII,MAAO,CACLoE,SAAUN,KAAK4B,SAAStB,SACxB8K,UAAWpL,KAAK4B,SAASwJ,UAAUlP,KAEnC6T,cAAeA,GACfC,OAAQA,KAGZ9E,QAAS,CACPqB,YADJ,WAEMvM,KAAK4B,SAASqO,UAAUjQ,KAAKM,SAASgF,UCxFyT,MCOjW,GAAY,eACd,GACA,GACA,IACA,EACA,KACA,KACA,MAIa,M,wECQF4K,GAAb,WAOI,aAAc,wBACVlQ,KAAKe,QAAS,EACdf,KAAKuK,UAAY,GATzB,mDAYI,WACI,OAA8B,IAA1BvK,KAAKuK,UAAU7N,OAAqBwT,EAASC,UAC1CnQ,KAAKuK,UAAUvK,KAAKuK,UAAU7N,OAAS,KAdtD,sBAiBI,WAAqE,IAA5D0N,EAA4D,uDAAvD,OAAQE,EAA+C,uDAAvC,kBAAMqF,GAAK3Q,EAAE,eAAe9C,EAAW,uDAAJ,GACxD8D,KAAKe,SACNf,KAAKuK,UAAU3M,OAAO,EAAGoC,KAAKuK,UAAU7N,QACxCsD,KAAKe,QAAS,GAGG,oBAAVuJ,EACPtK,KAAKuK,UAAUvN,KAAf,iBACIoN,GAAIA,EACJ,YAAa,OAAOE,MACjBpO,IAGP8D,KAAKuK,UAAUvN,KAAf,iBACIoN,GAAIA,EACJE,MAAOA,GACJpO,MAjCnB,uBAuCI,WACI8D,KAAKuK,UAAU3M,OAAOoC,KAAKuK,UAAU7N,OAAS,EAAG,GAE7CsD,KAAKuK,UAAU7N,OAAS,IACxBsD,KAAKe,QAAS,KA3C1B,wBA+CI,WACkC,IAA1Bf,KAAKuK,UAAU7N,OACfsD,KAAKqB,WAC2B,SAAzBrB,KAAKuK,UAAU,GAAGH,IACzBpK,KAAKuK,UAAU3M,OAAO,EAAGoC,KAAKuK,UAAU7N,QACxCsD,KAAKqB,YAELrB,KAAKe,QAAS,IAtD1B,sBA0DI,WACIf,KAAKe,QAAS,MA3DtB,K,gBAAamP,G,YAEU,CACf9F,GAAI,IACJE,MAAO,MC9Bf,IAAI,GAAS,WAAa,IAAIvK,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACA,EAAG,MAAM,CAACW,YAAY,eAAef,EAAI6K,GAAI7K,EAAsB,oBAAE,SAASyB,GAAW,OAAOrB,EAAG,YAAY,CAACd,IAAImC,EAAU4I,GAAG5J,MAAM,CAAC,aAAagB,GAAWP,GAAG,CAAC,KAAO,SAASC,GAAQ,OAAOnB,EAAIqQ,SAAS5O,UAAiB,GAAIzB,EAAIsQ,mBAAmB3T,OAAS,EAAIqD,EAAIuQ,cAAchP,QAAQ5E,OAAS,EAAGyD,EAAG,MAAMJ,EAAIY,KAAMZ,EAAIuQ,cAAchP,QAAQ5E,OAAS,EAAGyD,EAAG,MAAM,CAACW,YAAY,WAAW,CAACX,EAAG,YAAY,CAACK,MAAM,CAAC,MAAQT,EAAIwQ,OAAOC,OAAO,YAAczQ,EAAIiB,GAAG,8BAA8BC,GAAG,CAAC,MAAQ,SAASC,GAAQnB,EAAIwQ,OAAOC,OAAStP,EAAOe,OAAOlD,UAAUgB,EAAI6K,GAAI7K,EAAmB,iBAAE,SAASmN,GAAQ,OAAO/M,EAAG,aAAa,CAACd,IAAI6N,EAAO9C,GAAG5J,MAAM,CAAC,OAAS0M,SAAa,GAAGnN,EAAIY,QACrxB,GAAkB,G,6CCDlB,GAAS,WAAa,IAAIZ,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACW,YAAY,cAAcT,MAAM,CAAC,iBAAkBN,EAAImN,OAAOuD,UAAU,CAACtQ,EAAG,MAAM,CAACW,YAAY,gBAAgBN,MAAM,CAAC,MAAQT,EAAImN,OAAO9C,IAAInJ,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOnB,EAAI2Q,OAAM,MAAU,CAAsB,WAApB3Q,EAAImN,OAAOvE,KAAmBxI,EAAG,MAAM,CAACW,YAAY,QAAQ,CAACX,EAAG,MAAM,CAACK,MAAM,CAAC,IAAM,sBAAwBT,EAAImN,OAAOyD,WAAa,OAAO,IAAM,cAAc1P,GAAG,CAAC,MAAQlB,EAAI6Q,WAAW7Q,EAAIY,KAAKR,EAAG,MAAM,CAACW,YAAY,QAAQ,CAACX,EAAG,MAAM,CAACW,YAAY,SAAS,CAACf,EAAIqC,GAAGrC,EAAIsC,GAAGtC,EAAI8Q,gBAAgB1Q,EAAG,MAAM,CAACW,YAAY,SAAS,CAAEf,EAAIO,SAAc,MAAEH,EAAG,MAAM,CAACJ,EAAIqC,GAAG,IAAIrC,EAAIsC,GAAGtC,EAAImN,OAAOvE,MAAM,cAAc5I,EAAIY,KAAKR,EAAG,MAAM,CAACJ,EAAIqC,GAAG,KAAKrC,EAAIsC,GAAGtC,EAAIyC,GAAG,WAAPzC,CAAmBA,EAAImN,OAAOpL,SAASC,IAAI,MAAMhC,EAAIsC,GAAGtC,EAAIyC,GAAG,WAAPzC,CAAmBA,EAAImN,OAAOpL,SAASI,IAAI,MAAMnC,EAAIsC,GAAGtC,EAAIyC,GAAG,WAAPzC,CAAmBA,EAAImN,OAAOpL,SAASK,IAAI,cAAmC,WAApBpC,EAAImN,OAAOvE,KAAmBxI,EAAG,MAAM,CAACW,YAAY,uBAAuBT,MAAM,CAACiJ,OAAQvJ,EAAIU,SAASA,SAASqQ,iBAAmB/Q,EAAIU,SAASA,SAASqQ,gBAAgB1G,KAAOrK,EAAImN,OAAO9C,IAAI5J,MAAM,CAAC,MAAQT,EAAIiB,GAAG,8BAA8BC,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOnB,EAAI2Q,OAAM,MAAS,CAACvQ,EAAG,MAAM,CAACK,MAAM,CAAC,QAAU,cAAc,CAACL,EAAG,SAAS,CAACK,MAAM,CAAC,KAAO,OAAO,eAAe,IAAI,oBAAoB,KAAK,GAAK,KAAK,GAAK,KAAK,EAAI,YAAYL,EAAG,OAAO,CAACK,MAAM,CAAC,KAAO,OAAO,eAAe,IAAI,oBAAoB,KAAK,GAAK,OAAO,GAAK,KAAK,GAAK,QAAQ,GAAK,QAAQL,EAAG,OAAO,CAACK,MAAM,CAAC,KAAO,OAAO,eAAe,IAAI,oBAAoB,KAAK,GAAK,KAAK,GAAK,QAAQ,GAAK,KAAK,GAAK,YAAYL,EAAG,OAAO,CAACK,MAAM,CAAC,KAAO,OAAO,eAAe,IAAI,oBAAoB,KAAK,GAAK,QAAQ,GAAK,KAAK,GAAK,SAAS,GAAK,QAAQL,EAAG,OAAO,CAACK,MAAM,CAAC,KAAO,OAAO,eAAe,IAAI,oBAAoB,KAAK,GAAK,KAAK,GAAK,OAAO,GAAK,KAAK,GAAK,WAAWL,EAAG,SAAS,CAACK,MAAM,CAAC,OAAS,OAAO,GAAK,KAAK,GAAK,KAAK,EAAI,eAAeT,EAAIY,QAC35D,GAAkB,GCgCtB,I,UAAA,CACErC,KAAM,aACNqE,MAAO,CACLuK,OAAQvQ,QAEVT,KALF,WAMI,MAAO,CACLoE,SAAUN,KAAK4B,SAAStB,SACxBG,SAAUT,KAAK4B,SAASwJ,UAAU2F,gBAAgB7U,OAGtD2Q,SAAU,CACRgE,YADJ,WAEM,OAAQ7Q,KAAKkN,OAAOvE,MAClB,IAAK,SAAb,wBACQ,QAAR,MAGM,GAAI3I,KAAKkN,OAAO5K,MAAtB,CACQ,IAAR,sEACQ,GAAI0O,GAAiBA,EAActU,OAAS,EAC1C,OAAOsU,EAAc,GAIzB,OAAOhR,KAAKkN,OAAO9C,KAGvBtH,QAAS,CACPhB,SADJ,SACA,GACM,OAAOkB,KAAKC,MAAMgO,KAGtB/F,QAAS,CACP,MADJ,SACA,6KACA,uCAEA,kDACA,uCAGA,yBAPA,oBASA,qDATA,iBAUA,OAVA,iBAWA,iBAXA,4DAWA,EAXA,QAYA,8BAZA,wBAaA,IAbA,0KAkBA,EAlBA,oEAqBA,gCArBA,QAwBA,8CACA,wCAzBA,2BA4BA,iBA5BA,mDAgCA,mCAhCA,mEAkCI0F,MAnCJ,SAmCA,GACMjM,EAAM1C,OAAO4B,IAAM,uBCtG0U,MCQ/V,I,UAAY,eACd,GACA,GACA,IACA,EACA,KACA,KACA,OAIa,M,QCnBX,GAAS,WAAa,IAAI9D,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,QAAQ,CAACW,YAAY,aAAaN,MAAM,CAAC,KAAO,QAAQ+B,SAAS,CAAC,MAAQxC,EAAIhB,OAAOkC,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOnB,EAAI0C,MAAM,QAASvB,IAAS,QAAU,SAASA,GAAQ,OAAOA,EAAOwB,uBAC7R,GAAkB,GCItB,IACEpE,KAAM,YACNqE,MAAO,CACL5D,MAAO6D,SCRuV,MCQ9V,I,UAAY,eACd,GACA,GACA,IACA,EACA,KACA,KACA,OAIa,M,QCnBX,GAAS,WAAa,IAAI7C,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACW,YAAY,aAAaN,MAAM,CAAC,MAAQT,EAAIyB,UAAU4I,KAAK,CAACjK,EAAG,MAAM,CAACW,YAAY,OAAOG,GAAG,CAAC,MAAQlB,EAAImR,SAAS,CAAC/Q,EAAG,MAAM,CAACW,YAAY,qBAAqB,CAACX,EAAG,MAAM,CAACW,YAAY,SAAS,CAACf,EAAIqC,GAAGrC,EAAIsC,GAAGtC,EAAIuC,UAAWvC,EAAIyB,UAAoB,WAAErB,EAAG,eAAe,CAACK,MAAM,CAAC,GAAKT,EAAIyB,UAAUiP,WAAW1Q,EAAIY,MAAM,GAAGR,EAAG,MAAM,CAACW,YAAY,SAAS,CAACX,EAAG,MAAM,CAACJ,EAAIqC,GAAG,IAAIrC,EAAIsC,GAAGtC,EAAIyB,UAAUF,QAAQ5E,QAAQ,IAAIqD,EAAIsC,GAAGtC,EAAIoR,IAAI,iBAAkBpR,EAAIyB,UAAUF,QAAQ5E,SAAS,OAAQqD,EAAIsQ,mBAAmB3T,OAAS,EAAGyD,EAAG,MAAM,CAACJ,EAAIqC,GAAG,IAAIrC,EAAIsC,GAAGtC,EAAIsQ,mBAAmB3T,QAAQ,IAAIqD,EAAIsC,GAAGtC,EAAIoR,IAAI,oBAAqBpR,EAAIsQ,mBAAmB3T,SAAS,OAAOqD,EAAIY,SAASR,EAAG,MAAM,CAACW,YAAY,mBAAmBG,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOnB,EAAI0C,MAAM,OAAQvB,MAAW,CAACf,EAAG,MAAM,CAACK,MAAM,CAAC,QAAU,cAAc,CAACL,EAAG,OAAO,CAACK,MAAM,CAAC,EAAI,0LAA0LL,EAAG,OAAO,CAACK,MAAM,CAAC,EAAI,yMAC5nC,GAAkB,GC+BtB,IACElC,KAAM,YACNmL,WAAY,CAAd,iBACE9G,MAAO,CACLnB,UAAW7E,QAEbkQ,SAAU,CACRwD,mBADJ,WAEM,OAAOrQ,KAAKwB,UAAUD,WAAWgP,QAAO,SAA9C,GACQ,MAAR,iBAAe,EAAf,OAGIjO,MANJ,WAOM,MAA0B,eAAtBtC,KAAKwB,UAAU4I,GAA4BpK,KAAKgB,GAAG,iBAChDhB,KAAKwB,UAAUc,QAG1B4I,QAAS,CACPgG,OADJ,WAEUlR,KAAKwB,UAAU4P,aACjBpR,KAAKwB,UAAUiP,SAAWzQ,KAAKwB,UAAUiP,YCpDiT,MCQ9V,I,UAAY,eACd,GACA,GACA,IACA,EACA,KACA,KACA,OAIa,M,QCDf,IACEnS,KAAM,gBACNmL,WAAY,CAAd,yCACE9G,MAAO,CACL/B,KAAM,IAER1E,KANF,WAOI,MAAO,CACLqU,OAAQ,CACNC,OAAQ,MAId3D,SAAU,CACRyD,cADJ,WAEM,OAAOtQ,KAAKY,KAAKyJ,cAAc7I,WAEjC6P,gBAJJ,WAIA,WACM,OAAO,OAAb,QAAa,CAAb,gDACQ,OAAIC,EAAElH,GAAKmH,EAAEnH,IAAY,EACrBkH,EAAElH,GAAKmH,EAAEnH,GAAW,EACjB,KACf,oBACQ,OAAK,EAAb,kBACY8C,EAAO9C,GAAGoH,WAAW,EAAjC,oBACYtE,EAAO5K,QAAS4K,EAAO5K,MAAMkP,WAAW,EAApD,mBAC4B,WAAhBtE,EAAOvE,OAAsBuE,EAAO5O,KAAKkT,WAAW,EAAhE,iEAIInB,mBAjBJ,WAkBM,OAAOrQ,KAAKsQ,cAAc/O,WAAWgP,QAAO,SAAlD,GACQ,MAAR,iBAAe,EAAf,QAIErF,QAAS,CACPkF,SADJ,SACA,GACMpQ,KAAKY,KAAKS,SAChB,2BACA,4CACA,CAAQ,UAAR,OC3DsW,MCOlW,GAAY,eACd,GACA,GACA,IACA,EACA,KACA,KACA,MAIa,M,QClBX,GAAS,WAAa,IAAItB,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACW,YAAY,aAAaT,MAAM,CAACoR,SAAU1R,EAAI8K,IAAIT,KAAOrK,EAAI2R,eAAelR,MAAM,CAAC,MAAQT,EAAI8K,IAAIT,IAAInJ,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOnB,EAAI4R,UAAU5R,EAAI8K,IAAIT,OAAO,CAACjK,EAAG,OAAO,CAACW,YAAY,MAAMsC,MAAM,CAAEwO,MAAO,OAA8B,IAArB7R,EAAI8K,IAAIgH,SAASjT,EAAU,IAA2B,IAArBmB,EAAI8K,IAAIgH,SAASC,EAAU,IAA2B,IAArB/R,EAAI8K,IAAIgH,SAASN,EAAU,MAAO,CAACxR,EAAIqC,GAAG,OAAOjC,EAAG,OAAO,CAACW,YAAY,QAAQ,CAACf,EAAIqC,GAAGrC,EAAIsC,GAAGtC,EAAI8K,IAAIvM,YAC7e,GAAkB,GCOtB,IACEA,KAAM,YACNqE,MAAO,CACLkI,IAAKlO,QAEPT,KALF,WAMI,MAAO,CACLkP,UAAWpL,KAAK4B,SAASwJ,UAAUlP,KACnCoE,SAAUN,KAAK4B,SAAStB,WAG5BuM,SAAU,CACR6E,cADJ,WAEM,OAAO1R,KAAKoL,UAAUP,IAAM7K,KAAKoL,UAAUP,IAAIT,GAAK,OAGxDc,QAAS,CACPyG,UADJ,SACA,GACM3R,KAAK4B,SAAS+P,UAAUI,GAAO,MC1B6T,MCQ9V,I,UAAY,eACd,GACA,GACA,IACA,EACA,KACA,KACA,OAIa,M,QCoBf,IACEzT,KAAM,WACNmL,WAAY,CAAd,2EACE9G,MAAO,CACL/B,KAAM,IAER1E,KANF,WAOI,MAAO,CACLoE,SAAUN,KAAK4B,SAAStB,SACxBgB,QAAStB,KAAK4B,SAASwJ,UAAU9J,QAAQpF,OAG7CgP,QAAS,CACPR,aADJ,WAEM/G,SAASqO,KAAKC,uBCrD6U,MCQ7V,I,UAAY,eACd,GACA,GACA,IACA,EACA,KACA,KACA,OAIa,M,QCnBX,GAAS,WAAa,IAAIlS,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,MAAM,CAAC6R,UAAWnS,EAAIoS,SAAS3R,MAAM,CAAC,GAAK,uBAAuB,CAACL,EAAG,MAAM,CAACW,YAAY,eAAe,CAACX,EAAG,MAAM,CAACW,YAAY,mBAAmBG,GAAG,CAAC,WAAa,SAASC,GAAQnB,EAAIqS,QAAU,EAAGrS,EAAIsS,eAAiBnR,EAAOoR,eAAe,GAAGC,WAAYrR,EAAOsR,oBAAqB,CAACrS,EAAG,MAAM,CAACK,MAAM,CAAC,QAAU,eAAe,CAACL,EAAG,OAAO,CAACK,MAAM,CAAC,EAAI,sKAAsKL,EAAG,MAAM,CAACW,YAAY,qBAAqBG,GAAG,CAAC,WAAa,SAASC,GAAQnB,EAAIqS,SAAW,EAAGrS,EAAIsS,eAAiBnR,EAAOoR,eAAe,GAAGC,WAAYrR,EAAOsR,oBAAqB,CAACrS,EAAG,MAAM,CAACW,YAAY,OAAON,MAAM,CAAC,QAAU,eAAe,CAACL,EAAG,OAAO,CAACK,MAAM,CAAC,EAAI,wKAAwKL,EAAG,MAAM,CAACW,YAAY,iBAAiB,CAACX,EAAG,MAAM,CAACW,YAAY,mBAAmBG,GAAG,CAAC,WAAa,SAASC,GAAQnB,EAAI0S,GAAK,EAAG1S,EAAI2S,UAAYxR,EAAOoR,eAAe,GAAGC,WAAYrR,EAAOsR,oBAAqB,CAACrS,EAAG,MAAM,CAACK,MAAM,CAAC,QAAU,eAAe,CAACL,EAAG,OAAO,CAACK,MAAM,CAAC,EAAI,sKAAsKL,EAAG,MAAM,CAACW,YAAY,qBAAqBG,GAAG,CAAC,WAAa,SAASC,GAAQnB,EAAI0S,IAAM,EAAG1S,EAAI2S,UAAYxR,EAAOoR,eAAe,GAAGC,WAAYrR,EAAOsR,oBAAqB,CAACrS,EAAG,MAAM,CAACW,YAAY,OAAON,MAAM,CAAC,QAAU,eAAe,CAACL,EAAG,OAAO,CAACK,MAAM,CAAC,EAAI,2KACntD,GAAkB,GCiCtB,IACElC,KAAM,2BACNpC,KAFF,WAGI,MAAO,CACLiW,SAAS,EACTC,QAAS,EACTC,gBAAiB,EACjBI,GAAI,EACJC,WAAY,IAGhBxH,QAAS,CACPyH,YADJ,SACA,GACMzN,QAAQC,IAAI,SAAUyN,GAElBA,EAAIN,eAAe,GAAGC,aAAevS,KAAKqS,iBAAgBrS,KAAKoS,QAAU,GACzEQ,EAAIN,eAAe,GAAGC,aAAevS,KAAK0S,YAAW1S,KAAKyS,GAAK,IAErEI,QAPJ,SAOA,GACM,IAAN,0CACMC,EAAGhR,SAASC,GAAK/B,KAAKoS,QAAUpP,KAAK+P,IAAID,EAAGE,UAAYJ,EAAIhO,OAAOsE,MAAQ,IAC3E4J,EAAGhR,SAASK,GAAKnC,KAAKoS,SAAWpP,KAAKiQ,IAAIH,EAAGE,UAAYJ,EAAIhO,OAAOsE,MAAQ,IAC5E4J,EAAGhR,SAASI,GAAKlC,KAAKyS,GAAKG,EAAIhO,OAAOsE,MAAQ,KAEhDgK,OAbJ,SAaA,GACMlT,KAAKmS,SAAU,IAGnBgB,QA5BF,WA6BIvT,OAAOwT,iBAAiB,aAAcpT,KAAKkT,QAE3CtT,OAAOwT,iBAAiB,WAAYpT,KAAK2S,aACzC/S,OAAOwT,iBAAiB,cAAepT,KAAK2S,aAC5C3S,KAAK4B,SAASyR,OAAOD,iBAAiB,qBAAsBpT,KAAK6S,UAEnES,cAnCF,WAoCI1T,OAAO2T,oBAAoB,aAAcvT,KAAKkT,QAE9CtT,OAAO2T,oBAAoB,WAAYvT,KAAK2S,aAC5C/S,OAAO2T,oBAAoB,cAAevT,KAAK2S,aAC/C3S,KAAK4B,SAASyR,OAAOE,oBAAoB,qBAAsBvT,KAAK6S,WC1EyS,MCQ7W,I,UAAY,eACd,GACA,GACA,IACA,EACA,KACA,KACA,OAIa,M,QCNf,IACEvU,KAAM,MACNmL,WAAY,CACV+J,yBAAJ,GACItD,SAAJ,GACIuD,WAAJ,IAEEvX,KAPF,WAQI,MAAO,CACLoE,SAAUN,KAAK4B,SAAStB,YCtBgS,MCQ1T,I,UAAY,eACd,GACA,EACAO,GACA,EACA,KACA,KACA,OAIa,M,QCKF6S,I,8BAAb,WAQI,WAAY3R,EAAGI,EAAGwR,EAAQC,GAAU,wBAChCjX,OAAO8B,eAAgBuB,KAAM,SAAU,CAAEjB,OAAO,IAGhDiB,KAAK6T,MAAQ,KAEb7T,KAAK2T,OAASA,EACd3T,KAAK4T,SAAWA,EAEhB5T,KAAK+B,EAAIA,EACT/B,KAAKmC,EAAIA,EAETnC,KAAK8T,UAAW,EAChB9T,KAAK+T,SAAU,EArBvB,4CA4BI,SAAKC,GAAY,WACb,OAAIhU,KAAK+T,QAAgBE,QAAQC,OAAO,6BACxClU,KAAK+T,SAAU,EAEf/T,KAAKmU,SAELnU,KAAK8T,UAAW,EACTE,EAAWI,KAAKpU,KAAK+B,EAAG/B,KAAKmC,GAC/BkS,MAAK,SAAAR,GACE,EAAKC,SACLD,EAAMS,SAASC,WAInB,EAAKV,MAAQA,EACb,EAAKF,OAAO,OAEfa,SAAQ,WACL,EAAKT,SAAU,QA9C/B,oBAkDI,WACI/T,KAAK8T,UAAW,EACZ9T,KAAK6T,QACL7T,KAAK4T,SAAS5T,MAEdA,KAAK6T,MAAMS,SAASC,UACpBvU,KAAK6T,MAAQ,QAxDzB,kBA+DI,WACI,QAAS7T,KAAK6T,UAhEtB,MCEaY,GAAb,WASI,WAAYC,EAAOC,GAAQ,wBACvB3U,KAAK4U,OAASjR,SAASC,gBAAgB,+BAAgC,UACvE5D,KAAK4U,OAAOF,MAAQA,EACpB1U,KAAK4U,OAAOD,OAASA,EAKrB3U,KAAK6U,eAAiB7U,KAAK4U,OAAOE,WAAW,KAAM,CAC/CC,OAAO,EACPC,oBAAoB,IAGxBhV,KAAKiV,QAAU,IAAIC,OAAQlV,KAAK4U,QAChC5U,KAAKiV,QAAQE,iBAAkB,EAC/BnV,KAAKiV,QAAQG,UAAYC,OACzBrV,KAAKiV,QAAQK,UAAYD,OACzBrV,KAAKiV,QAAQM,MAAQC,OACrBxV,KAAKiV,QAAQQ,MAAQD,OACrBxV,KAAKiV,QAAQS,OAAQ,EACrB1V,KAAKiV,QAAQU,aAAc,EA7BnC,8CAmCI,SAAOjV,GACHV,KAAK6U,eAAee,UAAYlV,EAChCV,KAAK6U,eAAegB,SAAS,EAAG,EAAG7V,KAAK4U,OAAOF,MAAO1U,KAAK4U,OAAOD,QAElE3U,KAAKiV,QAAQU,aAAc,IAvCnC,qBA+CI,SAAQ5T,EAAGI,EAAGzB,GACVV,KAAK6U,eAAee,UAAYlV,EAChCV,KAAK6U,eAAegB,SAAS9T,EAAGI,EAAG,EAAG,GAEtCnC,KAAKiV,QAAQU,aAAc,MAnDnC,K,gBAAalB,G,QAEM,Q,gBAFNA,G,SAGO,QCAb,IAAMqB,GAAb,WAYI,WAAYC,EAAO/B,GAAmE,WAAvDgC,EAAuD,uDAA1C,KAAMC,EAAoC,uDAArB,KAAM5C,EAAe,uDAAN,KAAM,+DAsFrE,WACT,EAAKS,UACJ,EAAKoC,iBAEN,EAAKC,aAAaC,aAAa,EAAKD,aAEpC,EAAKE,iBAAmB,EACxB,EAAKF,YAAcG,WAAW,EAAKC,eAAgB,GAEnD,EAAKJ,YAAcG,WAAW,EAAKC,eAAgB,SA/F2B,yCAwKnE,SAAAC,GAGf,EAAKT,MAAMU,IAAID,EAAK3C,OACpB,EAAKmC,WAAWQ,MA5KkE,2CA+KjE,SAAAA,GACjB,EAAKE,QAAQC,QAAQH,EAAKzU,EAAI,EAAK6U,WAAW7U,EAAI+T,EAAYe,gBAAiBL,EAAKrU,EAAI,EAAKyU,WAAW1U,EAAI4T,EAAYe,gBAAiBpC,GAAQqC,OAEjJ,EAAKf,MAAMgB,OAAOP,EAAK3C,OACvB,EAAKoC,aAAaO,MAlLlB7Z,OAAO8B,eAAgBuB,KAAM,gBAAiB,CAAEjB,OAAO,IAEvDiB,KAAKqT,OAASA,EACdrT,KAAK+V,MAAQA,EACb/V,KAAKgU,WAAaA,EAElBhU,KAAKgW,WAAaA,GAAc,aAChChW,KAAKiW,aAAeA,GAAgB,aAEpCjW,KAAKgX,cAAgB,EACrBhX,KAAKiX,cAAgB,EACrBjX,KAAK4W,WAAa,IAAItT,OAAQ,EAAG,GAEjCtD,KAAKqW,iBAAmB,EACxBrW,KAAKmW,YAAc,KAGnBnW,KAAKkX,MAAQ,IAAIC,IAGjBnX,KAAK0W,QAAU,IAAIjC,GAAQqB,EAAYsB,YAAatB,EAAYsB,aAEhEpX,KAAK8T,UAAW,EAnCxB,sDA4CI,SAAe/R,EAAGI,EAAG6U,EAAeC,GAAe,WAC/CjX,KAAK8T,UAAW,EAEhB,IAAIuD,GAAc,GACdrX,KAAKgX,cAAgBA,GAAiBhX,KAAKiX,cAAgBA,KAC3DI,GAAc,GAGlBrX,KAAKgX,cAAgBA,EACrBhX,KAAKiX,cAAgBA,GAEjBI,GAAerX,KAAK4W,WAAW7U,IAAMA,GAAK/B,KAAK4W,WAAW1U,IAAMC,KAChEnC,KAAK4W,WAAWzM,IAAIpI,EAAGI,GACvBnC,KAAKsX,iBAELtX,KAAK0W,QAAQa,OAAO9C,GAAQqC,OAC5B9W,KAAKkX,MAAMM,SAAQ,SAAAhB,GACVA,EAAKzC,SACN,EAAK2C,QAAQC,QAAQH,EAAKzU,EAAI,EAAK6U,WAAW7U,EAAI+T,EAAYe,gBAAiBL,EAAKrU,EAAI,EAAKyU,WAAW1U,EAAI4T,EAAYe,gBAAiBpC,GAAQgD,YAK7JzX,KAAKuW,mBAnEb,oBAsEI,WACIvW,KAAK8T,UAAW,EAChB9T,KAAK0X,mBAxEb,4BA2EI,WAAiB,WACb1X,KAAKkX,MAAMM,SAAQ,SAAChB,EAAMmB,EAAM9M,IAExB2L,EAAKzU,EAAI,EAAKiV,cAAgB,EAAKJ,WAAW7U,GAC9CyU,EAAKzU,EAAI,EAAKiV,cAAgB,EAAKJ,WAAW7U,GAC9CyU,EAAKrU,EAAI,EAAK8U,cAAgB,EAAKL,WAAW1U,GAC9CsU,EAAKrU,EAAI,EAAK8U,cAAgB,EAAKL,WAAW1U,KAE9CsU,EAAKrC,SACLtJ,EAAI+M,OAAOD,SApF3B,4BAyFI,WACI3X,KAAK0W,QAAQa,OAAO9C,GAAQqC,OAE5B9W,KAAKkX,MAAMM,SAAQ,SAAAhB,GACfA,EAAKrC,YAETnU,KAAKkX,MAAMW,UA/FnB,0BAkHI,WACI,GAAI7X,KAAK8T,SAAU,OAAO,EAE1B,IAAI/R,EAAI,EACJI,EAAI,EACJ9D,EAAI,EACJF,EAAI,EAER,MAAOA,EAAuD,EAAnD6E,KAAKoG,IAAIpJ,KAAKgX,cAAehX,KAAKiX,eAAqB,EAAG,CACjE,MAAO,EAAIlV,EAAI1D,EAAIF,EAAG,CAClB,GAAI6B,KAAK8X,YAAY9X,KAAK4W,WAAW7U,EAAIA,EAAG/B,KAAK4W,WAAW1U,EAAIC,GAAI,OAAO,EAC3EJ,GAAQ1D,EAEZ,MAAO,EAAI8D,EAAI9D,EAAIF,EAAG,CAClB,GAAI6B,KAAK8X,YAAY9X,KAAK4W,WAAW7U,EAAIA,EAAG/B,KAAK4W,WAAW1U,EAAIC,GAAI,OAAO,EAC3EA,GAAQ9D,EAEZA,IAAK,EACLF,GAAQ,EAGZ,OAAO,IAvIf,yBA+II,SAAY4D,EAAGI,GAAG,WACd,GAAInC,KAAK8T,SAAU,OAAO,EAE1B,GAAI9Q,KAAK+U,IAAIhW,EAAI/B,KAAK4W,WAAW7U,GAAK/B,KAAKgX,cAAe,OAAO,EACjE,GAAIhU,KAAK+U,IAAI5V,EAAInC,KAAK4W,WAAW1U,GAAKlC,KAAKiX,cAAe,OAAO,EAEjE,IAAIe,EAAW3T,EAAStC,EAAGI,GAEvBqU,EAAOxW,KAAKkX,MAAMvY,IAAIqZ,GAC1B,YAAaC,IAATzB,IAEJxW,KAAKqW,mBAELG,EAAO,IAAI9C,GAAK3R,EAAGI,EAAGnC,KAAKkY,iBAAkBlY,KAAKmY,oBAClDnY,KAAKkX,MAAM/M,IAAI6N,EAAUxB,GACzBA,EAAKpC,KAAKpU,KAAKgU,YACVK,MAAK,WACF,EAAKqC,QAAQC,QAAQH,EAAKzU,EAAI,EAAK6U,WAAW7U,EAAI+T,EAAYe,gBAAiBL,EAAKrU,EAAI,EAAKyU,WAAW1U,EAAI4T,EAAYe,gBAAiBpC,GAAQgD,QAE7I,EAAKtB,aAAaC,aAAa,EAAKD,aACxC,EAAKA,YAAcG,WAAW,EAAKC,eAAgB,MAEtD6B,OAAM,SAAA/S,GACCA,EAAMgT,QAA2B,UAAjBhT,EAAMgT,QACtBhT,EAAMpD,QAAkC,MAAxBoD,EAAMpD,OAAOoW,QAC7BhT,EAAMsD,MAAuB,UAAftD,EAAMsD,MAExB7D,EAAM,EAAKuO,OAAQ,wBAA0BhO,EAAO,cAEvDmP,SAAQ,WACL,EAAKkC,QAAQC,QAAQH,EAAKzU,EAAI,EAAK6U,WAAW7U,EAAI+T,EAAYe,gBAAiBL,EAAKrU,EAAI,EAAKyU,WAAW1U,EAAI4T,EAAYe,gBAAiBpC,GAAQgD,QACjJ,EAAKpB,uBAGN,OAjLf,K,gBAAaP,G,cAEY,K,gBAFZA,G,kBAGgBA,GAAYsB,YAAc,GCLhD,IAAMkB,GAaT,WAAYC,EAAUC,EAAUC,GAA4C,WAA9BC,EAA8B,uDAAd,EAAGC,EAAW,uDAAH,EAAG,qDAiBrE,SAACC,EAAOC,GACX,IAAIC,EAAU,EAAKP,SAAWzU,EAAe8U,EAAOC,GAAS,QAE7D,OAAO,IAAI5E,SAAQ,SAAC8E,EAAS7E,GACzB,EAAK8E,WAAW5E,KAAK0E,EAAU,IAAM,EAAKJ,eACtC,SAAAO,GACI,GAAKA,EAAatQ,MAA8B,mBAAtBsQ,EAAatQ,KAAvC,CAKA,IAAI2L,EAAW,EAAK4E,qBAAqBC,MAAMF,GAE3CzZ,EAAS,IAAI4Z,OAAK9E,EAAU,EAAKkE,UACjC,EAAKG,OAAOnZ,EAAO6Z,OAAOlP,IAAI,EAAKwO,OAEvC,IAAIW,EAAW,EAAKb,aAAaa,SAC7BC,EAAY,EAAKd,aAAac,UAC9BC,EAAQ,EAAKf,aAAae,MAC9Bha,EAAOsC,SAASqI,IAAIyO,EAAQU,EAASvX,EAAIwX,EAAUxX,EAAG,EAAG8W,EAAQS,EAASnX,EAAIoX,EAAUpX,GACxF3C,EAAOga,MAAMrP,IAAIqP,EAAMzX,EAAG,EAAGyX,EAAMrX,GAEnC3C,EAAOia,SAASX,QAAUA,EAE1BtZ,EAAOka,mBAAkB,GAEzBX,EAAQvZ,QAnBJ0U,EAAO,CAACmE,OAAQ,aAqBxB,cACAnE,SA7CRvX,OAAO8B,eAAgBuB,KAAM,eAAgB,CAAEjB,OAAO,IAEtDiB,KAAKuY,SAAWA,EAChBvY,KAAKwY,SAAWA,EAChBxY,KAAKyY,aAAeA,EAEpBzY,KAAK2Y,MAAQA,EAEb3Y,KAAK0Y,cAAgBA,EAErB1Y,KAAKgZ,WAAa,IAAIW,OACtB3Z,KAAKgZ,WAAWY,gBAAgB,QAEhC5Z,KAAKkZ,qBAAuB,IAAIW,Q,6EC5B3BC,GAAb,0DAKI,WAAY1P,GAAI,qCACZ,eACAzN,OAAO8B,eAAP9B,OAAA,QAAAA,CAAA,GAA4B,cAAe,CAACoC,OAAO,IAEnD,EAAK7C,KAAO,CACRkO,GAAIA,EACJ9H,MAAO8H,EACPgH,YAAY,EACZ2I,aAAa,EACbxY,WAAY,GACZD,QAAS,GACTmP,QAAS,EAAKA,SAGlB9T,OAAO8B,eAAP9B,OAAA,QAAAA,CAAA,GAA4B,UAAW,CACnCgC,IADmC,WAC3B,OAAOqB,KAAK9D,KAAKuU,SACzBtG,IAFmC,SAE/BpL,GAASiB,KAAK9D,KAAKuU,QAAU1R,KAhBzB,EALpB,2CAyBI,WAAe,6BAARS,EAAQ,yBAARA,EAAQ,gBACX,GAAsB,IAAlBA,EAAO9C,OAAc,CACrB,IAAI8B,EAAIgB,EAAO,GACXhB,EAAEwb,aACFha,KAAK9D,KAAKqF,WAAWvE,KAAKwB,EAAEtC,MAE5BsC,EAAEyb,UACFja,KAAK9D,KAAKoF,QAAQtE,KAAKwB,EAAEtC,MAIjC,8FAAoBsD,MApC5B,oBAuCI,WAAkB,6BAARA,EAAQ,yBAARA,EAAQ,gBACd,GAAsB,IAAlBA,EAAO9C,OAAc,CACrB,IAAI8B,EAAIgB,EAAO,GACf,GAAIhB,EAAEwb,YAAa,CACf,IAAIxd,EAAIwD,KAAK9D,KAAKqF,WAAW2Y,QAAQ1b,EAAEtC,MACnCM,GAAK,GAAGwD,KAAK9D,KAAKqF,WAAW3D,OAAOpB,EAAG,GAE/C,GAAIgC,EAAEyb,SAAU,CACZ,IAAIzd,EAAIwD,KAAK9D,KAAKoF,QAAQ4Y,QAAQ1b,EAAEtC,MAChCM,GAAK,GAAGwD,KAAK9D,KAAKoF,QAAQ1D,OAAOpB,EAAG,IAIhD,iGAAuBgD,MApD/B,qBAuDI,WACIQ,KAAKma,SAAS3C,SAAQ,SAAA4C,GACdA,EAAM7F,SAAS6F,EAAM7F,iBAzDrC,GAA+B8F,Q,UCP/BC,OAAYC,KAAO,CAElBC,UAAW,CAAEzb,MAAO,GACpB0O,WAAY,CAAE1O,MAAO,IAAIuE,OAAS,EAAG,IACrCmX,UAAW,CAAE1b,MAAO,GACpB2b,SAAU,CAAE3b,MAAO,GACnB4b,QAAS,CAAE5b,MAAO,GAClB6b,QAAS,CAAE7b,MAAO,IAInB8b,OAAW,QAAW,CAErBxP,SAAUyP,OAAcC,MAAO,CAC9BT,OAAYU,OACZV,OAAYW,IACZX,OAAYC,OAGbW,aAAY,m0HAuJZC,eAAc,gzDA8Ef,IAAIC,GAAe,SAAWC,GAE7BC,OAAexe,KAAMkD,KAAM,CAE1B2I,KAAM,eAEN0C,SAAUyP,OAAcS,MAAOV,OAAW,QAASxP,UAEnD6P,aAAcL,OAAW,QAASK,aAClCC,eAAgBN,OAAW,QAASM,eAEpCK,UAAU,IAIXxb,KAAKyb,QAAS,EAEd9e,OAAO+e,iBAAkB1b,KAAM,CAE9B4R,MAAO,CAENlT,YAAY,EAEZC,IAAK,WAEJ,OAAOqB,KAAKqL,SAASsQ,QAAQ5c,OAI9BoL,IAAK,SAAWpL,GAEfiB,KAAKqL,SAASsQ,QAAQ5c,MAAQA,IAMhCyb,UAAW,CAEV9b,YAAY,EAEZC,IAAK,WAEJ,OAAOqB,KAAKqL,SAASmP,UAAUzb,OAIhCoL,IAAK,SAAWpL,GAEfiB,KAAKqL,SAASmP,UAAUzb,MAAQA,IAMlC0b,UAAW,CAEV/b,YAAY,EAEZC,IAAK,WAEJ,OAAOqB,KAAKqL,SAASoP,UAAU1b,OAIhCoL,IAAK,SAAWpL,GAEfiB,KAAKqL,SAASoP,UAAU1b,MAAQA,IAMlC2b,SAAU,CAEThc,YAAY,EAEZC,IAAK,WAEJ,OAAOqB,KAAKqL,SAASqP,SAAS3b,OAI/BoL,IAAK,SAAWpL,GAEfiB,KAAKqL,SAASqP,SAAS3b,MAAQA,IAMjC4b,QAAS,CAERjc,YAAY,EAEZC,IAAK,WAEJ,OAAOqB,KAAKqL,SAASsP,QAAQ5b,OAI9BoL,IAAK,SAAWpL,GAEfiB,KAAKqL,SAASsP,QAAQ5b,MAAQA,IAMhC6b,QAAS,CAERlc,YAAY,EAEZC,IAAK,WAEJ,OAAOqB,KAAKqL,SAASuP,QAAQ7b,OAI9BoL,IAAK,SAAWpL,GAEfiB,KAAKqL,SAASuP,QAAQ7b,MAAQA,IAMhC0O,WAAY,CAEX/O,YAAY,EAEZC,IAAK,WAEJ,OAAOqB,KAAKqL,SAASoC,WAAW1O,OAIjCoL,IAAK,SAAWpL,GAEfiB,KAAKqL,SAASoC,WAAW1O,MAAM6c,KAAM7c,OAQxCiB,KAAK6b,UAAWR,IAIjBD,GAAaxe,UAAYD,OAAOyC,OAAQkc,OAAe1e,WACvDwe,GAAaxe,UAAUkf,YAAcV,GAErCA,GAAaxe,UAAUmf,gBAAiB,EC3YjC,IAAMC,GAA4B,wBAAH,OAEpCC,OAAYC,wBAFwB,weAwBnCD,OAAYE,mBAxBuB,UCAzBC,GAA8B,KAAH,OACtCH,OAAYI,0BAD0B,g4BAuCrCJ,OAAYK,qBAvCyB,SCfpCC,I,gPAAuB,WAE1BC,OAAwB1f,KAAMkD,MAE9BA,KAAK2I,KAAO,uBAEZ,IAAI8T,EAAY,EAAI,EAAG,EAAG,EAAG,EAAG,EAAG,GAAK,EAAG,EAAG,EAAG,EAAG,EAAG,GAAK,EAAG,EAAG,EAAG,EAAG,EAAG,GAAK,GAAK,EAAG,EAAG,GAAK,EAAG,GAC/FC,EAAM,EAAI,EAAG,EAAG,EAAG,GAAK,EAAG,EAAG,EAAG,GAAK,GAAK,EAAG,GAAK,GAAK,GAAK,EAAG,GAAK,GACrEC,EAAQ,CAAE,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAEjE3c,KAAK4c,SAAUD,GACf3c,KAAKuP,aAAc,WAAY,IAAIsN,OAAwBJ,EAAW,IACtEzc,KAAKuP,aAAc,KAAM,IAAIsN,OAAwBH,EAAK,MAI3DH,GAAqB3f,UAAYD,OAAOmgB,OAAQngB,OAAOyC,OAAQod,OAAwB5f,WAAa,CAEnGkf,YAAaS,GAEbQ,wBAAwB,EAExBC,aAAc,SAAWC,GAExB,IAAIC,EAAQld,KAAKmd,WAAWC,cACxBC,EAAMrd,KAAKmd,WAAWG,YAwB1B,YAtBerF,IAAViF,IAEJA,EAAMF,aAAcC,GAEpBI,EAAIL,aAAcC,GAElBC,EAAMvH,aAAc,GAIK,OAArB3V,KAAKud,aAETvd,KAAKwd,qBAIuB,OAAxBxd,KAAKyd,gBAETzd,KAAK0d,wBAIC1d,MAIR2d,aAAc,SAAWC,GAExB,IAAIC,EAECD,aAAiBE,aAErBD,EAAeD,EAEJhV,MAAMC,QAAS+U,KAE1BC,EAAe,IAAIC,aAAcF,IAIlC,IAAIG,EAAiB,IAAIC,OAA4BH,EAAc,EAAG,GAUtE,OARA7d,KAAKuP,aAAc,gBAAiB,IAAI0O,OAA4BF,EAAgB,EAAG,IACvF/d,KAAKuP,aAAc,cAAe,IAAI0O,OAA4BF,EAAgB,EAAG,IAIrF/d,KAAKwd,qBACLxd,KAAK0d,wBAEE1d,MAIRke,UAAW,SAAWN,GAErB,IAAIO,EAECP,aAAiBE,aAErBK,EAASP,EAEEhV,MAAMC,QAAS+U,KAE1BO,EAAS,IAAIL,aAAcF,IAI5B,IAAIQ,EAAsB,IAAIJ,OAA4BG,EAAQ,EAAG,GAKrE,OAHAne,KAAKuP,aAAc,qBAAsB,IAAI0O,OAA4BG,EAAqB,EAAG,IACjGpe,KAAKuP,aAAc,mBAAoB,IAAI0O,OAA4BG,EAAqB,EAAG,IAExFpe,MAIRqe,sBAAuB,SAAW/J,GAIjC,OAFAtU,KAAK2d,aAAcrJ,EAAS6I,WAAWrb,SAAS8b,OAEzC5d,MAIRse,kBAAmB,SAAWhK,GAI7B,OAFAtU,KAAK2d,aAAcrJ,EAAS6I,WAAWrb,SAAS8b,OAEzC5d,MAIRue,SAAU,SAAWC,GAMpB,OAJAxe,KAAKqe,sBAAuB,IAAII,OAAmBD,EAAKlK,WAIjDtU,MAIR0e,iBAAkB,SAAWb,GAE5B,IAAIvJ,EAAWuJ,EAAavJ,SAc5B,OAZKA,EAASqK,WAEb3e,KAAK2d,aAAcrJ,EAASsK,UAEjBtK,EAASuK,kBAEpB7e,KAAK2d,aAAcrJ,EAAS6I,WAAWrb,SAAS8b,OAM1C5d,MAIRwd,mBAAoB,WAEnB,IAAIsB,EAAM,IAAIC,OAEd,OAAO,WAEoB,OAArB/e,KAAKud,cAETvd,KAAKud,YAAc,IAAIwB,QAIxB,IAAI7B,EAAQld,KAAKmd,WAAWC,cACxBC,EAAMrd,KAAKmd,WAAWG,iBAEXrF,IAAViF,QAA+BjF,IAARoF,IAE3Brd,KAAKud,YAAYyB,uBAAwB9B,GAEzC4B,EAAIE,uBAAwB3B,GAE5Brd,KAAKud,YAAY0B,MAAOH,KArBP,GA6BpBpB,sBAAuB,WAEtB,IAAIwB,EAAS,IAAI1b,OAEjB,OAAO,WAEuB,OAAxBxD,KAAKyd,iBAETzd,KAAKyd,eAAiB,IAAI0B,QAID,OAArBnf,KAAKud,aAETvd,KAAKwd,qBAIN,IAAIN,EAAQld,KAAKmd,WAAWC,cACxBC,EAAMrd,KAAKmd,WAAWG,YAE1B,QAAerF,IAAViF,QAA+BjF,IAARoF,EAAoB,CAE/C,IAAI+B,EAASpf,KAAKyd,eAAe2B,OAEjCpf,KAAKud,YAAY8B,UAAWD,GAI5B,IAFA,IAAIE,EAAc,EAER9iB,EAAI,EAAG+iB,EAAKrC,EAAMsC,MAAOhjB,EAAI+iB,EAAI/iB,IAE1C0iB,EAAOO,oBAAqBvC,EAAO1gB,GACnC8iB,EAActc,KAAKoG,IAAKkW,EAAaF,EAAOM,kBAAmBR,IAE/DA,EAAOO,oBAAqBpC,EAAK7gB,GACjC8iB,EAActc,KAAKoG,IAAKkW,EAAaF,EAAOM,kBAAmBR,IAIhElf,KAAKyd,eAAekC,OAAS3c,KAAK4c,KAAMN,GAEnCO,MAAO7f,KAAKyd,eAAekC,SAE/Bza,QAAQG,MAAO,wIAAyIrF,QA3CrI,GAqDvB8f,OAAQ,aAIRC,YAAa,SAAW9C,GAIvB,OAFA/X,QAAQE,KAAM,iFAEPpF,KAAKgd,aAAcC,MCxP5B,IAAI+C,GAAe,WAElBzD,GAAqBzf,KAAMkD,MAE3BA,KAAK2I,KAAO,gBAIbqX,GAAapjB,UAAYD,OAAOmgB,OAAQngB,OAAOyC,OAAQmd,GAAqB3f,WAAa,CAExFkf,YAAakE,GAEbC,gBAAgB,EAEhBtC,aAAc,SAAWC,GAOxB,IAHA,IAAIlhB,EAASkhB,EAAMlhB,OAAS,EACxBwjB,EAAS,IAAIpC,aAAc,EAAIphB,GAEzBF,EAAI,EAAGA,EAAIE,EAAQF,GAAK,EAEjC0jB,EAAQ,EAAI1jB,GAAMohB,EAAOphB,GACzB0jB,EAAQ,EAAI1jB,EAAI,GAAMohB,EAAOphB,EAAI,GACjC0jB,EAAQ,EAAI1jB,EAAI,GAAMohB,EAAOphB,EAAI,GAEjC0jB,EAAQ,EAAI1jB,EAAI,GAAMohB,EAAOphB,EAAI,GACjC0jB,EAAQ,EAAI1jB,EAAI,GAAMohB,EAAOphB,EAAI,GACjC0jB,EAAQ,EAAI1jB,EAAI,GAAMohB,EAAOphB,EAAI,GAMlC,OAFA+f,GAAqB3f,UAAU+gB,aAAa7gB,KAAMkD,KAAMkgB,GAEjDlgB,MAIRke,UAAW,SAAWN,GAOrB,IAHA,IAAIlhB,EAASkhB,EAAMlhB,OAAS,EACxByhB,EAAS,IAAIL,aAAc,EAAIphB,GAEzBF,EAAI,EAAGA,EAAIE,EAAQF,GAAK,EAEjC2hB,EAAQ,EAAI3hB,GAAMohB,EAAOphB,GACzB2hB,EAAQ,EAAI3hB,EAAI,GAAMohB,EAAOphB,EAAI,GACjC2hB,EAAQ,EAAI3hB,EAAI,GAAMohB,EAAOphB,EAAI,GAEjC2hB,EAAQ,EAAI3hB,EAAI,GAAMohB,EAAOphB,EAAI,GACjC2hB,EAAQ,EAAI3hB,EAAI,GAAMohB,EAAOphB,EAAI,GACjC2hB,EAAQ,EAAI3hB,EAAI,GAAMohB,EAAOphB,EAAI,GAMlC,OAFA+f,GAAqB3f,UAAUshB,UAAUphB,KAAMkD,KAAMme,GAE9Cne,MAIRmgB,SAAU,SAAW5F,GAEpB,IAAIjG,EAAWiG,EAAKjG,SAcpB,OAZKA,EAASqK,WAEb3e,KAAK2d,aAAcrJ,EAASsK,UAEjBtK,EAASuK,kBAEpB7e,KAAK2d,aAAcrJ,EAAS6I,WAAWrb,SAAS8b,OAM1C5d,MAIR4b,KAAM,WAEL,OAAO5b,QC5ET,IAAIogB,GAAgB,SAAW9L,EAAUkE,QAEtBP,IAAb3D,IAAyBA,EAAW,IAAIiI,SAC3BtE,IAAbO,IAAyBA,EAAW,IAAI4C,GAAc,CAAExJ,MAAuB,SAAhB5O,KAAKwB,YAEzE4U,OAAKtc,KAAMkD,KAAMsU,EAAUkE,GAE3BxY,KAAK2I,KAAO,iBAIbyX,GAAcxjB,UAAYD,OAAOmgB,OAAQngB,OAAOyC,OAAQga,OAAKxc,WAAa,CAEzEkf,YAAasE,GAEbC,iBAAiB,EAEjBC,qBAAwB,WAEvB,IAAIpD,EAAQ,IAAI1Z,OACZ6Z,EAAM,IAAI7Z,OAEd,OAAO,WAQN,IANA,IAAI8Q,EAAWtU,KAAKsU,SAEhB8I,EAAgB9I,EAAS6I,WAAWC,cACpCE,EAAchJ,EAAS6I,WAAWG,YAClCiD,EAAgB,IAAIzC,aAAc,EAAIV,EAAclhB,KAAKsjB,OAEnDhjB,EAAI,EAAGkB,EAAI,EAAGQ,EAAIkf,EAAclhB,KAAKsjB,MAAOhjB,EAAI0B,EAAG1B,IAAMkB,GAAK,EAEvEwf,EAAMuC,oBAAqBrC,EAAe5gB,GAC1C6gB,EAAIoC,oBAAqBnC,EAAa9gB,GAEtC+jB,EAAe7iB,GAAc,IAANA,EAAY,EAAI6iB,EAAe7iB,EAAI,GAC1D6iB,EAAe7iB,EAAI,GAAM6iB,EAAe7iB,GAAMwf,EAAMsD,WAAYnD,GAIjE,IAAIoD,EAAyB,IAAIzC,OAA4BuC,EAAe,EAAG,GAK/E,OAHAjM,EAAS/E,aAAc,wBAAyB,IAAI0O,OAA4BwC,EAAwB,EAAG,IAC3GnM,EAAS/E,aAAc,sBAAuB,IAAI0O,OAA4BwC,EAAwB,EAAG,IAElGzgB,MA5Be,GAkCxB0gB,QAAW,WAEV,IAAIxD,EAAQ,IAAIyD,OACZtD,EAAM,IAAIsD,OAEVC,EAAW,IAAID,OACfE,EAAY,IAAIrd,OAChBsd,EAAW,IAAIC,OACfxG,EAAO,IAAIyG,OACXC,EAAe,IAAIzd,OAEvB,OAAO,SAAkB0d,EAAWC,GAET,OAArBD,EAAUE,QAEdlc,QAAQG,MAAO,gGAIhB,IAAIgc,OAAyCpJ,IAA3BiJ,EAAUI,OAAOC,OAAwBL,EAAUI,OAAOC,MAAMF,WAAiB,EAE/FG,EAAMN,EAAUM,IAChBJ,EAASF,EAAUE,OACnBK,EAAmBL,EAAOK,iBAE1BnN,EAAWtU,KAAKsU,SAChBkE,EAAWxY,KAAKwY,SAChB/K,EAAa+K,EAAS/K,WACtBiU,EAAYlJ,EAASgC,UAAY6G,EAEjCjE,EAAgB9I,EAAS6I,WAAWC,cACpCE,EAAchJ,EAAS6I,WAAWG,YAKtCkE,EAAIG,GAAI,EAAGf,GAGXA,EAASgB,EAAI,EACbhB,EAAS5D,aAAcoE,EAAOS,oBAC9BjB,EAAS5D,aAAcyE,GACvBb,EAASkB,eAAgB,EAAIlB,EAASgB,GAGtChB,EAAS7e,GAAK0L,EAAW1L,EAAI,EAC7B6e,EAAS1e,GAAKuL,EAAWvL,EAAI,EAC7B0e,EAASze,EAAI,EAEb0e,EAAUjF,KAAMgF,GAEhB,IAAImB,EAAc/hB,KAAK+hB,YACvBjB,EAASkB,iBAAkBZ,EAAOS,mBAAoBE,GAEtD,IAAM,IAAIvlB,EAAI,EAAG0B,EAAIkf,EAAcoC,MAAOhjB,EAAI0B,EAAG1B,IAAO,CAEvD0gB,EAAMuC,oBAAqBrC,EAAe5gB,GAC1C6gB,EAAIoC,oBAAqBnC,EAAa9gB,GAEtC0gB,EAAM0E,EAAI,EACVvE,EAAIuE,EAAI,EAGR1E,EAAMF,aAAc8D,GACpBzD,EAAIL,aAAc8D,GAGlB5D,EAAMF,aAAcyE,GACpBpE,EAAIL,aAAcyE,GAGlBvE,EAAM4E,eAAgB,EAAI5E,EAAM0E,GAChCvE,EAAIyE,eAAgB,EAAIzE,EAAIuE,GAG5B,IAAIK,EAAqB/E,EAAM/a,GAAM,GAAKkb,EAAIlb,GAAM,EAChD+f,EAAkBhF,EAAM/a,EAAI,GAAKkb,EAAIlb,EAAI,EAC7C,IAAK8f,IAAsBC,EAA3B,CAOAhF,EAAMnb,GAAK0L,EAAW1L,EAAI,EAC1Bmb,EAAMhb,GAAKuL,EAAWvL,EAAI,EAE1Bmb,EAAItb,GAAK0L,EAAW1L,EAAI,EACxBsb,EAAInb,GAAKuL,EAAWvL,EAAI,EAGxBqY,EAAK2C,MAAMtB,KAAMsB,GACjB3C,EAAK2C,MAAM/a,EAAI,EAEfoY,EAAK8C,IAAIzB,KAAMyB,GACf9C,EAAK8C,IAAIlb,EAAI,EAGb,IAAIggB,EAAQ5H,EAAK6H,6BAA8BvB,GAAW,GAC1DtG,EAAKoH,GAAIQ,EAAOlB,GAGhB,IAAIoB,EAAO3b,OAAU4b,KAAMpF,EAAM/a,EAAGkb,EAAIlb,EAAGggB,GACvCI,EAAgBF,IAAU,GAAKA,GAAQ,EAEvCG,EAAW3B,EAAUL,WAAYS,GAA6B,GAAZS,EAEtD,GAAKa,GAAiBC,EAAW,CAEhCjI,EAAK2C,MAAMuC,oBAAqBrC,EAAe5gB,GAC/C+d,EAAK8C,IAAIoC,oBAAqBnC,EAAa9gB,GAE3C+d,EAAK2C,MAAMF,aAAc+E,GACzBxH,EAAK8C,IAAIL,aAAc+E,GAEvB,IAAIU,EAAc,IAAIjf,OAClBkf,EAAQ,IAAIlf,OAEhBge,EAAImB,oBAAqBpI,EAAK2C,MAAO3C,EAAK8C,IAAKqF,EAAOD,GAEtDtB,EAAWnkB,KAAM,CAEhB0lB,MAAOA,EACPD,YAAaA,EACbG,SAAUpB,EAAIqB,OAAOrC,WAAYkC,GAEjCljB,OAAQQ,KACR8iB,KAAM,KACNC,UAAWvmB,EACXwmB,GAAI,KACJC,IAAK,WAlIC,KC3DZ,IAAI1B,GAAQ,SAAWjN,EAAUkE,QAEdP,IAAb3D,IAAyBA,EAAW,IAAI0L,SAC3B/H,IAAbO,IAAyBA,EAAW,IAAI4C,GAAc,CAAExJ,MAAuB,SAAhB5O,KAAKwB,YAEzE4b,GAActjB,KAAMkD,KAAMsU,EAAUkE,GAEpCxY,KAAK2I,KAAO,SAIb4Y,GAAM3kB,UAAYD,OAAOmgB,OAAQngB,OAAOyC,OAAQghB,GAAcxjB,WAAa,CAE1Ekf,YAAayF,GAEb2B,SAAS,I,wBCMGC,GAAb,0DAKI,WAAYC,GAAU,qCAClB,eACAzmB,OAAO8B,eAAP9B,OAAA,QAAAA,CAAA,GAA4B,WAAY,CAACoC,OAAO,IAEhD,EAAK7C,KAAO,CACRkO,GAAIgZ,EACJza,KAAM,SACN7G,SAAU,EAAKA,SACf2O,QAAS,EAAKA,SAIlB9T,OAAO8B,eAAP9B,OAAA,QAAAA,CAAA,GAA4B,WAAY,CACpCgC,IADoC,WAC5B,OAAOqB,KAAK9D,KAAK4F,UACzBqI,IAFoC,SAEhCpL,GAASiB,KAAK9D,KAAK4F,SAAW/C,KAEtCpC,OAAO8B,eAAP9B,OAAA,QAAAA,CAAA,GAA4B,UAAW,CACnCgC,IADmC,WAC3B,OAAOqB,KAAK9D,KAAKuU,SACzBtG,IAFmC,SAE/BpL,GAASiB,KAAK9D,KAAKuU,QAAU1R,KAlBnB,EAL1B,+CA2BI,cA3BJ,4BAiCI,SAAeskB,OAjCnB,uCA+CI,SAAgCvhB,EAAUsf,EAAQkC,EAAiBC,GAC/D,IAAIX,EAAWO,EAAOK,+BAA+B1hB,EAAUsf,GAC3DqC,GAAYb,EAAWU,GAAmBA,EAC1CI,GAAYd,EAAWW,IAAsC,GAAlBA,GAC/C,OAAOvgB,KAAKgG,IACRtC,OAAUC,MAAM8c,EAAU,EAAG,GAC7B,EAAI/c,OAAUC,MAAM+c,EAAW,EAAG,EAAG,MArDjD,4CA8DI,SAAuC5hB,EAAUsf,GAG7C,OAFA+B,EAAOQ,qBAAqBC,WAAW9hB,EAAUsf,EAAOtf,UACxDsf,EAAOyC,kBAAkBV,EAAOW,kBACzBX,EAAOQ,qBAAqBI,IAAIZ,EAAOW,sBAjEtD,GAA4BE,Q,gBAAfb,G,uBAqCqB,IAAI3f,Q,gBArCzB2f,G,mBAsCiB,IAAI3f,Q,wBCnD9BygB,GAAc,SAAWvf,GAAU,WAEnCsf,OAASlnB,KAAMkD,MAEfA,KAAK0E,QAAUf,SAAS+B,cAAc,OACtC,IAAIwe,EAASxf,EAAQyf,WACrBD,EAAOE,aAAapkB,KAAK0E,QAASA,GAClC1E,KAAK0E,QAAQ2f,YAAY3f,GAEzB1E,KAAK0E,QAAQtB,MAAMtB,SAAW,WAE9B9B,KAAKskB,OAAS,IAAIhhB,OAElBtD,KAAKqT,OAAS,KAEdrT,KAAKoT,iBAAkB,WAAW,WAE9BpT,KAAKukB,UAAU,SAAW/kB,GAEjBA,EAAOkF,mBAAmB8f,SAAyC,OAA9BhlB,EAAOkF,QAAQyf,YAErD3kB,EAAOkF,QAAQyf,WAAWM,YAAajlB,EAAOkF,eAQ1D,IAAIggB,GAAa,EACbC,EAAc,SAAAhgB,GACd,IAAIigB,GAAY,EAEZC,EAAMC,KAAKD,MACXA,EAAMH,EAAY,MAClBE,GAAY,GAGhBF,EAAYG,EAEZ,IAAI3oB,EAAO,CAAC0oB,UAAWA,GAEnB,EAAKG,QAAS,CAACpgB,MAAOA,EAAOzI,KAAMA,KACnCyI,EAAM6N,iBACN7N,EAAMjC,mBAGN+B,EAAc,EAAK4O,OAAQ,wBAAyB,CAChDnX,KAAMA,EACNsD,OAAQ,KAKpBQ,KAAK0E,QAAQ0O,iBAAiB,QAASuR,GACvC3kB,KAAK0E,QAAQ0O,iBAAiB,QAASuR,IAI3CV,GAAYrnB,UAAYD,OAAOyC,OAAQ4kB,OAASpnB,WAChDqnB,GAAYrnB,UAAUkf,YAAcmI,GAIpC,IAAIe,GAAgB,WAAyB,IAIrCC,EAAQC,EACRC,EAAYC,EALU/R,EAAe,uDAAN,KAE/BgS,EAAQrlB,KAKRkf,EAAS,IAAI1b,OACb8hB,EAAa,IAAIvE,OACjBwE,EAAuB,IAAIxE,OAE3ByE,EAAQ,CACRC,QAAS,IAAIC,SAGbC,EAAahiB,SAAS+B,cAAe,OACzCigB,EAAWviB,MAAMwiB,SAAW,SAE5B5lB,KAAK2lB,WAAaA,EAElB3lB,KAAKqT,OAASA,EAEdrT,KAAK6lB,QAAU,WAEX,MAAO,CACHnR,MAAOuQ,EACPtQ,OAAQuQ,IAKhBllB,KAAK8lB,QAAU,SAAWpR,EAAOC,GAE7BsQ,EAASvQ,EACTwQ,EAAUvQ,EAEVwQ,EAAaF,EAAS,EACtBG,EAAcF,EAAU,EAExBS,EAAWviB,MAAMsR,MAAQA,EAAQ,KACjCiR,EAAWviB,MAAMuR,OAASA,EAAS,MAIvC,IAAIoR,EAAe,SAAfA,EAA0BvmB,EAAQuW,EAAOqL,EAAQ4E,GAEjD,GAAKxmB,aAAkBykB,GAAc,CAEjCzkB,EAAO6T,OAASgS,EAAMhS,OAEtB7T,EAAOymB,eAAgBZ,EAAOtP,EAAOqL,GAErClC,EAAOgH,sBAAuB1mB,EAAOuiB,aACrC7C,EAAOlC,aAAcuI,GAErB,IAAI7gB,EAAUlF,EAAOkF,QACjBtB,EAAQ,cAAiB8b,EAAOnd,EAAIojB,EAAaA,EAAa3lB,EAAO8kB,OAAOviB,GAAK,QAAYmd,EAAOhd,EAAIkjB,EAAcA,EAAc5lB,EAAO8kB,OAAOpiB,GAAM,MAE5JwC,EAAQtB,MAAM+iB,gBAAkB/iB,EAChCsB,EAAQtB,MAAMgjB,aAAehjB,EAC7BsB,EAAQtB,MAAMijB,WAAajjB,EAC3BsB,EAAQtB,MAAMkjB,UAAYljB,EAE1BsB,EAAQtB,MAAMmjB,QAAYP,GAAiBxmB,EAAOiR,SAAWyO,EAAO/c,IAAO,GAAK+c,EAAO/c,GAAK,GAA+B,MAA1BuC,EAAQtB,MAAMwX,QAAoB,GAAK,OAExI,IAAI4L,EAAa,CACbC,wBAAyBC,EAAsBtF,EAAQ5hB,IAG3DgmB,EAAMC,QAAQtb,IAAK3K,EAAQgnB,GAEtB9hB,EAAQyf,aAAewB,GAExBA,EAAWtB,YAAa3f,GAI5BlF,EAAOmnB,cAAetB,EAAOtP,EAAOqL,GAIxC,IAAM,IAAI5kB,EAAI,EAAG0B,EAAIsB,EAAO2a,SAASzd,OAAQF,EAAI0B,EAAG1B,IAEhDupB,EAAcvmB,EAAO2a,SAAU3d,GAAKuZ,EAAOqL,EAAQ4E,GAAiBxmB,EAAOiR,UAM/EiW,EAAuB,WAEvB,IAAIpV,EAAI,IAAI9N,OACR+N,EAAI,IAAI/N,OAEZ,OAAO,SAAWgF,EAASC,GAKvB,OAHA6I,EAAE4U,sBAAuB1d,EAAQuZ,aACjCxQ,EAAE2U,sBAAuBzd,EAAQsZ,aAE1BzQ,EAAEoO,kBAAmBnO,IAVT,GAgBvBqV,EAAmB,SAAW7Q,GAE9B,IAAIxY,EAAS,GAQb,OANAwY,EAAMwO,UAAU,SAAW/kB,GAElBA,aAAkBykB,IAAc1mB,EAAOP,KAAMwC,MAI/CjC,GAIPspB,EAAS,SAAW9Q,GAapB,IAXA,IAAI+Q,EAASF,EAAkB7Q,GAAQgR,MAAM,SAAWzV,EAAGC,GAEvD,IAAIyV,EAAYxB,EAAMC,QAAQ9mB,IAAK2S,GAAImV,wBACnCQ,EAAYzB,EAAMC,QAAQ9mB,IAAK4S,GAAIkV,wBAEvC,OAAOO,EAAYC,KAInBC,EAAOJ,EAAOpqB,OAERF,EAAI,EAAG0B,EAAI4oB,EAAOpqB,OAAQF,EAAI0B,EAAG1B,IAEvCsqB,EAAQtqB,GAAIkI,QAAQtB,MAAM+jB,OAASD,EAAO1qB,GAMlDwD,KAAKonB,OAAS,SAAWrR,EAAOqL,IAEF,IAArBrL,EAAMsR,YAAsBtR,EAAM2D,oBAChB,OAAlB0H,EAAO8C,QAAkB9C,EAAO1H,oBAErC4L,EAAW1J,KAAMwF,EAAOS,oBACxB0D,EAAqBvD,iBAAkBZ,EAAOK,iBAAkB6D,GAEhES,EAAchQ,EAAOA,EAAOqL,GAAQ,GACpCyF,EAAQ9Q,KCrMHuR,GAAb,0DAKI,WAAYlE,GAAU,qCAClB,cAAMA,GACNzmB,OAAO8B,eAAP9B,OAAA,QAAAA,CAAA,GAA4B,iBAAkB,CAACoC,OAAO,IACtD,EAAK7C,KAAKyM,KAAO,SAEjB,EAAKzM,KAAKoG,MAAQ,KAClB,EAAKpG,KAAK0I,OAAS,KACnB,EAAK1I,KAAKqrB,KAAO,KACjB,EAAKrrB,KAAKsrB,QAAS,EAEnB,EAAK9C,WAAa,EAVA,EAL1B,+CAkBI,SAAQ/f,GACJ,IAAI8iB,EAAM,IAAIjkB,OAMd,GALImB,EAAM+iB,eACND,EAAI7L,KAAKjX,EAAM+iB,aAAajF,aAAe9d,EAAM+iB,aAAahF,OAC9D+E,EAAIE,IAAI3nB,KAAK8B,WAGb6C,EAAMzI,KAAK0oB,UAAW,OAAO,EAEjC,GAAI5kB,KAAK9D,KAAK0I,QAAU5E,KAAK9D,KAAKoG,MAAO,CACrC,IAAIslB,EAAQ,IAAIC,GAAW7nB,KAAK9D,KAAK0I,QAAU5E,KAAK9D,KAAKoG,OACzDslB,EAAM9lB,SAAS8Z,KAAK6L,GACpBznB,KAAKyW,IAAImR,GACTA,EAAM7c,OAOV,OAJI/K,KAAK9D,KAAKqrB,MACV3nB,OAAOmL,KAAK/K,KAAK9D,KAAKqrB,KAAMvnB,KAAK9D,KAAKsrB,OAAS,SAAW,UAGvD,IAtCf,4BAkDI,SAAenE,GAGX,IAAIoE,EAAMpE,EAAWvhB,UAAY,GACjC9B,KAAK8B,SAASgmB,KAAKL,EAAI1lB,GAAK,GAC5B/B,KAAK8B,SAASimB,KAAKN,EAAIvlB,GAAK,GAC5BlC,KAAK8B,SAASkmB,KAAKP,EAAItlB,GAAK,GAG5BnC,KAAK9D,KAAKoG,MAAQ+gB,EAAW/gB,OAAS,KAGtCtC,KAAK9D,KAAK0I,OAASye,EAAWze,QAAU,KAGxC5E,KAAK9D,KAAKqrB,KAAOlE,EAAWkE,MAAQ,KACpCvnB,KAAK9D,KAAKsrB,SAAWnE,EAAWmE,WAlExC,GAAkCrE,IAuErB0E,GAAb,0DAKI,WAAYvlB,GAAO,2CACTiD,EAAc,qCAAD,OAAsCjD,EAAtC,YAN3B,4CAYI,WAAuB,WAAlB2lB,IAAkB,yDACfC,EAAgBloB,KAAK0E,QAAQtB,MAAMwX,SAAW,EAElD5a,KAAK0E,QAAQtB,MAAMwX,QAAU,EAC7B,IAAIuN,EAAcpiB,GAAQ,SAAAU,GACtB,EAAK/B,QAAQtB,MAAMwX,SAAWnU,EAAWyhB,GAAe/jB,aACzD,KAEH,GAAI8jB,EAAW,CACX,IAAIG,EAAgB,SAAhBA,EAAgBxV,GACZA,EAAIyV,eAAeC,SAAS,EAAK5jB,WAErCyjB,EAAYrhB,SACZ,EAAKkD,QAELpK,OAAO2T,oBAAoB,YAAa6U,GACxCxoB,OAAO2T,oBAAoB,aAAc6U,GACzCxoB,OAAO2T,oBAAoB,UAAW6U,GACtCxoB,OAAO2T,oBAAoB,aAAc6U,KAG7CxoB,OAAOwT,iBAAiB,YAAagV,GACrCxoB,OAAOwT,iBAAiB,aAAcgV,GACtCxoB,OAAOwT,iBAAiB,UAAWgV,GACnCxoB,OAAOwT,iBAAiB,aAAcgV,MApClD,mBA2CI,WAAqB,WAAfrR,IAAe,yDACbwR,EAAevmB,WAAWhC,KAAK0E,QAAQtB,MAAMwX,SAEjD7U,GAAQ,SAAAU,GACJ,EAAK/B,QAAQtB,MAAMwX,SAAW2N,EAAe9hB,EAAW8hB,GAAcpkB,aACvE,KAAK,SAAAqkB,GACAzR,GAAUyR,GAAa,EAAKtE,QAC5B,EAAKA,OAAOnN,OAAO,UAlDnC,GAAgCkN,ICnEnBwE,GAAb,0DAKI,WAAYrF,GAAU,8BAClB,cAAMA,GACNzmB,OAAO8B,eAAP9B,OAAA,QAAAA,CAAA,GAA4B,gBAAiB,CAACoC,OAAO,IACrD,EAAK7C,KAAKyM,KAAO,QAEjB,IAAI+f,EAAO,IAAIplB,OACXqlB,EAAQ,IAAIC,OAAM,CAACF,EAAMA,EAAMA,IANjB,OAOlB,EAAKG,KAAO,IAAIC,GAAgBH,GAChC,EAAKI,OAAS,IAAIC,GAAkBL,GACpC,EAAKI,OAAOE,aAAe,EAE3B,EAAKxS,IAAI,EAAKsS,OAAQ,EAAKF,MAE3B,EAAKK,YAAc,GAbD,EAL1B,iDAwBI,SAAUhnB,GACN,IAAIinB,EAAYjnB,EAAIlC,KAAK8B,SAASI,EAClClC,KAAK6oB,KAAK/mB,SAASI,EAAIinB,EACvBnpB,KAAK+oB,OAAOjnB,SAASI,EAAIinB,IA3BjC,sBAiCI,SAASR,GACL3oB,KAAK6oB,KAAKO,eAAeT,GACzB3oB,KAAK+oB,OAAOK,eAAeT,KAnCnC,4BA6DI,SAAetF,GACX,8EAAqBA,GAIhBrjB,KAAKkpB,YAAYP,OAAUpgB,EAAW8a,EAAWsF,MAAO3oB,KAAKkpB,YAAYP,QACzE3oB,KAAKkpB,YAAYpnB,UAAayG,EAAW8a,EAAWvhB,SAAU9B,KAAKkpB,YAAYpnB,WAEhF9B,KAAKqpB,SAASrpB,KAAKspB,oBAAoBjG,EAAWsF,QAItD3oB,KAAKupB,WAAWlG,EAAWmG,QAAUnG,EAAW1O,QAAU,GAAK,KAG/D3U,KAAK+oB,OAAOU,YAAcpG,EAAWoG,UACrCzpB,KAAK6oB,KAAKY,YAAcpG,EAAWoG,UAGnCzpB,KAAK+oB,OAAOvO,eAAqCvC,IAAzBoL,EAAW3B,UAA0B2B,EAAW3B,UAAY,EAGpF,IAAIgI,EAAKrG,EAAWsG,WAAatG,EAAWuG,aAAe,GAC3D5pB,KAAK+oB,OAAOnX,MAAMiY,QAAQH,EAAG9qB,GAAK,GAAK,KAAM8qB,EAAG5X,GAAK,GAAK,KAAM4X,EAAGnY,GAAK,GAAK,KAC7EvR,KAAK+oB,OAAOnO,QAAU8O,EAAGpY,GAAK,EAG9B,IAAIwY,EAAKzG,EAAW0G,WAAa,GACjC/pB,KAAK6oB,KAAKjX,MAAMiY,QAAQC,EAAGlrB,GAAK,GAAK,KAAMkrB,EAAGhY,GAAK,GAAK,KAAMgY,EAAGvY,GAAK,GAAK,KAC3EvR,KAAK6oB,KAAKjO,QAAUkP,EAAGxY,GAAK,EAG5B,IAAI0Y,EAAU3G,EAAW4G,aAAe,EACpCC,OAAqCjS,IAA3BoL,EAAW8G,YAA4B9G,EAAW8G,YAActnB,OAAOunB,UACrFpqB,KAAK+oB,OAAOzF,gBAAkB0G,EAC9BhqB,KAAK+oB,OAAOxF,gBAAkB2G,EAC9BlqB,KAAK6oB,KAAKvF,gBAAkB0G,EAC5BhqB,KAAK6oB,KAAKtF,gBAAkB2G,EAG5BlqB,KAAKkpB,YAAc7F,IArG3B,qBAwGI,WACI,wEAEArjB,KAAK6oB,KAAKtU,UACVvU,KAAK+oB,OAAOxU,YA5GpB,iCAqHI,SAAoB8V,GAAW,WAEvBnK,EAAS,GAWb,OATItX,MAAMC,QAAQwhB,IACdA,EAAU7S,SAAQ,SAAAkL,GACd,IAAI3gB,GAAK2gB,EAAM3gB,GAAK,GAAK,EAAKD,SAASC,EACnCI,GAAKugB,EAAMvgB,GAAK,GAAK,EAAKL,SAASK,EAEvC+d,EAAOljB,KAAK,IAAIsG,OAAQvB,EAAGI,OAI5B,IAAIymB,OAAM1I,OAlIzB,GAAiCoH,IAuI3BwB,G,0DAKF,WAAYH,GAAO,wBACf,IAAIrU,EAAWwU,EAAgBwB,eAAe3B,GAC1CnQ,EAAW,IAAI8C,OAAe,CAC9BJ,aAAcc,GACdb,eAAgBiB,GAChBmO,KAAMC,OACNf,WAAW,EACXgB,aAAa,EACbpf,SAAU,CACNqf,YAAa,CAAE3rB,MAAO,IAAI4rB,QAC1BC,cAAe,CAAE7rB,MAAO,GACxBukB,gBAAiB,CAAEvkB,MAAO,GAC1BwkB,gBAAiB,CAAExkB,MAAO8D,OAAOunB,cAZ1B,mBAgBT9V,EAAUkE,G,2CAMpB,WACI,OAAOxY,KAAKwY,SAASnN,SAASqf,YAAY3rB,Q,mBAM9C,WACI,OAAOiB,KAAKwY,SAASnN,SAASuf,cAAc7rB,O,IAMhD,SAAY6b,GACR5a,KAAKwY,SAASnN,SAASuf,cAAc7rB,MAAQ6b,EAC7C5a,KAAKyQ,QAAUmK,EAAU,I,qBAM7B,WACI,OAAO5a,KAAKwY,SAASiR,W,IAMzB,SAAcoB,GACV7qB,KAAKwY,SAASiR,UAAYoB,I,2BAM9B,WACI,OAAO7qB,KAAKwY,SAASnN,SAASiY,gBAAgBvkB,O,IAMlD,SAAoBiK,GAChBhJ,KAAKwY,SAASnN,SAASiY,gBAAgBvkB,MAAQiK,I,2BAMnD,WACI,OAAOhJ,KAAKwY,SAASnN,SAASkY,gBAAgBxkB,O,IAMlD,SAAoBqK,GAChBpJ,KAAKwY,SAASnN,SAASkY,gBAAgBxkB,MAAQqK,I,qBAGnD,SAAQzE,GACJ,GAAIA,EAAM+iB,aAAc,CACpB,GAAI/iB,EAAM+iB,aAAa9E,SAAW5iB,KAAKujB,gBAAiB,OAAO,EAC/D,GAAI5e,EAAM+iB,aAAa9E,SAAW5iB,KAAKsjB,gBAAiB,OAAO,EAGnE,8EAAqB3e,K,4BAMzB,SAAegkB,GACX3oB,KAAKsU,SAASC,UACdvU,KAAKsU,SAAWwU,EAAgBwB,eAAe3B,K,qBAGnD,WACI3oB,KAAKsU,SAASC,UACdvU,KAAKwY,SAASjE,a,6BAOlB,SAAsBoU,GAClB,IAAIrU,EAAW,IAAIwW,OAAoBnC,EAAO,GAG9C,OAFArU,EAASyW,QAAQ/nB,KAAKgoB,GAAK,GAEpB1W,M,GAtHe8E,QA2HxB4P,G,0DAKF,WAAYL,GAAO,8BACf,IAAIrU,EAAW,IAAI0L,GACnB1L,EAASqJ,aAAaqL,EAAkBiC,iBAAiBtC,IAEzD,IAAInQ,EAAW,IAAI4C,GAAa,CAC5BxJ,MAAO,IAAI+Y,OACX/P,QAAS,EACT6P,aAAa,EACbjQ,UAAW,EACXiP,WAAW,EACXyB,cAAc,EACdzP,QAAQ,IAXG,OAafjD,EAASnN,SAASiY,gBAAkB,CAAEvkB,MAAO,GAC7CyZ,EAASnN,SAASkY,gBAAkB,CAAExkB,MAAO8D,OAAOunB,WAEpD5R,EAAS/K,WAAWtD,IAAIvK,OAAOurB,WAAYvrB,OAAOwrB,aAElD,cAAM9W,EAAUkE,GAEhB,EAAK8H,uBApBU,E,2CA0BnB,WACI,OAAOtgB,KAAKwY,SAAS5G,Q,mBAMzB,WACI,OAAO5R,KAAKwY,SAASoC,S,IAMzB,SAAYA,GACR5a,KAAKwY,SAASoC,QAAUA,EACxB5a,KAAKyQ,QAAUmK,EAAU,I,qBAM7B,WACI,OAAO5a,KAAKwY,SAASgC,W,IAMzB,SAAc9F,GACV1U,KAAKwY,SAASgC,UAAY9F,I,qBAM9B,WACI,OAAO1U,KAAKwY,SAASiR,W,IAMzB,SAAcoB,GACV7qB,KAAKwY,SAASiR,UAAYoB,I,2BAM9B,WACI,OAAO7qB,KAAKwY,SAASnN,SAASiY,gBAAgBvkB,O,IAMlD,SAAoBiK,GAChBhJ,KAAKwY,SAASnN,SAASiY,gBAAgBvkB,MAAQiK,I,2BAMnD,WACI,OAAOhJ,KAAKwY,SAASnN,SAASkY,gBAAgBxkB,O,IAMlD,SAAoBqK,GAChBpJ,KAAKwY,SAASnN,SAASkY,gBAAgBxkB,MAAQqK,I,qBAGnD,SAAQzE,GACJ,GAAIA,EAAM+iB,aAAc,CACpB,GAAI/iB,EAAM+iB,aAAa9E,SAAW5iB,KAAKujB,gBAAiB,OAAO,EAC/D,GAAI5e,EAAM+iB,aAAa9E,SAAW5iB,KAAKsjB,gBAAiB,OAAO,EAGnE,8EAAqB3e,K,4BAMzB,SAAegkB,GACX3oB,KAAKsU,SAAW,IAAI0L,GACpBhgB,KAAKsU,SAASqJ,aAAaqL,EAAkBiC,iBAAiBtC,IAC9D3oB,KAAKsgB,yB,4BAMT,SAAe+K,GACXA,EAASxF,QAAQ7lB,KAAKwY,SAAS/K,c,qBAGnC,WACIzN,KAAKsU,SAASC,UACdvU,KAAKwY,SAASjE,a,+BAOlB,SAAwBoU,GACpB,IAAI2C,EAAW,GACXpL,EAASyI,EAAM4C,UAAU,GAI7B,OAHArL,EAAO1I,SAAQ,SAAAkL,GAAK,OAAI4I,EAAStuB,KAAK0lB,EAAM3gB,EAAG,EAAG2gB,EAAMxgB,MACxDopB,EAAStuB,KAAKkjB,EAAO,GAAGne,EAAG,EAAGme,EAAO,GAAGhe,GAEjCopB,M,GAlJiB/J,IClQnBiK,GAAb,0DAKI,WAAYpI,GAAU,8BAClB,cAAMA,GACNzmB,OAAO8B,eAAP9B,OAAA,QAAAA,CAAA,GAA4B,kBAAmB,CAACoC,OAAO,IACvD,EAAK7C,KAAKyM,KAAO,UAEjB,IAAI+f,EAAO,IAAIplB,OACXqlB,EAAQ,IAAIC,OAAM,CAACF,EAAMA,EAAMA,IANjB,OAOlB,EAAKG,KAAO,IAAI4C,GAAkB9C,GAClC,EAAKI,OAAS,IAAI2C,GAAoB/C,GACtC,EAAKI,OAAOE,aAAe,EAE3B,EAAKxS,IAAI,EAAKsS,OAAQ,EAAKF,MAE3B,EAAKK,YAAc,GAbD,EAL1B,iDAyBI,SAAUyC,EAAMC,GACZ,IAAIzC,EAAYyC,EAAO5rB,KAAK8B,SAASI,EACjCyS,EAASiX,EAAOD,EACpB3rB,KAAK6oB,KAAK/mB,SAASI,EAAIinB,EACvBnpB,KAAK+oB,OAAOjnB,SAASI,EAAIinB,EACzBnpB,KAAK6oB,KAAKrP,MAAMtX,EAAIyS,EACpB3U,KAAK+oB,OAAOvP,MAAMtX,EAAIyS,IA/B9B,sBAqCI,SAASgU,GACL3oB,KAAK6oB,KAAKO,eAAeT,GACzB3oB,KAAK+oB,OAAOK,eAAeT,KAvCnC,4BAgEI,SAAetF,GACX,8EAAqBA,GAIhBrjB,KAAKkpB,YAAYP,OAAUpgB,EAAW8a,EAAWsF,MAAO3oB,KAAKkpB,YAAYP,QACzE3oB,KAAKkpB,YAAYpnB,UAAayG,EAAW8a,EAAWvhB,SAAU9B,KAAKkpB,YAAYpnB,WAEhF9B,KAAKqpB,SAASrpB,KAAKspB,oBAAoBjG,EAAWsF,QAItD3oB,KAAKupB,WAAWlG,EAAWwI,WAAa,GAAK,KAAOxI,EAAWyI,WAAa,GAAK,KAGjF9rB,KAAK+oB,OAAOU,YAAcpG,EAAWoG,UACrCzpB,KAAK6oB,KAAKY,YAAcpG,EAAWoG,UAGnCzpB,KAAK+oB,OAAOvO,eAAqCvC,IAAzBoL,EAAW3B,UAA0B2B,EAAW3B,UAAY,EAGpF,IAAIgI,EAAKrG,EAAWsG,WAAa,GACjC3pB,KAAK+oB,OAAOnX,MAAMiY,QAAQH,EAAG9qB,GAAK,GAAK,KAAM8qB,EAAG5X,GAAK,GAAK,KAAM4X,EAAGnY,GAAK,GAAK,KAC7EvR,KAAK+oB,OAAOnO,QAAU8O,EAAGpY,GAAK,EAG9B,IAAIwY,EAAKzG,EAAW0G,WAAa,GACjC/pB,KAAK6oB,KAAKjX,MAAMiY,QAAQC,EAAGlrB,GAAK,GAAK,KAAMkrB,EAAGhY,GAAK,GAAK,KAAMgY,EAAGvY,GAAK,GAAK,KAC3EvR,KAAK6oB,KAAKjO,QAAUkP,EAAGxY,GAAK,EAG5B,IAAI0Y,EAAU3G,EAAW4G,aAAe,EACpCC,OAAqCjS,IAA3BoL,EAAW8G,YAA4B9G,EAAW8G,YAActnB,OAAOunB,UACrFpqB,KAAK+oB,OAAOzF,gBAAkB0G,EAC9BhqB,KAAK+oB,OAAOxF,gBAAkB2G,EAC9BlqB,KAAK6oB,KAAKvF,gBAAkB0G,EAC5BhqB,KAAK6oB,KAAKtF,gBAAkB2G,EAG5BlqB,KAAKkpB,YAAc7F,IAxG3B,qBA2GI,WACI,wEAEArjB,KAAK6oB,KAAKtU,UACVvU,KAAK+oB,OAAOxU,YA/GpB,iCAwHI,SAAoB8V,GAAW,WAEvBnK,EAAS,GAWb,OATItX,MAAMC,QAAQwhB,IACdA,EAAU7S,SAAQ,SAAAkL,GACd,IAAI3gB,GAAK2gB,EAAM3gB,GAAK,GAAK,EAAKD,SAASC,EAAI,IACvCI,GAAKugB,EAAMvgB,GAAK,GAAK,EAAKL,SAASK,EAAI,IAE3C+d,EAAOljB,KAAK,IAAIsG,OAAQvB,EAAGI,OAI5B,IAAIymB,OAAM1I,OArIzB,GAAmCoH,IA0I7BmE,G,0DAKF,WAAY9C,GAAO,wBACf,IAAIrU,EAAWmX,EAAkBnB,eAAe3B,GAC5CnQ,EAAW,IAAI8C,OAAe,CAC9BJ,aAAcc,GACdb,eAAgBiB,GAChBmO,KAAMC,OACNf,WAAW,EACXgB,aAAa,EACbpf,SAAU,CACNqf,YAAa,CAAE3rB,MAAO,IAAI4rB,QAC1BC,cAAe,CAAE7rB,MAAO,GACxBukB,gBAAiB,CAAEvkB,MAAO,GAC1BwkB,gBAAiB,CAAExkB,MAAO8D,OAAOunB,cAZ1B,mBAgBT9V,EAAUkE,G,2CAMpB,WACI,OAAOxY,KAAKwY,SAASnN,SAASqf,YAAY3rB,Q,mBAM9C,WACI,OAAOiB,KAAKwY,SAASnN,SAASuf,cAAc7rB,O,IAMhD,SAAY6b,GACR5a,KAAKwY,SAASnN,SAASuf,cAAc7rB,MAAQ6b,EAC7C5a,KAAKyQ,QAAUmK,EAAU,I,qBAM7B,WACI,OAAO5a,KAAKwY,SAASiR,W,IAMzB,SAAcoB,GACV7qB,KAAKwY,SAASiR,UAAYoB,I,2BAM9B,WACI,OAAO7qB,KAAKwY,SAASnN,SAASiY,gBAAgBvkB,O,IAMlD,SAAoBiK,GAChBhJ,KAAKwY,SAASnN,SAASiY,gBAAgBvkB,MAAQiK,I,2BAMnD,WACI,OAAOhJ,KAAKwY,SAASnN,SAASkY,gBAAgBxkB,O,IAMlD,SAAoBqK,GAChBpJ,KAAKwY,SAASnN,SAASkY,gBAAgBxkB,MAAQqK,I,qBAGnD,SAAQzE,GACJ,GAAIA,EAAM+iB,aAAc,CACpB,GAAI/iB,EAAM+iB,aAAa9E,SAAW5iB,KAAKujB,gBAAiB,OAAO,EAC/D,GAAI5e,EAAM+iB,aAAa9E,SAAW5iB,KAAKsjB,gBAAiB,OAAO,EAGnE,8EAAqB3e,K,4BAMzB,SAAegkB,GACX3oB,KAAKsU,SAASC,UACdvU,KAAKsU,SAAWmX,EAAkBnB,eAAe3B,K,qBAGrD,WACI3oB,KAAKsU,SAASC,UACdvU,KAAKwY,SAASjE,a,6BAOlB,SAAsBoU,GAClB,IAAIrU,EAAW,IAAIyX,OAAsBpD,EAAO,CAC5CqD,MAAO,EACPC,MAAO,EACPC,cAAc,IAIlB,OAFA5X,EAASyW,QAAQ/nB,KAAKgoB,GAAK,GAEpB1W,M,GA1HiB8E,QA+H1BsS,G,0DAKF,WAAY/C,GAAO,8BACf,IAAIrU,EAAW,IAAIiI,GACnBjI,EAASqJ,aAAa+N,EAAoBT,iBAAiBtC,IAE3D,IAAInQ,EAAW,IAAI4C,GAAa,CAC5BxJ,MAAO,IAAI+Y,OACX/P,QAAS,EACT6P,aAAa,EACbjQ,UAAW,EACXiP,WAAW,EACXyB,cAAc,EACdzP,QAAQ,IAXG,OAafjD,EAASnN,SAASiY,gBAAkB,CAAEvkB,MAAO,GAC7CyZ,EAASnN,SAASkY,gBAAkB,CAAExkB,MAAO8D,OAAOunB,WAEpD5R,EAAS/K,WAAWtD,IAAIvK,OAAOurB,WAAYvrB,OAAOwrB,aAElD,cAAM9W,EAAUkE,GAEhB,EAAK8H,uBApBU,E,2CA0BnB,WACI,OAAOtgB,KAAKwY,SAAS5G,Q,mBAMzB,WACI,OAAO5R,KAAKwY,SAASoC,S,IAMzB,SAAYA,GACR5a,KAAKwY,SAASoC,QAAUA,EACxB5a,KAAKyQ,QAAUmK,EAAU,I,qBAM7B,WACI,OAAO5a,KAAKwY,SAASgC,W,IAMzB,SAAc9F,GACV1U,KAAKwY,SAASgC,UAAY9F,I,qBAM9B,WACI,OAAO1U,KAAKwY,SAASiR,W,IAMzB,SAAcoB,GACV7qB,KAAKwY,SAASiR,UAAYoB,I,2BAM9B,WACI,OAAO7qB,KAAKwY,SAASnN,SAASiY,gBAAgBvkB,O,IAMlD,SAAoBiK,GAChBhJ,KAAKwY,SAASnN,SAASiY,gBAAgBvkB,MAAQiK,I,2BAMnD,WACI,OAAOhJ,KAAKwY,SAASnN,SAASkY,gBAAgBxkB,O,IAMlD,SAAoBqK,GAChBpJ,KAAKwY,SAASnN,SAASkY,gBAAgBxkB,MAAQqK,I,qBAGnD,SAAQzE,GACJ,GAAIA,EAAM+iB,aAAc,CACpB,GAAI/iB,EAAM+iB,aAAa9E,SAAW5iB,KAAKujB,gBAAiB,OAAO,EAC/D,GAAI5e,EAAM+iB,aAAa9E,SAAW5iB,KAAKsjB,gBAAiB,OAAO,EAGnE,8EAAqB3e,K,4BAMzB,SAAegkB,GACX3oB,KAAKsU,SAAW,IAAIiI,GACpBvc,KAAKsU,SAASqJ,aAAa+N,EAAoBT,iBAAiBtC,IAChE3oB,KAAKsgB,yB,4BAMT,SAAe+K,GACXA,EAASxF,QAAQ7lB,KAAKwY,SAAS/K,c,qBAGnC,WACIzN,KAAKsU,SAASC,UACdvU,KAAKwY,SAASjE,a,+BAOlB,SAAwBoU,GACpB,IAAI2C,EAAW,GACXpL,EAASyI,EAAM4C,UAAU,GAC7BrL,EAAOljB,KAAKkjB,EAAO,IAEnB,IAAIiM,EAAY,KAoBhB,OAnBAjM,EAAO1I,SAAQ,SAAAkL,GAGX4I,EAAStuB,KAAK0lB,EAAM3gB,EAAG,EAAG2gB,EAAMxgB,GAChCopB,EAAStuB,KAAK0lB,EAAM3gB,GAAI,EAAG2gB,EAAMxgB,GAE7BiqB,IAEAb,EAAStuB,KAAKmvB,EAAUpqB,EAAG,EAAGoqB,EAAUjqB,GACxCopB,EAAStuB,KAAK0lB,EAAM3gB,EAAG,EAAG2gB,EAAMxgB,GAGhCopB,EAAStuB,KAAKmvB,EAAUpqB,GAAI,EAAGoqB,EAAUjqB,GACzCopB,EAAStuB,KAAK0lB,EAAM3gB,GAAI,EAAG2gB,EAAMxgB,IAGrCiqB,EAAYzJ,KAGT4I,M,GArKmB/J,IC3QrB6K,GAAb,0DAKI,WAAYhJ,GAAU,qCAClB,cAAMA,GACNzmB,OAAO8B,eAAP9B,OAAA,QAAAA,CAAA,GAA4B,eAAgB,CAACoC,OAAO,IACpD,EAAK7C,KAAKyM,KAAO,OAEjB,EAAK4R,KAAO,IAAI8R,GAAe,CAAC,EAAG,EAAG,IAEtC,EAAK5V,IAAI,EAAK8D,MAEd,EAAK2O,YAAc,GATD,EAL1B,+CAoBI,SAAQ3O,GAEJ,IAAI2F,EAMJ,GAJkB,UAAd3F,EAAK5R,MAAkC,cAAd4R,EAAK5R,OAC9B4R,EAAOA,EAAKgR,UAAU,KAGtB3iB,MAAMC,QAAQ0R,GAYd,MAAM,IAAI+R,MAAM,0BAXI,IAAhB/R,EAAK7d,OACLwjB,EAAS,GACF3F,EAAK,GAAGgS,WACfrM,EAAS,GACT3F,EAAK/C,SAAQ,SAAAkL,GACTxC,EAAOljB,KAAK0lB,EAAM3gB,EAAG2gB,EAAMxgB,EAAGwgB,EAAMvgB,OAGxC+d,EAAS3F,EAMjBva,KAAKua,KAAK6O,eAAelJ,KA3CjC,4BAiEI,SAAemD,GACX,8EAAqBA,GAIhBrjB,KAAKkpB,YAAY3O,MAAShS,EAAW8a,EAAW9I,KAAMva,KAAKkpB,YAAY3O,OACvEva,KAAKkpB,YAAYpnB,UAAayG,EAAW8a,EAAWvhB,SAAU9B,KAAKkpB,YAAYpnB,WAEhF9B,KAAKwsB,QAAQxsB,KAAKysB,qBAAqBpJ,EAAW9I,OAItDva,KAAKua,KAAKkP,YAAcpG,EAAWoG,UAGnCzpB,KAAKua,KAAKC,eAAqCvC,IAAzBoL,EAAW3B,UAA0B2B,EAAW3B,UAAY,EAGlF,IAAIgL,EAAKrJ,EAAWsG,WAAa,GACjC3pB,KAAKua,KAAK3I,MAAMiY,QAAQ6C,EAAG9tB,GAAK,GAAK,KAAM8tB,EAAG5a,GAAK,GAAK,KAAM4a,EAAGnb,GAAK,GAAK,KAC3EvR,KAAKua,KAAKK,QAAU8R,EAAGpb,GAAK,EAG5B,IAAI0Y,EAAU3G,EAAW4G,aAAe,EACpCC,OAAqCjS,IAA3BoL,EAAW8G,YAA4B9G,EAAW8G,YAActnB,OAAOunB,UACrFpqB,KAAKua,KAAK+I,gBAAkB0G,EAC5BhqB,KAAKua,KAAKgJ,gBAAkB2G,EAG5BlqB,KAAKkpB,YAAc7F,IA9F3B,qBAiGI,WACI,wEAEArjB,KAAKua,KAAKhG,YApGlB,kCA6GI,SAAqB8V,GAAW,WAExBnK,EAAS,GAYb,OAVItX,MAAMC,QAAQwhB,IACdA,EAAU7S,SAAQ,SAAAkL,GACd,IAAI3gB,GAAK2gB,EAAM3gB,GAAK,GAAK,EAAKD,SAASC,EACnCG,GAAKwgB,EAAMxgB,GAAK,GAAK,EAAKJ,SAASI,EACnCC,GAAKugB,EAAMvgB,GAAK,GAAK,EAAKL,SAASK,EAEvC+d,EAAOljB,KAAK+E,EAAGG,EAAGC,MAInB+d,MA3Hf,GAAgCoH,IAgI1B+E,G,0DAKF,WAAYnM,GAAQ,8BAChB,IAAI5L,EAAW,IAAI0L,GACnB1L,EAASqJ,aAAauC,GAEtB,IAAI1H,EAAW,IAAI4C,GAAa,CAC5BxJ,MAAO,IAAI+Y,OACX/P,QAAS,EACT6P,aAAa,EACbjQ,UAAW,EACXiP,WAAW,EACXyB,cAAc,EACdzP,QAAQ,IAXI,OAahBjD,EAASnN,SAASiY,gBAAkB,CAAEvkB,MAAO,GAC7CyZ,EAASnN,SAASkY,gBAAkB,CAAExkB,MAAO8D,OAAOunB,WAEpD5R,EAAS/K,WAAWtD,IAAIvK,OAAOurB,WAAYvrB,OAAOwrB,aAElD,cAAM9W,EAAUkE,GAEhB,EAAK8H,uBApBW,E,2CA0BpB,WACI,OAAOtgB,KAAKwY,SAAS5G,Q,mBAMzB,WACI,OAAO5R,KAAKwY,SAASoC,S,IAMzB,SAAYA,GACR5a,KAAKwY,SAASoC,QAAUA,EACxB5a,KAAKyQ,QAAUmK,EAAU,I,qBAM7B,WACI,OAAO5a,KAAKwY,SAASgC,W,IAMzB,SAAc9F,GACV1U,KAAKwY,SAASgC,UAAY9F,I,qBAM9B,WACI,OAAO1U,KAAKwY,SAASiR,W,IAMzB,SAAcoB,GACV7qB,KAAKwY,SAASiR,UAAYoB,I,2BAM9B,WACI,OAAO7qB,KAAKwY,SAASnN,SAASiY,gBAAgBvkB,O,IAMlD,SAAoBiK,GAChBhJ,KAAKwY,SAASnN,SAASiY,gBAAgBvkB,MAAQiK,I,2BAMnD,WACI,OAAOhJ,KAAKwY,SAASnN,SAASkY,gBAAgBxkB,O,IAMlD,SAAoBqK,GAChBpJ,KAAKwY,SAASnN,SAASkY,gBAAgBxkB,MAAQqK,I,qBAGnD,SAAQzE,GACJ,GAAIA,EAAM+iB,aAAc,CACpB,GAAI/iB,EAAM+iB,aAAa9E,SAAW5iB,KAAKujB,gBAAiB,OAAO,EAC/D,GAAI5e,EAAM+iB,aAAa9E,SAAW5iB,KAAKsjB,gBAAiB,OAAO,EAGnE,8EAAqB3e,K,4BAMzB,SAAeub,GACXlgB,KAAKsU,SAAW,IAAI0L,GACpBhgB,KAAKsU,SAASqJ,aAAauC,GAC3BlgB,KAAKsgB,yB,4BAMT,SAAe+K,GACXA,EAASxF,QAAQ7lB,KAAKwY,SAAS/K,c,qBAGnC,WACIzN,KAAKsU,SAASC,UACdvU,KAAKwY,SAASjE,c,GArIOgN,ICnIhBoL,GAAb,0DAKI,WAAYvJ,GAAU,qCAClB,cAAMA,GACNzmB,OAAO8B,eAAP9B,OAAA,QAAAA,CAAA,GAA4B,eAAgB,CAACoC,OAAO,IACpD,EAAK7C,KAAKyM,KAAO,OAEjB,EAAKzM,KAAKoG,MAAQ,KAElB,EAAKsqB,cAAgB,IAAI3I,GAAY1e,EAAc,sBAAD,OAAuB,EAAKrJ,KAAKkO,GAAjC,8BAAyD,EAAKlO,KAAKyM,KAAnE,cAClD,EAAKikB,cAAc3G,eAAiB,SAACoF,EAAUtV,EAAOqL,GAAlB,OAA6B,EAAK6E,eAAeoF,EAAUtV,EAAOqL,IAEtG,EAAKkC,gBAAkB,EACvB,EAAKC,gBAAkB1gB,OAAOunB,UAE9B,EAAKhX,iBAAkB,WAAW,WAC1B,EAAK1O,QAAQyf,YAAY,EAAKzf,QAAQyf,WAAWM,YAAY,EAAK/f,YAG1E,EAAK+R,IAAI,EAAKmW,eAjBI,EAL1B,sDAyBI,SAAevB,EAAUtV,EAAOqL,GACxBphB,KAAKujB,kBAAoB1gB,OAAOunB,WAAapqB,KAAKsjB,iBAAmB,EACrEtjB,KAAK0E,QAAQtB,MAAMwX,aAAU3C,EAE7BjY,KAAK0E,QAAQtB,MAAMwX,QAAUuI,GAAO0J,yBAAyB7sB,KAAK8B,SAAUsf,EAAQphB,KAAKsjB,gBAAiBtjB,KAAKujB,iBAAiBpf,aA7B5I,gBAoCI,WACI,OAAOnE,KAAK0E,QAAQiB,WArC5B,IA2CI,SAASH,GACLxF,KAAK0E,QAAQiB,UAAYH,IA5CjC,kBAkDI,WACI,OAAOxF,KAAK4sB,cAActI,SAnDlC,mBAyDI,WACI,OAAOtkB,KAAK4sB,cAAcloB,QAAQooB,qBAAqB,OAAO,KA1DtE,4BAuEI,SAAezJ,GAGX,IAAIoE,EAAMpE,EAAWvhB,UAAY,GACjC9B,KAAK8B,SAASgmB,KAAKL,EAAI1lB,GAAK,GAC5B/B,KAAK8B,SAASimB,KAAKN,EAAIvlB,GAAK,GAC5BlC,KAAK8B,SAASkmB,KAAKP,EAAItlB,GAAK,GAG5BnC,KAAK9D,KAAKoG,MAAQ+gB,EAAW/gB,OAAS,KAGtC,IAAIyqB,EAAO1J,EAAWiB,QAAU,GAChCtkB,KAAKskB,OAAOwD,KAAKiF,EAAKhrB,GAAK,GAC3B/B,KAAKskB,OAAOyD,KAAKgF,EAAK7qB,GAAK,GAGvBlC,KAAK0E,QAAQiB,YAAc0d,EAAW7d,OACtCxF,KAAK0E,QAAQiB,UAAY0d,EAAW7d,MAIxCxF,KAAKsjB,gBAAkBD,EAAW4G,aAAe,EACjDjqB,KAAKujB,qBAA6CtL,IAA3BoL,EAAW8G,YAA4B9G,EAAW8G,YAActnB,OAAOunB,YA9FtG,qBAkGI,WACI,wEAEIpqB,KAAK0E,QAAQyf,YAAYnkB,KAAK0E,QAAQyf,WAAWM,YAAYzkB,KAAK0E,aArG9E,GAAgCye,ICFnB6J,GAAb,0DAKI,WAAY5J,GAAU,qCAClB,cAAMA,GACNzmB,OAAO8B,eAAP9B,OAAA,QAAAA,CAAA,GAA4B,cAAe,CAACoC,OAAO,IACnD,EAAK7C,KAAKyM,KAAO,MAEjB,EAAKnD,KAAL,qCAA0C,EAAKtJ,KAAKkO,GAApD,wHAEA,EAAK6iB,YAAc,EAAKvoB,QAAQooB,qBAAqB,OAAOI,KAAK,GACjE,EAAKC,aAAe,EAAKzoB,QAAQooB,qBAAqB,OAAOI,KAAK,GAElE,EAAKE,UAAY,KAVC,EAL1B,+CAkBI,SAAQzoB,GAAO,WACX,GAAIA,EAAMzI,KAAK0oB,UAAW,OAAO,EAEjC,GAAI5kB,KAAKqtB,YAAcrtB,KAAK9D,KAAKoG,MAAO,OAAO,EAC/CtC,KAAKqtB,WAAY,EAEjB,IAAIC,EAAe,SAAfA,EAAe1a,GACXA,EAAIyV,eAAeC,SAAS,EAAK5jB,WAErC,EAAK2oB,WAAY,EAEjBztB,OAAO2T,oBAAoB,YAAa+Z,GACxC1tB,OAAO2T,oBAAoB,aAAc+Z,GACzC1tB,OAAO2T,oBAAoB,UAAW+Z,GACtC1tB,OAAO2T,oBAAoB,aAAc+Z,KAU7C,OAPAhX,YAAW,WACP1W,OAAOwT,iBAAiB,YAAaka,GACrC1tB,OAAOwT,iBAAiB,aAAcka,GACtC1tB,OAAOwT,iBAAiB,UAAWka,GACnC1tB,OAAOwT,iBAAiB,aAAcka,KACvC,IAEI,IA1Cf,qBAqDI,WACI,OAAOttB,KAAK0E,QAAQ6oB,UAAUC,SAAS,wBAtD/C,IA6CI,SAAcH,GACNA,EACArtB,KAAK0E,QAAQ6oB,UAAU9W,IAAI,uBAE3BzW,KAAK0E,QAAQ6oB,UAAUxW,OAAO,yBAjD1C,4BAoEI,SAAesM,GAGX,IAAIoE,EAAMpE,EAAWvhB,UAAY,GACjC9B,KAAK8B,SAASgmB,KAAKL,EAAI1lB,GAAK,GAC5B/B,KAAK8B,SAASimB,KAAKN,EAAIvlB,GAAK,GAC5BlC,KAAK8B,SAASkmB,KAAKP,EAAItlB,GAAK,GAG5B,IAAI4qB,EAAO1J,EAAWiB,QAAUjB,EAAWoK,YAAc,GACzDztB,KAAKitB,YAAY7pB,MAAMkjB,UAAvB,qBAAiDyG,EAAKhrB,EAAtD,gBAA+DgrB,EAAK7qB,EAApE,OAMIlC,KAAK9D,KAAKoG,QAAU+gB,EAAW/gB,QAC/BtC,KAAK9D,KAAKoG,MAAQ+gB,EAAW/gB,OAAS,GACtCtC,KAAKmtB,aAAaxnB,UAAY3F,KAAK9D,KAAKoG,OAAS,IAIjDtC,KAAKotB,YAAc/J,EAAWqK,OAC9B1tB,KAAKitB,YAAYppB,IAAMwf,EAAWqK,MAAQ,iBAC1C1tB,KAAKotB,UAAY/J,EAAWqK,MAIhC1tB,KAAKsjB,gBAAkBD,EAAW4G,aAAe,EACjDjqB,KAAKujB,qBAA6CtL,IAA3BoL,EAAW8G,YAA4B9G,EAAW8G,YAActnB,OAAOunB,cAjGtG,GAA+BuC,ICKlBgB,GAAb,WAQI,WAAYC,EAAaC,GAAwB,IAAfxa,EAAe,uDAAN,KAAM,wBAC7C1W,OAAO8B,eAAeuB,KAAM,kBAAmB,CAACjB,OAAO,IAEvDiB,KAAK4tB,YAAcA,EACnB5tB,KAAK6tB,QAAUA,EACf7tB,KAAKqT,OAASA,EAGdrT,KAAKuB,WAAa,IAAI4V,IAEtBnX,KAAKsB,QAAU,IAAI6V,IAGnBnX,KAAK8tB,gBAAkB,KArB/B,6DA6BI,SAAsBC,GAAI,WAEtB,GADI/tB,KAAK8tB,iBAAiB1X,aAAapW,KAAK8tB,iBACxCC,EAAK,EAAG,CACR,IAAI1G,EAAa,SAAbA,IACA,EAAK2G,SACA3Z,MAAK,SAAA4Z,GAEE,EAAKH,gBADLG,EACuB3X,WAAW+Q,EAAY0G,GAEvBzX,WAAW+Q,EAAYrkB,KAAKoG,IAAI2kB,EAAI,UAGlE3V,OAAM,SAAA8V,GACHppB,EAAM,EAAKuO,OAAQ6a,EAAG,WACtB,EAAKJ,gBAAkBxX,WAAW+Q,EAAYrkB,KAAKoG,IAAI2kB,EAAI,WAIvE/tB,KAAK8tB,gBAAkBxX,WAAW+Q,EAAY0G,MA/C1D,oBAuDI,WAAS,WACL,OAAO/tB,KAAKmuB,iBACP9Z,MAAK,SAAA+Z,GAAc,OAAI,EAAKC,eAAeD,QAzDxD,qBA+DI,WACIpuB,KAAKsuB,sBAAsB,GAC3BtuB,KAAKuB,WAAWiW,SAAQ,SAAAhW,GAAS,OAAIA,EAAU+S,eAjEvD,mBAuEI,WAAQ,WACJvU,KAAKuB,WAAWiW,SAAQ,SAAAhW,GAAS,OAAI,EAAK+sB,gBAAgB/sB,EAAUtF,KAAKkO,SAxEjF,0BAgFI,SAAa5I,GACTxB,KAAKuuB,gBAAgB/sB,EAAUtF,KAAKkO,IAEpCpK,KAAKuB,WAAW4I,IAAI3I,EAAUtF,KAAKkO,GAAI5I,GACvCxB,KAAK4tB,YAAYnX,IAAIjV,KApF7B,6BA4FI,SAAgBgtB,GACZ,IAAIhtB,EAAYxB,KAAKuB,WAAW5C,IAAI6vB,GAEhChtB,IACAxB,KAAK4tB,YAAY7W,OAAOvV,GACxBxB,KAAKuB,WAAWqW,OAAO4W,GACvBhtB,EAAU+S,aAlGtB,uBA4GI,SAAU/S,EAAW0L,GACjBlN,KAAKyuB,aAAavhB,EAAOhR,KAAKkO,IAE9BpK,KAAKsB,QAAQ6I,IAAI+C,EAAOhR,KAAKkO,GAAI8C,GACjC1L,EAAUiV,IAAIvJ,KAhHtB,0BAwHI,SAAakW,GACT,IAAIlW,EAASlN,KAAKsB,QAAQ3C,IAAIykB,GAE1BlW,IACIA,EAAOgX,QAAQhX,EAAOgX,OAAOnN,OAAO7J,GACxClN,KAAKsB,QAAQsW,OAAOwL,GACpBlW,EAAOqH,aA9HnB,4BAuII,SAAe8O,GACX,OAAO,IAxIf,4BAgJI,WAAiB,WACb,OAAO,IAAIpP,SAAQ,SAAC8E,EAAS7E,GACzB,IAAIwa,EAAS,IAAI/U,OACjB+U,EAAO9U,gBAAgB,QACvB8U,EAAOta,KAAK,EAAKyZ,QAAU,IAAMvpB,KAC7B,SAAA8pB,GACSA,EACArV,EAAQqV,GADQla,EAAO,oBAAD,OAAqB,EAAK2Z,QAA1B,UAG/B,eACA,kBAAM3Z,EAAO,mBAAD,OAAoB,EAAK2Z,QAAzB,iBA1J5B,KCMac,GAAb,0DASI,WAAYf,EAAaC,EAAS9b,GAAsB,MAAfsB,EAAe,uDAAN,KAAM,+BACpD,cAAMua,EAAaC,EAASxa,GAC5B1W,OAAO8B,eAAP9B,OAAA,QAAAA,CAAA,GAA4B,sBAAuB,CAACoC,OAAO,IAE3D,EAAKgT,MAAQA,EAJuC,EAT5D,sDAgBI,SAAesR,GAAY,WACvB,IAAKza,MAAMC,QAAQwa,EAAW9hB,YAAa,OAAO,EAClD,IAAIqtB,EAAoB,IAAIC,IAmB5B,OAhBAxL,EAAW9hB,WAAWiW,SAAQ,SAAAsX,GAC1B,IACI,IAAIttB,EAAY,EAAKutB,wBAAwBD,GAC7CF,EAAkBnY,IAAIjV,GACxB,MAAOwtB,GACLlqB,EAAM,EAAKuO,OAAQ2b,EAAK,YAKhChvB,KAAKuB,WAAWiW,SAAQ,SAAChW,EAAWgtB,GAC3BI,EAAkBK,IAAIztB,IACvB,EAAK+sB,gBAAgBC,OAItB,IArCf,qCA+CI,SAAwBM,GAAe,WACnC,IAAKA,EAAc1kB,GAAI,MAAM,IAAIkiB,MAAM,6BACvC,IAAI9qB,EAAYxB,KAAKuB,WAAW5C,IAAImwB,EAAc1kB,IAG7C5I,IACDA,EAAY,IAAIsY,GAAUgV,EAAc1kB,IACxCpK,KAAKkvB,aAAa1tB,GAEdstB,EAAc/U,cACdvY,EAAUiP,SAAU,IAK5BjP,EAAUtF,KAAKoG,MAAQwsB,EAAcxsB,OAASwsB,EAAc1kB,GAC5D5I,EAAUtF,KAAKkV,aAAe0d,EAAc1d,WAC5C5P,EAAUtF,KAAK6d,cAAgB+U,EAAc/U,YAG7C,IAAIoV,EAAiB,IAAIN,IAuBzB,OArBIjmB,MAAMC,QAAQimB,EAAc5hB,SAC5B4hB,EAAc5hB,OAAOsK,SAAQ,SAAA6L,GACzB,IAAIA,EAAWxY,KAAOwY,EAAWxY,MAAQ,EAAKkH,MAE9C,IACI,IAAI7E,EAAS,EAAKkiB,qBAAqB5tB,EAAW6hB,GAClD8L,EAAe1Y,IAAIvJ,GACrB,MAAO8hB,GACLlqB,EAAM,EAAKuO,OAAQ2b,EAAK,QACxB9pB,QAAQI,MAAM0pB,OAM1BxtB,EAAU2Y,SAAS3C,SAAQ,SAACtK,GACpBA,EAAO+M,WAAakV,EAAeF,IAAI/hB,IACvC,EAAKuhB,aAAavhB,EAAOhR,KAAKkO,OAI/B5I,IA1Ff,kCAqGI,SAAqBA,EAAW6hB,GAC5B,IAAKA,EAAWjZ,GAAI,MAAM,IAAIkiB,MAAM,0BACpC,IAAKjJ,EAAW1a,KAAM,MAAM,IAAI2jB,MAAM,4BACtC,IAAIpf,EAASlN,KAAKsB,QAAQ3C,IAAI0kB,EAAWjZ,IAGzC,IAAK8C,GAAUA,EAAOhR,KAAKyM,OAAS0a,EAAW1a,KAAM,CACjD,OAAQ0a,EAAW1a,MACf,IAAK,QAAUuE,EAAS,IAAIub,GAAYpF,EAAWjZ,IAAK,MACxD,IAAK,UAAY8C,EAAS,IAAIse,GAAcnI,EAAWjZ,IAAK,MAC5D,IAAK,OAAS8C,EAAS,IAAIkf,GAAW/I,EAAWjZ,IAAK,MACtD,IAAK,OAAS8C,EAAS,IAAIyf,GAAWtJ,EAAWjZ,IAAK,MACtD,IAAK,MAAQ8C,EAAS,IAAI8f,GAAU3J,EAAWjZ,IAAK,MACpD,QAAU,MAAM,IAAIkiB,MAAJ,gCAAmCjJ,EAAW1a,KAA9C,MAGpB3I,KAAKqvB,UAAU7tB,EAAW0L,GAS9B,OALIA,EAAOgX,SAAW1iB,GAAWA,EAAUiV,IAAIvJ,GAG/CA,EAAOmhB,eAAehL,GAEfnW,MA9Hf,GAAuCygB,ICT1B2B,GAAb,0DAMI,WAAYlM,EAAUzS,GAAY,qCAC9B,cAAMyS,GACNzmB,OAAO8B,eAAP9B,OAAA,QAAAA,CAAA,GAA4B,iBAAkB,CAACoC,OAAO,IACtD,EAAK7C,KAAKyM,KAAO,SAEjB,EAAKzM,KAAKyU,WAAaA,EACvB,EAAKzU,KAAKoC,KAAOqS,EAEjB,EAAKzU,KAAKqzB,MAAQ,IAElB,EAAK3C,cAAgB,IAAI3I,GAAY1e,EAAc,wBAAD,OACrC,EAAKrJ,KAAKkO,GAD2B,8BACH,EAAKlO,KAAKyM,KADP,gDAEvB,EAAKzM,KAAKyU,WAFa,yGAMlD,EAAKic,cAAc3G,eAAiB,SAACoF,EAAUtV,EAAOqL,GAAlB,OAA6B,EAAK6E,eAAeoF,EAAUtV,EAAOqL,IAEtG,EAAKoO,kBAAoB,EAAK9qB,QAAQooB,qBAAqB,OAAO,GAClE,EAAK2C,kBAAoB,EAAK/qB,QAAQooB,qBAAqB,OAAO,GAElE,EAAK1Z,iBAAkB,WAAW,WAC1B,EAAK1O,QAAQyf,YAAY,EAAKzf,QAAQyf,WAAWM,YAAY,EAAK/f,YAG1E,EAAK8qB,kBAAkBpc,iBAAiB,SAAS,WAC7C,EAAKoc,kBAAkB3rB,IAAM,qBAC9B,CAAC6rB,MAAM,IAEV,EAAKjZ,IAAI,EAAKmW,eA7BgB,EANtC,6CAyCI,WACI,OAAO5sB,KAAK4sB,cAAcloB,QAAQooB,qBAAqB,OAAO,KA1CtE,4BA6CI,SAAezB,EAAUtV,EAAOqL,GAC5B,IAAIwB,EAAWO,GAAOK,+BAA+BxjB,KAAK8B,SAAUsf,GAEhEriB,EAAQ,OACR6jB,EAAW,MACX7jB,EAAQ,OAER6jB,EAAW,MACX7jB,EAAQ,OAGZiB,KAAK0E,QAAQ6K,aAAa,gBAAiBxQ,KAxDnD,4BAwEI,SAAeskB,GAAY,WAGnBoE,EAAMpE,EAAWvhB,UAAY,GACjC,GAAK9B,KAAK8B,SAASC,GAAM/B,KAAK8B,SAASI,GAAMlC,KAAK8B,SAASK,EAMpD,CACH,IAAIwtB,EAAW,CACX5tB,EAAG/B,KAAK8B,SAASC,EACjBG,EAAGlC,KAAK8B,SAASI,EACjBC,EAAGnC,KAAK8B,SAASK,GAEjBytB,EAAW,CACX7tB,GAAI0lB,EAAI1lB,GAAK,GAAK4tB,EAAS5tB,EAC3BG,GAAKulB,EAAIvlB,GAAK,GAAK,IAAOytB,EAASztB,EACnCC,GAAIslB,EAAItlB,GAAK,GAAKwtB,EAASxtB,IAE3BytB,EAAS7tB,GAAK6tB,EAAS1tB,GAAK0tB,EAASztB,IACrC4D,GAAQ,SAAAU,GACJ,IAAIopB,EAAO9oB,EAAgBO,eAAeb,GAC1C,EAAK3E,SAASqI,IACVwlB,EAAS5tB,EAAI6tB,EAAS7tB,EAAI8tB,GAAQ,EAClCF,EAASztB,EAAI0tB,EAAS1tB,EAAI2tB,GAAQ,EAClCF,EAASxtB,EAAIytB,EAASztB,EAAI0tB,GAAQ,KAEvC,UAxBP7vB,KAAK8B,SAASqI,IACVsd,EAAI1lB,GAAK,EACT0lB,EAAIvlB,GAAK,EACTulB,EAAItlB,GAAK,GA0BjB,IAAI7D,EAAO+kB,EAAW/kB,MAAQ0B,KAAK9D,KAAKyU,WACxC3Q,KAAK9D,KAAKoC,KAAOA,EACb0B,KAAKyvB,kBAAkB9pB,YAAcrH,IACrC0B,KAAKyvB,kBAAkB9pB,UAAYrH,GAGvC0B,KAAK9D,KAAKqzB,MAAQlM,EAAWkM,OAAS,MAhH9C,qBAoHI,WACI,wEAEA,IAAI7qB,EAAU1E,KAAK4sB,cAAcloB,QAC7BA,EAAQyf,YAAYzf,EAAQyf,WAAWM,YAAY/f,OAxH/D,GAAkCye,ICCrB2M,GAAb,0DASI,WAAYlC,EAAamC,EAAeC,GAAwB,MAAf3c,EAAe,uDAAN,KAAM,+BAC5D,cAAMua,EAAamC,EAAe1c,GAClC1W,OAAO8B,eAAP9B,OAAA,QAAAA,CAAA,GAA4B,wBAAyB,CAACoC,OAAO,IAE7D,EAAKixB,QAAUA,EAEf,EAAKC,qBANuD,EATpE,sDAqBI,SAAe5M,GAAY,WAEvB,IAAKza,MAAMC,QAAQwa,EAAWhV,SAE1B,OADArO,KAAK6X,SACE,EAIX,IAAIqY,EAAuB,IAAIrB,IAmB/B,OAhBAxL,EAAWhV,QAAQmJ,SAAQ,SAAA2Y,GACvB,IACI,IAAIC,EAAe,EAAKC,2BAA2BF,GACnDD,EAAqBzZ,IAAI2Z,GAC3B,MAAOpB,GACLlqB,EAAM,EAAKuO,OAAQ2b,EAAK,YAKhChvB,KAAKsB,QAAQkW,SAAQ,SAAC4Y,EAAchN,GAC3B8M,EAAqBjB,IAAImB,IAC1B,EAAK3B,aAAarL,OAInB,IAhDf,wCAwDI,SAA2BC,GACvB,IAAI1S,EAAa0S,EAAWiN,KAC5B,IAAK3f,EAAY,MAAM,IAAI2b,MAAM,4BACjC,IAAIlJ,EAAW,aAAezS,EAG1BzD,EAASlN,KAAKsB,QAAQ3C,IAAIykB,GAE1B5hB,EAAYxB,KAAKiwB,qBAiBrB,OAdK/iB,GAAWA,EAAOqjB,iBACnBrjB,EAAS,IAAIoiB,GAAalM,EAAUzS,GACpC3Q,KAAKqvB,UAAU7tB,EAAW0L,IAI1BA,EAAOgX,SAAW1iB,GAAWA,EAAUiV,IAAIvJ,GAG/CA,EAAOmhB,eAAehL,GAGtBnW,EAAOuD,QAAU4S,EAAWkM,QAAUvvB,KAAKgwB,QAEpC9iB,IAjFf,gCAwFI,WACI,IAAIzL,EAAkBzB,KAAKuB,WAAW5C,IAAI,cAQ1C,OANK8C,IACDA,EAAkB,IAAIqY,GAAU,cAChCrY,EAAgBvF,KAAKoG,MAAQ,UAC7BtC,KAAKkvB,aAAaztB,IAGfA,MAjGf,GAAyCksB,ICM5BxW,GAAb,WASC,WAAY/M,EAAIomB,EAASC,EAAaC,GAA4B,WAAfrd,EAAe,uDAAN,KAAM,2DAiHrD,SAAAsF,GAAK,OAAI,SAAAnC,GACrB/R,EAAc,EAAK4O,OAAQ,uBAAwB,CAClDmD,KAAMA,EACNmC,MAAOA,QApHyD,qCAwHnD,SAAAA,GAAK,OAAI,SAAAnC,GACvB/R,EAAc,EAAK4O,OAAQ,yBAA0B,CACpDmD,KAAMA,EACNmC,MAAOA,QA1HRhc,OAAO8B,eAAgBuB,KAAM,QAAS,CAAEjB,OAAO,IAE/CiB,KAAKqT,OAASA,EAEdrT,KAAK9D,KAAO,CACXkO,GAAIA,EACJomB,QAASA,EACTC,YAAaA,EACbC,YAAaA,EACbpyB,KAAM8L,EACNmlB,MAAO,IACPI,SAAU,CAAC5tB,EAAG,EAAGI,EAAG,GACpB0P,SAAU,IAAI8Y,OACdpf,aAAc,EACdolB,MAAO,CACNrX,SAAU,CAACvX,EAAG,GAAII,EAAG,IACrBqX,MAAO,CAACzX,EAAG,EAAGI,EAAG,GACjBoX,UAAW,CAACxX,EAAG,EAAGI,EAAG,IAEtByuB,OAAQ,CACPtX,SAAU,CAACvX,EAAG,GAAII,EAAG,IACrBqX,MAAO,CAACzX,EAAG,EAAGI,EAAG,GACjBoX,UAAW,CAACxX,EAAG,EAAGI,EAAG,KAIvBnC,KAAKkhB,UAAY,IAAI2P,OAGrB7wB,KAAK8wB,cAAgB,KAErB9wB,KAAK+wB,eAAiB,KAEtB/wB,KAAKgxB,eAAiB,GAGtBhxB,KAAKixB,iBAAmB,KAExBjxB,KAAKkxB,kBAAoB,KAhD3B,4CA6DC,SAAKC,EAAmBC,EAAqBC,EAAoBC,EAAsBjmB,GAA6B,WAAnBqN,EAAmB,uDAAH,EAChH1Y,KAAKmU,SAEL,IAAIod,EAAkBvxB,KAAKwxB,eACvBC,EAAqBzxB,KAAK0xB,mBAI9B,OAFA1xB,KAAK+wB,eAAiB/wB,KAAK2xB,qBAAqBN,EAAoBC,EAAsBjmB,GAEnF4I,QAAQ2d,IAAI,CAACL,EAAiBE,IAC1Bpd,MAAK,SAAAwd,GACF,IAAIC,EAAWD,EAAO,GACtB,GAAiB,OAAbC,EAAmB,MAAM,IAAIxF,MAAM,kCAEvC,EAAKwE,cAAgB,EAAKiB,oBAAoBZ,EAAmBC,EAAqB/lB,EAAUymB,GAEhG,EAAKb,iBAAmB,IAAInb,GAAY,IAAIuE,OAAS,IAAI/B,GAAJ,UAAkB,EAAKpc,KAAKs0B,QAA5B,UAA6C,EAAKM,cAAe,EAAK50B,KAAKy0B,MAAOjY,GAAgB,EAAK1C,WAAW,SAAU,EAAKC,aAAa,SAAU,EAAK5C,QAClN,EAAK6d,kBAAoB,IAAIpb,GAAY,IAAIuE,OAAS,IAAI/B,GAAJ,UAAkB,EAAKpc,KAAKs0B,QAA5B,WAA8C,EAAKO,eAAgB,EAAK70B,KAAK00B,OAAQlY,GAAgB,EAAK1C,WAAW,UAAW,EAAKC,aAAa,UAAW,EAAK5C,QAExN,EAAK4d,iBAAiBlb,MAAMsR,YAAa,EACzC,EAAK6J,kBAAkBnb,MAAMsR,YAAa,EAE1CviB,EAAM,EAAKuO,OAAN,eAAsB,EAAKnX,KAAKkO,GAAhC,gBAAkD,aAlFvE,0BA0FC,WAAe,WACd,OAAOpK,KAAKgyB,mBACV3d,MAAK,SAAA4d,GACL,EAAK/1B,KAAKoC,KAAO2zB,EAAc3zB,KAAO2zB,EAAc3zB,KAAO,EAAKpC,KAAKoC,KACrE,EAAKpC,KAAKqzB,MAAQ0C,EAAc1C,MAAQ0C,EAAc1C,MAAQ,EAAKrzB,KAAKqzB,MAExE,EAAKrzB,KAAKyzB,SAAV,mCAAyB,EAAKzzB,KAAKyzB,UAAasC,EAActC,UAC9D,EAAKzzB,KAAK2V,SAASgY,YACW5R,IAA7Bga,EAAcpgB,SAASjT,EAAkBqzB,EAAcpgB,SAASjT,EAAI,EAAK1C,KAAK2V,SAASjT,OAC1DqZ,IAA7Bga,EAAcpgB,SAASC,EAAkBmgB,EAAcpgB,SAASC,EAAI,EAAK5V,KAAK2V,SAASC,OAC1DmG,IAA7Bga,EAAcpgB,SAASN,EAAkB0gB,EAAcpgB,SAASN,EAAI,EAAKrV,KAAK2V,SAASN,GAExF,EAAKrV,KAAKqP,aAAe0mB,EAAc1mB,aAAe0mB,EAAc1mB,aAAe,EAAKrP,KAAKqP,kBAEjE0M,IAAxBga,EAActB,QAAqBsB,EAActB,MAAQ,SAChC1Y,IAAzBga,EAAcrB,SAAsBqB,EAAcrB,OAAS,IAE/D,EAAK10B,KAAKy0B,MAAQ,CACjBrX,SAAU,mCAAI,EAAKpd,KAAKy0B,MAAMrX,UAAa2Y,EAActB,MAAMrX,UAC/DE,MAAO,mCAAI,EAAKtd,KAAKy0B,MAAMnX,OAAUyY,EAActB,MAAMnX,OACzDD,UAAW,mCAAI,EAAKrd,KAAKy0B,MAAMpX,WAAc0Y,EAActB,MAAMpX,YAElE,EAAKrd,KAAK00B,OAAS,CAClBtX,SAAU,mCAAI,EAAKpd,KAAK00B,OAAOtX,UAAa2Y,EAAcrB,OAAOtX,UACjEE,MAAO,mCAAI,EAAKtd,KAAK00B,OAAOpX,OAAUyY,EAAcrB,OAAOpX,OAC3DD,UAAW,mCAAI,EAAKrd,KAAK00B,OAAOrX,WAAc0Y,EAAcrB,OAAOrX,YAGpEzU,EAAM,EAAKuO,OAAN,4BAAmC,EAAKnX,KAAKkO,GAA7C,aAA4D,aAtHrE,yBA8IC,SAAYrI,EAAGI,EAAG+vB,EAAmBC,GACpC,GAAKnyB,KAAKoyB,SAAV,CAEA,IAAIC,EAASrvB,KAAKC,OAAOlB,EAAI/B,KAAK9D,KAAKy0B,MAAMpX,UAAUxX,GAAK/B,KAAK9D,KAAKy0B,MAAMrX,SAASvX,GACjFuwB,EAAStvB,KAAKC,OAAOd,EAAInC,KAAK9D,KAAKy0B,MAAMpX,UAAUpX,GAAKnC,KAAK9D,KAAKy0B,MAAMrX,SAASnX,GACjFowB,EAAavvB,KAAKC,MAAMivB,EAAoBlyB,KAAK9D,KAAKy0B,MAAMrX,SAASvX,GACrEywB,EAAaxvB,KAAKC,MAAMivB,EAAoBlyB,KAAK9D,KAAKy0B,MAAMrX,SAASnX,GAErEswB,EAAUzvB,KAAKC,OAAOlB,EAAI/B,KAAK9D,KAAK00B,OAAOrX,UAAUxX,GAAK/B,KAAK9D,KAAK00B,OAAOtX,SAASvX,GACpF2wB,EAAU1vB,KAAKC,OAAOd,EAAInC,KAAK9D,KAAK00B,OAAOrX,UAAUpX,GAAKnC,KAAK9D,KAAK00B,OAAOtX,SAASnX,GACpFwwB,EAAc3vB,KAAKC,MAAMkvB,EAAqBnyB,KAAK9D,KAAK00B,OAAOtX,SAASvX,GACxE6wB,EAAc5vB,KAAKC,MAAMkvB,EAAqBnyB,KAAK9D,KAAK00B,OAAOtX,SAASnX,GAE5EnC,KAAKixB,iBAAiB4B,eAAeR,EAAQC,EAAQC,EAAYC,GACjExyB,KAAKkxB,kBAAkB2B,eAAeJ,EAASC,EAASC,EAAaC,MA5JvE,8BAmKI,WAAmB,WACf,OAAO,IAAI3e,SAAQ,SAAC8E,EAAS7E,GACzBpP,EAAM,EAAKuO,OAAN,oCAA2C,EAAKnX,KAAKkO,GAArD,QAA+D,QAEpE,IAAIskB,EAAS,IAAI/U,OACjB+U,EAAO9U,gBAAgB,QACvB8U,EAAOta,KAAK,EAAKlY,KAAKu0B,YAAc,IAAMnsB,KACtC,SAAA+I,GACQA,EAASjM,MAAQiM,EAASjM,KAAK,EAAKlF,KAAKkO,IACzC2O,EAAQ1L,EAASjM,KAAK,EAAKlF,KAAKkO,KAEhC8J,EAAO,2DAAD,OAA4D,EAAKhY,KAAKkO,QAGpF,eACA,kBAAM8J,EAAO,6CAAD,OAA8C,EAAKhY,KAAKkO,aAlLpF,8BA2LC,WAAmB,WAClB,OAAO,IAAI6J,SAAQ,SAAC8E,EAAS7E,GAC5BpP,EAAM,EAAKuO,OAAN,oCAA2C,EAAKnX,KAAKkO,GAArD,QAA+D,QAEpE,IAAIskB,EAAS,IAAI/U,OACjB+U,EAAO9U,gBAAgB,QACvB8U,EAAOta,KAAK,EAAKlY,KAAKw0B,YAAc,IAAMpsB,IACzCyU,GACA,eACA,kBAAM7E,EAAO,6CAAD,OAA8C,EAAKhY,KAAKkO,aApMxE,iCAiNC,SAAoB8Q,EAAcC,EAAgB9P,EAAUymB,GAAU,WACjEgB,EAAY,GAChB,IAAKlqB,MAAMC,QAAQipB,EAASA,UAAW,MAAM,IAAIxF,MAAM,qDACvD,IAHqE,eAG5D9vB,GACR,IAAIu2B,EAAkBjB,EAASA,SAASt1B,GAEpCoV,EAAQmhB,EAAgBnhB,QACvBhJ,MAAMC,QAAQ+I,IAAUA,EAAMlV,OAAS,KAC3CkV,EAAQ,CAAC,EAAG,EAAG,EAAG,IAGnB,IAAIohB,EAAsB,IAAbphB,EAAM,GACf6Y,IAAgBsI,EAAgBtI,YAEhCxV,EAAU,IAAIC,OAClBD,EAAQvR,MAAQH,EAAcwvB,EAAgB9d,SAE9CA,EAAQge,WAAa,EACrBhe,EAAQE,gBAAkB6d,GAAUvI,EACpCxV,EAAQG,UAAY8d,OACpBje,EAAQK,UAAYL,EAAQE,gBAAkBge,OAA4BD,OAC1Eje,EAAQM,MAAQC,OAChBP,EAAQQ,MAAQD,OAChBP,EAAQS,OAAQ,EAChBT,EAAQme,aAAc,EACtBne,EAAQvR,MAAM0P,iBAAiB,QAAQ,kBAAM6B,EAAQU,aAAc,KAEnE,EAAKqb,eAAeh0B,KAAKiY,GAEzB,IAAIuD,EAAW,IAAI8C,OAAe,CACjCjQ,SAAU,mCACNA,GADI,IAEPgoB,aAAc,CACb1qB,KAAM,IACN5J,MAAOkW,GAERwV,YAAa,CAAE1rB,MAAO0rB,KAEvBvP,aAAcA,EACdC,eAAgBA,EAChBsP,YAAaA,EACb6I,YAAY,EACZ7J,WAAW,EACXyB,aAAcqI,OACdhJ,KAAMiJ,OACNC,WAAW,IAGZjb,EAAS7C,aAAc,EACvBmd,EAAUt2B,GAAKgc,GA9CPhc,EAAI,EAAGA,EAAIs1B,EAASA,SAASp1B,OAAQF,IAAK,EAA1CA,GAiDT,OAAOs2B,IArQT,kCA+QC,SAAqB5X,EAAcC,EAAgB9P,GAClD,OAAO,IAAIiQ,OAAe,CACzBjQ,SAAUA,EACV6P,aAAcA,EACdC,eAAgBA,EAChBsP,aAAa,EACb6I,YAAY,EACZ7J,WAAW,EACXyB,aAAcqI,OACdhJ,KAAMiJ,OACNC,WAAW,MAzRd,oBA6RC,WACKzzB,KAAKixB,kBAAkBjxB,KAAKixB,iBAAiB9c,SACjDnU,KAAKixB,iBAAmB,KAEpBjxB,KAAKkxB,mBAAmBlxB,KAAKkxB,kBAAkB/c,SACnDnU,KAAKkxB,kBAAoB,KAErBlxB,KAAK8wB,eAAe9wB,KAAK8wB,cAActZ,SAAQ,SAAAgB,GAAQ,OAAIA,EAASjE,aACxEvU,KAAK8wB,cAAgB,KAEjB9wB,KAAK+wB,gBAAgB/wB,KAAK+wB,eAAexc,UAC7CvU,KAAK+wB,eAAiB,KAEtB/wB,KAAKgxB,eAAexZ,SAAQ,SAAAvC,GAAO,OAAIA,EAAQV,aAC/CvU,KAAKgxB,eAAiB,KA3SxB,6BAoTC,SAAgBjvB,EAAGI,GAClB,IAAKnC,KAAKoyB,SAAU,OAAO,EAE3BpyB,KAAKkhB,UAAU/W,IACd,IAAI3G,OAAQzB,EAAG,IAAKI,GACpB,IAAIqB,OAAQ,GAAI,EAAG,IAEpBxD,KAAKkhB,UAAUwS,KAAO,EACtB1zB,KAAKkhB,UAAUyS,IAAM,IACrB3zB,KAAKkhB,UAAU7H,OAAOua,YAEtB,IAAIC,EAAgBxvB,EAASrB,KAAKC,OAAOlB,EAAI/B,KAAK9D,KAAKy0B,MAAMpX,UAAUxX,GAAK/B,KAAK9D,KAAKy0B,MAAMrX,SAASvX,GAAIiB,KAAKC,OAAOd,EAAInC,KAAK9D,KAAKy0B,MAAMpX,UAAUpX,GAAKnC,KAAK9D,KAAKy0B,MAAMrX,SAASnX,IAC7KqU,EAAOxW,KAAKixB,iBAAiB/Z,MAAMvY,IAAIk1B,GAC3C,IAAKrd,IAASA,EAAK3C,MAAO,CACzB,IAAIigB,EAAiBzvB,EAASrB,KAAKC,OAAOlB,EAAI/B,KAAK9D,KAAK00B,OAAOrX,UAAUxX,GAAK/B,KAAK9D,KAAK00B,OAAOtX,SAASvX,GAAIiB,KAAKC,OAAOd,EAAInC,KAAK9D,KAAK00B,OAAOrX,UAAUpX,GAAKnC,KAAK9D,KAAK00B,OAAOtX,SAASnX,IACtLqU,EAAOxW,KAAKkxB,kBAAkBha,MAAMvY,IAAIm1B,GAGzC,IAAKtd,IAASA,EAAK3C,MAClB,OAAO,EAGR,IACC,IAAIsN,EAAanhB,KAAKkhB,UAAU6S,iBAAiB,CAACvd,EAAK3C,QACvD,GAAIsN,EAAWzkB,OAAS,EACvB,OAAOykB,EAAW,GAAGuB,MAAMxgB,EAE3B,MAAO8sB,GACR,OAAO,KAhVV,qBAoVC,WACChvB,KAAKmU,WArVP,oBA2VC,WACC,SAAUnU,KAAK8wB,gBAAiB9wB,KAAK+wB,oBA5VvC,KCXaiD,GAAsB,ueCAtBC,GAAoB,sKCKpBC,GAAb,0DAEC,WAAY7oB,GAAU,8BACrB,eAEA,EAAKgc,YAAa,EAElB1qB,OAAO8B,eAAP9B,OAAA,QAAAA,CAAA,GAA4B,gBAAiB,CAACoC,OAAO,IAErD,IAAIuV,EAAW,IAAI6f,OAAe,EAAG,GAAI,GACrC3b,EAAW,IAAI8C,OAAe,CACjCjQ,SAAUA,EACV6P,aAAc+Y,GACd9Y,eAAgB6Y,GAChBzJ,KAAM6J,SAEHC,EAAS,IAAIjb,OAAK9E,EAAUkE,GAdX,OAgBrB,EAAK/B,IAAI4d,GAhBY,EAFvB,UAAiCha,QCApBia,GAAb,WAMC,WAAYlpB,EAAWgW,GAAQ,wBAC9BzkB,OAAO8B,eAAgBuB,KAAM,oBAAqB,CAAEjB,OAAO,IAE3DiB,KAAK9D,KAAO,CACXkP,UAAW,KACXgW,OAAQ,KACR3gB,SAAU,KACVqB,SAAU,IAAI0B,OAAQ,EAAG,EAAG,GAC5BwP,SAAU,EACVuhB,MAAO,EACPC,KAAM,GAGPx0B,KAAKoL,UAAYA,EACjBpL,KAAKohB,OAASA,EAGdphB,KAAKy0B,aAAez0B,KAAK8B,SAASyZ,QAClCvb,KAAK00B,aAAe10B,KAAKgT,SACzBhT,KAAK20B,UAAY30B,KAAKu0B,MACtBv0B,KAAK40B,aAAe50B,KAAK4iB,SACzB5iB,KAAK60B,UAAY70B,KAAK80B,MACtB90B,KAAK+0B,SAAW/0B,KAAKw0B,KAErBx0B,KAAKg1B,sBAAwBh1B,KAAK8B,SAASyZ,QAE3Cvb,KAAKi1B,iBAAmB,GAExBj1B,KAAKk1B,UAAY,KAGjBl1B,KAAK4iB,SAAW,IAChB5iB,KAAK8B,SAASqI,IAAI,EAAG,EAAG,GACxBnK,KAAKgT,SAAW,EAChBhT,KAAKu0B,MAAQ,EACbv0B,KAAKw0B,KAAO,EACZx0B,KAAK80B,MAAQ,EAEb90B,KAAKm1B,eA5CP,8CAmDC,SAAOvuB,EAAWiE,GACbjE,EAAY,KAAIA,EAAY,IAChC5G,KAAKi1B,iBAA2C,GAAxBj1B,KAAKi1B,iBAAqC,GAAZruB,EAElD5G,KAAKk1B,WAAWl1B,KAAKk1B,UAAUlH,OAAOhuB,KAAKi1B,iBAAkBpqB,GAEjE7K,KAAKm1B,iBAzDP,0BA4DC,WACC,IAAIC,EAAep1B,KAAKq1B,iBAExB,GAAID,EAAc,CACjBp1B,KAAKs1B,oBAGL,MAAOt1B,KAAKgT,UAAYhQ,KAAKgoB,GAAIhrB,KAAKgT,UAAsB,EAAVhQ,KAAKgoB,GACvD,MAAOhrB,KAAKgT,WAAahQ,KAAKgoB,GAAIhrB,KAAKgT,UAAsB,EAAVhQ,KAAKgoB,GAGxD,IAAIuK,EAAiBv1B,KAAKu0B,MACtBvxB,KAAK+U,IAAIwd,IAAmB,KAAQA,EAAiB,KAChDvyB,KAAK+U,IAAIwd,GAAkBvyB,KAAKgoB,IAAM,OAAQuK,GAAkC,MACzF,IAAIC,EAAoBx1B,KAAK4iB,SACzB5f,KAAK+U,IAAIyd,IAAsB,OAAQA,EAAoB,MAG3Dx1B,KAAK80B,MAAQ,IAChBU,EAAoB9uB,OAAU4b,KAAKkT,EAAmBxyB,KAAKoG,IAAIosB,EAAmB,KAAMxyB,KAAKyyB,IAAIz1B,KAAK80B,MAAO,KAI9G,IAAIY,EAAiB,IAAIlyB,OAAQR,KAAK+P,IAAI/S,KAAKgT,UAAW,GAAIhQ,KAAKiQ,IAAIjT,KAAKgT,WACxE2iB,EAAoB,IAAInyB,OAAQ,EAAG,EAAG,GAAGoyB,MAAMF,GAWnD,GAVAA,EAAeG,eAAeF,EAAoB3yB,KAAKgoB,GAAK,EAAKuK,GACjEG,EAAe5T,eAAe0T,GAG9Bx1B,KAAKohB,OAAOpO,SAAS7I,IAAI,EAAG,EAAG,GAC/BnK,KAAKohB,OAAOtf,SAAS8Z,KAAK5b,KAAK8B,UAAU6lB,IAAI+N,GAC7C11B,KAAKohB,OAAO0U,OAAO91B,KAAK8B,UACxB9B,KAAKohB,OAAO2U,QAAQ/1B,KAAKw0B,KAAOe,EAAiB,EAAIvyB,KAAKgoB,GAAK,GAG3DhrB,KAAK80B,OAAS,EAAG,CACpB,IAAIpB,EAAOhtB,OAAUC,MAAM6uB,EAAoB,IAAM,IAAM,GACvD7B,EAAMjtB,OAAUC,MAA0B,EAApB6uB,EAAuBxyB,KAAKoG,IAAIsqB,EAAO,EAAG,KAAO8B,EAAoB,KAC3F7B,EAAMD,EAAO,MAAOA,EAAOC,EAAM,KACrC3zB,KAAKohB,OAAOsS,KAAOA,EACnB1zB,KAAKohB,OAAOuS,IAAMA,OACO,IAAf3zB,KAAKu0B,OACfv0B,KAAKohB,OAAOsS,KAAO,EACnB1zB,KAAKohB,OAAOuS,IAAM6B,EAAoB,MAEtCx1B,KAAKohB,OAAOsS,KAAO,EACnB1zB,KAAKohB,OAAOuS,IAAM,KAInBlvB,EAAczE,KAAKoL,UAAUiI,OAAQ,qBAAsB,CAC1DtC,gBAAiB/Q,KACjBohB,OAAQphB,KAAKohB,SAKf,GAAIphB,KAAKoL,UAAUP,IAAK,CACvB,IAAImrB,EAAkB,EAClBZ,IAEFY,EADGh2B,KAAK4iB,SAAW,IAC8C,GAA/C5iB,KAAKoL,UAAUlP,KAAK2P,yBAE0B,GAA9C7L,KAAKoL,UAAUlP,KAAKyP,0BAKvC3I,KAAK+U,IAAI/X,KAAKg1B,sBAAsBjzB,EAAI/B,KAAK8B,SAASC,IAAMi0B,GAC5DhzB,KAAK+U,IAAI/X,KAAKg1B,sBAAsB7yB,EAAInC,KAAK8B,SAASK,IAAM6zB,KAE5Dh2B,KAAKg1B,sBAAwBh1B,KAAK8B,SAASyZ,QAC3Cvb,KAAKoL,UAAU6qB,YAAYj2B,KAAK8B,SAASC,EAAG/B,KAAK8B,SAASK,OApI9D,kCA8IC,SAAqB+zB,GAA2B,IAAXh6B,EAAW,uDAAJ,GAC3C8D,KAAKoL,UAAU+qB,qBAAqBD,EAAgBh6B,KA/ItD,4BAkJC,WACC,QACC8D,KAAK9D,KAAK4F,SAASs0B,OAAOp2B,KAAKy0B,eAC/Bz0B,KAAK9D,KAAK8W,WAAahT,KAAK00B,cAC5B10B,KAAK9D,KAAKq4B,QAAUv0B,KAAK20B,WACzB30B,KAAK4iB,WAAa5iB,KAAK40B,cACvB50B,KAAK80B,QAAU90B,KAAK60B,WACpB70B,KAAK9D,KAAKs4B,OAASx0B,KAAK+0B,YAzJ3B,+BA6JC,WACC/0B,KAAKy0B,aAAa7Y,KAAK5b,KAAK9D,KAAK4F,UACjC9B,KAAK00B,aAAe10B,KAAK9D,KAAK8W,SAC9BhT,KAAK20B,UAAY30B,KAAK9D,KAAKq4B,MAC3Bv0B,KAAK40B,aAAe50B,KAAK4iB,SACzB5iB,KAAK60B,UAAY70B,KAAK80B,MACtB90B,KAAK+0B,SAAW/0B,KAAK9D,KAAKs4B,OAnK5B,iBAyKC,WACC,OAAOx0B,KAAKohB,OAAO0T,OA1KrB,IAgLC,SAAUA,GACT90B,KAAKohB,OAAO0T,MAAQA,IAjLtB,oBAoLC,WACC,OAAO90B,KAAKohB,OAAOwB,UArLrB,IAwLC,SAAaA,GACZ5iB,KAAKohB,OAAOwB,SAAWA,IAzLzB,oBAmNC,WACC,OAAO5iB,KAAKk1B,WApNd,IAqMC,SAAaz0B,GACRT,KAAKk1B,WAAal1B,KAAKk1B,UAAUmB,MACpCr2B,KAAKk1B,UAAUmB,OAEhBr2B,KAAKk1B,UAAYz0B,EACbA,IAAUT,KAAK9D,KAAKuE,SAAWA,EAASvE,MAAQ,MAEhD8D,KAAKk1B,WAAal1B,KAAKk1B,UAAUhY,OACpCld,KAAKk1B,UAAUhY,MAAMld,QA7MxB,qBA0NC,WACC,OAAOA,KAAKs2B,YA3Nd,IAiOC,SAAcv3B,GACbiB,KAAKs2B,WAAav3B,EAClBiB,KAAK9D,KAAKkP,UAAYrM,EAAM7C,OAnO9B,kBAyOC,WACC,OAAO8D,KAAKu2B,SA1Od,IAgPC,SAAWx3B,GACViB,KAAKu2B,QAAUx3B,EACfiB,KAAK9D,KAAKklB,OAASriB,EAAM7C,OAlP3B,oBAwPC,WACC,OAAO8D,KAAK9D,KAAK4F,UAzPnB,IA+PC,SAAa/C,GACZiB,KAAK9D,KAAK4F,SAAW/C,IAhQvB,oBAsQC,WACC,OAAOiB,KAAK9D,KAAK8W,UAvQnB,IA6QC,SAAajU,GACZiB,KAAK9D,KAAK8W,SAAWjU,IA9QvB,iBAoRC,WACC,OAAOiB,KAAK9D,KAAKq4B,OArRnB,IA2RC,SAAUx1B,GACTiB,KAAK9D,KAAKq4B,MAAQx1B,IA5RpB,gBAkSC,WACC,OAAOiB,KAAK9D,KAAKs4B,MAnSnB,IAySC,SAASz1B,GACRiB,KAAK9D,KAAKs4B,KAAOz1B,MA1SnB,KC1BIy3B,GAAQ,SAARA,IAEA,IAAIv3B,EAAO,EAEPw3B,EAAY9yB,SAAS+B,cAAe,OAWxC,SAASgxB,EAAUC,GAGf,OADAF,EAAUpS,YAAasS,EAAMC,KACtBD,EAIX,SAASE,EAAWzsB,GAEhB,IAAM,IAAI5N,EAAI,EAAGA,EAAIi6B,EAAUtc,SAASzd,OAAQF,IAE5Ci6B,EAAUtc,SAAU3d,GAAI4G,MAAMmjB,QAAU/pB,IAAM4N,EAAK,QAAU,OAIjEnL,EAAOmL,EAIX,SAAS0sB,IACLD,GAAW,GA9BfJ,EAAUrzB,MAAM2zB,QAAU,kFAC1BN,EAAUrjB,iBAAkB,SAAS,SAAWzO,GAE5CA,EAAM6N,iBACNqkB,IAAc53B,EAAOw3B,EAAUtc,SAASzd,WAEzC,GA6BH,IAAIs6B,GAAcC,aAAenS,MAAOD,MAAOqS,EAAWF,EAAWG,EAAS,EAC1EC,EAAgBJ,EAEhBK,EAAWX,EAAU,IAAIF,EAAMc,MAAO,MAAO,OAAQ,SACrDC,EAAUb,EAAU,IAAIF,EAAMc,MAAO,cAAe,OAAQ,SAC5DE,EAAmBd,EAAU,IAAIF,EAAMc,MAAO,WAAY,OAAQ,SAElEG,EAAW,KASf,OARKC,KAAKT,aAAeS,KAAKT,YAAYU,SAEtCF,EAAWf,EAAU,IAAIF,EAAMc,MAAO,KAAM,OAAQ,UAIxDT,EAAW,GAEJ,CAEHe,SAAU,GAEVhB,IAAKH,EAELC,SAAUA,EACVG,UAAWA,EACXC,KAAMA,EAENe,MAAO,WAEHb,GAAcC,aAAenS,MAAOD,OAIxCxH,IAAK,WAED8Z,IAEA,IAAI3wB,GAASywB,aAAenS,MAAOD,MAKnC,GAHA0S,EAAQvJ,OAAQxnB,EAAOwwB,EAAW,KAClCQ,EAAiBxJ,OAAQxnB,EAAO4wB,EAAe,KAE1C5wB,GAAQ0wB,EAAW,MAEpBG,EAASrJ,OAAmB,IAATmJ,GAAoB3wB,EAAO0wB,GAAY,KAE1DA,EAAW1wB,EACX2wB,EAAS,EAEJM,GAAW,CAEZ,IAAIE,EAASV,YAAYU,OACzBF,EAASzJ,OAAQ2J,EAAOG,eAAiB,QAASH,EAAOI,gBAAkB,SAMnF,OAAOvxB,GAIXwnB,OAAQ,WAEJgJ,EAAYh3B,KAAKqd,MACjB+Z,EAAgBJ,GAMpBrR,WAAY8Q,EACZuB,QAASnB,IAMjBL,GAAMc,MAAQ,SAAWh5B,EAAM25B,EAAIC,GAE/B,IAAIlvB,EAAMmvB,IAAU/uB,EAAM,EAAG7E,EAAQvB,KAAKuB,MACtC6zB,EAAK7zB,EAAO3E,OAAOy4B,kBAAoB,GAEvCC,EAAQ,IAAMF,EAAIG,EAAS,GAAKH,EAChCI,EAAS,EAAIJ,EAAIK,EAAS,EAAIL,EAC9BM,EAAU,EAAIN,EAAIO,EAAU,GAAKP,EACjCQ,EAAc,IAAMR,EAAIS,EAAe,GAAKT,EAE5CxjB,EAASjR,SAAS+B,cAAe,UACrCkP,EAAOF,MAAQ4jB,EACf1jB,EAAOD,OAAS4jB,EAChB3jB,EAAOxR,MAAM2zB,QAAU,0BAEvB,IAAI+B,EAAUlkB,EAAOE,WAAY,MAejC,OAdAgkB,EAAQC,KAAO,QAAY,EAAIX,EAAO,gCACtCU,EAAQE,aAAe,MAEvBF,EAAQljB,UAAYsiB,EACpBY,EAAQjjB,SAAU,EAAG,EAAGyiB,EAAOC,GAE/BO,EAAQljB,UAAYqiB,EACpBa,EAAQG,SAAU36B,EAAMk6B,EAAQC,GAChCK,EAAQjjB,SAAU6iB,EAASC,EAASC,EAAaC,GAEjDC,EAAQljB,UAAYsiB,EACpBY,EAAQI,YAAc,GACtBJ,EAAQjjB,SAAU6iB,EAASC,EAASC,EAAaC,GAE1C,CAEHjC,IAAKhiB,EAELoZ,OAAQ,SAAWjvB,EAAOo6B,GAEtBnwB,EAAMhG,KAAKgG,IAAKA,EAAKjK,GACrBqK,EAAMpG,KAAKoG,IAAKA,EAAKrK,GAErB+5B,EAAQljB,UAAYsiB,EACpBY,EAAQI,YAAc,EACtBJ,EAAQjjB,SAAU,EAAG,EAAGyiB,EAAOK,GAC/BG,EAAQljB,UAAYqiB,EACpBa,EAAQG,SAAU10B,EAAOxF,GAAU,IAAMT,EAAO,KAAOiG,EAAOyE,GAAQ,IAAMzE,EAAO6E,GAAQ,IAAKovB,EAAQC,GAExGK,EAAQM,UAAWxkB,EAAQ8jB,EAAUN,EAAIO,EAASC,EAAcR,EAAIS,EAAcH,EAASC,EAASC,EAAcR,EAAIS,GAEtHC,EAAQjjB,SAAU6iB,EAAUE,EAAcR,EAAIO,EAASP,EAAIS,GAE3DC,EAAQljB,UAAYsiB,EACpBY,EAAQI,YAAc,GACtBJ,EAAQjjB,SAAU6iB,EAAUE,EAAcR,EAAIO,EAASP,EAAI7zB,GAAS,EAAMxF,EAAQo6B,GAAeN,OAQ9FrC,UCzJF6C,GAAsB,wBAAH,OAE9Bpd,OAAYC,wBAFkB,qrBAkC7BD,OAAYE,mBAlCiB,UCAnBmd,GAAwB,KAAH,OAChCrd,OAAYI,0BADoB,iwBAqC/BJ,OAAYK,qBArCmB,SCArBid,GAAuB,wBAAH,OAE/Btd,OAAYC,wBAFmB,sdAwB9BD,OAAYE,mBAxBkB,SCApBqd,GAAyB,KAAH,OACjCvd,OAAYI,0BADqB,y4BAuChCJ,OAAYK,qBAvCoB,SCAtBmd,GAAb,0DASI,WAAYC,EAAKC,EAAQjG,EAAMC,EAAKmB,GAAO,qCACvC,cAAM4E,EAAKC,EAAQjG,EAAMC,GAEzB,EAAKz3B,KAAO,CACRw9B,IAAK,EAAKA,IACVC,OAAQ,EAAKA,OACbjG,KAAM,EAAKA,KACXC,IAAK,EAAKA,IACViG,KAAM,EAAKA,KACX9E,MAAOA,EACPlS,SAAU,GAIdjmB,OAAO8B,eAAP9B,OAAA,QAAAA,CAAA,GAA4B,MAAO,CAC/BgC,IAD+B,WACvB,OAAOqB,KAAK9D,KAAKw9B,KACzBvvB,IAF+B,SAE3BpL,GAASiB,KAAK9D,KAAKw9B,IAAM36B,KAEjCpC,OAAO8B,eAAP9B,OAAA,QAAAA,CAAA,GAA4B,SAAU,CAClCgC,IADkC,WAC1B,OAAOqB,KAAK9D,KAAKy9B,QACzBxvB,IAFkC,SAE9BpL,GAASiB,KAAK9D,KAAKy9B,OAAS56B,KAEpCpC,OAAO8B,eAAP9B,OAAA,QAAAA,CAAA,GAA4B,OAAQ,CAChCgC,IADgC,WACxB,OAAOqB,KAAK9D,KAAKw3B,MACzBvpB,IAFgC,SAE5BpL,GAASiB,KAAK9D,KAAKw3B,KAAO30B,KAElCpC,OAAO8B,eAAP9B,OAAA,QAAAA,CAAA,GAA4B,MAAO,CAC/BgC,IAD+B,WACvB,OAAOqB,KAAK9D,KAAKy3B,KACzBxpB,IAF+B,SAE3BpL,GAASiB,KAAK9D,KAAKy3B,IAAM50B,KAEjCpC,OAAO8B,eAAP9B,OAAA,QAAAA,CAAA,GAA4B,OAAQ,CAChCgC,IADgC,WACxB,OAAOqB,KAAK9D,KAAK09B,MACzBzvB,IAFgC,SAE5BpL,GAASiB,KAAK9D,KAAK09B,KAAO76B,KAGlC,EAAK86B,yBAnCkC,EAT/C,8DA+CI,WACS75B,KAAK85B,wBACN95B,KAAK85B,sBAAwB,IAAI/Y,QAEhC/gB,KAAK+5B,wBACN/5B,KAAK+5B,sBAAwB,IAAIhZ,QAEhC/gB,KAAK9D,OACN8D,KAAK9D,KAAO,IAGhB,IAAMw3B,EAAO1zB,KAAK0zB,KACdrrB,EAAMqrB,EAAO1wB,KAAKg3B,IAAyB,GAApBtzB,OAAUuzB,QAAgBj6B,KAAK05B,KAAQ15B,KAAK45B,KACnEjlB,EAAS,EAAItM,EACbqM,EAAQ1U,KAAK25B,OAAShlB,EACtBrM,GAAS,GAAMoM,EACbwlB,EAAOl6B,KAAKk6B,KAElB,GAAmB,OAAdl6B,KAAKk6B,MAAiBl6B,KAAKk6B,KAAK/nB,QAAU,CAE3C,IAAMgoB,EAAYD,EAAKC,UACnBC,EAAaF,EAAKE,WAEtB9xB,GAAQ4xB,EAAKG,QAAU3lB,EAAQylB,EAC/B9xB,GAAO6xB,EAAKI,QAAU3lB,EAASylB,EAC/B1lB,GAASwlB,EAAKxlB,MAAQylB,EACtBxlB,GAAUulB,EAAKvlB,OAASylB,EAI5B,IAAMG,EAAOv6B,KAAKw6B,WACJ,IAATD,IAAajyB,GAAQorB,EAAO6G,EAAOv6B,KAAKy6B,gBAG7C,IAAIC,EAAiD,EAA9B13B,KAAKyyB,IAAIz1B,KAAK80B,MAAQ,EAAG,GAC5C6F,EAAW33B,KAAKoG,IAAIpJ,KAAK4iB,SAAU,MAAU5f,KAAKg3B,IAAyB,GAApBtzB,OAAUuzB,QAAgBj6B,KAAK05B,KAAQ15B,KAAK45B,KACnGgB,EAAc,EAAID,EAClBE,EAAa76B,KAAK25B,OAASiB,EAC3BE,GAAc,GAAMD,EAExB76B,KAAK+5B,sBAAsBgB,gBAAiBzyB,EAAMA,EAAOoM,EAAOrM,EAAKA,EAAMsM,EAAQ+e,EAAM1zB,KAAK2zB,KAC9F3zB,KAAK85B,sBAAsBkB,iBAAkBF,EAAWA,EAAYD,EAAYF,EAAUA,EAAWC,EAAalH,EAAM1zB,KAAK2zB,KAE7H,IAAK,IAAIn3B,EAAI,EAAGA,EAAI,GAAIA,IACpBwD,KAAKyhB,iBAAiBwZ,SAASz+B,GAAMwD,KAAK+5B,sBAAsBkB,SAASz+B,IAAM,EAAIk+B,GAAqB16B,KAAK85B,sBAAsBmB,SAASz+B,GAAKk+B,EAIrJ16B,KAAKk7B,wBAAwBtf,KAAM5b,KAAKyhB,kBAAmB0Z,WA/FnE,+BAsGI,WACI,OAAOn7B,KAAK80B,MAAQ,IAvG5B,gCA6GI,WACI,OAAQ90B,KAAKo7B,sBA9GrB,gBAoHI,WACI,OAAOp7B,KAAKo7B,oBAAsB,oBAAsB,sBArHhE,IA2HI,SAASzyB,MA3Hb,iBAkII,WACI,OAAO3I,KAAK9D,KAAK44B,OAnIzB,IAyII,SAAU/1B,GACNiB,KAAK9D,KAAK44B,MAAQ/1B,IA1I1B,oBAgJI,WACI,OAAOiB,KAAK9D,KAAK0mB,UAjJzB,IAuJI,SAAa7jB,GACTiB,KAAK9D,KAAK0mB,SAAW7jB,MAxJ7B,GAAoCs8B,QCavBC,GAAb,WAMC,WAAY52B,GAA2B,WAAlB2O,EAAkB,uDAAT3O,EAAS,sEAwGf,WACvB,EAAK2mB,SAASvF,QAAQ,EAAKyV,YAAYC,YAAa,EAAKD,YAAYE,cACrE,EAAKpQ,SAASqQ,cAAc97B,OAAOy4B,iBAAmB,EAAK5sB,eAE3D,EAAKkwB,cAAc7V,QAAQ,EAAKyV,YAAYC,YAAa,EAAKD,YAAYE,cAE1E,EAAKra,OAAOuY,OAAS,EAAK4B,YAAYC,YAAc,EAAKD,YAAYE,aACrE,EAAKra,OAAOyY,4BA/G0B,mCAqM1B,SAAChV,GACbhe,sBAAsB,EAAK+0B,YAGvB,EAAKv1B,WAAa,IAAG,EAAKA,UAAYwe,GAC1C,IAAI3b,EAAQ2b,EAAM,EAAKxe,UACvB,EAAKA,UAAYwe,EAGjB,EAAKgX,MAAMhE,QAGK,MAAZ,EAAKhtB,KACR,EAAKkG,gBAAgBid,OAAO9kB,EAAO,EAAK2B,KAIzC,EAAKuc,OAAOle,GAGZ,EAAK2yB,MAAM7N,YAzN2B,4CAsTjB,WAChB,EAAKnjB,KACV,EAAKA,IAAIorB,YAAY,EAAK/5B,KAAK4/B,aAAa/5B,EAAG,EAAK7F,KAAK4/B,aAAa55B,EAAG,EAAKhG,KAAKyP,wBAAyB,EAAKzP,KAAK2P,6BAvTtHlP,OAAO8B,eAAgBuB,KAAM,cAAe,CAAEjB,OAAO,IAErDiB,KAAKu7B,YAAc72B,EACnB1E,KAAKqT,OAASA,EAEdrT,KAAK9D,KAAO,CACX2O,IAAK,KACLuW,OAAQ,KACRrQ,gBAAiB,KACjB1F,SAAU,CACTC,iBAAkB,CAAEvM,MAAO,GAC3BwM,aAAc,CAAExM,MAAO,GACvB8S,SAAU,CAAE9S,MAAO,IAAI4rB,OAAM,GAAK,GAAK,IACvCoR,aAAc,CACbh9B,MAAO,CACN8L,IAAK,KACLmxB,KAAMlmB,GAAYsB,YAClBoC,MAAO,IAAIlW,OAAQ,EAAG,GACtBiW,UAAW,IAAIjW,OACfmkB,IAAK,IAAInkB,UAIZmI,cAAe,EACfqwB,aAAc,IAAIx4B,OAAQ,EAAG,GAC7BqI,wBAAyB,IACzBE,yBAA0B,KAG3B7L,KAAK0Y,cAAgBpU,IAErBtE,KAAK67B,MAAQ,IAAIrF,GACjBx2B,KAAK67B,MAAM/E,OAGX92B,KAAKqrB,SAAW,IAAI4Q,OAAc,CACjCC,WAAW,EACXC,aAAa,EACbC,uBAAuB,EACvBC,wBAAwB,IAEzBr8B,KAAKqrB,SAASiR,WAAY,EAC1Bt8B,KAAKqrB,SAAShgB,SAAWrL,KAAK9D,KAAKmP,SAGnCrL,KAAK27B,cAAgB,IAAI3W,GAAchlB,KAAKqT,QAE5CrT,KAAKu8B,YAAc,IAAIrI,GAAYl0B,KAAK9D,KAAKmP,UAE7CrL,KAAKohB,OAAS,IAAIqY,GAAe,GAAI,EAAG,GAAK,IAAO,GACpDz5B,KAAKw8B,aAAe,IAAInB,OAAkB,GAAI,EAAG,GAAK,KAEtDr7B,KAAK+Q,gBAAkB,IAAIujB,GAAgBt0B,KAAMA,KAAKohB,QAEtDphB,KAAKkhB,UAAY,IAAI2P,OACrB7wB,KAAKkhB,UAAU7H,OAAOua,YACtB5zB,KAAKkhB,UAAUI,OAAOC,MAAQ,CAACF,UAAW,IAG1CrhB,KAAK6K,IAAM,KAEX7K,KAAKsB,QAAU,IAAIwY,GAAU,WAE7B9Z,KAAKqG,UAAY,EAGjBrG,KAAKy8B,wBAGL78B,OAAOwT,iBAAiB,SAAUpT,KAAK08B,uBAGvC71B,sBAAsB7G,KAAK47B,YA/E7B,6DAqFC,WACC57B,KAAKu7B,YAAY51B,UAAY,GAE7B,IAAIg3B,EAAWp3B,EAAc,wFAC7BvF,KAAKu7B,YAAYlX,YAAYsY,GAG7BA,EAAStY,YAAYrkB,KAAKqrB,SAAS1F,YAGnC3lB,KAAK27B,cAAchW,WAAWviB,MAAMtB,SAAW,WAC/C9B,KAAK27B,cAAchW,WAAWviB,MAAMiF,IAAM,IAC1CrI,KAAK27B,cAAchW,WAAWviB,MAAMkF,KAAO,IAC3CtI,KAAK27B,cAAchW,WAAWviB,MAAMw5B,cAAgB,OACpDD,EAAStY,YAAYrkB,KAAK27B,cAAchW,YAGxCgX,EAAStY,YAAYrkB,KAAK67B,MAAMjF,KAEhC52B,KAAK08B,0BAxGP,kCAiIC,SAAqBxG,GAA2B,IAAXh6B,EAAW,uDAAJ,GACvC2gC,EAAah1B,EAAc7H,KAAKu7B,aAChCuB,EAAsB,IAAIx5B,QAC3B4yB,EAAen0B,EAAI86B,EAAWx0B,KAAOrI,KAAKu7B,YAAYC,YAAe,EAAI,IACxEtF,EAAeh0B,EAAI26B,EAAWv0B,MAAQtI,KAAKu7B,YAAYE,aAAgB,EAAI,GAG/E,GAAIz7B,KAAK6K,KAAO7K,KAAK6K,IAAIunB,SAAS,CACjCpyB,KAAKkhB,UAAU6b,cAAcD,EAAqB98B,KAAKohB,QAQvD,IALA,IAAID,EAAanhB,KAAKkhB,UAAU6S,iBAAiB,CAAC/zB,KAAK6K,IAAIomB,iBAAiBlb,MAAO/V,KAAK6K,IAAIqmB,kBAAkBnb,MAAO/V,KAAKsB,UAAU,GAChI07B,EAAM,KACNC,EAAY,KACZC,EAAW,KACXC,GAAU,EACL3gC,EAAI,EAAGA,EAAI2kB,EAAWzkB,OAAQF,IACtC,GAAI2kB,EAAW3kB,GAAGgD,OAAO,CACxB,IAAIA,EAAS2hB,EAAW3kB,GAAGgD,OAGvB0kB,EAAS1kB,EACTiR,EAAUyT,EAAOzT,QACrB,MAAOA,GAAWyT,EAAOA,OACxBA,EAASA,EAAOA,OAChBzT,EAAUyT,EAAOzT,QAGlB,GAAIA,EAAS,CACPusB,IAAKA,EAAM7b,EAAW3kB,IAG3B,IAAI4gC,EAAa59B,EACjB,MAAM49B,EAAWlZ,OAAQkZ,EAAaA,EAAWlZ,OAUjD,GARIkZ,IAAep9B,KAAK6K,IAAIqmB,kBAAkBnb,QACxCknB,IAAWA,EAAY9b,EAAW3kB,KAGpC4gC,IAAep9B,KAAK6K,IAAIomB,iBAAiBlb,QACvCmnB,IAAUA,EAAW/b,EAAW3kB,OAGjC2gC,GAAY39B,EAAOgZ,WAAahZ,EAAOgZ,SAASiR,YAChDjqB,EAAOulB,SAAWvlB,EAAOulB,QAAQ,CACpC7oB,KAAMA,EACNwrB,aAAcvG,EAAW3kB,KACtB,OAGD4gC,IAAep9B,KAAK6K,IAAIqmB,kBAAkBnb,QAC7ConB,GAAU,IAOd14B,EAAczE,KAAKqT,OAAQ,wBAAyB,CACnDnX,KAAMA,EACN8gC,IAAKA,EACLE,SAAUA,EACVD,UAAWA,EACXI,cAAelc,EACfK,IAAKxhB,KAAKkhB,UAAUM,SAjMxB,oBAuOC,SAAOtY,GACNzE,EAAczE,KAAKqT,OAAQ,qBAAsB,CAChDnK,MAAOA,IAIRlJ,KAAKohB,OAAOyY,yBACZ75B,KAAKw8B,aAAaxpB,SAAS4I,KAAK5b,KAAKohB,OAAOpO,UAC5ChT,KAAKw8B,aAAa3C,yBAGlB75B,KAAKqrB,SAASxT,QAEd7X,KAAKqrB,SAASjE,OAAOpnB,KAAKu8B,YAAav8B,KAAKw8B,cAC5Cx8B,KAAKqrB,SAASiS,aAEVt9B,KAAK6K,KAAO7K,KAAK6K,IAAIunB,WAExBpyB,KAAK9D,KAAKmP,SAAS0wB,aAAah9B,MAAM0oB,IAAI7L,KAAK5b,KAAK6K,IAAIomB,iBAAiBra,YAEzE5W,KAAKqrB,SAASjE,OAAOpnB,KAAK6K,IAAIqmB,kBAAkBnb,MAAO/V,KAAKohB,QAC5DphB,KAAKqrB,SAASiS,aAEVt9B,KAAK+Q,gBAAgB6R,SAAW,KACnC5iB,KAAKqrB,SAASjE,OAAOpnB,KAAK6K,IAAIomB,iBAAiBlb,MAAO/V,KAAKohB,SAK7DphB,KAAKqrB,SAASjE,OAAOpnB,KAAKsB,QAAStB,KAAKohB,QACxCphB,KAAK27B,cAAcvU,OAAOpnB,KAAKsB,QAAStB,KAAKohB,UArQ/C,uBA6QC,WAAsB,WAAZvW,EAAY,uDAAN,KAKf,OAJI7K,KAAK6K,KAAO7K,KAAK6K,IAAI0yB,OAAOv9B,KAAK6K,IAAIsJ,SAEzCnU,KAAK6K,IAAMA,EAEP7K,KAAK6K,KAAO7K,KAAK6K,IAAI0yB,MACjB1yB,EAAIuJ,KAAKilB,GAAqBC,GAAuBC,GAAsBC,GAAwBx5B,KAAK9D,KAAKmP,SAAUrL,KAAK0Y,eACjIrE,MAAK,WAAM,uBACS,EAAKxJ,IAAImmB,gBADlB,IACX,2BAA4C,KAAnC/b,EAAmC,QAC3C,EAAKoW,SAASmS,YAAYvoB,IAFhB,8BAKX,EAAK/Y,KAAKmP,SAASwG,SAAS9S,MAAQ8L,EAAI3O,KAAK2V,SAC7C,EAAK3V,KAAKmP,SAASE,aAAaxM,MAAQ8L,EAAI3O,KAAKqP,aACjD,EAAKrP,KAAKmP,SAAS0wB,aAAah9B,MAAM8L,IAAMA,EAAIomB,iBAAiBva,QAAQzB,QACzE,EAAK/Y,KAAKmP,SAAS0wB,aAAah9B,MAAMya,MAAMrP,IAAIU,EAAI3O,KAAKy0B,MAAMrX,SAASvX,EAAG8I,EAAI3O,KAAKy0B,MAAMrX,SAASnX,GACnG,EAAKjG,KAAKmP,SAAS0wB,aAAah9B,MAAMwa,UAAUpP,IAAIU,EAAI3O,KAAKy0B,MAAMpX,UAAUxX,EAAG8I,EAAI3O,KAAKy0B,MAAMpX,UAAUpX,GAEzGmU,WAAW,EAAK1K,qBAEhBnH,EAAc,EAAK4O,OAAQ,oBAAqB,CAC/CxI,IAAKA,OAGNuN,OAAM,SAAA/S,GACNP,EAAM,EAAKuO,OAAQhO,EAAO,YAGrB4O,QAAQ8E,YAzSlB,yBAoTC,SAAY0kB,EAASC,GAA0D,IAAjDxL,EAAiD,wDAA5B,EAAGC,EAAyB,wDAAH,EAC3EnyB,KAAK9D,KAAK4/B,aAAa3xB,IAAIszB,EAASC,GAChCxL,GAAqB,IAAGlyB,KAAK9D,KAAKyP,wBAA0BumB,GAC5DC,GAAsB,IAAGnyB,KAAK9D,KAAK2P,yBAA2BsmB,GAElEnyB,KAAK4L,wBAzTP,4BAiUC,SAAe+xB,GACTA,IAAkBA,EAAmBr5B,KAE1CtE,KAAK0Y,cAAgBilB,EACjB39B,KAAK6K,MACR7K,KAAK6K,IAAIqmB,kBAAkBld,WAAW0E,cAAgB1Y,KAAK0Y,cAC3D1Y,KAAK6K,IAAIomB,iBAAiBjd,WAAW0E,cAAgB1Y,KAAK0Y,iBAvU7D,yBA8UC,WACC,OAAO1Y,KAAK9D,KAAKuP,eA/UnB,IAqVC,SAAkB1M,GACjBiB,KAAK9D,KAAKuP,cAAgB1M,EAC1BiB,KAAK08B,0BAvVP,kBA6VC,WACC,OAAO18B,KAAKu2B,SA9Vd,IAoWC,SAAWx3B,GACViB,KAAKu2B,QAAUx3B,EACfiB,KAAK9D,KAAKklB,OAASriB,EAAM7C,OAtW3B,2BA4WC,WACC,OAAO8D,KAAK49B,kBA7Wd,IAmXC,SAAoB7+B,GACnBiB,KAAK49B,iBAAmB7+B,EACxBiB,KAAK9D,KAAK6U,gBAAkBhS,EAAM7C,OArXpC,eA2XC,WACC,OAAO8D,KAAK69B,MA5Xd,IAkYC,SAAQ9+B,GACPiB,KAAK69B,KAAO9+B,EACRA,IAAOiB,KAAK9D,KAAK2O,IAAM9L,EAAM7C,UApYnC,KCXa4hC,GAAb,WASI,WAAY77B,EAAQ87B,EAAO90B,GAAW,uEAmExB,SAAA2J,SACWqF,IAAhBrF,EAAIorB,QAAwC,IAAhBprB,EAAIorB,QAA+B,IAAfprB,EAAI3F,SAAkB2F,EAAIqrB,SAC3E,EAAKC,QAAS,EACd,EAAKC,cAAch0B,IAAI,EAAG,GAC1B,EAAKsqB,aAAatqB,IAAIyI,EAAI7Q,EAAG6Q,EAAI1Q,OAvEH,oCA+ExB,SAAA0Q,GACV,IAAI9Q,EAAWg8B,EAAkBM,WAAWj0B,IAAIyI,EAAI7Q,EAAG6Q,EAAI1Q,GAExD,EAAKg8B,QACJ,EAAKC,cAAcxW,IAAI7lB,GAAU2U,IAAI,EAAKge,cAG9C,EAAKA,aAAa7Y,KAAK9Z,MAtFW,kCA6F1B,SAAA8Q,GACW,IAAfA,EAAI3F,SAAc,EAAKixB,QAAS,MA9FF,qDAiGP,WAC3B,EAAKG,wBAA2B,EAAI,EAAKp8B,OAAOu5B,aAAgB,EAAKv5B,OAAOu5B,YAAc,EAAKv5B,OAAOw5B,cACtG,EAAK6C,wBAA0B,EAAI,EAAKr8B,OAAOw5B,gBAlG/Cz7B,KAAKiC,OAASA,EACdjC,KAAKu+B,QAAU,KAEfv+B,KAAKk+B,QAAS,EACdl+B,KAAKy0B,aAAe,IAAInxB,OACxBtD,KAAKm+B,cAAgB,IAAI76B,OAEzBtD,KAAK+9B,MAAQA,EACb/9B,KAAKiJ,UAAYA,EAEjBjJ,KAAKq+B,wBAA0B,EAC/Br+B,KAAKs+B,wBAA0B,EAC/Bt+B,KAAKw+B,+BAtBb,6CA4BI,SAAMD,GACFv+B,KAAKu+B,QAAUA,EAEfv+B,KAAKiC,OAAOmR,iBAAiB,YAAapT,KAAKy+B,aAC/C7+B,OAAOwT,iBAAiB,YAAapT,KAAK0+B,aAC1C9+B,OAAOwT,iBAAiB,UAAWpT,KAAK2+B,WAExC/+B,OAAOwT,iBAAiB,SAAUpT,KAAKw+B,gCAnC/C,kBAsCI,WACIx+B,KAAKiC,OAAOsR,oBAAoB,YAAavT,KAAKy+B,aAClD7+B,OAAO2T,oBAAoB,YAAavT,KAAK0+B,aAC7C9+B,OAAO2T,oBAAoB,UAAWvT,KAAK2+B,WAE3C/+B,OAAO2T,oBAAoB,SAAUvT,KAAKw+B,gCA3ClD,oBAkDI,SAAOt1B,EAAO2B,GACV,GAA6B,IAAzB7K,KAAKm+B,cAAcp8B,GAAoC,IAAzB/B,KAAKm+B,cAAcj8B,EAArD,CAEA,IAAI08B,EAAY5+B,KAAKiJ,WAAa,OAASC,GAC3C01B,EAAYl4B,OAAUC,MAAMi4B,EAAW,EAAG,GAE1C,IAAIC,EAAiBf,EAAkBM,WAAWxiB,KAAK5b,KAAKm+B,eAC5DU,EAAeC,aAAaz7B,EAAWrD,KAAKu+B,QAAQvrB,UAEpDhT,KAAKu+B,QAAQz8B,SAASC,GAAK88B,EAAe98B,EAAI68B,EAAY5+B,KAAKu+B,QAAQ3b,SAAW5iB,KAAK+9B,MAAQ/9B,KAAKq+B,wBACpGr+B,KAAKu+B,QAAQz8B,SAASK,GAAK08B,EAAe38B,EAAI08B,EAAY5+B,KAAKu+B,QAAQ3b,SAAW5iB,KAAK+9B,MAAQ/9B,KAAKs+B,wBAEpGt+B,KAAKm+B,cAAcrc,eAAe,EAAI8c,GAClC5+B,KAAKm+B,cAAcY,WAAa,MAChC/+B,KAAKm+B,cAAch0B,IAAI,EAAG,MAhEtC,mBAoEI,WACInK,KAAKm+B,cAAch0B,IAAI,EAAG,OArElC,K,gBAAa2zB,G,aAEW,IAAIx6B,QCHrB,IAAM07B,GAAb,WAOI,WAAY/8B,EAAQ87B,EAAO90B,GAAW,wEAiDvB,SAAA2J,GACX,IAAI1J,EAAQ0J,EAAIqsB,OACZrsB,EAAIssB,YAAcC,WAAWC,kBAAiBl2B,GAAS,KACvD0J,EAAIssB,YAAcC,WAAWE,iBAAgBn2B,GAAS,KAE1D,EAAKo2B,WAAap2B,KArDlBlJ,KAAKiC,OAASA,EACdjC,KAAKu+B,QAAU,KAEfv+B,KAAKiJ,UAAYA,EACjBjJ,KAAK+9B,MAAQA,EAEb/9B,KAAKs/B,UAAY,EAdzB,6CAoBI,SAAMf,GACFv+B,KAAKu+B,QAAUA,EAEfv+B,KAAKiC,OAAOmR,iBAAiB,QAASpT,KAAKu/B,aAAc,CAACC,SAAS,MAvB3E,kBA0BI,WACIx/B,KAAKiC,OAAOsR,oBAAoB,QAASvT,KAAKu/B,gBA3BtD,oBAkCI,SAAOr2B,EAAO2B,GACV,GAAuB,IAAnB7K,KAAKs/B,UAAT,CAEA,IAAIV,EAAY5+B,KAAKiJ,WAAa,OAASC,GAC3C01B,EAAYl4B,OAAUC,MAAMi4B,EAAW,EAAG,GAE1C5+B,KAAKu+B,QAAQ3b,UAAY5f,KAAKyyB,IAAI,IAAKz1B,KAAKs/B,UAAYV,EAAY5+B,KAAK+9B,OAEzE/9B,KAAKs/B,WAAa,EAAIV,EAClB57B,KAAK+U,IAAI/X,KAAKs/B,WAAa,OAC3Bt/B,KAAKs/B,UAAY,MA5C7B,mBAgDI,WACIt/B,KAAKs/B,UAAY,MAjDzB,KCAaG,GAAb,WAOI,WAAYx9B,EAAQ87B,EAAO90B,GAAW,uEA8DxB,SAAA2J,UACWqF,IAAhBrF,EAAIorB,QAAwC,IAAhBprB,EAAIorB,QAA+B,IAAfprB,EAAI3F,UACnD2F,EAAIqrB,QAAUrrB,EAAI8sB,gBAA6BznB,IAAhBrF,EAAIorB,QAAwC,IAAhBprB,EAAIorB,QAA+B,IAAfprB,EAAI3F,WACrF,EAAKixB,QAAS,EACd,EAAKyB,cAAgB,EACrB,EAAKC,MAAQhtB,EAAI7Q,MAnEa,oCA2ExB,SAAA6Q,GACP,EAAKsrB,SACJ,EAAKyB,eAAiB/sB,EAAI7Q,EAAI,EAAK69B,OAGvC,EAAKA,MAAQhtB,EAAI7Q,KAhFiB,kCAuF1B,SAAA6Q,GACR,EAAKsrB,QAAS,KAxFoB,qDA2FP,WAC3B,EAAKG,wBAA2B,EAAI,EAAKp8B,OAAOu5B,eA3FhDx7B,KAAKiC,OAASA,EACdjC,KAAKu+B,QAAU,KAEfv+B,KAAKk+B,QAAS,EACdl+B,KAAK4/B,MAAQ,EACb5/B,KAAK2/B,cAAgB,EAErB3/B,KAAK+9B,MAAQA,EACb/9B,KAAKiJ,UAAYA,EAEjBjJ,KAAKq+B,wBAA0B,EAC/Br+B,KAAKw+B,+BAnBb,6CAyBI,SAAMD,GACFv+B,KAAKu+B,QAAUA,EAEfv+B,KAAKiC,OAAOmR,iBAAiB,YAAapT,KAAKy+B,aAC/C7+B,OAAOwT,iBAAiB,YAAapT,KAAK0+B,aAC1C9+B,OAAOwT,iBAAiB,UAAWpT,KAAK2+B,WAExC/+B,OAAOwT,iBAAiB,SAAUpT,KAAKw+B,gCAhC/C,kBAmCI,WACIx+B,KAAKiC,OAAOsR,oBAAoB,YAAavT,KAAKy+B,aAClD7+B,OAAO2T,oBAAoB,YAAavT,KAAK0+B,aAC7C9+B,OAAO2T,oBAAoB,UAAWvT,KAAK2+B,WAE3C/+B,OAAO2T,oBAAoB,SAAUvT,KAAKw+B,gCAxClD,oBA+CI,SAAOt1B,EAAO2B,GACV,GAA2B,IAAvB7K,KAAK2/B,cAAT,CAEA,IAAIf,EAAY5+B,KAAKiJ,WAAa,OAASC,GAC3C01B,EAAYl4B,OAAUC,MAAMi4B,EAAW,EAAG,GAE1C5+B,KAAKu+B,QAAQvrB,UAAYhT,KAAK2/B,cAAgBf,EAAY5+B,KAAK+9B,MAAQ/9B,KAAKq+B,wBAE5Er+B,KAAK2/B,eAAiB,EAAIf,EACtB57B,KAAK+U,IAAI/X,KAAK2/B,eAAiB,OAC/B3/B,KAAK2/B,cAAgB,MAzDjC,mBA6DI,WACI3/B,KAAK2/B,cAAgB,MA9D7B,KCAaE,GAAb,WAOI,WAAY59B,EAAQ87B,EAAO90B,GAAW,uEA8DxB,SAAA2J,UACWqF,IAAhBrF,EAAIorB,QAAwC,IAAhBprB,EAAIorB,QAA+B,IAAfprB,EAAI3F,UACnD2F,EAAIqrB,QAAUrrB,EAAI8sB,gBAA6BznB,IAAhBrF,EAAIorB,QAAwC,IAAhBprB,EAAIorB,QAA+B,IAAfprB,EAAI3F,WACrF,EAAKixB,QAAS,EACd,EAAK4B,WAAa,EAClB,EAAKC,MAAQntB,EAAI1Q,MAnEa,oCA2ExB,SAAA0Q,GACP,EAAKsrB,SACJ,EAAK4B,YAAcltB,EAAI1Q,EAAI,EAAK69B,OAGpC,EAAKA,MAAQntB,EAAI1Q,KAhFiB,kCAuF1B,SAAA0Q,GACR,EAAKsrB,QAAS,KAxFoB,qDA2FP,WAC3B,EAAKI,wBAA0B,EAAI,EAAKr8B,OAAOw5B,gBA3F/Cz7B,KAAKiC,OAASA,EACdjC,KAAKu+B,QAAU,KAEfv+B,KAAKk+B,QAAS,EACdl+B,KAAK+/B,MAAQ,EACb//B,KAAK8/B,WAAa,EAElB9/B,KAAK+9B,MAAQA,EACb/9B,KAAKiJ,UAAYA,EAEjBjJ,KAAKs+B,wBAA0B,EAC/Bt+B,KAAKw+B,+BAnBb,6CAyBI,SAAMD,GACFv+B,KAAKu+B,QAAUA,EAEfv+B,KAAKiC,OAAOmR,iBAAiB,YAAapT,KAAKy+B,aAC/C7+B,OAAOwT,iBAAiB,YAAapT,KAAK0+B,aAC1C9+B,OAAOwT,iBAAiB,UAAWpT,KAAK2+B,WAExC/+B,OAAOwT,iBAAiB,SAAUpT,KAAKw+B,gCAhC/C,kBAmCI,WACIx+B,KAAKiC,OAAOsR,oBAAoB,YAAavT,KAAKy+B,aAClD7+B,OAAO2T,oBAAoB,YAAavT,KAAK0+B,aAC7C9+B,OAAO2T,oBAAoB,UAAWvT,KAAK2+B,WAE3C/+B,OAAO2T,oBAAoB,SAAUvT,KAAKw+B,gCAxClD,oBA+CI,SAAOt1B,EAAO2B,GACV,GAAwB,IAApB7K,KAAK8/B,WAAT,CAEA,IAAIlB,EAAY5+B,KAAKiJ,WAAa,OAASC,GAC3C01B,EAAYl4B,OAAUC,MAAMi4B,EAAW,EAAG,GAE1C5+B,KAAKu+B,QAAQhK,OAASv0B,KAAK8/B,WAAalB,EAAY5+B,KAAK+9B,MAAQ/9B,KAAKs+B,wBAEtEt+B,KAAK8/B,YAAc,EAAIlB,EACnB57B,KAAK+U,IAAI/X,KAAK8/B,YAAc,OAC5B9/B,KAAK8/B,WAAa,MAzD9B,mBA6DI,WACI9/B,KAAK8/B,WAAa,MA9D1B,K,aCAaE,GAAb,WAMI,WAAYC,EAAuBC,GAAuB,wBACtDlgC,KAAKu+B,QAAU,KAEfv+B,KAAKigC,sBAAwBA,EAC7BjgC,KAAKkgC,sBAAwBA,EAC7BlgC,KAAKmgC,SAAWn9B,KAAKgoB,GAAK,EAE1BhrB,KAAKogC,aAAe,EACpBpgC,KAAKqgC,aAAe,EAEpBrgC,KAAKsgC,gBAAkB,EACvBtgC,KAAKugC,qBAAuB,EAjBpC,6CAuBI,SAAMhC,GACFv+B,KAAKu+B,QAAUA,IAxBvB,kBA2BI,cA3BJ,oBAiCI,SAAOr1B,EAAO2B,GAGV7K,KAAKwgC,cAAct3B,EAAO2B,GAC1B7K,KAAKu+B,QAAQz8B,SAASI,EAAIc,KAAKoG,IAAIpJ,KAAKu+B,QAAQz8B,SAASI,EAAGlC,KAAKygC,wBArCzE,2BAwCI,SAAcv3B,EAAO2B,GAEjB,IAAI61B,EAAkB1gC,KAAKkgC,uBAAyB,OAASh3B,GAC7Dw3B,EAAkBh6B,OAAUC,MAAM+5B,EAAiB,EAAG,GAEtD,IAAIC,EAAsB91B,EAAI+1B,gBAAgB5gC,KAAKu+B,QAAQz8B,SAASC,EAAG/B,KAAKu+B,QAAQz8B,SAASK,GAAK,GAAK,EAEnG0+B,EAAcF,EAAsB3gC,KAAKogC,aAM7C,GALApgC,KAAKogC,cAAgBS,EAAcH,EAC/B19B,KAAK+U,IAAI8oB,GAAe,OAAO7gC,KAAKogC,aAAeO,GAGvD3gC,KAAKsgC,gBAAkB,EACnBtgC,KAAKmgC,UAAY,GAAK,CACtB,IAAIW,EAAkB9gC,KAAKigC,uBAAyB,OAAS/2B,GAC7D43B,EAAkBp6B,OAAUC,MAAMm6B,EAAiB,EAAG,GAEtD,IAAIC,EAAsBl2B,EAAI+1B,gBAAgB5gC,KAAKu+B,QAAQnd,OAAOtf,SAASC,EAAG/B,KAAKu+B,QAAQnd,OAAOtf,SAASK,IAAM,EAE7G6+B,EAAcD,EAAsB/gC,KAAKqgC,aAC7CrgC,KAAKqgC,cAAgBW,EAAcF,EAC/B99B,KAAK+U,IAAIipB,GAAe,OAAOhhC,KAAKqgC,aAAeU,GAEvD,IAAIE,EAAiBj+B,KAAKiQ,IAAIjT,KAAKmgC,UAAYngC,KAAKu+B,QAAQ3b,SAC5D5iB,KAAKsgC,gBAAkBtgC,KAAKqgC,aAAeY,EAAiB,EAIhEjhC,KAAKugC,qBAAuBv9B,KAAKoG,IAAI1C,OAAU4b,KAAKtiB,KAAKogC,aAAc,EAAGpgC,KAAKu+B,QAAQ3b,SAAW,KAAM,KApEhH,gCAuEI,WACI,OAAO5f,KAAKoG,IAAIpJ,KAAKugC,qBAAsBvgC,KAAKsgC,qBAxExD,KCFaY,GAAb,WAUI,WAAYC,GAAoB,wBAE5BnhC,KAAKmhC,KAAOA,EAFgB,2BAAXC,EAAW,iCAAXA,EAAW,kBAG5BphC,KAAKqhC,KAAOD,EAAU9Y,SAAS4Y,EAAeI,OAAuB,aAAdthC,KAAKmhC,MAAqC,cAAdnhC,KAAKmhC,KACxFnhC,KAAK7C,MAAQikC,EAAU9Y,SAAS4Y,EAAeK,QAAwB,cAAdvhC,KAAKmhC,MAAsC,eAAdnhC,KAAKmhC,KAC3FnhC,KAAKwhC,IAAMJ,EAAU9Y,SAAS4Y,EAAeO,MAAsB,YAAdzhC,KAAKmhC,MAAoC,aAAdnhC,KAAKmhC,KAf7F,gDAuBI,SAASvuB,GACL,OAAO5S,KAAKmhC,OAASvuB,EAAIuuB,MACrBnhC,KAAKqhC,OAASzuB,EAAI8sB,SAClB1/B,KAAK7C,QAAUyV,EAAI8uB,UACnB1hC,KAAKwhC,MAAQ5uB,EAAIqrB,SA3B7B,oBAkCI,SAAOrrB,GACH,OAAO5S,KAAKmhC,OAASvuB,EAAIuuB,QAnCjC,sBAsCI,SAAevuB,GAAsB,2BAAd+uB,EAAc,iCAAdA,EAAc,kBACjC,cAAwBA,EAAxB,eAAqC,CAAhC,IAAIC,EAAW,KAChB,GAAIA,EAAYC,SAASjvB,GAAM,OAAO,EAE1C,OAAO,IA1Cf,mBA6CI,SAAaA,GAAsB,2BAAd+uB,EAAc,iCAAdA,EAAc,kBAC/B,cAAwBA,EAAxB,eAAqC,CAAhC,IAAIC,EAAW,KAChB,GAAIA,EAAYE,OAAOlvB,GAAM,OAAO,EAExC,OAAO,MAjDf,K,gBAAasuB,G,OAEK,G,gBAFLA,G,QAGM,G,gBAHNA,G,MAII,GCAV,IAAMa,GAAb,WA4BI,WAAY9/B,EAAQ87B,EAAO90B,GAAW,qEA4D1B,SAAA2J,GACJsuB,GAAec,QAAf,MAAAd,GAAc,CAAStuB,GAAT,uBAAiBmvB,EAAgBE,KAAKC,QACpD,EAAKzvB,IAAK,EACVG,EAAIJ,kBAEJ0uB,GAAec,QAAf,MAAAd,GAAc,CAAStuB,GAAT,uBAAiBmvB,EAAgBE,KAAKE,UACpD,EAAKC,MAAO,EACZxvB,EAAIJ,kBAEJ0uB,GAAec,QAAf,MAAAd,GAAc,CAAStuB,GAAT,uBAAiBmvB,EAAgBE,KAAKI,UACpD,EAAK/5B,MAAO,EACZsK,EAAIJ,kBAEJ0uB,GAAec,QAAf,MAAAd,GAAc,CAAStuB,GAAT,uBAAiBmvB,EAAgBE,KAAKK,WACpD,EAAKC,OAAQ,EACb3vB,EAAIJ,qBA3E0B,gCAkF5B,SAAAI,GACFsuB,GAAesB,MAAf,MAAAtB,GAAc,CAAOtuB,GAAP,uBAAemvB,EAAgBE,KAAKC,QAClD,EAAKzvB,IAAK,GAEVyuB,GAAesB,MAAf,MAAAtB,GAAc,CAAOtuB,GAAP,uBAAemvB,EAAgBE,KAAKE,UAClD,EAAKC,MAAO,GAEZlB,GAAesB,MAAf,MAAAtB,GAAc,CAAOtuB,GAAP,uBAAemvB,EAAgBE,KAAKI,UAClD,EAAK/5B,MAAO,GAEZ44B,GAAesB,MAAf,MAAAtB,GAAc,CAAOtuB,GAAP,uBAAemvB,EAAgBE,KAAKK,WAClD,EAAKC,OAAQ,MA5FjBviC,KAAKiC,OAASA,EACdjC,KAAKu+B,QAAU,KAEfv+B,KAAKm+B,cAAgB,IAAI76B,OAEzBtD,KAAKyS,IAAK,EACVzS,KAAKoiC,MAAO,EACZpiC,KAAKsI,MAAO,EACZtI,KAAKuiC,OAAQ,EAEbviC,KAAK+9B,MAAQA,EACb/9B,KAAKiJ,UAAYA,EAxCzB,6CA8CI,SAAMs1B,GACFv+B,KAAKu+B,QAAUA,EAEf3+B,OAAOwT,iBAAiB,UAAWpT,KAAKyiC,WACxC7iC,OAAOwT,iBAAiB,QAASpT,KAAK0iC,WAlD9C,kBAqDI,WACI9iC,OAAO2T,oBAAoB,UAAWvT,KAAKyiC,WAC3C7iC,OAAO2T,oBAAoB,QAASvT,KAAK0iC,WAvDjD,oBA8DI,SAAOx5B,EAAO2B,GAMV,GALI7K,KAAKyS,KAAIzS,KAAKm+B,cAAcj8B,GAAK,GACjClC,KAAKoiC,OAAMpiC,KAAKm+B,cAAcj8B,GAAK,GACnClC,KAAKsI,OAAMtI,KAAKm+B,cAAcp8B,GAAK,GACnC/B,KAAKuiC,QAAOviC,KAAKm+B,cAAcp8B,GAAK,GAEX,IAAzB/B,KAAKm+B,cAAcp8B,GAAoC,IAAzB/B,KAAKm+B,cAAcj8B,EAArD,CAEA,IAAI08B,EAAY5+B,KAAKiJ,WAAa,OAASC,GAC3C01B,EAAYl4B,OAAUC,MAAMi4B,EAAW,EAAG,GAE1C,IAAI+D,EAAeZ,EAAgBa,QAAQhnB,KAAK5b,KAAKm+B,eACrDwE,EAAa7D,aAAaz7B,EAAWrD,KAAKu+B,QAAQvrB,UAElDhT,KAAKu+B,QAAQz8B,SAASC,GAAK4gC,EAAa5gC,EAAI68B,EAAY5+B,KAAKu+B,QAAQ3b,SAAW5iB,KAAK+9B,MAAQ70B,EAAQ,IACrGlJ,KAAKu+B,QAAQz8B,SAASK,GAAKwgC,EAAazgC,EAAI08B,EAAY5+B,KAAKu+B,QAAQ3b,SAAW5iB,KAAK+9B,MAAQ70B,EAAQ,IAErGlJ,KAAKm+B,cAAcrc,eAAe,EAAI8c,GAClC5+B,KAAKm+B,cAAcY,WAAa,MAChC/+B,KAAKm+B,cAAch0B,IAAI,EAAG,QAjFtC,K,gBAAa43B,G,OAEK,CACVM,KAAM,CACF,IAAInB,GAAe,aACnB,IAAIA,GAAe,SAEvBgB,GAAI,CACA,IAAIhB,GAAe,WACnB,IAAIA,GAAe,SAEvBoB,MAAO,CACH,IAAIpB,GAAe,cACnB,IAAIA,GAAe,SAEvBiB,KAAM,CACF,IAAIjB,GAAe,aACnB,IAAIA,GAAe,W,gBAjBlBa,G,UAqBQ,IAAIz+B,QCtBlB,IAAMu/B,GAAb,WAoBI,WAAY5gC,EAAQ87B,EAAO90B,GAAW,qEAoD1B,SAAA2J,GACJsuB,GAAec,QAAf,MAAAd,GAAc,CAAStuB,GAAT,uBAAiBiwB,EAAiBZ,KAAKC,QACrD,EAAKzvB,IAAK,EACVG,EAAIJ,kBAEJ0uB,GAAec,QAAf,MAAAd,GAAc,CAAStuB,GAAT,uBAAiBiwB,EAAiBZ,KAAKE,UACrD,EAAKC,MAAO,EACZxvB,EAAIJ,qBA3D0B,gCAkE5B,SAAAI,GACFsuB,GAAesB,MAAf,MAAAtB,GAAc,CAAOtuB,GAAP,uBAAeiwB,EAAiBZ,KAAKC,QACnD,EAAKzvB,IAAK,GAEVyuB,GAAesB,MAAf,MAAAtB,GAAc,CAAOtuB,GAAP,uBAAeiwB,EAAiBZ,KAAKE,UACnD,EAAKC,MAAO,MAtEhBpiC,KAAKiC,OAASA,EACdjC,KAAKu+B,QAAU,KAEfv+B,KAAK8/B,WAAa,EAElB9/B,KAAKyS,IAAK,EACVzS,KAAKoiC,MAAO,EAEZpiC,KAAK+9B,MAAQA,EACb/9B,KAAKiJ,UAAYA,EA9BzB,6CAoCI,SAAMs1B,GACFv+B,KAAKu+B,QAAUA,EAEf3+B,OAAOwT,iBAAiB,UAAWpT,KAAKyiC,WACxC7iC,OAAOwT,iBAAiB,QAASpT,KAAK0iC,WAxC9C,kBA2CI,WACI9iC,OAAO2T,oBAAoB,UAAWvT,KAAKyiC,WAC3C7iC,OAAO2T,oBAAoB,QAASvT,KAAK0iC,WA7CjD,oBAoDI,SAAOx5B,EAAO2B,GAIV,GAHI7K,KAAKyS,KAAIzS,KAAK8/B,YAAc,GAC5B9/B,KAAKoiC,OAAMpiC,KAAK8/B,YAAc,GAEV,IAApB9/B,KAAK8/B,WAAT,CAEA,IAAIlB,EAAY5+B,KAAKiJ,WAAa,OAASC,GAC3C01B,EAAYl4B,OAAUC,MAAMi4B,EAAW,EAAG,GAE1C5+B,KAAKu+B,QAAQhK,OAASv0B,KAAK8/B,WAAalB,EAAY5+B,KAAK+9B,MAAQ70B,EAAQ,IAEzElJ,KAAK8/B,YAAc,EAAIlB,EACnB57B,KAAK+U,IAAI/X,KAAK8/B,YAAc,OAC5B9/B,KAAK8/B,WAAa,QAjE9B,K,gBAAa+C,G,OAEK,CACVX,GAAI,CACA,IAAIhB,GAAe,UAAWA,GAAeO,KAC7C,IAAIP,GAAe,OAAQA,GAAeO,KAC1C,IAAIP,GAAe,WAEvBiB,KAAM,CACF,IAAIjB,GAAe,YAAaA,GAAeO,KAC/C,IAAIP,GAAe,OAAQA,GAAeO,KAC1C,IAAIP,GAAe,eCXxB,IAAM4B,GAAb,WAoBI,WAAY7gC,EAAQ87B,EAAO90B,GAAW,qEAoD1B,SAAA2J,GACJsuB,GAAec,QAAf,MAAAd,GAAc,CAAStuB,GAAT,uBAAiBkwB,EAAkBb,KAAKI,UACtD,EAAK/5B,MAAO,EACZsK,EAAIJ,kBAEJ0uB,GAAec,QAAf,MAAAd,GAAc,CAAStuB,GAAT,uBAAiBkwB,EAAkBb,KAAKK,WACtD,EAAKC,OAAQ,EACb3vB,EAAIJ,qBA3D0B,gCAkE5B,SAAAI,GACFsuB,GAAesB,MAAf,MAAAtB,GAAc,CAAOtuB,GAAP,uBAAekwB,EAAkBb,KAAKI,UACpD,EAAK/5B,MAAO,GAEZ44B,GAAesB,MAAf,MAAAtB,GAAc,CAAOtuB,GAAP,uBAAekwB,EAAkBb,KAAKK,WACpD,EAAKC,OAAQ,MAtEjBviC,KAAKiC,OAASA,EACdjC,KAAKu+B,QAAU,KAEfv+B,KAAK2/B,cAAgB,EAErB3/B,KAAKsI,MAAO,EACZtI,KAAKuiC,OAAQ,EAEbviC,KAAK+9B,MAAQA,EACb/9B,KAAKiJ,UAAYA,EA9BzB,6CAoCI,SAAMs1B,GACFv+B,KAAKu+B,QAAUA,EAEf3+B,OAAOwT,iBAAiB,UAAWpT,KAAKyiC,WACxC7iC,OAAOwT,iBAAiB,QAASpT,KAAK0iC,WAxC9C,kBA2CI,WACI9iC,OAAO2T,oBAAoB,UAAWvT,KAAKyiC,WAC3C7iC,OAAO2T,oBAAoB,QAASvT,KAAK0iC,WA7CjD,oBAoDI,SAAOx5B,EAAO2B,GAIV,GAHI7K,KAAKsI,OAAMtI,KAAK2/B,eAAiB,GACjC3/B,KAAKuiC,QAAOviC,KAAK2/B,eAAiB,GAEX,IAAvB3/B,KAAK2/B,cAAT,CAEA,IAAIf,EAAY5+B,KAAKiJ,WAAa,OAASC,GAC3C01B,EAAYl4B,OAAUC,MAAMi4B,EAAW,EAAG,GAE1C5+B,KAAKu+B,QAAQvrB,UAAYhT,KAAK2/B,cAAgBf,EAAY5+B,KAAK+9B,MAAQ70B,EAAQ,IAE/ElJ,KAAK2/B,eAAiB,EAAIf,EACtB57B,KAAK+U,IAAI/X,KAAK2/B,eAAiB,OAC/B3/B,KAAK2/B,cAAgB,QAjEjC,K,gBAAamD,G,OAEK,CACVT,KAAM,CACF,IAAInB,GAAe,YAAaA,GAAeO,KAC/C,IAAIP,GAAe,OAAQA,GAAeO,KAC1C,IAAIP,GAAe,WAEvBoB,MAAO,CACH,IAAIpB,GAAe,aAAcA,GAAeO,KAChD,IAAIP,GAAe,OAAQA,GAAeO,KAC1C,IAAIP,GAAe,UCXxB,IAAM6B,GAAb,WAkBI,WAAY9gC,EAAQ87B,EAAO90B,GAAW,qEAoD1B,SAAA2J,GACJsuB,GAAec,QAAf,MAAAd,GAAc,CAAStuB,GAAT,uBAAiBmwB,EAAgBd,KAAKe,QACpD,EAAKC,IAAK,EACVrwB,EAAIJ,kBAEJ0uB,GAAec,QAAf,MAAAd,GAAc,CAAStuB,GAAT,uBAAiBmwB,EAAgBd,KAAKiB,SACpD,EAAKC,KAAM,EACXvwB,EAAIJ,qBA3D0B,gCAkE5B,SAAAI,GACFsuB,GAAesB,MAAf,MAAAtB,GAAc,CAAOtuB,GAAP,uBAAemwB,EAAgBd,KAAKe,QAClD,EAAKC,IAAK,GAEV/B,GAAesB,MAAf,MAAAtB,GAAc,CAAOtuB,GAAP,uBAAemwB,EAAgBd,KAAKiB,SAClD,EAAKC,KAAM,MAtEfnjC,KAAKiC,OAASA,EACdjC,KAAKu+B,QAAU,KAEfv+B,KAAKs/B,UAAY,EAEjBt/B,KAAKijC,IAAK,EACVjjC,KAAKmjC,KAAM,EAEXnjC,KAAK+9B,MAAQA,EACb/9B,KAAKiJ,UAAYA,EA5BzB,6CAkCI,SAAMs1B,GACFv+B,KAAKu+B,QAAUA,EAEf3+B,OAAOwT,iBAAiB,UAAWpT,KAAKyiC,WACxC7iC,OAAOwT,iBAAiB,QAASpT,KAAK0iC,WAtC9C,kBAyCI,WACI9iC,OAAO2T,oBAAoB,UAAWvT,KAAKyiC,WAC3C7iC,OAAO2T,oBAAoB,QAASvT,KAAK0iC,WA3CjD,oBAkDI,SAAOx5B,EAAO2B,GAIV,GAHI7K,KAAKijC,KAAIjjC,KAAKs/B,WAAa,GAC3Bt/B,KAAKmjC,MAAKnjC,KAAKs/B,WAAa,GAET,IAAnBt/B,KAAKs/B,UAAT,CAEA,IAAIV,EAAY5+B,KAAKiJ,WAAa,OAASC,GAC3C01B,EAAYl4B,OAAUC,MAAMi4B,EAAW,EAAG,GAE1C5+B,KAAKu+B,QAAQ3b,UAAY5f,KAAKyyB,IAAI,IAAKz1B,KAAKs/B,UAAYV,EAAY5+B,KAAK+9B,MAAQ70B,EAAQ,KAEzFlJ,KAAKs/B,WAAa,EAAIV,EAClB57B,KAAK+U,IAAI/X,KAAKs/B,WAAa,OAC3Bt/B,KAAKs/B,UAAY,QA/D7B,K,gBAAayD,G,OAEK,CACVC,GAAI,CACA,IAAI9B,GAAe,aACnB,IAAIA,GAAe,WAEvBgC,IAAK,CACD,IAAIhC,GAAe,kBACnB,IAAIA,GAAe,WCTxB,IAAMkC,GAAb,WAUI,WAAYnhC,EAAQohC,EAAQtF,EAAO90B,GAAW,uEAsEhC,SAAA2J,GACc,UAApBA,EAAI0wB,cAER,EAAKpF,QAAS,EACd,EAAKC,cAAch0B,IAAI,EAAG,GAC1B,EAAKsqB,aAAatqB,IAAIyI,EAAIwM,OAAOrd,EAAG6Q,EAAIwM,OAAOld,OA3EL,oCAkFhC,SAAA0Q,GACV,GAAwB,UAApBA,EAAI0wB,YAAR,CAEA,IAAIxhC,EAAWshC,EAAkBhF,WAAWj0B,IAAIyI,EAAIwM,OAAOrd,EAAG6Q,EAAIwM,OAAOld,GAEtE,EAAKg8B,QACJ,EAAKC,cAAcxW,IAAI7lB,GAAU2U,IAAI,EAAKge,cAG9C,EAAKA,aAAa7Y,KAAK9Z,OA3FmB,kCAkGlC,SAAA8Q,GACgB,UAApBA,EAAI0wB,cAER,EAAKpF,QAAS,MArG4B,qDAwGf,WAC3B,EAAKG,wBAA2B,EAAI,EAAKp8B,OAAOu5B,aAAgB,EAAKv5B,OAAOu5B,YAAc,EAAKv5B,OAAOw5B,cACtG,EAAK6C,wBAA0B,EAAI,EAAKr8B,OAAOw5B,gBAzG/Cz7B,KAAKiC,OAASA,EACdjC,KAAKqjC,OAASA,EACdrjC,KAAKu+B,QAAU,KAEfv+B,KAAKk+B,QAAS,EACdl+B,KAAKy0B,aAAe,IAAInxB,OACxBtD,KAAKm+B,cAAgB,IAAI76B,OAEzBtD,KAAK+9B,MAAQA,EACb/9B,KAAKiJ,UAAYA,EAEjBjJ,KAAKq+B,wBAA0B,EAC/Br+B,KAAKs+B,wBAA0B,EAC/Bt+B,KAAKw+B,+BAxBb,6CA8BI,SAAMD,GACFv+B,KAAKu+B,QAAUA,EAEfv+B,KAAKqjC,OAAOpiC,GAAG,YAAajB,KAAKujC,aACjCvjC,KAAKqjC,OAAOpiC,GAAG,WAAYjB,KAAKwjC,aAChCxjC,KAAKqjC,OAAOpiC,GAAG,UAAWjB,KAAKyjC,WAC/BzjC,KAAKqjC,OAAOpiC,GAAG,aAAcjB,KAAKyjC,WAElC7jC,OAAOwT,iBAAiB,SAAUpT,KAAKw+B,gCAtC/C,kBAyCI,WACIx+B,KAAKqjC,OAAOK,IAAI,YAAa1jC,KAAKujC,aAClCvjC,KAAKqjC,OAAOK,IAAI,WAAY1jC,KAAKwjC,aACjCxjC,KAAKqjC,OAAOK,IAAI,UAAW1jC,KAAKyjC,WAChCzjC,KAAKqjC,OAAOK,IAAI,aAAc1jC,KAAKyjC,WAEnC7jC,OAAO2T,oBAAoB,SAAUvT,KAAKw+B,gCA/ClD,oBAsDI,SAAOt1B,EAAO2B,GACV,GAA6B,IAAzB7K,KAAKm+B,cAAcp8B,GAAoC,IAAzB/B,KAAKm+B,cAAcj8B,EAArD,CAEA,IAAI08B,EAAY5+B,KAAKiJ,WAAa,OAASC,GAC3C01B,EAAYl4B,OAAUC,MAAMi4B,EAAW,EAAG,GAE1C,IAAIC,EAAiBuE,EAAkBhF,WAAWxiB,KAAK5b,KAAKm+B,eAC5DU,EAAeC,aAAaz7B,EAAWrD,KAAKu+B,QAAQvrB,UAEpDhT,KAAKu+B,QAAQz8B,SAASC,GAAK88B,EAAe98B,EAAI68B,EAAY5+B,KAAKu+B,QAAQ3b,SAAW5iB,KAAK+9B,MAAQ/9B,KAAKq+B,wBACpGr+B,KAAKu+B,QAAQz8B,SAASK,GAAK08B,EAAe38B,EAAI08B,EAAY5+B,KAAKu+B,QAAQ3b,SAAW5iB,KAAK+9B,MAAQ/9B,KAAKs+B,wBAEpGt+B,KAAKm+B,cAAcrc,eAAe,EAAI8c,GAClC5+B,KAAKm+B,cAAcY,WAAa,MAChC/+B,KAAKm+B,cAAch0B,IAAI,EAAG,MApEtC,mBAwEI,WACInK,KAAKm+B,cAAch0B,IAAI,EAAG,OAzElC,K,gBAAai5B,G,aAEW,IAAI9/B,QCHrB,IAAMqgC,GAAb,WAOI,WAAYN,EAAQtF,EAAO90B,GAAW,uEAyDxB,SAAA2J,GACV,EAAKsrB,QAAS,EACd,EAAKyB,cAAgB,EACrB,EAAKjL,aAAe9hB,EAAII,YA5DU,oCAmExB,SAAAJ,GACV,GAAG,EAAKsrB,OAAO,CACX,IAAIh1B,EAAQ0J,EAAII,SAAW,EAAK0hB,aAC5BxrB,EAAQ,MAAKA,GAAS,KACtBA,GAAS,MAAKA,GAAS,KAE3B,EAAKy2B,eAAiBz2B,EAG1B,EAAKwrB,aAAe9hB,EAAII,YA5EU,kCAmF1B,SAAAJ,GACR,EAAKsrB,QAAS,KAnFdl+B,KAAKqjC,OAASA,EACdrjC,KAAKu+B,QAAU,KAEfv+B,KAAKk+B,QAAS,EACdl+B,KAAK00B,aAAe,EACpB10B,KAAK2/B,cAAgB,EAErB3/B,KAAK+9B,MAAQA,EACb/9B,KAAKiJ,UAAYA,EAhBzB,6CAsBI,SAAMs1B,GACFv+B,KAAKu+B,QAAUA,EAEfv+B,KAAKqjC,OAAOpiC,GAAG,cAAejB,KAAKujC,aACnCvjC,KAAKqjC,OAAOpiC,GAAG,aAAcjB,KAAKwjC,aAClCxjC,KAAKqjC,OAAOpiC,GAAG,YAAajB,KAAKyjC,WACjCzjC,KAAKqjC,OAAOpiC,GAAG,eAAgBjB,KAAKyjC,aA5B5C,kBA+BI,WACIzjC,KAAKqjC,OAAOK,IAAI,cAAe1jC,KAAKujC,aACpCvjC,KAAKqjC,OAAOK,IAAI,aAAc1jC,KAAKwjC,aACnCxjC,KAAKqjC,OAAOK,IAAI,YAAa1jC,KAAKyjC,WAClCzjC,KAAKqjC,OAAOK,IAAI,eAAgB1jC,KAAKyjC,aAnC7C,oBA0CI,SAAOv6B,EAAO2B,GACV,GAA2B,IAAvB7K,KAAK2/B,cAAT,CAEA,IAAIf,EAAY5+B,KAAKiJ,WAAa,OAASC,GAC3C01B,EAAYl4B,OAAUC,MAAMi4B,EAAW,EAAG,GAE1C5+B,KAAKu+B,QAAQvrB,UAAYhT,KAAK2/B,cAAgBf,EAAY5+B,KAAK+9B,MAE/D/9B,KAAK2/B,eAAiB,EAAIf,EACtB57B,KAAK+U,IAAI/X,KAAK2/B,eAAiB,OAC/B3/B,KAAK2/B,cAAgB,MApDjC,mBAwDI,WACI3/B,KAAK2/B,cAAgB,MAzD7B,KCAaiE,GAAb,WAQI,WAAY3hC,EAAQohC,EAAQtF,EAAO90B,GAAW,uEAiEhC,SAAA2J,GACV,EAAKsrB,QAAS,EACd,EAAK4B,WAAa,EAClB,EAAKC,MAAQntB,EAAIwM,OAAOld,KApEkB,oCA2EhC,SAAA0Q,GACP,EAAKsrB,SACJ,EAAK4B,YAAcltB,EAAIwM,OAAOld,EAAI,EAAK69B,OAG3C,EAAKA,MAAQntB,EAAIwM,OAAOld,KAhFkB,kCAuFlC,SAAA0Q,GACR,EAAKsrB,QAAS,KAxF4B,qDA2Ff,WAC3B,EAAKI,wBAA0B,EAAI,EAAKr8B,OAAOw5B,gBA3F/Cz7B,KAAKiC,OAASA,EACdjC,KAAKqjC,OAASA,EACdrjC,KAAKu+B,QAAU,KAEfv+B,KAAKk+B,QAAS,EACdl+B,KAAK+/B,MAAQ,EACb//B,KAAK8/B,WAAa,EAElB9/B,KAAK+9B,MAAQA,EACb/9B,KAAKiJ,UAAYA,EAEjBjJ,KAAKs+B,wBAA0B,EAC/Bt+B,KAAKw+B,+BArBb,6CA2BI,SAAMD,GACFv+B,KAAKu+B,QAAUA,EAEfv+B,KAAKqjC,OAAOpiC,GAAG,YAAajB,KAAKujC,aACjCvjC,KAAKqjC,OAAOpiC,GAAG,WAAYjB,KAAKwjC,aAChCxjC,KAAKqjC,OAAOpiC,GAAG,UAAWjB,KAAKyjC,WAC/BzjC,KAAKqjC,OAAOpiC,GAAG,aAAcjB,KAAKyjC,WAElC7jC,OAAOwT,iBAAiB,SAAUpT,KAAKw+B,gCAnC/C,kBAsCI,WACIx+B,KAAKqjC,OAAOK,IAAI,YAAa1jC,KAAKujC,aAClCvjC,KAAKqjC,OAAOK,IAAI,WAAY1jC,KAAKwjC,aACjCxjC,KAAKqjC,OAAOK,IAAI,UAAW1jC,KAAKyjC,WAChCzjC,KAAKqjC,OAAOK,IAAI,aAAc1jC,KAAKyjC,WAEnC7jC,OAAO2T,oBAAoB,SAAUvT,KAAKw+B,gCA5ClD,oBAmDI,SAAOt1B,EAAO2B,GACV,GAAwB,IAApB7K,KAAK8/B,WAAT,CAEA,IAAIlB,EAAY5+B,KAAKiJ,WAAa,OAASC,GAC3C01B,EAAYl4B,OAAUC,MAAMi4B,EAAW,EAAG,GAE1C5+B,KAAKu+B,QAAQhK,OAASv0B,KAAK8/B,WAAalB,EAAY5+B,KAAK+9B,MAAQ/9B,KAAKs+B,wBAEtEt+B,KAAK8/B,YAAc,EAAIlB,EACnB57B,KAAK+U,IAAI/X,KAAK8/B,YAAc,OAC5B9/B,KAAK8/B,WAAa,MA7D9B,mBAiEI,WACI9/B,KAAK8/B,WAAa,MAlE1B,KCFa+D,GAAb,WAKI,WAAYR,GAAQ,uEA+CN,SAAAzwB,GACV,EAAKsrB,QAAS,EACd,EAAK4F,SAAW,KAjDA,oCAwDN,SAAAlxB,GACP,EAAKsrB,SACJ,EAAKoB,WAAa1sB,EAAI4G,MAAQ,EAAKsqB,UAGvC,EAAKA,SAAWlxB,EAAI4G,SA7DJ,kCAoER,SAAA5G,GACR,EAAKsrB,QAAS,KApEdl+B,KAAKqjC,OAASA,EACdrjC,KAAKu+B,QAAU,KAEfv+B,KAAKk+B,QAAS,EACdl+B,KAAKs/B,UAAY,EACjBt/B,KAAK8jC,SAAW,EAXxB,6CAiBI,SAAMvF,GACFv+B,KAAKu+B,QAAUA,EAEfv+B,KAAKqjC,OAAOpiC,GAAG,YAAajB,KAAKujC,aACjCvjC,KAAKqjC,OAAOpiC,GAAG,WAAYjB,KAAKwjC,aAChCxjC,KAAKqjC,OAAOpiC,GAAG,UAAWjB,KAAKyjC,WAC/BzjC,KAAKqjC,OAAOpiC,GAAG,aAAcjB,KAAKyjC,aAvB1C,kBA0BI,WACIzjC,KAAKqjC,OAAOK,IAAI,YAAa1jC,KAAKujC,aAClCvjC,KAAKqjC,OAAOK,IAAI,WAAY1jC,KAAKwjC,aACjCxjC,KAAKqjC,OAAOK,IAAI,UAAW1jC,KAAKyjC,WAChCzjC,KAAKqjC,OAAOK,IAAI,aAAc1jC,KAAKyjC,aA9B3C,oBAqCI,SAAOv6B,EAAO2B,GACa,IAAnB7K,KAAKs/B,YAETt/B,KAAKu+B,QAAQ3b,UAAY5iB,KAAKs/B,UAC9Bt/B,KAAKs/B,UAAY,KAzCzB,mBA4CI,WACIt/B,KAAKs/B,UAAY,MA7CzB,KCkBMyE,GAAoB,GAAV/gC,KAAKgoB,GAERgZ,GAAb,WAOI,WAAYzI,GAAa,yEA8LT,SAAA3oB,GACZA,EAAIJ,oBA/LiB,8BAkMjB,SAAAI,GACJ,IAAIgS,GAAY,EACZxF,EAAS,IAAI9b,OAAQsP,EAAIwM,OAAOrd,EAAG6Q,EAAIwM,OAAOld,GAE9C2iB,EAAMC,KAAKD,MACX,EAAKof,QAAU,GAAK,EAAKC,eAAiBrf,EAAM,EAAKof,QAAU,KAAO,EAAKC,cAAc1jB,WAAWpB,GAAU,GAC9GwF,GAAY,EACZ,EAAKqf,SAAW,IAEhB,EAAKA,QAAUpf,EACf,EAAKqf,cAAgB9kB,GAGzB,EAAKmf,QAAQpI,qBAAqB,IAAI7yB,OAAQsP,EAAIwM,OAAOrd,EAAG6Q,EAAIwM,OAAOld,GAAI,CAAC0iB,UAAWA,OA9MvF5kB,KAAKu7B,YAAcA,EAEnBv7B,KAAK9D,KAAO,CACR4U,gBAAiB,MAIrB9Q,KAAKu+B,QAAU,KAEfv+B,KAAKqjC,OAAS,IAAIc,cAAQnkC,KAAKu7B,aAC/Bv7B,KAAKokC,mBAGLpkC,KAAKqkC,UAAY,IAAIvG,GAAkB99B,KAAKu7B,YAAa,IAAI,IAC7Dv7B,KAAKskC,YAAc,IAAI7E,GAAoBz/B,KAAKu7B,YAAa,EAAG,IAChEv7B,KAAKukC,WAAa,IAAI1E,GAAmB7/B,KAAKu7B,YAAa,EAAG,IAC9Dv7B,KAAKwkC,UAAY,IAAIxF,GAAkBh/B,KAAKu7B,YAAa,EAAG,IAE5Dv7B,KAAKykC,QAAU,IAAI1C,GAAgB/hC,KAAKu7B,YAAa,KAAO,IAC5Dv7B,KAAK0kC,UAAY,IAAI5B,GAAkB9iC,KAAKu7B,YAAa,IAAM,KAC/Dv7B,KAAK2kC,SAAW,IAAI9B,GAAiB7iC,KAAKu7B,YAAa,IAAM,KAC7Dv7B,KAAK4kC,QAAU,IAAI7B,GAAgB/iC,KAAKu7B,YAAa,GAAK,KAE1Dv7B,KAAK6kC,UAAY,IAAIzB,GAAkBpjC,KAAKu7B,YAAav7B,KAAKqjC,OAAQ,IAAI,IAC1ErjC,KAAK8kC,YAAc,IAAInB,GAAoB3jC,KAAKqjC,OAAQ,SAAW,IACnErjC,KAAK+kC,WAAa,IAAInB,GAAmB5jC,KAAKu7B,YAAav7B,KAAKqjC,OAAQ,EAAG,IAC3ErjC,KAAKglC,UAAY,IAAInB,GAAkB7jC,KAAKqjC,QAE5CrjC,KAAKilC,UAAY,IAAIjF,GAAkB,GAAK,IAE5ChgC,KAAKikC,SAAW,EAChBjkC,KAAKkkC,cAAgB,KAvC7B,6CA6CI,SAAM3F,GACFv+B,KAAKu+B,QAAUA,EAEfv+B,KAAKu7B,YAAYnoB,iBAAiB,cAAepT,KAAKklC,eACtDllC,KAAKqjC,OAAOpiC,GAAG,MAAOjB,KAAKmlC,OAE3BnlC,KAAKqkC,UAAUnnB,MAAMqhB,GACrBv+B,KAAKskC,YAAYpnB,MAAMqhB,GACvBv+B,KAAKukC,WAAWrnB,MAAMqhB,GACtBv+B,KAAKwkC,UAAUtnB,MAAMqhB,GAErBv+B,KAAKykC,QAAQvnB,MAAMqhB,GACnBv+B,KAAK0kC,UAAUxnB,MAAMqhB,GACrBv+B,KAAK2kC,SAASznB,MAAMqhB,GACpBv+B,KAAK4kC,QAAQ1nB,MAAMqhB,GAEnBv+B,KAAK6kC,UAAU3nB,MAAMqhB,GACrBv+B,KAAK8kC,YAAY5nB,MAAMqhB,GACvBv+B,KAAK+kC,WAAW7nB,MAAMqhB,GACtBv+B,KAAKglC,UAAU9nB,MAAMqhB,GAErBv+B,KAAKilC,UAAU/nB,MAAMqhB,KAlE7B,kBAqEI,WACIv+B,KAAKolC,4BAELplC,KAAKu7B,YAAYhoB,oBAAoB,cAAevT,KAAKklC,eACzDllC,KAAKqjC,OAAOK,IAAI,MAAO1jC,KAAKmlC,OAE5BnlC,KAAKqkC,UAAUhO,OACfr2B,KAAKskC,YAAYjO,OACjBr2B,KAAKukC,WAAWlO,OAChBr2B,KAAKwkC,UAAUnO,OAEfr2B,KAAKykC,QAAQpO,OACbr2B,KAAK0kC,UAAUrO,OACfr2B,KAAK2kC,SAAStO,OACdr2B,KAAK4kC,QAAQvO,OAEbr2B,KAAK6kC,UAAUxO,OACfr2B,KAAK8kC,YAAYzO,OACjBr2B,KAAK+kC,WAAW1O,OAChBr2B,KAAKglC,UAAU3O,OAEfr2B,KAAKilC,UAAU5O,SA1FvB,oBAiGI,SAAOntB,EAAO2B,GACV7K,KAAKu+B,QAAQz8B,SAASI,EAAI,EAG1B8hC,EAAYqB,gBAAgBzpB,KAAK5b,KAAKu+B,QAAQz8B,UAC9C9B,KAAKqkC,UAAUrW,OAAO9kB,EAAO2B,GAC7B7K,KAAKykC,QAAQzW,OAAO9kB,EAAO2B,GAC3B7K,KAAK6kC,UAAU7W,OAAO9kB,EAAO2B,GAGzB7K,KAAK9D,KAAK4U,kBAAoBkzB,EAAYqB,gBAAgBjP,OAAOp2B,KAAKu+B,QAAQz8B,WAC9E9B,KAAKolC,4BAILplC,KAAK9D,KAAK4U,iBACV9Q,KAAKu+B,QAAQz8B,SAAS8Z,KAAK5b,KAAK9D,KAAK4U,gBAAgBhP,UAIzD9B,KAAKwkC,UAAUxW,OAAO9kB,EAAO2B,GAC7B7K,KAAK4kC,QAAQ5W,OAAO9kB,EAAO2B,GAC3B7K,KAAKglC,UAAUhX,OAAO9kB,EAAO2B,GAE7B7K,KAAKu+B,QAAQ3b,SAAWvZ,EAAUrJ,KAAKu+B,QAAQ3b,SAAU,EAAG,IAAO,IAGnE,IAAI0iB,EAAkBtlC,KAAKulC,kCAAkCvlC,KAAKu+B,QAAQ3b,UAG/C,IAAvB5iB,KAAKu+B,QAAQzJ,QACb90B,KAAKskC,YAAYtW,OAAO9kB,EAAO2B,GAC/B7K,KAAK0kC,UAAU1W,OAAO9kB,EAAO2B,GAC7B7K,KAAK8kC,YAAY9W,OAAO9kB,EAAO2B,IAIR,IAAvB7K,KAAKu+B,QAAQzJ,QACb90B,KAAKukC,WAAWvW,OAAO9kB,EAAO2B,GAC9B7K,KAAK2kC,SAAS3W,OAAO9kB,EAAO2B,GAC5B7K,KAAK+kC,WAAW/W,OAAO9kB,EAAO2B,GAC9B7K,KAAKu+B,QAAQhK,MAAQlrB,EAAUrJ,KAAKu+B,QAAQhK,MAAO,EAAG+Q,EAAiB,KAIhD,IAAvBtlC,KAAKu+B,QAAQzJ,OAAsC,IAAvB90B,KAAKu+B,QAAQhK,QACzCv0B,KAAKilC,UAAU9E,SAAWmF,EAC1BtlC,KAAKilC,UAAUjX,OAAO9kB,EAAO2B,MAhJzC,mBAoJI,WACI7K,KAAKqkC,UAAUmB,QACfxlC,KAAKskC,YAAYkB,QACjBxlC,KAAKukC,WAAWiB,QAChBxlC,KAAKwkC,UAAUgB,QAEfxlC,KAAK6kC,UAAUW,QACfxlC,KAAK8kC,YAAYU,QACjBxlC,KAAK+kC,WAAWS,QAChBxlC,KAAKglC,UAAUQ,UA7JvB,+CAgKI,SAAkC5iB,GAC9B,OAAOlc,OAAUC,OAAO,EAAI3D,KAAKyyB,IAAIzyB,KAAKoG,IAAIwZ,EAAW,EAAG,MAAS,IAAK,KAAQmhB,GAAQ,EAAGA,MAjKrG,8BAoKI,WACI,IAAI0B,EAAW,IAAIC,UAAI,CAAE/gC,MAAO,MAAOghC,SAAU,EAAGC,KAAM,EAAGvkB,UAAW,IACpEwjB,EAAY,IAAIgB,UAAI,CAAElhC,MAAO,OAAQghC,SAAU,EAAGG,UAAWC,oBAAe1kB,UAAW,IACvF2kB,EAAa,IAAIH,UAAI,CAAElhC,MAAO,OAAQghC,SAAU,EAAGG,UAAWG,yBAAoB5kB,UAAW,IAC7FyjB,EAAc,IAAIoB,aAAO,CAAEvhC,MAAO,SAAUghC,SAAU,EAAGtkB,UAAW,IACpE2jB,EAAY,IAAImB,YAAM,CAAExhC,MAAO,OAAQghC,SAAU,EAAGtkB,UAAW,IAEnEwjB,EAAUuB,cAActB,GACxBD,EAAUuB,cAAcJ,GACxBnB,EAAUuB,cAAcpB,GACxBgB,EAAUI,cAActB,GACxBkB,EAAUI,cAAcpB,GACxBF,EAAYsB,cAAcpB,GAE1BhlC,KAAKqjC,OAAO5sB,IAAIgvB,GAChBzlC,KAAKqjC,OAAO5sB,IAAIuvB,GAChBhmC,KAAKqjC,OAAO5sB,IAAIouB,GAChB7kC,KAAKqjC,OAAO5sB,IAAIquB,GAChB9kC,KAAKqjC,OAAO5sB,IAAIuuB,KAtLxB,gCA4LI,SAAmB93B,GACXA,EAAOqjB,iBAAgBrjB,EAASA,EAAOhR,MAC3C8D,KAAK9D,KAAK4U,gBAAkB5D,IA9LpC,uCAiMI,WACIlN,KAAK9D,KAAK4U,gBAAkB,SAlMpC,K,gBAAakzB,G,kBAEgB,IAAIxgC,QClB1B,IAAMu+B,GAAb,WA4BI,WAAY9/B,EAAQ87B,EAAO90B,GAAW,qEA4D1B,SAAA2J,GACJsuB,GAAesB,MAAf,MAAAtB,GAAc,CAAOtuB,GAAP,uBAAemvB,EAAgBE,KAAKC,QAClD,EAAKzvB,IAAK,EACVG,EAAIJ,kBAEJ0uB,GAAesB,MAAf,MAAAtB,GAAc,CAAOtuB,GAAP,uBAAemvB,EAAgBE,KAAKE,UAClD,EAAKC,MAAO,EACZxvB,EAAIJ,kBAEJ0uB,GAAesB,MAAf,MAAAtB,GAAc,CAAOtuB,GAAP,uBAAemvB,EAAgBE,KAAKI,UAClD,EAAK/5B,MAAO,EACZsK,EAAIJ,kBAEJ0uB,GAAesB,MAAf,MAAAtB,GAAc,CAAOtuB,GAAP,uBAAemvB,EAAgBE,KAAKK,WAClD,EAAKC,OAAQ,EACb3vB,EAAIJ,qBA3E0B,gCAkF5B,SAAAI,GACFsuB,GAAesB,MAAf,MAAAtB,GAAc,CAAOtuB,GAAP,uBAAemvB,EAAgBE,KAAKC,QAClD,EAAKzvB,IAAK,GAEVyuB,GAAesB,MAAf,MAAAtB,GAAc,CAAOtuB,GAAP,uBAAemvB,EAAgBE,KAAKE,UAClD,EAAKC,MAAO,GAEZlB,GAAesB,MAAf,MAAAtB,GAAc,CAAOtuB,GAAP,uBAAemvB,EAAgBE,KAAKI,UAClD,EAAK/5B,MAAO,GAEZ44B,GAAesB,MAAf,MAAAtB,GAAc,CAAOtuB,GAAP,uBAAemvB,EAAgBE,KAAKK,WAClD,EAAKC,OAAQ,MA5FjBviC,KAAKiC,OAASA,EACdjC,KAAKu+B,QAAU,KAEfv+B,KAAKm+B,cAAgB,IAAI76B,OAEzBtD,KAAKyS,IAAK,EACVzS,KAAKoiC,MAAO,EACZpiC,KAAKsI,MAAO,EACZtI,KAAKuiC,OAAQ,EAEbviC,KAAK+9B,MAAQA,EACb/9B,KAAKiJ,UAAYA,EAxCzB,6CA8CI,SAAMs1B,GACFv+B,KAAKu+B,QAAUA,EAEf3+B,OAAOwT,iBAAiB,UAAWpT,KAAKyiC,WACxC7iC,OAAOwT,iBAAiB,QAASpT,KAAK0iC,WAlD9C,kBAqDI,WACI9iC,OAAO2T,oBAAoB,UAAWvT,KAAKyiC,WAC3C7iC,OAAO2T,oBAAoB,QAASvT,KAAK0iC,WAvDjD,oBA8DI,SAAOx5B,EAAO2B,GAMV,GALI7K,KAAKyS,KAAIzS,KAAKm+B,cAAcj8B,GAAK,GACjClC,KAAKoiC,OAAMpiC,KAAKm+B,cAAcj8B,GAAK,GACnClC,KAAKsI,OAAMtI,KAAKm+B,cAAcp8B,GAAK,GACnC/B,KAAKuiC,QAAOviC,KAAKm+B,cAAcp8B,GAAK,GAEX,IAAzB/B,KAAKm+B,cAAcp8B,GAAoC,IAAzB/B,KAAKm+B,cAAcj8B,EAArD,CAEA,IAAI08B,EAAY5+B,KAAKiJ,WAAa,OAASC,GAC3C01B,EAAYl4B,OAAUC,MAAMi4B,EAAW,EAAG,GAE1C,IAAI+D,EAAeZ,EAAgBa,QAAQhnB,KAAK5b,KAAKm+B,eACrDwE,EAAa7D,aAAaz7B,EAAWrD,KAAKu+B,QAAQvrB,UAElDhT,KAAKu+B,QAAQz8B,SAASC,GAAK4gC,EAAa5gC,EAAI68B,EAAY5+B,KAAK+9B,MAAQ70B,EAAQ,IAC7ElJ,KAAKu+B,QAAQz8B,SAASK,GAAKwgC,EAAazgC,EAAI08B,EAAY5+B,KAAK+9B,MAAQ70B,EAAQ,IAE7ElJ,KAAKm+B,cAAcrc,eAAe,EAAI8c,GAClC5+B,KAAKm+B,cAAcY,WAAa,MAChC/+B,KAAKm+B,cAAch0B,IAAI,EAAG,QAjFtC,K,gBAAa43B,G,OAEK,CACVM,KAAM,CACF,IAAInB,GAAe,aACnB,IAAIA,GAAe,SAEvBgB,GAAI,CACA,IAAIhB,GAAe,WACnB,IAAIA,GAAe,SAEvBoB,MAAO,CACH,IAAIpB,GAAe,cACnB,IAAIA,GAAe,SAEvBiB,KAAM,CACF,IAAIjB,GAAe,aACnB,IAAIA,GAAe,W,gBAjBlBa,G,UAqBQ,IAAIz+B,QCvBlB,IAAMm8B,GAAb,WASI,WAAYx9B,EAAQokC,EAAWC,EAAYC,EAAct9B,GAAW,uEAgEtD,SAAA2J,GACV,EAAKsrB,QAAS,EACd,EAAKyB,cAAgB,EACrB,EAAKC,MAAQhtB,EAAI7Q,KAnE+C,oCA0EtD,SAAA6Q,GACNjP,SAAS6iC,mBACT,EAAK7G,eAAiB/sB,EAAI6zB,UAAY,EAAKF,aAAe,EAAKG,uBAG3D,EAAKxI,SACW,IAAhBtrB,EAAIorB,QACJ,EAAK2B,gBAAkB/sB,EAAI7Q,EAAI,EAAK69B,OAAS,EAAKyG,UAAY,EAAKK,uBAEnE,EAAK/G,gBAAkB/sB,EAAI7Q,EAAI,EAAK69B,OAAS,EAAK0G,WAAa,EAAKI,wBAI5E,EAAK9G,MAAQhtB,EAAI7Q,KAvF+C,kCA8FxD,SAAA6Q,GACR,EAAKsrB,QAAS,KA/FkD,qDAkGrC,WAC3B,EAAKwI,uBAA0B,EAAI,EAAKzkC,OAAOu5B,aAAgB,EAAKv5B,OAAOu5B,YAAc,EAAKv5B,OAAOw5B,iBAlGrGz7B,KAAKiC,OAASA,EACdjC,KAAKu+B,QAAU,KAEfv+B,KAAKk+B,QAAS,EACdl+B,KAAK4/B,MAAQ,EACb5/B,KAAK2/B,cAAgB,EAErB3/B,KAAKqmC,UAAYA,EACjBrmC,KAAKsmC,WAAaA,EAClBtmC,KAAKumC,aAAeA,EACpBvmC,KAAKiJ,UAAYA,EAEjBjJ,KAAK0mC,uBAAyB,EAC9B1mC,KAAKw+B,+BAvBb,6CA6BI,SAAMD,GACFv+B,KAAKu+B,QAAUA,EAEfv+B,KAAKiC,OAAOmR,iBAAiB,YAAapT,KAAKy+B,aAC/C7+B,OAAOwT,iBAAiB,YAAapT,KAAK0+B,aAC1C9+B,OAAOwT,iBAAiB,UAAWpT,KAAK2+B,WAExC/+B,OAAOwT,iBAAiB,SAAUpT,KAAKw+B,gCApC/C,kBAuCI,WACIx+B,KAAKiC,OAAOsR,oBAAoB,YAAavT,KAAKy+B,aAClD7+B,OAAO2T,oBAAoB,YAAavT,KAAK0+B,aAC7C9+B,OAAO2T,oBAAoB,UAAWvT,KAAK2+B,WAE3C/+B,OAAO2T,oBAAoB,SAAUvT,KAAKw+B,gCA5ClD,oBAmDI,SAAOt1B,EAAO2B,GACV,GAA2B,IAAvB7K,KAAK2/B,cAAT,CAEA,IAAIf,EAAY5+B,KAAKiJ,WAAa,OAASC,GAC3C01B,EAAYl4B,OAAUC,MAAMi4B,EAAW,EAAG,GAE1C5+B,KAAKu+B,QAAQvrB,UAAYhT,KAAK2/B,cAAgBf,EAE9C5+B,KAAK2/B,eAAiB,EAAIf,EACtB57B,KAAK+U,IAAI/X,KAAK2/B,eAAiB,OAC/B3/B,KAAK2/B,cAAgB,MA7DjC,mBAiEI,WACI3/B,KAAK2/B,cAAgB,MAlE7B,KCAaE,GAAb,WASI,WAAY59B,EAAQokC,EAAWC,EAAYC,EAAct9B,GAAW,uEAgEtD,SAAA2J,GACV,EAAKsrB,QAAS,EACd,EAAK4B,WAAa,EAClB,EAAKC,MAAQntB,EAAI1Q,KAnE+C,oCA0EtD,SAAA0Q,GACNjP,SAAS6iC,mBACT,EAAK1G,YAAcltB,EAAI+zB,UAAY,EAAKJ,aAAe,EAAKG,uBAGxD,EAAKxI,SACW,IAAhBtrB,EAAIorB,QACJ,EAAK8B,aAAeltB,EAAI1Q,EAAI,EAAK69B,OAAS,EAAKsG,UAAY,EAAKK,uBAEhE,EAAK5G,aAAeltB,EAAI1Q,EAAI,EAAK69B,OAAS,EAAKuG,WAAa,EAAKI,wBAIzE,EAAK3G,MAAQntB,EAAI1Q,KAvF+C,kCA8FxD,SAAA0Q,GACR,EAAKsrB,QAAS,KA/FkD,qDAkGrC,WAC3B,EAAKwI,uBAAyB,EAAI,EAAKzkC,OAAOw5B,gBAlG9Cz7B,KAAKiC,OAASA,EACdjC,KAAKu+B,QAAU,KAEfv+B,KAAKk+B,QAAS,EACdl+B,KAAK+/B,MAAQ,EACb//B,KAAK8/B,WAAa,EAElB9/B,KAAKqmC,UAAYA,EACjBrmC,KAAKsmC,WAAaA,EAClBtmC,KAAKumC,aAAeA,EACpBvmC,KAAKiJ,UAAYA,EAEjBjJ,KAAK0mC,uBAAyB,EAC9B1mC,KAAKw+B,+BAvBb,6CA6BI,SAAMD,GACFv+B,KAAKu+B,QAAUA,EAEfv+B,KAAKiC,OAAOmR,iBAAiB,YAAapT,KAAKy+B,aAC/C7+B,OAAOwT,iBAAiB,YAAapT,KAAK0+B,aAC1C9+B,OAAOwT,iBAAiB,UAAWpT,KAAK2+B,WAExC/+B,OAAOwT,iBAAiB,SAAUpT,KAAKw+B,gCApC/C,kBAuCI,WACIx+B,KAAKiC,OAAOsR,oBAAoB,YAAavT,KAAKy+B,aAClD7+B,OAAO2T,oBAAoB,YAAavT,KAAK0+B,aAC7C9+B,OAAO2T,oBAAoB,UAAWvT,KAAK2+B,WAE3C/+B,OAAO2T,oBAAoB,SAAUvT,KAAKw+B,gCA5ClD,oBAmDI,SAAOt1B,EAAO2B,GACV,GAAwB,IAApB7K,KAAK8/B,WAAT,CAEA,IAAIlB,EAAY5+B,KAAKiJ,WAAa,OAASC,GAC3C01B,EAAYl4B,OAAUC,MAAMi4B,EAAW,EAAG,GAE1C5+B,KAAKu+B,QAAQhK,OAASv0B,KAAK8/B,WAAalB,EAExC5+B,KAAK8/B,YAAc,EAAIlB,EACnB57B,KAAK+U,IAAI/X,KAAK8/B,YAAc,OAC5B9/B,KAAK8/B,WAAa,MA7D9B,mBAiEI,WACI9/B,KAAK8/B,WAAa,MAlE1B,KCCa8G,GAAb,WAmBI,WAAY3kC,EAAQ87B,EAAO90B,GAAW,qEAoD1B,SAAA2J,GACJsuB,GAAesB,MAAf,MAAAtB,GAAc,CAAOtuB,GAAP,uBAAeg0B,EAAkB3E,KAAKC,OACpD,EAAKzvB,IAAK,EACVG,EAAIJ,kBAEC0uB,GAAesB,MAAf,MAAAtB,GAAc,CAAOtuB,GAAP,uBAAeg0B,EAAkB3E,KAAKE,UACzD,EAAKC,MAAO,EACZxvB,EAAIJ,qBA3D0B,gCAkE5B,SAAAI,GACFsuB,GAAesB,MAAf,MAAAtB,GAAc,CAAOtuB,GAAP,uBAAeg0B,EAAkB3E,KAAKC,QACpD,EAAKzvB,IAAK,GAEVyuB,GAAesB,MAAf,MAAAtB,GAAc,CAAOtuB,GAAP,uBAAeg0B,EAAkB3E,KAAKE,UACpD,EAAKC,MAAO,MAtEhBpiC,KAAKiC,OAASA,EACdjC,KAAKu+B,QAAU,KAEfv+B,KAAKi/B,OAAS,EAEdj/B,KAAKyS,IAAK,EACVzS,KAAKoiC,MAAO,EAEZpiC,KAAK+9B,MAAQA,EACb/9B,KAAKiJ,UAAYA,EA7BzB,6CAmCI,SAAMs1B,GACFv+B,KAAKu+B,QAAUA,EAEf3+B,OAAOwT,iBAAiB,UAAWpT,KAAKyiC,WACxC7iC,OAAOwT,iBAAiB,QAASpT,KAAK0iC,WAvC9C,kBA0CI,WACI9iC,OAAO2T,oBAAoB,UAAWvT,KAAKyiC,WAC3C7iC,OAAO2T,oBAAoB,QAASvT,KAAK0iC,WA5CjD,oBAmDI,SAAOx5B,EAAO2B,GAIV,GAHI7K,KAAKyS,KAAIzS,KAAKi/B,QAAU,GACxBj/B,KAAKoiC,OAAMpiC,KAAKi/B,QAAU,GAEV,IAAhBj/B,KAAKi/B,OAAT,CAEA,IAAIL,EAAY5+B,KAAKiJ,WAAa,OAASC,GAC3C01B,EAAYl4B,OAAUC,MAAMi4B,EAAW,EAAG,GAE1C5+B,KAAKu+B,QAAQz8B,SAASI,GAAKlC,KAAKi/B,OAASL,EAAY5+B,KAAK+9B,MAAQ70B,EAAQ,IAE1ElJ,KAAKi/B,QAAU,EAAIL,EACf57B,KAAK+U,IAAI/X,KAAKi/B,QAAU,OACxBj/B,KAAKi/B,OAAS,QAhE1B,K,gBAAa2H,G,OAEK,CACV1E,GAAI,CACA,IAAIhB,GAAe,SACnB,IAAIA,GAAe,WAEvBiB,KAAM,CACF,IAAIjB,GAAe,aACnB,IAAIA,GAAe,cACnB,IAAIA,GAAe,eCXxB,IAAM2F,GAAb,WAUI,WAAY5kC,EAAQohC,EAAQtF,EAAO90B,GAAW,uEAmEhC,SAAA2J,GACc,UAApBA,EAAI0wB,cAER,EAAKpF,QAAS,EACd,EAAKC,cAAch0B,IAAI,EAAG,GAC1B,EAAKsqB,aAAatqB,IAAIyI,EAAIwM,OAAOrd,EAAG6Q,EAAIwM,OAAOld,OAxEL,oCA+EhC,SAAA0Q,GACV,GAAwB,UAApBA,EAAI0wB,YAAR,CAEA,IAAIxhC,EAAW+kC,EAAiBzI,WAAWj0B,IAAIyI,EAAIwM,OAAOrd,EAAG6Q,EAAIwM,OAAOld,GAErE,EAAKg8B,QACJ,EAAKC,cAAcxW,IAAI7lB,GAAU2U,IAAI,EAAKge,cAG9C,EAAKA,aAAa7Y,KAAK9Z,OAxFmB,kCA+FlC,SAAA8Q,GACgB,UAApBA,EAAI0wB,cAER,EAAKpF,QAAS,MAlG4B,qDAqGf,WAC3B,EAAKG,wBAA2B,EAAI,EAAKp8B,OAAOu5B,aAAgB,EAAKv5B,OAAOu5B,YAAc,EAAKv5B,OAAOw5B,cACtG,EAAK6C,wBAA0B,EAAI,EAAKr8B,OAAOw5B,gBAtG/Cz7B,KAAKiC,OAASA,EACdjC,KAAKqjC,OAASA,EACdrjC,KAAKu+B,QAAU,KAEfv+B,KAAKk+B,QAAS,EACdl+B,KAAKy0B,aAAe,IAAInxB,OACxBtD,KAAKm+B,cAAgB,IAAI76B,OAEzBtD,KAAK+9B,MAAQA,EACb/9B,KAAKiJ,UAAYA,EAEjBjJ,KAAKq+B,wBAA0B,EAC/Br+B,KAAKs+B,wBAA0B,EAC/Bt+B,KAAKw+B,+BAxBb,6CA8BI,SAAMD,GACFv+B,KAAKu+B,QAAUA,EAEfv+B,KAAKqjC,OAAOpiC,GAAG,YAAajB,KAAKujC,aACjCvjC,KAAKqjC,OAAOpiC,GAAG,WAAYjB,KAAKwjC,aAChCxjC,KAAKqjC,OAAOpiC,GAAG,UAAWjB,KAAKyjC,WAC/BzjC,KAAKqjC,OAAOpiC,GAAG,aAAcjB,KAAKyjC,WAElC7jC,OAAOwT,iBAAiB,SAAUpT,KAAKw+B,gCAtC/C,kBAyCI,WACIx+B,KAAKqjC,OAAOK,IAAI,YAAa1jC,KAAKujC,aAClCvjC,KAAKqjC,OAAOK,IAAI,WAAY1jC,KAAKwjC,aACjCxjC,KAAKqjC,OAAOK,IAAI,UAAW1jC,KAAKyjC,WAChCzjC,KAAKqjC,OAAOK,IAAI,aAAc1jC,KAAKyjC,WAEnC7jC,OAAO2T,oBAAoB,SAAUvT,KAAKw+B,gCA/ClD,oBAsDI,SAAOt1B,EAAO2B,GACV,GAA6B,IAAzB7K,KAAKm+B,cAAcp8B,GAAoC,IAAzB/B,KAAKm+B,cAAcj8B,EAArD,CAEA,IAAI08B,EAAY5+B,KAAKiJ,WAAa,OAASC,GAC3C01B,EAAYl4B,OAAUC,MAAMi4B,EAAW,EAAG,GAE1C5+B,KAAKu+B,QAAQvrB,UAAYhT,KAAKm+B,cAAcp8B,EAAI/B,KAAK+9B,MAAQ/9B,KAAKq+B,wBAA0Br+B,KAAKiJ,UACjGjJ,KAAKu+B,QAAQhK,OAASv0B,KAAKm+B,cAAcj8B,EAAIlC,KAAK+9B,MAAQ/9B,KAAKs+B,wBAA0Bt+B,KAAKiJ,UAE9FjJ,KAAKm+B,cAAcrc,eAAe,EAAI8c,GAClC5+B,KAAKm+B,cAAcY,WAAa,MAChC/+B,KAAKm+B,cAAch0B,IAAI,EAAG,MAjEtC,mBAqEI,WACInK,KAAKm+B,cAAch0B,IAAI,EAAG,OAtElC,K,gBAAa08B,G,aAEW,IAAIvjC,QCKrB,IAAMwjC,GAAb,WAKI,WAAY7kC,GAAQ,yEA6EJ,SAAA2Q,GACZA,EAAIJ,oBA9EY,oCAiFN,SAAAI,GACV,EAAKm0B,WAAW58B,IAAIyI,EAAI7Q,EAAG6Q,EAAI1Q,MAlFf,kCAqFR,SAAA0Q,GACJ5P,KAAK+U,IAAI,EAAKgvB,WAAWhlC,EAAI6Q,EAAI7Q,GAAK,GACtCiB,KAAK+U,IAAI,EAAKgvB,WAAW7kC,EAAI0Q,EAAI1Q,GAAK,GAE1CyB,SAASqO,KAAKC,oBACTuC,SAAQ,WACL,EAAKvS,OAAO+kC,2BA3FJ,gCA+FV,SAAAp0B,GACN,IAAI1J,EAAQ0J,EAAIqsB,OACZrsB,EAAIssB,YAAcC,WAAWC,kBAAiBl2B,GAAS,KACvD0J,EAAIssB,YAAcC,WAAWE,iBAAgBn2B,GAAS,KAE1D,EAAK+9B,WAAajkC,KAAKyyB,IAAI,IAAc,KAARvsB,GACjC,EAAK+9B,UAAYvgC,OAAUC,MAAM,EAAKsgC,UAAW,IAAM,GAEvD,EAAKxC,QAAQ1G,MAAQ,EAAKkJ,UAC1B,EAAKC,UAAUnJ,MAAQ,EAAKkJ,aAvG5BjnC,KAAKiC,OAASA,EACdjC,KAAKu+B,QAAU,KAEfv+B,KAAK9D,KAAO,GAIZ8D,KAAKqjC,OAAS,IAAIc,cAAQnkC,KAAKiC,QAC/BjC,KAAKokC,mBAELpkC,KAAKykC,QAAU,IAAI1C,GAAgB/hC,KAAKiC,OAAQ,GAAK,IACrDjC,KAAKknC,UAAY,IAAIN,GAAkB5mC,KAAKiC,OAAQ,GAAK,IACzDjC,KAAKskC,YAAc,IAAI7E,GAAoBz/B,KAAKiC,OAAQ,KAAM,GAAI,IAAK,IACvEjC,KAAKukC,WAAa,IAAI1E,GAAmB7/B,KAAKiC,OAAQ,KAAM,GAAI,IAAK,IACrEjC,KAAKmnC,SAAW,IAAIN,GAAiB7mC,KAAKiC,OAAQjC,KAAKqjC,OAAQ,EAAG,KAElErjC,KAAKonC,SAAU,EAEfpnC,KAAK+mC,WAAa,IAAIzjC,OACtBtD,KAAKinC,UAAY,GAEjBjnC,KAAKqnC,sBAAwB,EA3BrC,6CAiCI,SAAM9I,GACFv+B,KAAKu+B,QAAUA,EAEfv+B,KAAKykC,QAAQvnB,MAAMqhB,GACnBv+B,KAAKknC,UAAUhqB,MAAMqhB,GACrBv+B,KAAKskC,YAAYpnB,MAAMqhB,GACvBv+B,KAAKukC,WAAWrnB,MAAMqhB,GACtBv+B,KAAKmnC,SAASjqB,MAAMqhB,GAEpBv+B,KAAKiC,OAAOmR,iBAAiB,cAAepT,KAAKklC,eACjDllC,KAAKiC,OAAOmR,iBAAiB,YAAapT,KAAKy+B,aAC/Cz+B,KAAKiC,OAAOmR,iBAAiB,UAAWpT,KAAK2+B,WAC7C/+B,OAAOwT,iBAAiB,QAASpT,KAAKsnC,QAAS,CAAC9H,SAAS,MA7CjE,kBAgDI,WACIx/B,KAAKykC,QAAQpO,OACbr2B,KAAKknC,UAAU7Q,OACfr2B,KAAKskC,YAAYjO,OACjBr2B,KAAKukC,WAAWlO,OAChBr2B,KAAKmnC,SAAS9Q,OAEdr2B,KAAKiC,OAAOsR,oBAAoB,cAAevT,KAAKklC,eACpDllC,KAAKiC,OAAOsR,oBAAoB,YAAavT,KAAKy+B,aAClDz+B,KAAKiC,OAAOsR,oBAAoB,UAAWvT,KAAK2+B,WAChD/+B,OAAO2T,oBAAoB,QAASvT,KAAKsnC,WA1DjD,oBAiEI,SAAOp+B,EAAO2B,GACV7K,KAAKykC,QAAQzW,OAAO9kB,EAAO2B,GAC3B7K,KAAKknC,UAAUlZ,OAAO9kB,EAAO2B,GAC7B7K,KAAKskC,YAAYtW,OAAO9kB,EAAO2B,GAC/B7K,KAAKukC,WAAWvW,OAAO9kB,EAAO2B,GAC9B7K,KAAKmnC,SAASnZ,OAAO9kB,EAAO2B,GAE5B7K,KAAKu+B,QAAQhK,MAAQ7tB,OAAUC,MAAM3G,KAAKu+B,QAAQhK,MAAO,EAAGvxB,KAAKgoB,IACjEhrB,KAAKu+B,QAAQ3b,SAAW,EACxB5iB,KAAKu+B,QAAQzJ,MAAQ,IA1E7B,8BA6EI,WACI,IAAI+P,EAAY,IAAIgB,UAAI,CAAElhC,MAAO,OAAQghC,SAAU,EAAGG,UAAWC,oBAAe1kB,UAAW,IAC3FrhB,KAAKqjC,OAAO5sB,IAAIouB,OA/ExB,KCuBA7gB,OAASpnB,UAAUmoB,QAAU,SAASpgB,GAElC,QAAI3E,KAAKkkB,SACAtb,MAAMC,QAAQlE,EAAM4iC,cAAa5iC,EAAM4iC,WAAa,IACzD5iC,EAAM4iC,WAAWvqC,KAAKgD,MAEfA,KAAKkkB,OAAOa,QAAQpgB,KCjC5B,IAAM6iC,GAAb,0DAEI,WAAYp9B,EAAI9J,EAAU+S,GAAQ,8BAC9B,cAAMjJ,GADwB,uDAsCf,SAAAwI,GACf,IAAI60B,GAAU,EACVC,EAAM90B,EAAIhO,OAAOs4B,SAOrB,GALKwK,IACDD,GAAU,EACVC,EAAM90B,EAAIhO,OAAOq4B,WAGhByK,EAAL,CAkCA,GAhCA,EAAK5lC,SACA8Z,KAAK8rB,EAAIjlB,aAAeilB,EAAIhlB,OAC5BjM,IAAI7D,EAAIhO,OAAO4c,IAAIskB,UAAUvqB,QAAQuG,eAAe,MACpD7e,QAOD,EAAKyB,QAAQiB,UADb8hC,EACA,wFAE6B93B,GAAK3Q,EAAE,sBAFpC,4JAImF,EAAK8C,SAASC,EAJjG,uHAKmF,EAAKD,SAASI,EALjG,uHAMmF,EAAKJ,SAASK,EANjG,mFAWA,wFAE6BwN,GAAK3Q,EAAE,yBAFpC,4JAImF,EAAK8C,SAASC,EAJjG,uHAKmF,EAAKD,SAASK,EALjG,mFAWA,EAAK7B,SAASgF,MAAO,CACrB,IAAIqiC,EAAc,EAAK7lC,SAASyZ,QAAQqsB,aAAa,IAAI3kC,QACrD4kC,EAAe,IAAIvkC,OAAQ,EAAKxB,SAASC,EAAG,EAAKD,SAASK,GAAGylC,aAAa,KAAK3kC,QAC/E6kC,EAAa,KAAH,OAAQD,EAAa9lC,EAArB,YAA0B8lC,EAAa3lC,EAAvC,QAEd,EAAKwC,QAAQiB,WAAb,8GAG6BgK,GAAK3Q,EAAE,sBAHpC,4JAKmF2oC,EAAY5lC,EAL/F,uHAMmF4lC,EAAYzlC,EAN/F,uHAOmFylC,EAAYxlC,EAP/F,gLAY6BwN,GAAK3Q,EAAE,8BAZpC,4JAcmF6oC,EAAa9lC,EAdhG,uHAemF8lC,EAAa3lC,EAfhG,gKAkBqDyN,GAAK3Q,EAAE,4BAlB5D,wCAkBuH8oC,EAlBvH,mFAwBJ,GAAI,EAAKxnC,SAASgF,MAAO,CACrB,IAAIyd,EAAY2kB,EAAI3kB,UAChB5F,EAAauqB,EAAIloC,OAAO8U,SAAS6I,WACrC,GAAIA,EAAW3P,UAAY2P,EAAW4qB,WAAY,CAC9C,IAAIv6B,EAAW2P,EAAW3P,SAASoQ,MAAkB,EAAZmF,GACrCglB,EAAa5qB,EAAW4qB,WAAWnqB,MAAkB,EAAZmF,GAE7C,EAAKre,QAAQiB,WAAb,0HAG6BgK,GAAK3Q,EAAE,4BAHpC,sIAKqD2Q,GAAK3Q,EAAE,0BAL5D,wCAKqHwO,EALrH,6FAMqDmC,GAAK3Q,EAAE,4BAN5D,wCAMuH+oC,EANvH,gGAaR,GAAI,EAAKznC,SAASgF,MAAO,CACrB,IAAI2J,EAAO,GAEX,GAAIw4B,EAAS,CACT,IAAIO,EAASp1B,EAAIhO,OAAOs4B,SAAS19B,OAAOia,SAASX,QACjD7J,GAAQ,QAAJ,OAAY+4B,EAAZ,UAGR,IAAIC,EAASr1B,EAAIhO,OAAOq4B,UAAUz9B,OAAOia,SAASX,QAClD7J,GAAQ,QAAJ,OAAYg5B,EAAZ,UAEJ,EAAKvjC,QAAQiB,WAAb,2FAGUsJ,EAHV,0CAQA,EAAK3O,SAASgF,OACdJ,QAAQI,MAAM,yBAA0BsN,EAAIhO,QAGhD,EAAKmG,WAzJyB,oDA0KlB,SAAA6H,GACRA,EAAIyV,eAAeC,SAAS,EAAK5jB,UACrC,EAAKsF,WAzKL,EAAK9N,KAAKyM,KAAO,QACjB,EAAKzM,KAAKoG,MAAQ,uBAElB,EAAKhC,SAAWA,EAChB,EAAK+S,OAASA,EACd,EAAK5C,SAAU,EAEf,EAAKmc,cAAgB,IAAI3I,GAAY1e,EAAc,sBAAD,OAAuB,EAAKrJ,KAAKkO,GAAjC,8BAAyD,EAAKlO,KAAKyM,KAAnE,kBAClD,EAAKikB,cAAc9qB,SAASqI,IAAI,GAAK,EAAG,IACxC,EAAKiJ,iBAAkB,WAAW,WAC1B,EAAK1O,QAAQyf,YAAY,EAAKzf,QAAQyf,WAAWM,YAAY,EAAK/f,YAG1E,IAAIwjC,EAAU,IAAIC,OAAY,KAAM,KAAM,MAAM5uB,UAAU,GAAK,GAAK,IAChE6uB,EAAe,IAAIC,OAAmB,CAACz2B,MAAO,SAAUgJ,QAAS,GAAK6P,aAAa,IAjBzD,OAkB9B,EAAK6d,KAAO,IAAIlvB,OAAK8uB,EAASE,GAC9B,EAAKE,KAAKvjB,QAAU,SAAAnS,GAAG,OAAI,EAAKmS,QAAQnS,IAExC,EAAK6D,IAAI,EAAKmW,eACd,EAAKnW,IAAI,EAAK6xB,MAEd,EAAKniC,UAAY,KAEjB,EAAKkN,OAAOD,iBAAiB,wBAAyB,EAAKm1B,kBAE3D3oC,OAAOwT,iBAAiB,YAAa,EAAKgV,eAC1CxoB,OAAOwT,iBAAiB,aAAc,EAAKgV,eAC3CxoB,OAAOwT,iBAAiB,UAAW,EAAKgV,eACxCxoB,OAAOwT,iBAAiB,aAAc,EAAKgV,eA/Bb,EAFtC,+CAoCI,SAAQzjB,GACJ,OAAO,IArCf,kBA8JI,WAAO,WACC3E,KAAKmG,WAAWnG,KAAKmG,UAAUW,SAEnC9G,KAAKyQ,SAAU,EACfzQ,KAAKsoC,KAAK73B,SAAU,EAEpB,IAAIyX,EAAgB,EAEpBloB,KAAK0E,QAAQtB,MAAMwX,QAAU,IAC7B5a,KAAKmG,UAAYJ,GAAQ,SAAAU,GACrB,EAAK/B,QAAQtB,MAAMwX,SAAWnU,EAAWyhB,GAAe/jB,aACzD,OAzKX,mBAiLI,WAAQ,WACAnE,KAAKmG,WAAWnG,KAAKmG,UAAUW,SAEnC9G,KAAKsoC,KAAK73B,SAAU,EAEpB,IAAI8X,EAAevmB,WAAWhC,KAAK0E,QAAQtB,MAAMwX,SACjD5a,KAAKmG,UAAYJ,GAAQ,SAAAU,GACrB,EAAK/B,QAAQtB,MAAMwX,SAAW2N,EAAe9hB,EAAW8hB,GAAcpkB,aACvE,KAAK,SAAAqkC,GACAA,IAAU,EAAK/3B,SAAU,QA1LzC,mBAiMI,WACI,OAAOzQ,KAAK4sB,cAAcloB,QAAQooB,qBAAqB,OAAO,KAlMtE,qBAqMI,WACI,wEAEI9sB,KAAK0E,QAAQyf,YAAYnkB,KAAK0E,QAAQyf,WAAWM,YAAYzkB,KAAK0E,aAxM9E,GAAiCye,IC1BpBslB,GAAkB,SAACppC,EAAKN,GACjC2pC,aAAaC,QAAQtpC,EAAKupC,KAAKC,UAAU9pC,KAOhC+pC,GAAkB,SAAAzpC,GAC3B,IAAMN,EAAQ2pC,aAAaK,QAAQ1pC,GAInC,GAAa,MAATN,EAEJ,IACI,OAAO6pC,KAAKzvB,MAAMpa,GACpB,MAAMmvB,GACJ,OAAOnvB,IAIFwF,GAAQ,SAACxF,EAAOiqC,GACzB,IAAIC,EAAIjmC,KAAKyyB,IAAI,GAAIuT,GACrB,OAAOhmC,KAAKuB,MAAMxF,EAAQkqC,GAAKA,GCWtBC,GAAb,WAKI,WAAY3N,GAAa,0GAsGhB,8GACC,EAAK4N,0BADN,OAEL,EAAKC,WAAa9yB,WAAW,EAAK0X,OAAQ,KAFrC,4CAtGgB,oCAqfX,WACN,EAAKqb,mBAAmBjzB,aAAa,EAAKizB,mBAC9C,EAAKA,kBAAoB/yB,WAAW,EAAKgzB,kBAAmB,SAvfvC,0CA0fL,WAChB,IAAI3xB,EAAO,IAEX,GAAI,EAAKvM,UAAUP,IAAK,CACpB8M,GAAQ,EAAKvM,UAAUP,IAAI3O,KAAKkO,GAEhC,IAAI3J,EAAW,EAAK2K,UAAU2F,gBAC9B4G,GAAQ,IAAMpT,GAAM9D,EAASqB,SAASC,EAAG,GACzC4V,GAAQ,IAAMpT,GAAM9D,EAASqB,SAASI,EAAG,GACzCyV,GAAQ,IAAMpT,GAAM9D,EAASqB,SAASK,EAAG,GACzCwV,GAAQ,IAAMpT,GAAM9D,EAASmiB,SAAU,GACvCjL,GAAQ,IAAMpT,GAAM9D,EAASuS,SAAU,GACvC2E,GAAQ,IAAMpT,GAAM9D,EAAS8zB,MAAO,GACpC5c,GAAQ,IAAMpT,GAAM9D,EAAS+zB,KAAM,GACnC7c,GAAQ,IAAMpT,GAAM9D,EAASq0B,MAAO,GACpCnd,GAAQ,IAAM,EAAKrX,SAASG,SAASC,MAGzC6oC,QAAQC,kBAAavxB,OAAWA,EAAWN,GAE3ChU,SAAS2G,MAAQqF,GAAK3Q,EAAE,YAAa,CACjC6L,IAAK,EAAKO,UAAUP,IAAM,EAAKO,UAAUP,IAAI3O,KAAKoC,KAAO,SA/gBxC,gFAmhBP,2GACVqZ,EAAO/X,OAAO6pC,SAAS9xB,KAAK+xB,OAAO,GACnC7X,EAASla,EAAK/K,MAAM,KAEF,KAAlBilB,EAAOn1B,OAJG,0CAImB,GAJnB,UAMV+D,EAAW,EAAK2K,UAAU2F,gBAC9BtQ,EAASA,SAAW,KAEf,EAAK2K,UAAUP,KAAO,EAAKO,UAAUP,IAAI3O,KAAKkO,KAAOynB,EAAO,GATnD,2CAWA,EAAKlgB,UAAUkgB,EAAO,IAXtB,uFAaC,GAbD,QAiBdpxB,EAASqB,SAASC,EAAIC,WAAW6vB,EAAO,IACxCpxB,EAASqB,SAASI,EAAIF,WAAW6vB,EAAO,IACxCpxB,EAASqB,SAASK,EAAIH,WAAW6vB,EAAO,IACxCpxB,EAASmiB,SAAW5gB,WAAW6vB,EAAO,IACtCpxB,EAASuS,SAAWhR,WAAW6vB,EAAO,IACtCpxB,EAAS8zB,MAAQvyB,WAAW6vB,EAAO,IACnCpxB,EAAS+zB,KAAOxyB,WAAW6vB,EAAO,IAClCpxB,EAASq0B,MAAQ9yB,WAAW6vB,EAAO,IAxBrB,KA0BNA,EAAO,GA1BD,OA2BL,SA3BK,QA4BL,SA5BK,gCA2BI,EAAKhoB,YAAY,GA3BrB,oCA4BI,EAAKE,cAAc,EAAGtJ,EAASqB,SAASI,GA5B5C,oCA6BA,EAAKyH,mBAAmB,GA7BxB,uDAgCP,GAhCO,2DAnhBO,uCAsjBR,SAAAhF,GACb,GAAIA,EAAMC,OAAO1I,KAAK0oB,UAAW,CAC7B,IAAI9R,EAAK,EAAK1H,UAAU2F,gBACpB0W,IAAO9iB,EAAMC,OAAOo4B,KAAMr4B,EAAMC,OAAOo4B,IAAIta,OAAkB/d,EAAMC,OAAOpF,OAAOmqC,iBAAiB,IAAInmC,QAEtGomC,EAAgB92B,EAAG8P,SACnBinB,EAAiB7mC,KAAKoG,IAAoB,IAAhBwgC,EAAsB,GAEhDE,EAASh3B,EAAGhR,SAASC,EACrBgoC,EAAUtiB,EAAI1lB,EAEdioC,EAASl3B,EAAGhR,SAASK,EACrB8nC,EAAUxiB,EAAItlB,EAElB,EAAK+nC,cAAgBnkC,GAAQ,SAAArG,GACzB,IAAIyqC,EAAKpjC,EAAgBI,cAAczH,GACvCoT,EAAG8P,SAAWlc,OAAU4b,KAAKsnB,EAAeC,EAAgBM,GAC5Dr3B,EAAGhR,SAASC,EAAI2E,OAAU4b,KAAKwnB,EAAQC,EAASI,GAChDr3B,EAAGhR,SAASK,EAAIuE,OAAU4b,KAAK0nB,EAAQC,EAASE,KACjD,SAxkBPnqC,KAAKqT,OAASkoB,EAEdv7B,KAAKoL,UAAY,IAAIkwB,GAAUC,EAAav7B,KAAKqT,QAEjDrT,KAAKoqC,YAAc,IAAIpG,GAAYhkC,KAAKoL,UAAUigB,SAAS1F,YAC3D3lB,KAAK6N,mBAAqB,IAAIi5B,GAAmB9mC,KAAKoL,UAAUigB,SAAS1F,YAGzE3lB,KAAKqqC,oBAAsB,KAE3BrqC,KAAKsqC,kBAAoB,KAGzBtqC,KAAKqN,SAAW,KAChBrN,KAAKuqC,kBAAoB,IAAIpzB,IAG7BnX,KAAKoB,KAAO,GAEZpB,KAAKwqC,QAAU,IAAIrzB,IAEnBnX,KAAKwwB,QAAU,QAEfxwB,KAAKyqC,SAAW,IAAIv6B,GAEpBlQ,KAAKM,SAAW,CACZG,SAAU,CACNC,MAAO,cACPoL,iBAAkB,EAClBE,aAAa,EACb0+B,mBAAmB,GAEvB9pC,KAAMZ,KAAKyqC,SACXrpC,KAAM,GACNb,MAAO,KACP+E,OAAO,GAIXtF,KAAK+L,yBACL/L,KAAK2qC,oBAGL3qC,KAAK4qC,eAAiB,IAAI9wB,GAAU,gBACpC9Z,KAAK6qC,YAAc,IAAIrD,GAAY,WAAYxnC,KAAKM,SAAUN,KAAKqT,QACnErT,KAAK4qC,eAAen0B,IAAIzW,KAAK6qC,aAC7B7qC,KAAKoL,UAAU9J,QAAQmV,IAAIzW,KAAK4qC,gBAEhC5qC,KAAKopC,WAAa,KAElBppC,KAAKqpC,kBAAoB,KACzBrpC,KAAKkqC,cAAgB,KAzD7B,sGAgEI,iHACQY,EAAU9qC,KAAKoB,KACnBpB,KAAKoB,KAAO,GACZpB,KAAKM,SAASc,KAAKxD,OAAO,EAAGoC,KAAKM,SAASc,KAAK1E,QAChDsD,KAAKwqC,QAAQ3yB,QAJjB,SAOU7X,KAAK+qC,cAPf,cAQI/qC,KAAKM,SAASG,SAASiqC,kBAAoB1qC,KAAKqN,SAASq9B,kBAR7D,SAWU1qC,KAAKoL,UAAUuG,UAAU,MAXnC,OAYIm5B,EAAQtzB,SAAQ,SAAA3M,GAAG,OAAIA,EAAI0J,aAG3BvU,KAAKoB,KAAOpB,KAAKgrC,WAfrB,iBAgBoBhrC,KAAKoB,MAhBzB,IAgBI,2BAASyJ,EAAkB,QACvB7K,KAAKwqC,QAAQrgC,IAAIU,EAAI3O,KAAKkO,GAAIS,GAC9B7K,KAAKM,SAASc,KAAKpE,KAAK6N,EAAI3O,MAlBpC,+CAsBe8D,KAAKirC,kBAtBpB,wCAuBYjrC,KAAKoB,KAAK1E,OAAS,GAvB/B,kCAuBwCsD,KAAK2R,UAAU3R,KAAKoB,KAAK,GAAGlF,KAAKkO,IAvBzE,QAwBQpK,KAAK6B,cAxBb,eA4BIjC,OAAOwT,iBAAiB,aAAcpT,KAAKirC,iBAC3CjrC,KAAKqT,OAAOD,iBAAiB,qBAAsBpT,KAAKkrC,aACxDlrC,KAAKqT,OAAOD,iBAAiB,wBAAyBpT,KAAKmrC,gBAGxDnrC,KAAKopC,YAAYhzB,aAAapW,KAAKopC,YACtCppC,KAAKopC,WAAa9yB,WAAWtW,KAAKguB,OAAQ,KAlC9C,UAqCUhuB,KAAKorC,mBArCf,QAwCIprC,KAAK0L,mBAxCT,iDAhEJ,wJAgHI,+GACQ2/B,IAASrrC,KAAKoL,UAAU2F,gBAAgBtQ,UACxCT,KAAKoL,UAAU2F,gBAAgBtQ,SAASvE,KAAK4U,iBAG7C9Q,KAAKoL,UAAUP,MAAOwgC,EAL9B,oBAMYA,EAAO9b,QAAUvvB,KAAKoL,UAAUP,IAAI3O,KAAKqzB,MANrD,iBASgB+b,EAAc,KAT9B,iBAU4BtrC,KAAKoB,MAVjC,4DAUqByJ,EAVrB,QAWoBA,EAAI3O,KAAKqzB,QAAU8b,EAAO9b,MAX9C,wBAYoB+b,EAAczgC,EAZlC,0KAiBiBygC,EAjBjB,wBAkBoBtrC,KAAKoL,UAAU2F,gBAAgBtQ,SAAS2kC,2BACxCplC,KAAKoL,UAAU2F,gBAAgBtQ,SAAS2kC,4BAnB5D,4CAuBkBplC,KAAK2R,UAAU25B,EAAYpvC,KAAKkO,IAvBlD,gEAhHJ,gFAiJI,SAAU2H,GAAsC,WAA/Bw5B,EAA+B,wDACxC1gC,EAAM7K,KAAKwqC,QAAQ7rC,IAAIoT,GAC3B,IAAKlH,EAAK,OAAOoJ,QAAQC,OAAR,uCAA+CnC,EAA/C,cAEjB,IAAIy5B,EAAWxrC,KAAKoL,UAAUP,IAAM7K,KAAKoL,UAAUP,IAAI3O,KAAKqzB,MAAQ,KACpE,OAAOvvB,KAAKoL,UAAUuG,UAAU9G,GAAKwJ,MAAK,WAClCxJ,IACA,EAAK4gC,0BACL,EAAKC,wBAEDH,GAAyB1gC,EAAI3O,KAAKqzB,QAAUic,GAC5C,EAAK3pC,eAIb,EAAKynC,yBAhKjB,yBAoKI,WACI,IAAIz+B,EAAM7K,KAAKoL,UAAUP,IACrBpK,EAAWT,KAAKoL,UAAU2F,gBAE1BlG,IACApK,EAASqB,SAASqI,IAAIU,EAAI3O,KAAKyzB,SAAS5tB,EAAG,EAAG8I,EAAI3O,KAAKyzB,SAASxtB,GAChE1B,EAASmiB,SAAW,IACpBniB,EAAS8zB,MAAQ,EACjB9zB,EAASuS,SAAW,EACpBvS,EAAS+zB,KAAO,EAChB/zB,EAASq0B,MAAQ,GAGrBr0B,EAASA,SAAWT,KAAKoqC,YACzBpqC,KAAKM,SAASG,SAASC,MAAQ,cAC/BV,KAAKspC,sBAnLb,sBAyLI,WAAW,WACHj8B,EAAWrN,KAAKqN,SAChBjM,EAAO,GAGX,QAAsB6W,IAAlB5K,EAASjM,KACT,IAAK,IAAI2Q,KAAS1E,EAASjM,KACvB,GAAKzE,OAAOC,UAAUC,eAAeC,KAAKuQ,EAASjM,KAAM2Q,GAAzD,CAEA,IAAI45B,EAAct+B,EAASjM,KAAK2Q,GAC5B45B,EAAYx5B,SAAS,WACrB,IAAItH,EAAM,IAAI+gC,GAAW75B,EAAO,EAAKye,QAAUze,EAAQ,IAAK,EAAKye,QAAU,gBAAiB,EAAKA,QAAU,gBAAiB,EAAKplB,UAAUiI,QAC3IjS,EAAKpE,KAAK6N,GAEVA,EAAI2mB,eACCpZ,OAAM,SAAA/S,GACHP,EAAM,EAAKuO,OAAQ,2CAAoCxI,EAAI3O,KAAKkO,GAA7C,MAAsD/E,EAAO,cANnE,GAmBjC,OANAjE,EAAK2lB,MAAK,SAAC8kB,EAAMC,GACb,IAAI/kB,EAAO1Z,EAASjM,KAAKyqC,EAAK3vC,KAAKkO,IAAI2hC,QAAU1+B,EAASjM,KAAK0qC,EAAK5vC,KAAKkO,IAAI2hC,QAC7E,OAAIlsB,MAAMkH,GAAc,EACjBA,KAGJ3lB,IAtNf,mFAyNI,iGACSpB,KAAKqN,SADd,gCAE8BrN,KAAKwxB,eAFnC,OAEQxxB,KAAKqN,SAFb,uCAKWrN,KAAKqN,UALhB,gDAzNJ,mFAoOI,WAAe,WACX,OAAO,IAAI4G,SAAQ,SAAC8E,EAAS7E,GACzB,IAAIwa,EAAS,IAAI/U,OACjB+U,EAAO9U,gBAAgB,QACvB8U,EAAOta,KAAK,EAAKoc,QAAU,iBAAmBlsB,IAC1CyU,GACA,eACA,kBAAM7E,EAAO,6CA3O7B,qCAgPI,WAA0B,WACjBlU,KAAKoL,UAAUP,MAEhB7K,KAAKqqC,oBACLrqC,KAAKqqC,oBAAoBra,QAAUhwB,KAAKoL,UAAUP,IAAI3O,KAAKqzB,MAE3DvvB,KAAKqqC,oBAAsB,IAAIva,GAAoB9vB,KAAKoL,UAAU9J,QAAS,eAAgBtB,KAAKoL,UAAUP,IAAI3O,KAAKqzB,MAAOvvB,KAAKqT,QAGnIrT,KAAKqqC,oBAAoB/b,sBAAsB,GAC/CtuB,KAAKqqC,oBAAoBrc,SACpB3Z,MAAK,WACF,EAAKg2B,oBAAoB/b,sBAAsB,QAElDlW,OAAM,SAAA8V,GACHppB,EAAM,EAAKuO,OAAQ6a,EAAG,WACtB,EAAKmc,oBAAoBxyB,QACzB,EAAKwyB,oBAAoB91B,gBAjQzC,mCAqQI,WAAwB,WAChBvU,KAAKsqC,oBACLtqC,KAAKsqC,kBAAkBzyB,QACvB7X,KAAKsqC,kBAAkB/1B,WAGtBvU,KAAKoL,UAAUP,MAEpB7K,KAAKsqC,kBAAoB,IAAI3b,GAAkB3uB,KAAKoL,UAAU9J,QAAS,oBAAqBtB,KAAKoL,UAAUP,IAAI3O,KAAKkO,GAAIpK,KAAKqT,QAC7HrT,KAAKsqC,kBAAkBtc,SAClB3Z,MAAK,WACF,EAAKi2B,kBAAkBhc,sBAAsB,QAEhDlW,OAAM,SAAA8V,GACHppB,EAAM,EAAKuO,OAAQ6a,EAAG,WACtB,EAAKoc,kBAAkBzyB,QACvB,EAAKyyB,kBAAkB/1B,gBArRvC,oCAyRI,WACI,IAAIy3B,EAAchsC,KAAKM,SAASG,SAASuL,aAAe,EAAI,EAE5DhM,KAAK6N,mBAAmBy2B,YAAYiC,cAAgB,IAAMvmC,KAAKM,SAASG,SAASqL,iBACjF9L,KAAK6N,mBAAmB02B,WAAWgC,cAAgB,IAAMvmC,KAAKM,SAASG,SAASqL,iBAAmBkgC,EACnGhsC,KAAK6N,mBAAmBy2B,YAAYgC,YAAc,EAAItmC,KAAKM,SAASG,SAASqL,iBAC7E9L,KAAK6N,mBAAmB02B,WAAW+B,YAAc,EAAItmC,KAAKM,SAASG,SAASqL,iBAAmBkgC,IA/RvG,+BAkSI,WAAoB,WAEhBroC,SAASyP,iBAAiB,oBAAoB,SAAAR,GACtCjP,SAASsoC,YACT,EAAKxB,SAAShgC,gBAtS9B,gCA2SI,WAAoD,WAAjCyhC,EAAiC,uDAApB,EAAGjiB,EAAiB,uDAAH,EAC7C,GAAKjqB,KAAKoL,UAAUP,IAApB,CACI7K,KAAKkqC,eAAelqC,KAAKkqC,cAAcpjC,SAE3C,IAAIgM,EAAK9S,KAAKoL,UAAU2F,gBACxB+B,EAAGrS,SAAW,KAEd,IAAImpC,EAAgB92B,EAAG8P,SACnBinB,EAAiB7mC,KAAKoG,IAAI,EAAG6gB,EAAa2f,GAE1CuC,EAASr5B,EAAGhR,SAASI,EACrBkqC,EAAU1lC,OAAU4b,KAAKtiB,KAAKoL,UAAUP,IAAI+1B,gBAAgB9tB,EAAGhR,SAASC,EAAG+Q,EAAGhR,SAASK,GAAK,EAAG,EAAG0nC,EAAiB,KAEnHwC,EAAav5B,EAAGyhB,MAChB+X,EAActpC,KAAKgG,IAAIhG,KAAKgoB,GAAK,EAAGqhB,EAAYrsC,KAAKoqC,YAAY7E,kCAAkCsE,IAEnG0C,EAAaz5B,EAAGgiB,MAChB0X,EAAY15B,EAAG0hB,KAEnBx0B,KAAKkqC,cAAgBnkC,GAAQ,SAAArG,GACzB,IAAIyqC,EAAKpjC,EAAgBI,cAAczH,GACvCoT,EAAGhR,SAASI,EAAIwE,OAAU4b,KAAK6pB,EAAQC,EAASjC,GAChDr3B,EAAG8P,SAAWlc,OAAU4b,KAAKsnB,EAAeC,EAAgBM,GAC5Dr3B,EAAGyhB,MAAQ7tB,OAAU4b,KAAK+pB,EAAYC,EAAanC,GACnDr3B,EAAGgiB,MAAQpuB,OAAU4b,KAAKiqB,EAAY,EAAG7sC,GACzCoT,EAAG0hB,KAAO9tB,OAAU4b,KAAKkqB,EAAW,EAAGrC,KACxC+B,GAAY,SAAA1D,GACX,EAAK4B,YAAY5E,QACbgD,IACA11B,EAAGrS,SAAW,EAAK2pC,YACnB,EAAKd,wBAIbtpC,KAAKM,SAASG,SAASC,MAAQ,iBA7UvC,yBAgVI,WAA6C,WAAjCwrC,EAAiC,uDAApB,EAAGjiB,EAAiB,uDAAH,EACtC,GAAKjqB,KAAKoL,UAAUP,IAApB,CACI7K,KAAKkqC,eAAelqC,KAAKkqC,cAAcpjC,SAE3C,IAAIgM,EAAK9S,KAAKoL,UAAU2F,gBACxB+B,EAAGrS,SAAW,KAEd,IAAImpC,EAAgB92B,EAAG8P,SACnBinB,EAAiB7mC,KAAKoG,IAAI,EAAG6gB,EAAa2f,GAE1C6C,EAAgB35B,EAAGE,SACnBq5B,EAAav5B,EAAGyhB,MAChBgY,EAAaz5B,EAAGgiB,MAChB0X,EAAY15B,EAAG0hB,KAEnBx0B,KAAKkqC,cAAgBnkC,GAAQ,SAAArG,GACzB,IAAIyqC,EAAKpjC,EAAgBI,cAAczH,GACvCoT,EAAG8P,SAAWlc,OAAU4b,KAAKsnB,EAAeC,EAAgBM,GAC5Dr3B,EAAGE,SAAWtM,OAAU4b,KAAKmqB,EAAe,EAAGtC,GAC/Cr3B,EAAGyhB,MAAQ7tB,OAAU4b,KAAK+pB,EAAY,EAAGlC,GACzCr3B,EAAGgiB,MAAQpuB,OAAU4b,KAAKiqB,EAAY,EAAG7sC,GACzCoT,EAAG0hB,KAAO9tB,OAAU4b,KAAKkqB,EAAW,EAAGrC,KACxC+B,GAAY,SAAA1D,GACX,EAAK4B,YAAY5E,QACbgD,IACA11B,EAAGrS,SAAW,EAAK2pC,YACnB,EAAKd,wBAIbtpC,KAAKM,SAASG,SAASC,MAAQ,UA9WvC,2BAiXI,WAAmD,WAArCwrC,EAAqC,uDAAxB,EAAGE,EAAqB,4DAAXn0B,EACpC,GAAKjY,KAAKoL,UAAUP,IAApB,CACA,IAAK7K,KAAKqN,SAASq9B,kBAAmB,OAAO1qC,KAAK2J,mBAAmBuiC,GACjElsC,KAAKkqC,eAAelqC,KAAKkqC,cAAcpjC,SAE3C,IAAIgM,EAAK9S,KAAKoL,UAAU2F,gBACxB+B,EAAGrS,SAAW,KAEd,IAAImpC,EAAgB92B,EAAG8P,SAEnBupB,EAASr5B,EAAGhR,SAASI,EACpBkqC,IAASA,EAAUpsC,KAAKoL,UAAUP,IAAI+1B,gBAAgB9tB,EAAGhR,SAASC,EAAG+Q,EAAGhR,SAASK,GAAK,GAE3F,IAAIkqC,EAAav5B,EAAGyhB,MAChB+X,EAActpC,KAAKgoB,GAAK,EAExBuhB,EAAaz5B,EAAGgiB,MAChB0X,EAAY15B,EAAG0hB,KAEnBx0B,KAAKkqC,cAAgBnkC,GAAQ,SAAArG,GACzB,IAAIyqC,EAAKpjC,EAAgBI,cAAczH,GACvCoT,EAAGhR,SAASI,EAAIwE,OAAU4b,KAAK6pB,EAAQC,EAASjC,GAChDr3B,EAAG8P,SAAWlc,OAAU4b,KAAKsnB,EAAe,EAAGO,GAC/Cr3B,EAAGyhB,MAAQ7tB,OAAU4b,KAAK+pB,EAAYC,EAAanC,GACnDr3B,EAAGgiB,MAAQpuB,OAAU4b,KAAKiqB,EAAY,EAAGvpC,KAAKgG,IAAQ,EAAJtJ,EAAO,IACzDoT,EAAG0hB,KAAO9tB,OAAU4b,KAAKkqB,EAAW,EAAGrC,KACxC+B,GAAY,SAAA1D,GACPA,IACA11B,EAAGrS,SAAW,EAAKoN,mBACnB,EAAKy7B,wBAIbtpC,KAAKM,SAASG,SAASC,MAAQ,UAlZvC,sBAqZI,SAAS4E,GACLtF,KAAKM,SAASgF,MAAQA,EAElBA,EACAtF,KAAKoL,UAAUywB,MAAMhF,UAAU,GAE/B72B,KAAKoL,UAAUywB,MAAMhF,WAAW,KA3Z5C,sBA+ZI,SAASt2B,GACLP,KAAKM,SAASC,MAAQA,EAER,UAAVA,GACAP,KAAKoL,UAAUmwB,YAAYhO,UAAUxW,OAAO,cAC5C/W,KAAKoL,UAAUmwB,YAAYhO,UAAU9W,IAAI,gBAE1B,SAAVlW,GACLP,KAAKoL,UAAUmwB,YAAYhO,UAAUxW,OAAO,eAC5C/W,KAAKoL,UAAUmwB,YAAYhO,UAAU9W,IAAI,gBAGzCzW,KAAKoL,UAAUmwB,YAAYhO,UAAUxW,OAAO,eAC5C/W,KAAKoL,UAAUmwB,YAAYhO,UAAUxW,OAAO,iBA5axD,iFAgbI,0GAEQ/W,KAAKoL,UAAUshC,kBACX1sC,KAAKoL,UAAUP,IAH3B,gCAIkB7K,KAAK2R,UAAU3R,KAAKoL,UAAUP,IAAI3O,KAAKkO,IAJzD,OAMQpK,KAAK0L,mBANb,mDAQQ5G,EAAM9E,KAAKqT,OAAN,KAAiB,SAR9B,yDAhbJ,oFA4bI,WACIrT,KAAK2sC,gBAAgB,iBAAiB,GACtClD,SAASmD,WA9bjB,wFAicI,iGACS5sC,KAAKqN,SAASw/B,WADvB,qDAGQ7sC,KAAK8sC,gBAAgB,iBAAiB,GAH9C,uBAIQhoC,EAAM9E,KAAKqT,OAAQ,kBAAmB,QACtCrT,KAAK0L,mBALb,iCASI1L,KAAKoL,UAAUshC,eAAe1sC,KAAK8sC,gBAAgB,gBAAiB9sC,KAAKoL,UAAUsN,gBAEnF1Y,KAAKoL,UAAUK,cAAgBzL,KAAK8sC,gBAAgB,gBAAiB9sC,KAAKoL,UAAUlP,KAAKuP,eACzFzL,KAAKoL,UAAUlP,KAAKyP,wBAA0B3L,KAAK8sC,gBAAgB,oBAAqB9sC,KAAKoL,UAAUlP,KAAKyP,yBAC5G3L,KAAKoL,UAAUlP,KAAK2P,yBAA2B7L,KAAK8sC,gBAAgB,qBAAsB9sC,KAAKoL,UAAUlP,KAAK2P,0BAC9G7L,KAAKoL,UAAUQ,sBACf5L,KAAKM,SAASG,SAASqL,iBAAmB9L,KAAK8sC,gBAAgB,mBAAoB9sC,KAAKM,SAASG,SAASqL,kBAC1G9L,KAAKM,SAASG,SAASuL,YAAchM,KAAK8sC,gBAAgB,cAAe9sC,KAAKM,SAASG,SAASuL,aAChGhM,KAAK+L,yBACL/L,KAAKiM,SAASjM,KAAK8sC,gBAAgB,QAAS9sC,KAAKM,SAASC,QAlB9D,UAmBUoP,GAAKrD,YAAYtM,KAAK8sC,gBAAgB,OAAQn9B,GAAKtD,SAnB7D,QAoBIrM,KAAKiQ,SAASjQ,KAAK8sC,gBAAgB,QAAS9sC,KAAKM,SAASgF,QAE1DR,EAAM9E,KAAKqT,OAAQ,mBAAoB,QAtB3C,iDAjcJ,uFA0dI,WACSrT,KAAKqN,SAASw/B,aAEnB7sC,KAAK2sC,gBAAgB,iBAAiB,GACtC3sC,KAAK2sC,gBAAgB,gBAAiB3sC,KAAKoL,UAAUsN,eAErD1Y,KAAK2sC,gBAAgB,gBAAiB3sC,KAAKoL,UAAUlP,KAAKuP,eAC1DzL,KAAK2sC,gBAAgB,oBAAqB3sC,KAAKoL,UAAUlP,KAAKyP,yBAC9D3L,KAAK2sC,gBAAgB,qBAAsB3sC,KAAKoL,UAAUlP,KAAK2P,0BAC/D7L,KAAK2sC,gBAAgB,mBAAoB3sC,KAAKM,SAASG,SAASqL,kBAChE9L,KAAK2sC,gBAAgB,cAAe3sC,KAAKM,SAASG,SAASuL,aAC3DhM,KAAK2sC,gBAAgB,QAAS3sC,KAAKM,SAASC,OAC5CP,KAAK2sC,gBAAgB,OAAQh9B,GAAKtD,QAClCrM,KAAK2sC,gBAAgB,QAAS3sC,KAAKM,SAASgF,OAE5CR,EAAM9E,KAAKqT,OAAQ,kBAAmB,WAze9C,6BA4eI,SAAgBhU,EAAK0tC,GACjB,IAAIhuC,EAAQ+pC,GAAgB,WAAazpC,GAEzC,YAAc4Y,IAAVlZ,EAA4BguC,EACzBhuC,IAhff,6BAmfI,SAAgBM,EAAKN,GACbiB,KAAKuqC,kBAAkB5rC,IAAIU,KAASN,IACpCiB,KAAKuqC,kBAAkBpgC,IAAI9K,EAAKN,GAChC0pC,GAAgB,WAAappC,EAAKN,QAtf9C,KCRA6D,OAAOhG,UAAU4U,WAAa,SAAUw7B,GACtC,OAAOhtC,KAAKitC,cAAc3kB,SAAS0kB,EAAIC,gBAIzC,IAAMC,GAAU,IAAIhE,GAAWvlC,SAASwpC,eAAe,kBACvDvtC,OAAOstC,QAAUA,GAGjBz9B,OAAI29B,OAAOC,eAAgB,EAC3B1wC,OAAO8B,eAAegR,OAAI7S,UAAW,WAAY,CAC/C+B,IAD+C,WACvC,OAAOuuC,MAGjB,IAAMI,GAAM,IAAI79B,OAAI,CAClBE,QACAyX,OAAQ,SAAAmmB,GAAC,OAAIA,EAAEC,OACdC,OAAO,QAGV99B,GAAKH,uBAAuB4I,OAAM,SAAA/S,GAAK,OAAIH,QAAQG,MAAMA,MAGzDioC,GAAII,WAAU,WACZR,GAAQ94B,OAAOgE,OAAM,SAAA/S,GAAK,OAAIH,QAAQG,MAAMA,U,oCCvD9C,W,6GCAA,W,kCCAA,W,wLCAA,W,6DCAA,W,uGCAA,W,yDCAA,W,kCCAA,W,gFCAA,W,kCCAA,W","file":"js/app.65c9b303.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TextInput.vue?vue&type=style&index=0&lang=scss&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MarkerItem.vue?vue&type=style&index=0&lang=scss&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ControlsSwitch.vue?vue&type=style&index=0&lang=scss&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SvgButton.vue?vue&type=style&index=0&lang=scss&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MenuButton.vue?vue&type=style&index=0&lang=scss&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NumberInput.vue?vue&type=style&index=0&lang=scss&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DayNightSwitch.vue?vue&type=style&index=0&lang=scss&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MapButton.vue?vue&type=style&index=0&lang=scss&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FreeFlightMobileControls.vue?vue&type=style&index=0&lang=scss&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Compass.vue?vue&type=style&index=0&lang=scss&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SideMenu.vue?vue&type=style&index=0&lang=scss&\"","<template>\n  <SvgButton class=\"compass\" @action=\"action\">\n    <svg viewBox=\"0 0 30 30\" :style=\"style\">\n      <path class=\"north\" d=\"M14.792,1.04c0.114-0.354,0.299-0.354,0.412,0l4.089,12.729c0.114,0.353-0.097,0.642-0.468,0.642\n        l-7.651,0.001c-0.371,0-0.581-0.288-0.468-0.642L14.792,1.04z\"/>\n      <path class=\"south\" d=\"M10.707,16.23c-0.114-0.353,0.097-0.642,0.468-0.642l7.651-0.001c0.371,0,0.581,0.289,0.468,0.642\n        l-4.086,12.73c-0.113,0.353-0.299,0.353-0.412,0L10.707,16.23z\"/>\n    </svg>\n  </SvgButton>\n</template>\n\n<script>\n  import {animate, EasingFunctions} from \"bluemap/src/util/Utils\";\n  import SvgButton from \"@/components/ControlBar/SvgButton\";\n\n  let animation;\n\n  export default {\n    name: \"Compass\",\n    components: {SvgButton},\n    data() {\n      return {\n        controls: this.$bluemap.mapViewer.controlsManager.data\n      }\n    },\n    computed: {\n      style() {\n        return {transform: \"translate(-50%, -50%) rotate(\" + (-this.controls.rotation) + \"rad)\"}\n      }\n    },\n    methods: {\n      action(evt) {\n        evt.preventDefault();\n\n        if (animation) animation.cancel();\n\n        let startRotation = this.controls.rotation;\n        animation = animate(t => {\n          this.controls.rotation = startRotation * (1-EasingFunctions.easeOutQuad(t));\n        }, 300);\n      }\n    }\n  }\n</script>\n\n<style lang=\"scss\">\n  .compass {\n    svg {\n      height: 1.8em;\n\n      .north {\n        fill: var(--theme-fg);\n      }\n\n      .south {\n        fill: var(--theme-fg-light);\n      }\n    }\n\n    &:active {\n      svg {\n        .north {\n          fill: var(--theme-bg);\n        }\n\n        .south {\n          fill: var(--theme-bg-light);\n        }\n      }\n    }\n  }\n</style>","<template>\n  <SvgButton class=\"day-night-switch\" :active=\"!isDay\" @action=\"action\">\n    <svg viewBox=\"0 0 30 30\">\n      <path d=\"M17.011,19.722c-3.778-1.613-5.533-5.982-3.921-9.76c0.576-1.348,1.505-2.432,2.631-3.204\n        c-3.418-0.243-6.765,1.664-8.186,4.992c-1.792,4.197,0.159,9.053,4.356,10.844c3.504,1.496,7.462,0.377,9.717-2.476\n        C20.123,20.465,18.521,20.365,17.011,19.722z\"/>\n      <circle cx=\"5.123\" cy=\"7.64\" r=\"1.196\"/>\n      <circle cx=\"23.178\" cy=\"5.249\" r=\"1.195\"/>\n      <circle cx=\"20.412\" cy=\"13.805\" r=\"1.195\"/>\n      <circle cx=\"25.878\" cy=\"23.654\" r=\"1.195\"/>\n    </svg>\n  </SvgButton>\n</template>\n\n<script>\nimport {animate, EasingFunctions} from \"bluemap/src/util/Utils\";\nimport SvgButton from \"@/components/ControlBar/SvgButton\";\n\nlet animation;\n\nexport default {\n    name: \"DayNightSwitch\",\n  components: {SvgButton},\n  data() {\n      return {\n        mapViewer: this.$bluemap.mapViewer.data\n      }\n    },\n    computed: {\n      isDay() {\n        return this.mapViewer.uniforms.sunlightStrength.value > 0.6;\n      }\n    },\n    methods: {\n      action(evt) {\n\n        evt.preventDefault();\n\n        if (animation) animation.cancel();\n\n        let startValue = this.mapViewer.uniforms.sunlightStrength.value;\n        let targetValue = this.isDay ? 0.25 : 1;\n        animation = animate(t => {\n          let u = EasingFunctions.easeOutQuad(t);\n          this.mapViewer.uniforms.sunlightStrength.value = startValue * (1-u) + targetValue * u;\n        }, 300);\n      }\n    }\n  }\n</script>\n\n<style lang=\"scss\">\n  .day-night-switch {\n    svg {\n      fill: var(--theme-moon-day);\n      circle {\n        fill: var(--theme-stars-day);\n      }\n    }\n\n    &:active {\n      svg {\n        fill: var(--theme-moon-night);\n        circle {\n          fill: var(--theme-stars-night);\n        }\n      }\n    }\n  }\n</style>","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{class:{'theme-light': _vm.appState.theme === 'light', 'theme-dark': _vm.appState.theme === 'dark'},attrs:{\"id\":\"app\"}},[(_vm.appState.controls.state === 'free')?_c('FreeFlightMobileControls'):_vm._e(),_c('ControlBar'),_c('MainMenu',{attrs:{\"menu\":_vm.appState.menu}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"control-bar\"},[_c('MenuButton',{attrs:{\"close\":_vm.appState.menu.isOpen,\"back\":false,\"title\":_vm.$t('menu.tooltip')},on:{\"action\":function($event){return _vm.appState.menu.reOpenPage()}}}),_c('div',{staticClass:\"space thin-hide\"}),(_vm.appState.maps.length > 0)?_c('SvgButton',{staticClass:\"thin-hide\",attrs:{\"title\":_vm.$t('maps.tooltip')},on:{\"action\":function($event){_vm.appState.menu.openPage('maps', _vm.$t('maps.title'))}}},[_c('svg',{attrs:{\"viewBox\":\"0 0 30 30\"}},[_c('polygon',{attrs:{\"points\":\"26.708,22.841 19.049,25.186 11.311,20.718 3.292,22.841 7.725,5.96 13.475,4.814 19.314,7.409 25.018,6.037 \"}})])]):_vm._e(),(_vm.markers.markerSets.length > 0 || _vm.markers.markers.length > 0)?_c('SvgButton',{staticClass:\"thin-hide\",attrs:{\"title\":_vm.$t('markers.tooltip')},on:{\"action\":function($event){_vm.appState.menu.openPage('markers', _vm.$t('markers.title'), {markerSet: _vm.markers})}}},[_c('svg',{attrs:{\"viewBox\":\"0 0 30 30\"}},[_c('path',{attrs:{\"d\":\"M15,3.563c-4.459,0-8.073,3.615-8.073,8.073c0,6.483,8.196,14.802,8.196,14.802s7.951-8.013,7.951-14.802\\n\\t\\t\\tC23.073,7.177,19.459,3.563,15,3.563z M15,15.734c-2.263,0-4.098-1.835-4.098-4.099c0-2.263,1.835-4.098,4.098-4.098\\n\\t\\t\\tc2.263,0,4.098,1.835,4.098,4.098C19.098,13.899,17.263,15.734,15,15.734z\"}})])]):_vm._e(),(!_vm.playerMarkerSet.fake)?_c('SvgButton',{staticClass:\"thin-hide\",attrs:{\"title\":_vm.$t('players.tooltip')},on:{\"action\":_vm.openPlayerList}},[_c('svg',{attrs:{\"viewBox\":\"0 0 30 30\"}},[_c('g',[_c('path',{attrs:{\"d\":\"M8.95,14.477c0.409-0.77,1.298-1.307,2.164-1.309h0.026c-0.053-0.234-0.087-0.488-0.087-0.755\\n\\t\\t\\tc0-1.381,0.715-2.595,1.791-3.301c-0.01,0-0.021-0.006-0.03-0.006h-1.427c-0.39,0-0.514-0.251-0.276-0.563\\n\\t\\t\\tc0,0,0.497-0.645,0.497-1.452c0-1.48-1.2-2.681-2.679-2.681c-1.481,0-2.679,1.2-2.679,2.681c0,0.807,0.496,1.452,0.496,1.452\\n\\t\\t\\tc0.24,0.311,0.114,0.565-0.275,0.565L5.042,9.118C4.649,9.119,4.182,9.405,3.998,9.75l-2.601,4.927\\n\\t\\t\\tc-0.184,0.347-0.062,0.802,0.265,1.015l1.297,0.83c0.332,0.213,0.794,0.135,1.034-0.18l0.598-0.775\\n\\t\\t\\tc0.238-0.31,0.471-0.245,0.516,0.141l0.454,3.854c0.035,0.311,0.272,0.566,0.564,0.66c0.018-0.279,0.087-0.561,0.225-0.82\\n\\t\\t\\tL8.95,14.477z\"}}),_c('path',{attrs:{\"d\":\"M28.604,14.677l-2.597-4.94c-0.185-0.346-0.65-0.631-1.042-0.631h-1.428c-0.39,0-0.514-0.251-0.274-0.563\\n\\t\\t\\tc0,0,0.496-0.645,0.496-1.452c0-1.48-1.2-2.681-2.68-2.681c-1.481,0-2.679,1.2-2.679,2.681c0,0.807,0.496,1.452,0.496,1.452\\n\\t\\t\\tc0.239,0.311,0.114,0.565-0.275,0.565l-1.428,0.009c-0.005,0-0.009,0.002-0.015,0.002c1.067,0.708,1.774,1.917,1.774,3.292\\n\\t\\t\\tc0,0.263-0.031,0.513-0.084,0.744h0.02c0.868,0,1.758,0.537,2.166,1.305l2.598,4.944c0.137,0.262,0.205,0.539,0.222,0.818\\n\\t\\t\\tc0.296-0.092,0.538-0.35,0.574-0.664l0.451-3.842c0.044-0.389,0.28-0.452,0.519-0.143l0.588,0.768\\n\\t\\t\\tc0.239,0.313,0.702,0.391,1.033,0.182l1.297-0.833C28.667,15.479,28.787,15.026,28.604,14.677z\"}})]),_c('path',{attrs:{\"d\":\"M19.932,15.058c-0.184-0.346-0.651-0.63-1.043-0.63h-1.427c-0.39,0-0.515-0.252-0.275-0.564c0,0,0.496-0.645,0.496-1.451\\n\\t\\tc0-1.479-1.199-2.68-2.679-2.68c-1.482,0-2.679,1.201-2.679,2.68c0,0.806,0.496,1.451,0.496,1.451\\n\\t\\tc0.24,0.312,0.114,0.566-0.275,0.566l-1.427,0.009c-0.393,0.001-0.861,0.287-1.045,0.632l-2.602,4.925\\n\\t\\tc-0.185,0.348-0.062,0.803,0.266,1.016l1.297,0.832c0.332,0.213,0.794,0.133,1.034-0.18l0.598-0.775\\n\\t\\tc0.239-0.311,0.472-0.246,0.517,0.141l0.454,3.854c0.043,0.389,0.403,0.705,0.794,0.705h5.148c0.392,0,0.749-0.316,0.794-0.705\\n\\t\\tl0.45-3.844c0.045-0.389,0.282-0.451,0.52-0.143l0.587,0.768c0.239,0.313,0.703,0.393,1.033,0.182l1.297-0.832\\n\\t\\tc0.331-0.213,0.451-0.666,0.269-1.016L19.932,15.058z\"}})])]):_vm._e(),_c('div',{staticClass:\"space thin-hide greedy\"}),_c('DayNightSwitch',{staticClass:\"thin-hide\",attrs:{\"title\":_vm.$t('lighting.dayNightSwitch.tooltip')}}),_c('div',{staticClass:\"space thin-hide\"}),_c('ControlsSwitch',{staticClass:\"thin-hide\"}),_c('div',{staticClass:\"space thin-hide\"}),_c('SvgButton',{staticClass:\"thin-hide\",attrs:{\"title\":_vm.$t('resetCamera.tooltip')},on:{\"action\":function($event){return _vm.$bluemap.resetCamera()}}},[_c('svg',{attrs:{\"viewBox\":\"0 0 30 30\"}},[_c('rect',{attrs:{\"x\":\"7.085\",\"y\":\"4.341\",\"transform\":\"matrix(0.9774 0.2116 -0.2116 0.9774 3.2046 -1.394)\",\"width\":\"2.063\",\"height\":\"19.875\"}}),_c('path',{attrs:{\"d\":\"M12.528,5.088c0,0,3.416-0.382,4.479-0.031c1.005,0.332,2.375,2.219,3.382,2.545c1.096,0.354,4.607-0.089,4.607-0.089\\n      l-2.738,8.488c0,0-3.285,0.641-4.344,0.381c-1.049-0.257-2.607-2.015-3.642-2.324c-0.881-0.264-3.678-0.052-3.678-0.052\\n      L12.528,5.088z\"}})])]),_c('PositionInput',{staticClass:\"pos-input\"}),_c('Compass',{attrs:{\"title\":_vm.$t('compass.tooltip')}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"position-input\"},[_c('NumberInput',{attrs:{\"label\":\"x\",\"value\":_vm.controls.position.x},on:{\"input\":function($event){_vm.controls.position.x = parseFloat($event.target.value);}}}),(_vm.appState.controls.state === 'free')?_c('NumberInput',{attrs:{\"label\":\"y\",\"value\":_vm.controls.position.y},on:{\"input\":function($event){_vm.controls.position.y = parseFloat($event.target.value);}}}):_vm._e(),_c('NumberInput',{attrs:{\"label\":\"z\",\"value\":_vm.controls.position.z},on:{\"input\":function($event){_vm.controls.position.z = parseFloat($event.target.value);}}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"number-input\"},[_c('label',[_c('span',{staticClass:\"label\"},[_vm._v(_vm._s(_vm.label)+\":\")]),_c('input',{attrs:{\"type\":\"number\"},domProps:{\"value\":_vm._f(\"format\")(_vm.value)},on:{\"input\":function($event){return _vm.$emit('input', $event)},\"keydown\":function($event){return $event.stopPropagation()}}})])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"number-input\">\n    <label>\n      <span class=\"label\">{{label}}:</span>\n      <input type=\"number\"\n             v-bind:value=\"value | format\"\n             v-on:input=\"$emit('input', $event)\"\n             v-on:keydown=\"$event.stopPropagation()\"\n      >\n    </label>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: \"NumberInput\",\n  props: {\n    label: String,\n    value: Number\n  },\n  filters: {\n    format(value) {\n      return Math.floor(value);\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\">\n  .number-input {\n    pointer-events: auto;\n\n    background-color: var(--theme-bg);\n    color: var(--theme-fg);\n\n    min-height: 2em;\n\n    .label {\n      display: inline-block;\n      width: 1em;\n      padding: 0 0.5em 0 0.5em;\n\n      color: var(--theme-fg-light);\n    }\n\n    input {\n      height: 100%;\n      line-height: 100%;\n      width: calc(100% - 2em);\n\n      background-color: inherit;\n      color: inherit;\n\n      // remove number spinner firefox\n      -moz-appearance: textfield;\n\n      // remove number spinner webkit\n      &::-webkit-inner-spin-button,\n      &::-webkit-outer-spin-button {\n        -webkit-appearance: none;\n        margin: 0;\n      }\n    }\n  }\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NumberInput.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NumberInput.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./NumberInput.vue?vue&type=template&id=69a7a1b7&\"\nimport script from \"./NumberInput.vue?vue&type=script&lang=js&\"\nexport * from \"./NumberInput.vue?vue&type=script&lang=js&\"\nimport style0 from \"./NumberInput.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div class=\"position-input\">\n    <NumberInput label=\"x\" :value=\"controls.position.x\" v-on:input=\"controls.position.x = parseFloat($event.target.value);\" />\n    <NumberInput label=\"y\" :value=\"controls.position.y\" v-on:input=\"controls.position.y = parseFloat($event.target.value);\" v-if=\"appState.controls.state === 'free'\" />\n    <NumberInput label=\"z\" :value=\"controls.position.z\" v-on:input=\"controls.position.z = parseFloat($event.target.value);\" />\n  </div>\n</template>\n\n<script>\n  import NumberInput from \"@/components/ControlBar/NumberInput\";\n\n  export default {\n    name: \"PositionInput\",\n    components: {\n      NumberInput\n    },\n    data() {\n      return {\n        controls: this.$bluemap.mapViewer.controlsManager.data,\n        appState: this.$bluemap.appState\n      }\n    }\n  }\n</script>\n\n<style lang=\"scss\">\n  .position-input {\n    display: flex;\n    user-select: none;\n\n    > * {\n      width: 100%;\n\n      &:not(:first-child) {\n        border-left: solid 1px var(--theme-bg-light);\n      }\n    }\n  }\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PositionInput.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PositionInput.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./PositionInput.vue?vue&type=template&id=cd44c82e&\"\nimport script from \"./PositionInput.vue?vue&type=script&lang=js&\"\nexport * from \"./PositionInput.vue?vue&type=script&lang=js&\"\nimport style0 from \"./PositionInput.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('SvgButton',{staticClass:\"compass\",on:{\"action\":_vm.action}},[_c('svg',{style:(_vm.style),attrs:{\"viewBox\":\"0 0 30 30\"}},[_c('path',{staticClass:\"north\",attrs:{\"d\":\"M14.792,1.04c0.114-0.354,0.299-0.354,0.412,0l4.089,12.729c0.114,0.353-0.097,0.642-0.468,0.642\\n      l-7.651,0.001c-0.371,0-0.581-0.288-0.468-0.642L14.792,1.04z\"}}),_c('path',{staticClass:\"south\",attrs:{\"d\":\"M10.707,16.23c-0.114-0.353,0.097-0.642,0.468-0.642l7.651-0.001c0.371,0,0.581,0.289,0.468,0.642\\n      l-4.086,12.73c-0.113,0.353-0.299,0.353-0.412,0L10.707,16.23z\"}})])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport {MathUtils, Vector2, Vector3} from \"three\";\n\nexport const VEC2_ZERO = new Vector2(0, 0);\nexport const VEC3_ZERO = new Vector3(0, 0, 0);\nexport const VEC3_X = new Vector3(1, 0, 0);\nexport const VEC3_Y = new Vector3(0, 1, 0);\nexport const VEC3_Z = new Vector3(0, 0, 1);\n\n/**\n * Converts a url-encoded image string to an actual image-element\n * @param string {string}\n * @returns {HTMLElement}\n */\nexport const stringToImage = string => {\n    let image = document.createElementNS('http://www.w3.org/1999/xhtml', 'img');\n    image.src = string;\n    return image;\n};\n\n/**\n * Creates an optimized path from x,z coordinates used by bluemap to save tiles\n * @param x {number}\n * @param z {number}\n * @returns {string}\n */\nexport const pathFromCoords = (x, z) => {\n    let path = 'x';\n    path += splitNumberToPath(x);\n\n    path += 'z';\n    path += splitNumberToPath(z);\n\n    path = path.substring(0, path.length - 1);\n\n    return path;\n};\n\n/**\n * Splits a number into an optimized folder-path used to save bluemap-tiles\n * @param num {number}\n * @returns {string}\n */\nconst splitNumberToPath = num => {\n    let path = '';\n\n    if (num < 0) {\n        num = -num;\n        path += '-';\n    }\n\n    let s = num.toString();\n\n    for (let i = 0; i < s.length; i++) {\n        path += s.charAt(i) + '/';\n    }\n\n    return path;\n};\n\n/**\n * Hashes tile-coordinates to be saved in a map\n * @param x {number}\n * @param z {number}\n * @returns {string}\n */\nexport const hashTile = (x, z) => `x${x}z${z}`;\n\nexport const generateCacheHash = () => {\n    return Math.round(Math.random() * 1000000);\n}\n\n/**\n * Dispatches an event to the element of this map-viewer\n * @param element {EventTarget} the element on that the event is dispatched\n * @param event {string}\n * @param detail {object}\n * @returns {undefined|void|boolean}\n */\nexport const dispatchEvent = (element, event, detail = {}) => {\n    if (!element || !element.dispatchEvent) return;\n\n    return element.dispatchEvent(new CustomEvent(event, {\n        detail: detail\n    }));\n}\n\n/**\n * Sends a \"bluemapAlert\" event with a message and a level.\n * The level can be anything, but the app uses the levels\n * - debug\n * - fine\n * - info\n * - warning\n * - error\n * @param element {EventTarget} the element on that the event is dispatched\n * @param message {object}\n * @param level {string}\n */\nexport const alert = (element, message, level = \"info\") => {\n\n    // alert event\n    let printToConsole = dispatchEvent(element, \"bluemapAlert\", {\n        message: message,\n        level: level\n    });\n\n    // log alert to console\n    if (printToConsole) {\n        if (level === \"info\") {\n            console.log(`[BlueMap/${level}]`, message);\n        } else if (level === \"warning\") {\n            console.warn(`[BlueMap/${level}]`, message);\n        } else if (level === \"error\") {\n            console.error(`[BlueMap/${level}]`, message);\n        } else {\n            console.debug(`[BlueMap/${level}]`, message);\n        }\n    }\n}\n\n/**\n * Source: https://stackoverflow.com/questions/494143/creating-a-new-dom-element-from-an-html-string-using-built-in-dom-methods-or-pro/35385518#35385518\n *\n * @param html {string} representing a single element\n * @return {Element}\n */\nexport const htmlToElement = html => {\n    let template = document.createElement('template');\n    template.innerHTML = html.trim();\n    return template.content.firstChild;\n}\n\n/**\n * Source: https://stackoverflow.com/questions/494143/creating-a-new-dom-element-from-an-html-string-using-built-in-dom-methods-or-pro/35385518#35385518\n *\n * @param html {string} representing any number of sibling elements\n * @return {NodeList}\n */\nexport const htmlToElements = html => {\n    let template = document.createElement('template');\n    template.innerHTML = html;\n    return template.content.childNodes;\n}\n\n/**\n * Schedules an animation\n * @param durationMs {number} the duration of the animation in ms\n * @param animationFrame {function(progress: number, deltaTime: number)} a function that is getting called each frame with the parameters (progress (0-1), deltaTime)\n * @param postAnimation {function(finished: boolean)} a function that gets called once after the animation is finished or cancelled. The function accepts one bool-parameter whether the animation was finished (true) or canceled (false)\n * @returns {{cancel: function()}} the animation object\n */\nexport const animate = function (animationFrame, durationMs = 1000, postAnimation = null) {\n    let animation = {\n        animationStart: -1,\n        lastFrame: -1,\n        cancelled: false,\n\n        frame: function (time) {\n            if (this.cancelled) return;\n\n            if (this.animationStart === -1) {\n                this.animationStart = time;\n                this.lastFrame = time;\n            }\n\n            let progress = durationMs === 0 ? 1 : MathUtils.clamp((time - this.animationStart) / durationMs, 0, 1);\n            let deltaTime = time - this.lastFrame;\n\n            animationFrame(progress, deltaTime);\n\n            if (progress < 1) window.requestAnimationFrame(time => this.frame(time));\n            else if (postAnimation) postAnimation(true);\n\n            this.lastFrame = time;\n        },\n\n        cancel: function () {\n            this.cancelled = true;\n            if (postAnimation) postAnimation(false);\n        }\n    };\n\n    window.requestAnimationFrame(time => animation.frame(time));\n\n    return animation;\n}\n\n/**\n * Source: https://gist.github.com/gre/1650294\n * @type {{\n *      easeOutCubic: (function(number): number),\n *      linear: (function(number): number),\n *      easeOutQuint: (function(number): number),\n *      easeInQuart: (function(number): number),\n *      easeInOutQuint: (function(number): number),\n *      easeInQuad: (function(number): number),\n *      easeOutQuart: (function(number): number),\n *      easeInCubic: (function(number): number),\n *      easeInQuint: (function(number): number),\n *      easeOutQuad: (function(number): number),\n *      easeInOutQuad: (function(number): number),\n *      easeInOutCubic: (function(number): number),\n *      easeInOutQuart: (function(number): number)\n *      }}\n */\nexport const EasingFunctions = {\n    // no easing, no acceleration\n    linear: t => t,\n    // accelerating from zero velocity\n    easeInQuad: t => t*t,\n    // decelerating to zero velocity\n    easeOutQuad: t => t*(2-t),\n    // acceleration until halfway, then deceleration\n    easeInOutQuad: t => t<.5 ? 2*t*t : -1+(4-2*t)*t,\n    // accelerating from zero velocity\n    easeInCubic: t => t*t*t,\n    // decelerating to zero velocity\n    easeOutCubic: t => (--t)*t*t+1,\n    // acceleration until halfway, then deceleration\n    easeInOutCubic: t => t<.5 ? 4*t*t*t : (t-1)*(2*t-2)*(2*t-2)+1,\n    // accelerating from zero velocity\n    easeInQuart: t => t*t*t*t,\n    // decelerating to zero velocity\n    easeOutQuart: t => 1-(--t)*t*t*t,\n    // acceleration until halfway, then deceleration\n    easeInOutQuart: t => t<.5 ? 8*t*t*t*t : 1-8*(--t)*t*t*t,\n    // accelerating from zero velocity\n    easeInQuint: t => t*t*t*t*t,\n    // decelerating to zero velocity\n    easeOutQuint: t => 1+(--t)*t*t*t*t,\n    // acceleration until halfway, then deceleration\n    easeInOutQuint: t => t<.5 ? 16*t*t*t*t*t : 1+16*(--t)*t*t*t*t\n}\n\n/**\n * Returns the offset position of an element\n *\n * Source: https://plainjs.com/javascript/styles/get-the-position-of-an-element-relative-to-the-document-24/\n *\n * @param element {Element}\n * @returns {{top: number, left: number}}\n */\nexport const elementOffset = element => {\n    let rect = element.getBoundingClientRect(),\n        scrollLeft = window.pageXOffset || document.documentElement.scrollLeft,\n        scrollTop = window.pageYOffset || document.documentElement.scrollTop;\n    return { top: rect.top + scrollTop, left: rect.left + scrollLeft }\n}\n\n/**\n * Very simple deep equals, should not be used for complex objects. Is designed for comparing parsed json-objects.\n * @param object1 {object}\n * @param object2 {object}\n * @returns {boolean}\n */\nexport const deepEquals = (object1, object2) => {\n    if (Object.is(object1, object2)) return true;\n\n    let type = typeof object1;\n    if (type !== typeof object2) return false;\n\n    if (type === 'number' || type === 'boolean' || type === 'string') return false;\n\n    if (Array.isArray(object1)){\n        let len = object1.length;\n        if (len !== object2.length) return false;\n        for (let i = 0; i < len; i++) {\n            if (!deepEquals(object1[i], object2[i])) return false;\n        }\n\n        return true;\n    }\n\n    for (let property in object1) {\n        if (!object1.hasOwnProperty(property)) continue;\n        if (!deepEquals(object1[property], object2[property])) return false;\n    }\n\n    return true;\n}\n\n/**\n * Adds one listener to multiple events\n * @param target {EventTarget}\n * @param types {string|string[]}\n * @param listener {EventListenerOrEventListenerObject | null}\n * @param options {boolean | AddEventListenerOptions?}\n */\nexport const addEventListeners = (target, types, listener, options) => {\n    if (!Array.isArray(types)){\n        types = types.trim().split(\" \");\n    }\n\n    types.forEach(type => target.addEventListener(type, listener, options));\n}\n\n/**\n * Removes one listener to multiple events\n * @param target {EventTarget}\n * @param types {string|string[]}\n * @param listener {EventListenerOrEventListenerObject | null}\n * @param options {boolean | EventListenerOptions?}\n */\nexport const removeEventListeners = (target, types, listener, options) => {\n    if (!Array.isArray(types)){\n        types = types.trim().split(\" \");\n    }\n\n    types.forEach(type => target.removeEventListener(type, listener, options));\n}\n\n/**\n * Softly clamps towards a minimum value\n * @param value {number}\n * @param min {number}\n * @param stiffness {number}\n * @returns {number}\n */\nexport const softMin = (value, min, stiffness) => {\n    if (value >= min) return value;\n    let delta = min - value;\n    if (delta < 0.0001) return min;\n    return value + delta * stiffness;\n}\n\n/**\n * Softly clamps towards a maximum value\n * @param value {number}\n * @param max {number}\n * @param stiffness {number}\n * @returns {number}\n */\nexport const softMax = (value, max, stiffness) => {\n    if (value <= max) return value;\n    let delta = value - max;\n    if (delta < 0.0001) return max;\n    return value - delta * stiffness;\n}\n\n/**\n * Softly clamps towards a minimum and maximum value\n * @param value {number}\n * @param min {number}\n * @param max {number}\n * @param stiffness {number}\n * @returns {number}\n */\nexport const softClamp = (value, min, max, stiffness) => {\n    return softMax(softMin(value, min, stiffness), max, stiffness);\n}","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"svg-button\",class:{active: _vm.active},on:{\"click\":function($event){return _vm.$emit('action', $event)}}},[_vm._t(\"default\")],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"svg-button\" :class=\"{active: active}\" @click=\"$emit('action', $event)\">\n    <slot />\n  </div>\n</template>\n\n<script>\n  export default {\n    name: \"SvgButton\",\n    props: {\n      active: Boolean,\n    }\n  }\n</script>\n\n<style lang=\"scss\">\n.svg-button {\n  position: relative;\n  pointer-events: auto;\n  overflow: hidden;\n  cursor: pointer;\n\n  min-width: 2em;\n  min-height: 2em;\n\n  background-color: var(--theme-bg);\n  color: var(--theme-fg);\n\n  &:hover, &.active {\n    background-color: var(--theme-bg-light);\n  }\n\n  &:active {\n    background-color: var(--theme-fg-light);\n    color: var(--theme-bg);\n  }\n\n  svg {\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n\n    height: 1.8em;\n\n    fill: var(--theme-fg-light);\n  }\n\n  &:active {\n    svg {\n      fill: var(--theme-bg-light);\n    }\n  }\n}\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SvgButton.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SvgButton.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SvgButton.vue?vue&type=template&id=0bca2c93&\"\nimport script from \"./SvgButton.vue?vue&type=script&lang=js&\"\nexport * from \"./SvgButton.vue?vue&type=script&lang=js&\"\nimport style0 from \"./SvgButton.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Compass.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Compass.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Compass.vue?vue&type=template&id=9d1413c2&\"\nimport script from \"./Compass.vue?vue&type=script&lang=js&\"\nexport * from \"./Compass.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Compass.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('SvgButton',{staticClass:\"day-night-switch\",attrs:{\"active\":!_vm.isDay},on:{\"action\":_vm.action}},[_c('svg',{attrs:{\"viewBox\":\"0 0 30 30\"}},[_c('path',{attrs:{\"d\":\"M17.011,19.722c-3.778-1.613-5.533-5.982-3.921-9.76c0.576-1.348,1.505-2.432,2.631-3.204\\n      c-3.418-0.243-6.765,1.664-8.186,4.992c-1.792,4.197,0.159,9.053,4.356,10.844c3.504,1.496,7.462,0.377,9.717-2.476\\n      C20.123,20.465,18.521,20.365,17.011,19.722z\"}}),_c('circle',{attrs:{\"cx\":\"5.123\",\"cy\":\"7.64\",\"r\":\"1.196\"}}),_c('circle',{attrs:{\"cx\":\"23.178\",\"cy\":\"5.249\",\"r\":\"1.195\"}}),_c('circle',{attrs:{\"cx\":\"20.412\",\"cy\":\"13.805\",\"r\":\"1.195\"}}),_c('circle',{attrs:{\"cx\":\"25.878\",\"cy\":\"23.654\",\"r\":\"1.195\"}})])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DayNightSwitch.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DayNightSwitch.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./DayNightSwitch.vue?vue&type=template&id=5b57efe8&\"\nimport script from \"./DayNightSwitch.vue?vue&type=script&lang=js&\"\nexport * from \"./DayNightSwitch.vue?vue&type=script&lang=js&\"\nimport style0 from \"./DayNightSwitch.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"controls-switch\"},[_c('SvgButton',{attrs:{\"active\":_vm.isPerspectiveView,\"title\":_vm.$t('controls.perspective.tooltip')},on:{\"action\":_vm.setPerspectiveView}},[_c('svg',{attrs:{\"viewBox\":\"0 0 30 30\"}},[_c('path',{attrs:{\"d\":\"M19.475,10.574c-0.166-0.021-0.337-0.036-0.51-0.045c-0.174-0.009-0.35-0.013-0.525-0.011\\n        c-0.176,0.002-0.353,0.01-0.526,0.024c-0.175,0.015-0.347,0.036-0.515,0.063l-13.39,2.189\\n        c-0.372,0.061-0.7,0.146-0.975,0.247c-0.276,0.102-0.5,0.221-0.66,0.349c-0.161,0.129-0.259,0.268-0.282,0.408\\n        c-0.024,0.141,0.028,0.285,0.165,0.421l5.431,5.511c0.086,0.087,0.191,0.167,0.314,0.241s0.263,0.142,0.417,0.202\\n        c0.155,0.062,0.323,0.115,0.502,0.162c0.18,0.046,0.371,0.085,0.569,0.116s0.405,0.054,0.616,0.068\\n        c0.211,0.015,0.427,0.021,0.645,0.017c0.217-0.003,0.436-0.016,0.652-0.037c0.217-0.022,0.431-0.054,0.641-0.095L27.12,17.43\\n        c0.371-0.073,0.679-0.175,0.917-0.296c0.236-0.12,0.404-0.259,0.497-0.407c0.093-0.147,0.111-0.305,0.052-0.461\\n        c-0.059-0.156-0.195-0.313-0.415-0.46l-7.089-4.742c-0.089-0.06-0.192-0.115-0.308-0.166\\n        c-0.116-0.051-0.243-0.097-0.381-0.138c-0.137-0.041-0.283-0.078-0.438-0.108C19.803,10.621,19.641,10.595,19.475,10.574\"}})])]),_c('SvgButton',{attrs:{\"active\":_vm.isFlatView,\"title\":_vm.$t('controls.flatView.tooltip')},on:{\"action\":_vm.setFlatView}},[_c('svg',{attrs:{\"viewBox\":\"0 0 30 30\"}},[_c('path',{attrs:{\"d\":\"M22.371,4.158c1.65,0,3,1.35,3,3v15.684c0,1.65-1.35,3-3,3H7.629c-1.65,0-3-1.35-3-3V7.158c0-1.65,1.35-3,3-3H22.371z\"}})])]),(_vm.controls.freeFlightEnabled)?_c('SvgButton',{attrs:{\"active\":_vm.isFreeFlight,\"title\":_vm.$t('controls.freeFlight.tooltip')},on:{\"action\":_vm.setFreeFlight}},[_c('svg',{attrs:{\"viewBox\":\"0 0 30 30\"}},[_c('path',{attrs:{\"d\":\"M21.927,11.253c-0.256-0.487-0.915-0.885-1.465-0.885h-2.004c-0.55,0-0.726-0.356-0.39-0.792c0,0,0.698-0.905,0.698-2.041\\n        c0-2.08-1.687-3.767-3.767-3.767s-3.767,1.687-3.767,3.767c0,1.136,0.698,2.041,0.698,2.041c0.336,0.436,0.161,0.794-0.389,0.797\\n        l-2.005,0.01c-0.55,0.002-1.21,0.403-1.467,0.889l-3.656,6.924c-0.257,0.487-0.088,1.128,0.375,1.425l1.824,1.171\\n        c0.462,0.297,1.116,0.184,1.451-0.253l0.839-1.092c0.335-0.437,0.662-0.346,0.726,0.2l0.637,5.415\\n        c0.064,0.546,0.567,0.993,1.117,0.993h7.234c0.55,0,1.053-0.447,1.117-0.993l0.635-5.401c0.064-0.546,0.392-0.637,0.727-0.2\\n        l0.828,1.078c0.335,0.437,0.988,0.55,1.451,0.253l1.823-1.171c0.463-0.297,0.633-0.938,0.377-1.425L21.927,11.253z\"}})])]):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"controls-switch\">\n    <SvgButton :active=\"isPerspectiveView\" @action=\"setPerspectiveView\" :title=\"$t('controls.perspective.tooltip')\">\n      <svg viewBox=\"0 0 30 30\">\n        <path d=\"M19.475,10.574c-0.166-0.021-0.337-0.036-0.51-0.045c-0.174-0.009-0.35-0.013-0.525-0.011\n          c-0.176,0.002-0.353,0.01-0.526,0.024c-0.175,0.015-0.347,0.036-0.515,0.063l-13.39,2.189\n          c-0.372,0.061-0.7,0.146-0.975,0.247c-0.276,0.102-0.5,0.221-0.66,0.349c-0.161,0.129-0.259,0.268-0.282,0.408\n          c-0.024,0.141,0.028,0.285,0.165,0.421l5.431,5.511c0.086,0.087,0.191,0.167,0.314,0.241s0.263,0.142,0.417,0.202\n          c0.155,0.062,0.323,0.115,0.502,0.162c0.18,0.046,0.371,0.085,0.569,0.116s0.405,0.054,0.616,0.068\n          c0.211,0.015,0.427,0.021,0.645,0.017c0.217-0.003,0.436-0.016,0.652-0.037c0.217-0.022,0.431-0.054,0.641-0.095L27.12,17.43\n          c0.371-0.073,0.679-0.175,0.917-0.296c0.236-0.12,0.404-0.259,0.497-0.407c0.093-0.147,0.111-0.305,0.052-0.461\n          c-0.059-0.156-0.195-0.313-0.415-0.46l-7.089-4.742c-0.089-0.06-0.192-0.115-0.308-0.166\n          c-0.116-0.051-0.243-0.097-0.381-0.138c-0.137-0.041-0.283-0.078-0.438-0.108C19.803,10.621,19.641,10.595,19.475,10.574\"/>\n      </svg>\n    </SvgButton>\n    <SvgButton :active=\"isFlatView\" @action=\"setFlatView\" :title=\"$t('controls.flatView.tooltip')\">\n      <svg viewBox=\"0 0 30 30\">\n        <path d=\"M22.371,4.158c1.65,0,3,1.35,3,3v15.684c0,1.65-1.35,3-3,3H7.629c-1.65,0-3-1.35-3-3V7.158c0-1.65,1.35-3,3-3H22.371z\"/>\n      </svg>\n    </SvgButton>\n    <SvgButton v-if=\"controls.freeFlightEnabled\" :active=\"isFreeFlight\" @action=\"setFreeFlight\" :title=\"$t('controls.freeFlight.tooltip')\">\n      <svg viewBox=\"0 0 30 30\">\n        <path d=\"M21.927,11.253c-0.256-0.487-0.915-0.885-1.465-0.885h-2.004c-0.55,0-0.726-0.356-0.39-0.792c0,0,0.698-0.905,0.698-2.041\n          c0-2.08-1.687-3.767-3.767-3.767s-3.767,1.687-3.767,3.767c0,1.136,0.698,2.041,0.698,2.041c0.336,0.436,0.161,0.794-0.389,0.797\n          l-2.005,0.01c-0.55,0.002-1.21,0.403-1.467,0.889l-3.656,6.924c-0.257,0.487-0.088,1.128,0.375,1.425l1.824,1.171\n          c0.462,0.297,1.116,0.184,1.451-0.253l0.839-1.092c0.335-0.437,0.662-0.346,0.726,0.2l0.637,5.415\n          c0.064,0.546,0.567,0.993,1.117,0.993h7.234c0.55,0,1.053-0.447,1.117-0.993l0.635-5.401c0.064-0.546,0.392-0.637,0.727-0.2\n          l0.828,1.078c0.335,0.437,0.988,0.55,1.451,0.253l1.823-1.171c0.463-0.297,0.633-0.938,0.377-1.425L21.927,11.253z\"/>\n      </svg>\n    </SvgButton>\n  </div>\n</template>\n\n<script>\n  import SvgButton from \"@/components/ControlBar/SvgButton\";\n\n  export default {\n    name: \"ControlsSwitch\",\n    components: {SvgButton},\n    data() {\n      return {\n        controls: this.$bluemap.appState.controls,\n      }\n    },\n    computed: {\n      isPerspectiveView() {\n        return this.controls.state === \"perspective\";\n      },\n      isFlatView() {\n        return this.controls.state === \"flat\";\n      },\n      isFreeFlight() {\n        return this.controls.state === \"free\";\n      }\n    },\n    methods: {\n      setPerspectiveView() {\n        this.$bluemap.setPerspectiveView(500, this.isFreeFlight ? 100 : 0);\n      },\n      setFlatView() {\n        this.$bluemap.setFlatView(500, this.isFreeFlight ? 100 : 0);\n      },\n      setFreeFlight() {\n        this.$bluemap.setFreeFlight(500);\n      }\n    }\n  }\n</script>\n\n<style lang=\"scss\">\n  .controls-switch {\n    display: flex;\n  }\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ControlsSwitch.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ControlsSwitch.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ControlsSwitch.vue?vue&type=template&id=03188f5e&\"\nimport script from \"./ControlsSwitch.vue?vue&type=script&lang=js&\"\nexport * from \"./ControlsSwitch.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ControlsSwitch.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('SvgButton',{staticClass:\"menu-button\",class:{close: _vm.close, back: _vm.back},on:{\"action\":function($event){return _vm.$emit('action', $event)}}},[_c('svg',{attrs:{\"viewBox\":\"0 0 30 30\"}},[_c('g',[_c('path',{attrs:{\"d\":\"M25.004,9.294c0,0.806-0.75,1.46-1.676,1.46H6.671c-0.925,0-1.674-0.654-1.674-1.46l0,0\\n  c0-0.807,0.749-1.461,1.674-1.461h16.657C24.254,7.833,25.004,8.487,25.004,9.294L25.004,9.294z\"}}),_c('path',{attrs:{\"d\":\"M25.004,15c0,0.807-0.75,1.461-1.676,1.461H6.671c-0.925,0-1.674-0.654-1.674-1.461l0,0\\n  c0-0.807,0.749-1.461,1.674-1.461h16.657C24.254,13.539,25.004,14.193,25.004,15L25.004,15z\"}}),_c('path',{attrs:{\"d\":\"M25.004,20.706c0,0.807-0.75,1.461-1.676,1.461H6.671c-0.925,0-1.674-0.654-1.674-1.461l0,0\\n  c0-0.807,0.749-1.461,1.674-1.461h16.657C24.254,19.245,25.004,19.899,25.004,20.706L25.004,20.706z\"}})])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <SvgButton class=\"menu-button\" :class=\"{close: close, back: back}\" @action=\"$emit('action', $event)\">\n    <svg viewBox=\"0 0 30 30\">\n      <g>\n        <path d=\"M25.004,9.294c0,0.806-0.75,1.46-1.676,1.46H6.671c-0.925,0-1.674-0.654-1.674-1.46l0,0\n    c0-0.807,0.749-1.461,1.674-1.461h16.657C24.254,7.833,25.004,8.487,25.004,9.294L25.004,9.294z\"/>\n        <path d=\"M25.004,15c0,0.807-0.75,1.461-1.676,1.461H6.671c-0.925,0-1.674-0.654-1.674-1.461l0,0\n    c0-0.807,0.749-1.461,1.674-1.461h16.657C24.254,13.539,25.004,14.193,25.004,15L25.004,15z\"/>\n        <path d=\"M25.004,20.706c0,0.807-0.75,1.461-1.676,1.461H6.671c-0.925,0-1.674-0.654-1.674-1.461l0,0\n    c0-0.807,0.749-1.461,1.674-1.461h16.657C24.254,19.245,25.004,19.899,25.004,20.706L25.004,20.706z\"/>\n      </g>\n    </svg>\n  </SvgButton>\n</template>\n\n<script>\nimport SvgButton from \"@/components/ControlBar/SvgButton\";\nexport default {\n  name: \"MenuButton\",\n  components: {SvgButton},\n  props: {\n    close: Boolean,\n    back: Boolean,\n  }\n}\n</script>\n\n<style lang=\"scss\">\n  .menu-button {\n\n    svg {\n      g {\n        transform-origin: center;\n        transition: transform 0.3s;\n      }\n      path {\n        transition: transform 0.3s, fill 0.3s;\n        transform: translate(0 0) rotate(0);\n\n        &:nth-child(1) {\n          transform-origin: 15px 9px;\n        }\n\n        &:nth-child(2) {\n          transform-origin: 15px 15px;\n        }\n\n        &:nth-child(3) {\n          transform-origin: 15px 21px;\n        }\n      }\n    }\n\n    &.close {\n      svg {\n        path:nth-child(1) {\n          transform: translate(0, 5.75px) rotate(45deg);\n        }\n        path:nth-child(2) {\n          transform: translate(-100%, 0) rotate(0);\n        }\n        path:nth-child(3) {\n          transform: translate(0, -5.75px) rotate(-45deg);\n        }\n      }\n\n      &.back {\n        svg {\n          g {\n            transform: scale(0.75);\n          }\n          path:nth-child(1) {\n            transform: translate(0, 10px) rotate(30deg);\n          }\n          path:nth-child(2) {\n            transform: translate(-150%, 0) rotate(0);\n          }\n          path:nth-child(3) {\n            transform: translate(0, -10px) rotate(-30deg);\n          }\n        }\n      }\n    }\n  }\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MenuButton.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MenuButton.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./MenuButton.vue?vue&type=template&id=6d719739&\"\nimport script from \"./MenuButton.vue?vue&type=script&lang=js&\"\nexport * from \"./MenuButton.vue?vue&type=script&lang=js&\"\nimport style0 from \"./MenuButton.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div class=\"control-bar\">\n    <MenuButton :close=\"appState.menu.isOpen\" :back=\"false\" @action=\"appState.menu.reOpenPage()\" :title=\"$t('menu.tooltip')\" />\n    <div class=\"space thin-hide\"></div>\n    <SvgButton v-if=\"appState.maps.length > 0\" class=\"thin-hide\" :title=\"$t('maps.tooltip')\"\n               @action=\"appState.menu.openPage('maps', $t('maps.title'))\">\n      <svg viewBox=\"0 0 30 30\">\n        <polygon points=\"26.708,22.841 19.049,25.186 11.311,20.718 3.292,22.841 7.725,5.96 13.475,4.814 19.314,7.409 25.018,6.037 \"/>\n      </svg>\n    </SvgButton>\n    <SvgButton v-if=\"markers.markerSets.length > 0 || markers.markers.length > 0\" class=\"thin-hide\" :title=\"$t('markers.tooltip')\"\n               @action=\"appState.menu.openPage('markers', $t('markers.title'), {markerSet: markers})\">\n      <svg viewBox=\"0 0 30 30\">\n        <path d=\"M15,3.563c-4.459,0-8.073,3.615-8.073,8.073c0,6.483,8.196,14.802,8.196,14.802s7.951-8.013,7.951-14.802\n\t\t\tC23.073,7.177,19.459,3.563,15,3.563z M15,15.734c-2.263,0-4.098-1.835-4.098-4.099c0-2.263,1.835-4.098,4.098-4.098\n\t\t\tc2.263,0,4.098,1.835,4.098,4.098C19.098,13.899,17.263,15.734,15,15.734z\"/>\n      </svg>\n    </SvgButton>\n    <SvgButton v-if=\"!playerMarkerSet.fake\" class=\"thin-hide\" :title=\"$t('players.tooltip')\" @action=\"openPlayerList\">\n      <svg viewBox=\"0 0 30 30\">\n        <g>\n          <path d=\"M8.95,14.477c0.409-0.77,1.298-1.307,2.164-1.309h0.026c-0.053-0.234-0.087-0.488-0.087-0.755\n\t\t\tc0-1.381,0.715-2.595,1.791-3.301c-0.01,0-0.021-0.006-0.03-0.006h-1.427c-0.39,0-0.514-0.251-0.276-0.563\n\t\t\tc0,0,0.497-0.645,0.497-1.452c0-1.48-1.2-2.681-2.679-2.681c-1.481,0-2.679,1.2-2.679,2.681c0,0.807,0.496,1.452,0.496,1.452\n\t\t\tc0.24,0.311,0.114,0.565-0.275,0.565L5.042,9.118C4.649,9.119,4.182,9.405,3.998,9.75l-2.601,4.927\n\t\t\tc-0.184,0.347-0.062,0.802,0.265,1.015l1.297,0.83c0.332,0.213,0.794,0.135,1.034-0.18l0.598-0.775\n\t\t\tc0.238-0.31,0.471-0.245,0.516,0.141l0.454,3.854c0.035,0.311,0.272,0.566,0.564,0.66c0.018-0.279,0.087-0.561,0.225-0.82\n\t\t\tL8.95,14.477z\"/>\n          <path d=\"M28.604,14.677l-2.597-4.94c-0.185-0.346-0.65-0.631-1.042-0.631h-1.428c-0.39,0-0.514-0.251-0.274-0.563\n\t\t\tc0,0,0.496-0.645,0.496-1.452c0-1.48-1.2-2.681-2.68-2.681c-1.481,0-2.679,1.2-2.679,2.681c0,0.807,0.496,1.452,0.496,1.452\n\t\t\tc0.239,0.311,0.114,0.565-0.275,0.565l-1.428,0.009c-0.005,0-0.009,0.002-0.015,0.002c1.067,0.708,1.774,1.917,1.774,3.292\n\t\t\tc0,0.263-0.031,0.513-0.084,0.744h0.02c0.868,0,1.758,0.537,2.166,1.305l2.598,4.944c0.137,0.262,0.205,0.539,0.222,0.818\n\t\t\tc0.296-0.092,0.538-0.35,0.574-0.664l0.451-3.842c0.044-0.389,0.28-0.452,0.519-0.143l0.588,0.768\n\t\t\tc0.239,0.313,0.702,0.391,1.033,0.182l1.297-0.833C28.667,15.479,28.787,15.026,28.604,14.677z\"/>\n        </g>\n        <path d=\"M19.932,15.058c-0.184-0.346-0.651-0.63-1.043-0.63h-1.427c-0.39,0-0.515-0.252-0.275-0.564c0,0,0.496-0.645,0.496-1.451\n\t\tc0-1.479-1.199-2.68-2.679-2.68c-1.482,0-2.679,1.201-2.679,2.68c0,0.806,0.496,1.451,0.496,1.451\n\t\tc0.24,0.312,0.114,0.566-0.275,0.566l-1.427,0.009c-0.393,0.001-0.861,0.287-1.045,0.632l-2.602,4.925\n\t\tc-0.185,0.348-0.062,0.803,0.266,1.016l1.297,0.832c0.332,0.213,0.794,0.133,1.034-0.18l0.598-0.775\n\t\tc0.239-0.311,0.472-0.246,0.517,0.141l0.454,3.854c0.043,0.389,0.403,0.705,0.794,0.705h5.148c0.392,0,0.749-0.316,0.794-0.705\n\t\tl0.45-3.844c0.045-0.389,0.282-0.451,0.52-0.143l0.587,0.768c0.239,0.313,0.703,0.393,1.033,0.182l1.297-0.832\n\t\tc0.331-0.213,0.451-0.666,0.269-1.016L19.932,15.058z\"/>\n      </svg>\n    </SvgButton>\n    <div class=\"space thin-hide greedy\"></div>\n    <DayNightSwitch class=\"thin-hide\" :title=\"$t('lighting.dayNightSwitch.tooltip')\" />\n    <div class=\"space thin-hide\"></div>\n    <ControlsSwitch class=\"thin-hide\"></ControlsSwitch>\n    <div class=\"space thin-hide\"></div>\n    <SvgButton class=\"thin-hide\" :title=\"$t('resetCamera.tooltip')\" @action=\"$bluemap.resetCamera()\">\n      <svg viewBox=\"0 0 30 30\">\n        <rect x=\"7.085\" y=\"4.341\" transform=\"matrix(0.9774 0.2116 -0.2116 0.9774 3.2046 -1.394)\" width=\"2.063\" height=\"19.875\"/>\n        <path d=\"M12.528,5.088c0,0,3.416-0.382,4.479-0.031c1.005,0.332,2.375,2.219,3.382,2.545c1.096,0.354,4.607-0.089,4.607-0.089\n      l-2.738,8.488c0,0-3.285,0.641-4.344,0.381c-1.049-0.257-2.607-2.015-3.642-2.324c-0.881-0.264-3.678-0.052-3.678-0.052\n      L12.528,5.088z\"/>\n      </svg>\n    </SvgButton>\n    <PositionInput class=\"pos-input\" />\n    <Compass :title=\"$t('compass.tooltip')\" />\n  </div>\n</template>\n\n<script>\n  import PositionInput from \"@/components/ControlBar/PositionInput\";\n  import Compass from \"@/components/ControlBar/Compass\";\n  import DayNightSwitch from \"@/components/ControlBar/DayNightSwitch\";\n  import ControlsSwitch from \"@/components/ControlBar/ControlsSwitch\";\n  import MenuButton from \"@/components/ControlBar/MenuButton\";\n  import SvgButton from \"@/components/ControlBar/SvgButton\";\n\n  export default {\n    name: \"ControlBar\",\n    components: {\n      SvgButton,\n      MenuButton,\n      ControlsSwitch,\n      DayNightSwitch,\n      PositionInput,\n      Compass\n    },\n    data() {\n      return {\n        appState: this.$bluemap.appState,\n        markers: this.$bluemap.mapViewer.markers.data,\n      }\n    },\n    computed: {\n      playerMarkerSet() {\n        for (let set of this.markers.markerSets) {\n          if (set.id === \"bm-players\") return set;\n        }\n\n        return {\n          id: \"bm-players\",\n          label: \"Players\",\n          markerSets: [],\n          markers: [],\n          fake: true,\n        }\n      }\n    },\n    methods: {\n      openPlayerList() {\n        let playerList = this.playerMarkerSet;\n        this.appState.menu.openPage('markers', this.$t(\"players.title\"), {markerSet: playerList});\n      }\n    }\n  }\n</script>\n\n<style lang=\"scss\">\n  @import \"~@/scss/variables.scss\";\n\n  .control-bar {\n    position: fixed;\n    top: 0;\n    left: 0;\n\n    display: flex;\n\n    filter: drop-shadow(1px 1px 3px rgba(0, 0, 0, 0.53));\n    height: 2em;\n\n    margin: 0.5em;\n    width: calc(100% - 1em);\n\n    .pos-input {\n      max-width: 20em;\n      width: 100%;\n    }\n\n    > :not(:first-child) {\n      border-left: solid 1px var(--theme-bg-light);\n    }\n\n    .space {\n      width: 0.5em;\n      flex-shrink: 0;\n\n      &.greedy {\n        flex-grow: 1;\n      }\n    }\n\n    .space, .space + * {\n      border-left: none;\n    }\n\n    @media (max-width: $mobile-break) {\n      margin: 0;\n      width: 100%;\n\n      background-color: var(--theme-bg-light);\n\n      .pos-input {\n        max-width: unset;\n      }\n\n      .thin-hide {\n        display: none;\n      }\n\n      .space {\n        width: 1px;\n      }\n    }\n\n  }\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ControlBar.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ControlBar.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ControlBar.vue?vue&type=template&id=e943b240&\"\nimport script from \"./ControlBar.vue?vue&type=script&lang=js&\"\nexport * from \"./ControlBar.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ControlBar.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('SideMenu',{attrs:{\"open\":_vm.menu.isOpen,\"title\":_vm.menu.currentPage().title,\"back\":_vm.menu.pageStack.length > 1},on:{\"back\":function($event){return _vm.menu.closePage()},\"close\":function($event){return _vm.menu.closeAll()}}},[(_vm.menu.currentPage().id === 'root')?_c('div',[_c('SimpleButton',{attrs:{\"submenu\":true},on:{\"action\":function($event){_vm.menu.openPage('maps', function () { return _vm.$t('maps.title'); })}}},[_vm._v(_vm._s(_vm.$t(\"maps.button\")))]),_c('SimpleButton',{attrs:{\"submenu\":true},on:{\"action\":function($event){_vm.menu.openPage('markers', function () { return _vm.$t('markers.title'); }, {markerSet: _vm.markers})}}},[_vm._v(_vm._s(_vm.$t(\"markers.button\")))]),_c('SimpleButton',{attrs:{\"submenu\":true},on:{\"action\":function($event){_vm.menu.openPage('settings', function () { return _vm.$t('settings.title'); })}}},[_vm._v(_vm._s(_vm.$t(\"settings.button\")))]),_c('SimpleButton',{attrs:{\"submenu\":true},on:{\"action\":function($event){_vm.menu.openPage('info', function () { return _vm.$t('info.title'); })}}},[_vm._v(_vm._s(_vm.$t(\"info.button\")))]),_c('hr'),_c('SimpleButton',{on:{\"action\":_vm.goFullscreen}},[_vm._v(_vm._s(_vm.$t(\"goFullscreen.button\")))]),_c('SimpleButton',{on:{\"action\":function($event){return _vm.$bluemap.resetCamera()}}},[_vm._v(_vm._s(_vm.$t(\"resetCamera.button\")))]),_c('SimpleButton',{attrs:{\"title\":_vm.$t('updateMap.tooltip')},on:{\"action\":function($event){return _vm.$bluemap.updateMap()}}},[_vm._v(_vm._s(_vm.$t(\"updateMap.button\")))])],1):_vm._e(),(_vm.menu.currentPage().id === 'maps')?_c('div',_vm._l((_vm.appState.maps),function(map){return _c('MapButton',{key:map.id,attrs:{\"map\":map}})}),1):_vm._e(),(_vm.menu.currentPage().id === 'markers')?_c('MarkerSetMenu',{attrs:{\"menu\":_vm.menu}}):_vm._e(),(_vm.menu.currentPage().id === 'settings')?_c('SettingsMenu'):_vm._e(),(_vm.menu.currentPage().id === 'info')?_c('div',{staticClass:\"info-content\",domProps:{\"innerHTML\":_vm._s(_vm.$t('info.content'))}}):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('Transition',{attrs:{\"name\":\"side-menu\"},on:{\"enter\":function($event){_vm.buttonEnterAnimation(); _vm.$emit('enter', $event)}}},[(_vm.open)?_c('div',{staticClass:\"side-menu\"},[_c('MenuButton',{attrs:{\"close\":_vm.open && _vm.rendered,\"back\":_vm.back},on:{\"action\":function($event){return _vm.$emit('back', $event)}}}),(_vm.open && _vm.back)?_c('MenuButton',{staticClass:\"full-close\",attrs:{\"close\":true},on:{\"action\":function($event){return _vm.$emit('close', $event)}}}):_vm._e(),_c('div',{staticClass:\"title\"},[_vm._v(_vm._s(_vm.title))]),_c('div',{staticClass:\"content\"},[_vm._t(\"default\")],2)],1):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <Transition name=\"side-menu\" @enter=\"buttonEnterAnimation(); $emit('enter', $event)\">\n    <div class=\"side-menu\" v-if=\"open\">\n      <MenuButton :close=\"open && rendered\" :back=\"back\" @action=\"$emit('back', $event)\" />\n      <MenuButton class=\"full-close\" v-if=\"open && back\" :close=\"true\" @action=\"$emit('close', $event)\" />\n      <div class=\"title\">{{ title }}</div>\n      <div class=\"content\">\n        <slot />\n      </div>\n    </div>\n  </Transition>\n</template>\n\n<script>\nimport MenuButton from \"@/components/ControlBar/MenuButton\";\n\nexport default {\n  name: \"SideMenu\",\n  components: {MenuButton},\n  props: {\n    title: {\n      type: String,\n      default: \"Menu\"\n    },\n    open: {\n      type: Boolean,\n      default: true\n    },\n    back: Boolean\n  },\n  data() {\n    return {\n      rendered: false\n    }\n  },\n  methods: {\n    async buttonEnterAnimation() {\n      this.rendered = false;\n      await this.$nextTick();\n      await this.$nextTick();\n      this.rendered = true;\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\">\n@import \"~@/scss/variables.scss\";\n\n.side-menu {\n  position: fixed;\n  top: 0;\n  left: 0;\n\n  overflow: hidden;\n\n  pointer-events: auto;\n\n  width: 100%;\n  max-width: 20em;\n  height: 100%;\n\n  filter: drop-shadow(1px 1px 3px #0008);\n\n  background-color: var(--theme-bg);\n  color: var(--theme-fg);\n\n  &-enter-active, &-leave-active {\n    transition: opacity 0.3s;\n  }\n\n  &-enter, &-leave-to {\n    opacity: 0;\n    pointer-events: none;\n\n    * {\n      pointer-events: none !important;\n    }\n  }\n\n  > .menu-button {\n    position: absolute;\n    top: 0;\n    left: 0;\n\n    margin: 0.5em;\n\n    @media (max-width: $mobile-break) {\n      margin: 0;\n    }\n\n    &.full-close {\n      right: 0;\n      left: unset;\n    }\n  }\n\n  > .title {\n    line-height: 2em;\n    text-align: center;\n\n    background-color: inherit;\n    border-bottom: solid 1px var(--theme-bg-light);\n\n    padding: 0.5em;\n    @media (max-width: $mobile-break) {\n      padding: 0;\n    }\n  }\n\n  > .content {\n    position: relative;\n\n    overflow-y: auto;\n    overflow-x: hidden;\n\n    padding: 0.5em;\n\n    height: calc(100% - 4em - 1px);\n    @media (max-width: $mobile-break) {\n      height: calc(100% - 3em - 1px);\n    }\n\n    hr {\n      border: none;\n      border-bottom: solid 1px var(--theme-bg-light);\n      margin: 0.5em 0;\n    }\n  }\n}\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SideMenu.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SideMenu.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SideMenu.vue?vue&type=template&id=68ad7d88&\"\nimport script from \"./SideMenu.vue?vue&type=script&lang=js&\"\nexport * from \"./SideMenu.vue?vue&type=script&lang=js&\"\nimport style0 from \"./SideMenu.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"simple-button\",class:{active: _vm.active},on:{\"click\":function($event){return _vm.$emit('action')}}},[_c('div',{staticClass:\"label\"},[_vm._t(\"default\")],2),(_vm.submenu)?_c('div',{staticClass:\"submenu-icon\"},[_c('svg',{attrs:{\"viewBox\":\"0 0 30 30\"}},[_c('path',{attrs:{\"d\":\"M25.004,9.294c0,0.806-0.75,1.46-1.676,1.46H6.671c-0.925,0-1.674-0.654-1.674-1.46l0,0\\n\\tc0-0.807,0.749-1.461,1.674-1.461h16.657C24.254,7.833,25.004,8.487,25.004,9.294L25.004,9.294z\"}}),_c('path',{attrs:{\"d\":\"M25.004,20.706c0,0.807-0.75,1.461-1.676,1.461H6.671c-0.925,0-1.674-0.654-1.674-1.461l0,0\\n\\tc0-0.807,0.749-1.461,1.674-1.461h16.657C24.254,19.245,25.004,19.899,25.004,20.706L25.004,20.706z\"}})])]):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n<div class=\"simple-button\" :class=\"{active: active}\" @click=\"$emit('action')\">\n  <div class=\"label\"><slot /></div>\n  <div class=\"submenu-icon\" v-if=\"submenu\">\n    <svg viewBox=\"0 0 30 30\">\n      <path d=\"M25.004,9.294c0,0.806-0.75,1.46-1.676,1.46H6.671c-0.925,0-1.674-0.654-1.674-1.46l0,0\n\tc0-0.807,0.749-1.461,1.674-1.461h16.657C24.254,7.833,25.004,8.487,25.004,9.294L25.004,9.294z\"/>\n      <path d=\"M25.004,20.706c0,0.807-0.75,1.461-1.676,1.461H6.671c-0.925,0-1.674-0.654-1.674-1.461l0,0\n\tc0-0.807,0.749-1.461,1.674-1.461h16.657C24.254,19.245,25.004,19.899,25.004,20.706L25.004,20.706z\"/>\n    </svg>\n  </div>\n</div>\n</template>\n\n<script>\nexport default {\n  name: \"SimpleButton\",\n  props: {\n    submenu: Boolean,\n    active: {\n      type: Boolean,\n      default: false,\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\">\n\n.side-menu .simple-button {\n  cursor: pointer;\n  user-select: none;\n  display: flex;\n  line-height: 2em;\n\n  padding: 0 0.5em;\n\n  > .label {\n    flex-grow: 1;\n\n    white-space: nowrap;\n    overflow-x: hidden;\n    text-overflow: ellipsis;\n  }\n\n  &:hover, &.active {\n    background-color: var(--theme-bg-light);\n  }\n\n  > .submenu-icon {\n    width: 2em;\n    height: 2em;\n\n    flex-shrink: 0;\n\n    margin-right: -0.5em;\n\n    > svg {\n      fill: var(--theme-fg-light);\n\n      path:nth-child(1) {\n        transform-origin: 15px 9px;\n        transform: translate(0, 10px) rotate(-30deg);\n      }\n      path:nth-child(2) {\n        transform-origin: 15px 21px;\n        transform: translate(0, -10px) rotate(30deg);\n      }\n\n      transform: scale(0.75);\n    }\n  }\n\n  &:active {\n    background-color: var(--theme-fg-light);\n    color: var(--theme-bg);\n\n\n    > .submenu-icon > svg {\n      fill: var(--theme-bg-light);\n    }\n  }\n}\n\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SimpleButton.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SimpleButton.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SimpleButton.vue?vue&type=template&id=7478772b&\"\nimport script from \"./SimpleButton.vue?vue&type=script&lang=js&\"\nexport * from \"./SimpleButton.vue?vue&type=script&lang=js&\"\nimport style0 from \"./SimpleButton.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('Group',{attrs:{\"title\":_vm.$t('controls.title')}},[_c('SimpleButton',{attrs:{\"active\":_vm.appState.controls.state === 'perspective'},on:{\"action\":function($event){return _vm.$bluemap.setPerspectiveView(500, _vm.appState.controls.state === 'free' ? 100 : 0)}}},[_vm._v(_vm._s(_vm.$t('controls.perspective.button')))]),_c('SimpleButton',{attrs:{\"active\":_vm.appState.controls.state === 'flat'},on:{\"action\":function($event){return _vm.$bluemap.setFlatView(500, _vm.appState.controls.state === 'free' ? 100 : 0)}}},[_vm._v(_vm._s(_vm.$t('controls.flatView.button')))]),_c('SimpleButton',{attrs:{\"active\":_vm.appState.controls.state === 'free'},on:{\"action\":function($event){return _vm.$bluemap.setFreeFlight(500)}}},[_vm._v(_vm._s(_vm.$t('controls.freeFlight.button')))])],1),_c('Group',{attrs:{\"title\":_vm.$t('lighting.title')}},[_c('Slider',{attrs:{\"value\":_vm.mapViewer.uniforms.sunlightStrength.value,\"min\":0,\"max\":1,\"step\":0.01},on:{\"update\":function($event){_vm.mapViewer.uniforms.sunlightStrength.value = $event}}},[_vm._v(_vm._s(_vm.$t('lighting.sunlight')))]),_c('Slider',{attrs:{\"value\":_vm.mapViewer.uniforms.ambientLight.value,\"min\":0,\"max\":1,\"step\":0.01},on:{\"update\":function($event){_vm.mapViewer.uniforms.ambientLight.value = $event}}},[_vm._v(_vm._s(_vm.$t('lighting.ambientLight')))])],1),_c('Group',{attrs:{\"title\":_vm.$t('resolution.title')}},_vm._l((_vm.qualityStages),function(stage){return _c('SimpleButton',{key:stage.name,attrs:{\"active\":_vm.mapViewer.superSampling === stage.value},on:{\"action\":function($event){_vm.$bluemap.mapViewer.superSampling = stage.value; _vm.$bluemap.saveUserSettings();}}},[_vm._v(_vm._s(stage.name))])}),1),_c('Group',{attrs:{\"title\":_vm.$t('renderDistance.title')}},[_c('Slider',{attrs:{\"value\":_vm.mapViewer.loadedHiresViewDistance,\"min\":50,\"max\":500,\"step\":10},on:{\"update\":function($event){_vm.mapViewer.loadedHiresViewDistance = $event; _vm.$bluemap.mapViewer.updateLoadedMapArea()},\"lazy\":function($event){return _vm.$bluemap.saveUserSettings()}}},[_vm._v(_vm._s(_vm.$t(\"renderDistance.hiresLayer\")))]),_c('Slider',{attrs:{\"value\":_vm.mapViewer.loadedLowresViewDistance,\"min\":500,\"max\":10000,\"step\":100},on:{\"update\":function($event){_vm.mapViewer.loadedLowresViewDistance = $event; _vm.$bluemap.mapViewer.updateLoadedMapArea()},\"lazy\":function($event){return _vm.$bluemap.saveUserSettings()}}},[_vm._v(_vm._s(_vm.$t(\"renderDistance.lowersLayer\")))])],1),_c('Group',{attrs:{\"title\":_vm.$t('freeFlightControls.title')}},[_c('Slider',{attrs:{\"value\":_vm.appState.controls.mouseSensitivity,\"min\":0.1,\"max\":5,\"step\":0.05},on:{\"update\":function($event){_vm.appState.controls.mouseSensitivity = $event; _vm.$bluemap.updateControlsSettings();},\"lazy\":function($event){return _vm.$bluemap.saveUserSettings()}}},[_vm._v(_vm._s(_vm.$t(\"freeFlightControls.mouseSensitivity\")))]),_c('SwitchButton',{attrs:{\"on\":_vm.appState.controls.invertMouse},on:{\"action\":function($event){_vm.appState.controls.invertMouse = !_vm.appState.controls.invertMouse; _vm.$bluemap.updateControlsSettings(); _vm.$bluemap.saveUserSettings()}}},[_vm._v(_vm._s(_vm.$t(\"freeFlightControls.invertMouseY\")))])],1),_c('Group',{attrs:{\"title\":_vm.$t('theme.title')}},_vm._l((_vm.themes),function(theme){return _c('SimpleButton',{key:theme.name,attrs:{\"active\":_vm.appState.theme === theme.value},on:{\"action\":function($event){_vm.$bluemap.setTheme(theme.value); _vm.$bluemap.saveUserSettings();}}},[_vm._v(_vm._s(theme.name))])}),1),(_vm.$i18n.languages.length > 1)?_c('Group',{attrs:{\"title\":_vm.$t('language.title')}},_vm._l((_vm.$i18n.languages),function(lang){return _c('SimpleButton',{key:lang.locale,attrs:{\"active\":lang.locale === _vm.$i18n.locale},on:{\"action\":function($event){_vm.$i18n.setLanguage(lang.locale); _vm.$bluemap.saveUserSettings();}}},[_vm._v(_vm._s(lang.name))])}),1):_vm._e(),_c('SwitchButton',{attrs:{\"on\":_vm.appState.debug},on:{\"action\":function($event){_vm.switchDebug(); _vm.$bluemap.saveUserSettings();}}},[_vm._v(_vm._s(_vm.$t(\"debug.button\")))]),_c('SimpleButton',{on:{\"action\":function($event){return _vm.$bluemap.resetSettings()}}},[_vm._v(_vm._s(_vm.$t(\"resetAllSettings.button\")))])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"group\"},[_c('span',{staticClass:\"title\"},[_vm._v(_vm._s(_vm.title))]),_c('div',{staticClass:\"content\"},[_vm._t(\"default\")],2)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"group\">\n    <span class=\"title\">{{ title }}</span>\n    <div class=\"content\">\n      <slot/>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: \"Group\",\n  props: {\n    title: String\n  }\n}\n</script>\n\n<style lang=\"scss\">\n.side-menu .group {\n  position: relative;\n  margin: 2em 0 1em;\n  padding-top: 1em;\n  border: solid 1px var(--theme-bg-light);\n\n\n  > .title {\n    position: absolute;\n    top: calc(-0.5em - 1px);\n    right: 0.5em;\n    padding: 0 0.5em;\n    background-color: var(--theme-bg);\n  }\n\n  &:first-child {\n    margin-top: 1em;\n  }\n\n  > .content {\n    max-height: 15em;\n    overflow-y: auto;\n  }\n}\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Group.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Group.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Group.vue?vue&type=template&id=282a5cc2&\"\nimport script from \"./Group.vue?vue&type=script&lang=js&\"\nexport * from \"./Group.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Group.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"slider\"},[_c('div',{staticClass:\"label\"},[_vm._t(\"default\"),_vm._v(\": \"),_c('span',{staticClass:\"value\"},[_vm._v(_vm._s(_vm.formattedValue))])],2),_c('label',[_c('input',{attrs:{\"type\":\"range\",\"min\":_vm.min,\"max\":_vm.max,\"step\":_vm.step},domProps:{\"value\":_vm.value},on:{\"input\":function($event){_vm.$emit('update', parseFloat($event.target.value))},\"change\":function($event){_vm.$emit('lazy', parseFloat($event.target.value))}}})])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n<div class=\"slider\">\n  <div class=\"label\"><slot />: <span class=\"value\">{{formattedValue}}</span></div>\n  <label>\n    <input type=\"range\" :min=\"min\" :max=\"max\" :step=\"step\" :value=\"value\" @input=\"$emit('update', parseFloat($event.target.value))\" @change=\"$emit('lazy', parseFloat($event.target.value))\">\n  </label>\n</div>\n</template>\n\n<script>\n\nfunction countDecimals(value) {\n  if(Math.floor(value) === value) return 0;\n  return value.toString().split(\".\")[1].length || 0;\n}\n\nexport default {\n  name: \"Slider\",\n  props: {\n    value: Number,\n    min: Number,\n    max: Number,\n    step: Number,\n  },\n  computed: {\n    formattedValue() {\n      return parseFloat(this.value).toFixed(countDecimals(this.step));\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\">\n.side-menu .slider {\n  line-height: 2em;\n  padding: 0 0.5em;\n\n  &:hover {\n    background-color: var(--theme-bg-light);\n  }\n\n  > .label {\n    > .value {\n      float: right;\n    }\n  }\n\n  > label {\n    > input {\n      appearance: none;\n      -moz-appearance: none;\n      -webkit-appearance: none;\n      outline: none;\n\n      width: 100%;\n      height: 1em;\n\n      border-radius: 1em;\n      //border: solid 0.125em var(--theme-fg-light);\n\n      overflow: hidden;\n      background-color: var(--theme-fg-light);\n\n      &::-webkit-slider-thumb {\n        appearance: none;\n        -moz-appearance: none;\n        -webkit-appearance: none;\n        outline: none;\n\n        width: 1em;\n        height: 1em;\n\n        border-radius: 100%;\n        border: solid 0.125em var(--theme-fg-light);\n\n        background-color: var(--theme-bg);\n\n        //box-shadow: calc(-100vw - 0.375em) 0 0 100vw var(--theme-switch-button-on);\n      }\n\n      &::-moz-range-thumb {\n        width: 0.75em;\n        height: 0.75em;\n\n        border-radius: 100%;\n        border: solid 0.125em var(--theme-fg-light);\n\n        background-color: var(--theme-bg);\n      }\n    }\n  }\n}\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Slider.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Slider.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Slider.vue?vue&type=template&id=54631848&\"\nimport script from \"./Slider.vue?vue&type=script&lang=js&\"\nexport * from \"./Slider.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Slider.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"switch-button\",on:{\"click\":function($event){return _vm.$emit('action')}}},[_c('div',{staticClass:\"label\"},[_vm._t(\"default\")],2),_c('SwitchHandle',{attrs:{\"on\":_vm.on}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"switch\",class:{on: _vm.on}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"switch\" :class=\"{on: on}\"></div>\n</template>\n\n<script>\nexport default {\n  name: \"SwitchHandle\",\n  props: {\n    on: Boolean\n  }\n}\n</script>\n\n<style lang=\"scss\">\n.side-menu .switch {\n  height: 1em;\n  width: 2em;\n\n  border-radius: 1em;\n  background-color: var(--theme-fg-light);\n\n  transition: background-color 0.3s;\n\n  &::after {\n    content: \"\";\n    display: block;\n    width: 0.75em;\n    height: 0.75em;\n    border-radius: 100%;\n\n    background-color: var(--theme-bg);\n\n    position: relative;\n    top: 0.125em;\n    left: 0.125em;\n\n    transition: left 0.3s;\n  }\n\n  &.on {\n    background-color: var(--theme-switch-button-on);\n\n    &::after {\n      left: 1.125em;\n    }\n  }\n}\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SwitchHandle.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SwitchHandle.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SwitchHandle.vue?vue&type=template&id=0f0670a5&\"\nimport script from \"./SwitchHandle.vue?vue&type=script&lang=js&\"\nexport * from \"./SwitchHandle.vue?vue&type=script&lang=js&\"\nimport style0 from \"./SwitchHandle.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\n<div class=\"switch-button\" @click=\"$emit('action')\">\n  <div class=\"label\"><slot /></div>\n  <SwitchHandle :on=\"on\" />\n</div>\n</template>\n\n<script>\nimport SwitchHandle from \"@/components/Menu/SwitchHandle\";\nexport default {\n  name: \"SwitchButton\",\n  components: {SwitchHandle},\n  props: {\n    on: Boolean\n  }\n}\n</script>\n\n<style lang=\"scss\">\n\n.side-menu .switch-button {\n  cursor: pointer;\n  user-select: none;\n  display: flex;\n  line-height: 2em;\n\n  padding: 0 0.5em;\n\n  > .label {\n    flex-grow: 1;\n\n    white-space: nowrap;\n    overflow-x: hidden;\n    text-overflow: ellipsis;\n  }\n\n  > .switch {\n    margin: 0.5em 0;\n  }\n\n  &:hover {\n    background-color: var(--theme-bg-light);\n  }\n}\n\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SwitchButton.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SwitchButton.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SwitchButton.vue?vue&type=template&id=0f1912ae&\"\nimport script from \"./SwitchButton.vue?vue&type=script&lang=js&\"\nexport * from \"./SwitchButton.vue?vue&type=script&lang=js&\"\nimport style0 from \"./SwitchButton.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export default {\n\tpageTitle: \"BlueMap - {map}\",\n\tmenu: {\n\t\ttitle: \"Menu\",\n\t\ttooltip: \"Menu\"\n\t},\n\tmaps: {\n\t\ttitle: \"Maps\",\n\t\tbutton: \"Maps\",\n\t\ttooltip: \"Map-List\"\n\t},\n\tmarkers: {\n\t\ttitle: \"Markers\",\n\t\tbutton: \"Markers\",\n\t\ttooltip: \"Marker-List\",\n\t\tmarker: \"marker | markers\",\n\t\tmarkerSet: \"marker-set | marker-sets\",\n\t\tsearchPlaceholder: \"Search...\",\n\t\tfollowPlayerTitle: \"Follow Player\"\n\t},\n\tsettings: {\n\t\ttitle: \"Settings\",\n\t\tbutton: \"Settings\"\n\t},\n\tgoFullscreen: {\n\t\tbutton: \"Go Fullscreen\"\n\t},\n\tresetCamera: {\n\t\tbutton: \"Reset Camera\",\n\t\ttooltip: \"Reset Camera & Position\"\n\t},\n\tupdateMap: {\n\t\tbutton: \"Update Map\",\n\t\ttooltip: \"Clear Tile Cache\"\n\t},\n\tlighting: {\n\t\ttitle: \"Lighting\",\n\t\tdayNightSwitch: {\n\t\t\ttooltip: \"Day/Night\"\n\t\t},\n\t\tsunlight: \"Sunlight\",\n\t\tambientLight: \"Ambient-Light\"\n\t},\n\tresolution: {\n\t\ttitle: \"Resolution\",\n\t\thigh: \"High (SSAA, x2)\",\n\t\tnormal: \"Normal (Native, x1)\",\n\t\tlow: \"Low (Upscaling, x0.5)\"\n\t},\n\tfreeFlightControls: {\n\t\ttitle: \"Free-Flight Controls\",\n\t\tmouseSensitivity: \"Mouse-Sensitivity\",\n\t\tinvertMouseY: \"Invert Mouse Y\"\n\t},\n\trenderDistance: {\n\t\ttitle: \"Render Distance\",\n\t\thiresLayer: \"Hires layer\",\n\t\tlowersLayer: \"Lowres layer\"\n\t},\n\ttheme: {\n\t\ttitle: \"Theme\",\n\t\tdefault: \"Default (System/Browser)\",\n\t\tdark: \"Dark\",\n\t\tlight: \"Light\"\n\t},\n\tdebug: {\n\t\tbutton: \"Debug\"\n\t},\n\tresetAllSettings: {\n\t\tbutton: \"Reset All Settings\"\n\t},\n\tplayers: {\n\t\ttitle: \"Players\",\n\t\ttooltip: \"Player-List\"\n\t},\n\tcompass: {\n\t\ttooltip: \"Compass / Face North\"\n\t},\n\tcontrols: {\n\t\ttitle: \"View / Controls\",\n\t\tperspective: {\n\t\t\tbutton: \"Perspective\",\n\t\t\ttooltip: \"Perspective-View\"\n\t\t},\n\t\tflatView: {\n\t\t\tbutton: \"Flat\",\n\t\t\ttooltip: \"Orthographic / Flat-View\",\n\t\t},\n\t\tfreeFlight: {\n\t\t\tbutton: \"Free-Flight\",\n\t\t\ttooltip: \"Free-Flight / Spectator Mode\"\n\t\t}\n\t},\n\tlanguage: {\n\t\ttitle: \"Language\",\n\t},\n\tblockTooltip: {\n\t\tblock: \"Block\",\n\t\tposition: \"Position\",\n\t\tchunk: \"Chunk\",\n\t\tregion: {\n\t\t\tregion: \"Region\",\n\t\t\tfile: \"File\"\n\t\t},\n\t\tlight: {\n\t\t\tlight: \"Light\",\n\t\t\tsun: \"Sun\",\n\t\t\tblock: \"Block\",\n\t\t}\n\t},\n\tinfo: {\n\t\ttitle: \"Info\",\n\t\tbutton: \"Info\",\n\t\tcontent: `\n<img src=\"assets/logo.png\" style=\"display: block; width: 40%; margin: 3em auto; border-radius: 50%\">\n<p>\n\t<h2>Mouse-Controls:</h2>\n\t<table>\n\t\t<tr><th>move</th><td><kbd>left-click</kbd> + drag</td></tr>\n\t\t<tr><th>zoom</th><td><kbd>mousewheel</kbd> (scroll)</td></tr>\n\t\t<tr><th>rotate / tilt</th><td><kbd>right-click</kbd> + drag</td></tr>\n\t</table>\n</p>\n<p>\n\t<h2>Keyboard-Controls:</h2>\n\t<table>\n\t\t<tr><th>move</th><td><kbd>wasd</kbd> / <kbd>arrow-keys</kbd></td></tr>\n\t\t<tr><th>zoom</th><td>Numpad: <kbd>+</kbd>/<kbd>-</kbd> or <kbd>Ins</kbd>/<kbd>Home</kbd></td></tr>\n\t\t<tr><th>rotate / tilt</th><td><kbd>Left-Alt</kbd> + <kbd>wasd</kbd> / <kbd>arrow-keys</kbd> or <kbd>Delete</kbd>/<kbd>End</kbd>/<kbd>Page Up</kbd>/<kbd>Page Down</kbd></td></tr>\n\t</table>\n</p>\n<p>\n\t<h2>Touch-Controls:</h2>\n\t<table>\n\t\t<tr><th>move</th><td>touch + drag</td></tr>\n\t\t<tr><th>zoom</th><td>touch with two fingers + pinch</td></tr>\n\t\t<tr><th>rotate / tilt</th><td>touch with two fingers + rotate / move up/down</td></tr>\n\t</table>\n</p>\n<br><hr>\n<p>\n\tThis map has been generated with &#9829; using <a href=\"https://bluecolo.red/bluemap\">BlueMap</a>.\n</p>\n\t\t`\n\t}\n};\n","import VueI18n from 'vue-i18n';\nimport Vue from 'vue';\nimport fallback from './fallback';\n\nVueI18n.prototype.setLanguage = async function(lang) {\n\ttry {\n\t\tif (!this.messages[lang]){\n\t\t\tlet messages = {};\n\t\t\tmessages = (await import(/* webpackIgnore: true */ `../lang/${lang}.js`)).default;\n\n\t\t\tthis.setLocaleMessage(lang, messages);\n\t\t}\n\n\t\tthis.locale = lang;\n\t\tdocument.querySelector('html').setAttribute('lang', lang);\n\t} catch (e) {\n\t\tconsole.error(`Failed to load language '${lang}'!`, e);\n\t}\n}\n\nVueI18n.prototype.loadLanguageSettings = async function() {\n\tlet settings = (await import(/* webpackIgnore: true */ \"../lang/settings.js\")).default;\n\tthis.languages = settings.languages;\n\tthis.setLanguage(settings.default);\n};\n\nVue.use(VueI18n);\n\nconst i18n = new VueI18n({\n\tlocale: 'fallback',\n\tfallbackLocale: 'fallback',\n\tsilentFallbackWarn: true,\n\tmessages: { fallback }\n});\n\nexport default i18n;\n","<template>\n  <div>\n    <Group :title=\"$t('controls.title')\">\n      <SimpleButton :active=\"appState.controls.state === 'perspective'\" @action=\"$bluemap.setPerspectiveView(500, appState.controls.state === 'free' ? 100 : 0)\">{{$t('controls.perspective.button')}}</SimpleButton>\n      <SimpleButton :active=\"appState.controls.state === 'flat'\" @action=\"$bluemap.setFlatView(500, appState.controls.state === 'free' ? 100 : 0)\">{{$t('controls.flatView.button')}}</SimpleButton>\n      <SimpleButton :active=\"appState.controls.state === 'free'\" @action=\"$bluemap.setFreeFlight(500)\">{{$t('controls.freeFlight.button')}}</SimpleButton>\n    </Group>\n\n    <Group :title=\"$t('lighting.title')\">\n      <Slider :value=\"mapViewer.uniforms.sunlightStrength.value\" :min=\"0\" :max=\"1\" :step=\"0.01\"\n              @update=\"mapViewer.uniforms.sunlightStrength.value = $event\">{{$t('lighting.sunlight')}}</Slider>\n      <Slider :value=\"mapViewer.uniforms.ambientLight.value\" :min=\"0\" :max=\"1\" :step=\"0.01\"\n              @update=\"mapViewer.uniforms.ambientLight.value = $event\">{{$t('lighting.ambientLight')}}</Slider>\n    </Group>\n\n    <Group :title=\"$t('resolution.title')\">\n      <SimpleButton v-for=\"stage of qualityStages\" :key=\"stage.name\"\n                    :active=\"mapViewer.superSampling === stage.value\"\n                    @action=\"$bluemap.mapViewer.superSampling = stage.value; $bluemap.saveUserSettings();\"\n      >{{stage.name}}</SimpleButton>\n    </Group>\n\n    <Group :title=\"$t('renderDistance.title')\">\n      <Slider :value=\"mapViewer.loadedHiresViewDistance\" :min=\"50\" :max=\"500\" :step=\"10\"\n              @update=\"mapViewer.loadedHiresViewDistance = $event; $bluemap.mapViewer.updateLoadedMapArea()\" @lazy=\"$bluemap.saveUserSettings()\">{{ $t(\"renderDistance.hiresLayer\") }}</Slider>\n      <Slider :value=\"mapViewer.loadedLowresViewDistance\" :min=\"500\" :max=\"10000\" :step=\"100\"\n              @update=\"mapViewer.loadedLowresViewDistance = $event; $bluemap.mapViewer.updateLoadedMapArea()\" @lazy=\"$bluemap.saveUserSettings()\">{{ $t(\"renderDistance.lowersLayer\") }}</Slider>\n    </Group>\n\n    <Group :title=\"$t('freeFlightControls.title')\">\n      <Slider :value=\"appState.controls.mouseSensitivity\" :min=\"0.1\" :max=\"5\" :step=\"0.05\"\n              @update=\"appState.controls.mouseSensitivity = $event; $bluemap.updateControlsSettings();\" @lazy=\"$bluemap.saveUserSettings()\">{{ $t(\"freeFlightControls.mouseSensitivity\") }}</Slider>\n      <SwitchButton :on=\"appState.controls.invertMouse\" @action=\"appState.controls.invertMouse = !appState.controls.invertMouse; $bluemap.updateControlsSettings(); $bluemap.saveUserSettings()\">{{ $t(\"freeFlightControls.invertMouseY\") }}</SwitchButton>\n    </Group>\n\n    <Group :title=\"$t('theme.title')\">\n      <SimpleButton v-for=\"theme of themes\" :key=\"theme.name\"\n                    :active=\"appState.theme === theme.value\"\n                    @action=\"$bluemap.setTheme(theme.value); $bluemap.saveUserSettings();\"\n      >{{theme.name}}</SimpleButton>\n    </Group>\n\n    <Group v-if=\"$i18n.languages.length > 1\" :title=\"$t('language.title')\">\n      <SimpleButton v-for=\"lang of $i18n.languages\" :key=\"lang.locale\"\n                    :active=\"lang.locale === $i18n.locale\"\n                    @action=\"$i18n.setLanguage(lang.locale); $bluemap.saveUserSettings();\"\n      >{{lang.name}}</SimpleButton>\n    </Group>\n\n    <SwitchButton :on=\"appState.debug\" @action=\"switchDebug(); $bluemap.saveUserSettings();\">{{ $t(\"debug.button\") }}</SwitchButton>\n\n    <SimpleButton @action=\"$bluemap.resetSettings()\">{{ $t(\"resetAllSettings.button\") }}</SimpleButton>\n  </div>\n</template>\n\n<script>\nimport Group from \"@/components/Menu/Group\";\nimport SimpleButton from \"@/components/Menu/SimpleButton\";\nimport Slider from \"@/components/Menu/Slider\";\nimport SwitchButton from \"@/components/Menu/SwitchButton\";\nimport i18n from \"../../i18n\";\n\nconst themes = [\n  {get name(){ return i18n.t(\"theme.default\")}, value: null},\n  {get name(){ return i18n.t(\"theme.dark\")}, value: 'dark'},\n  {get name(){ return i18n.t(\"theme.light\")}, value: 'light'},\n];\n\nconst qualityStages = [\n  {get name(){ return i18n.t(\"resolution.high\")}, value: 2},\n  {get name(){ return i18n.t(\"resolution.normal\")}, value: 1},\n  {get name(){ return i18n.t(\"resolution.low\")}, value: 0.5},\n];\n\nexport default {\nname: \"SettingsMenu\",\n  components: {SwitchButton, Slider, SimpleButton, Group},\n  data() {\n    return {\n      appState: this.$bluemap.appState,\n      mapViewer: this.$bluemap.mapViewer.data,\n\n      qualityStages: qualityStages,\n      themes: themes,\n    }\n  },\n  methods: {\n    switchDebug() {\n      this.$bluemap.setDebug(!this.appState.debug);\n    }\n  }\n}\n</script>\n\n<style>\n\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SettingsMenu.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SettingsMenu.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SettingsMenu.vue?vue&type=template&id=15966b59&\"\nimport script from \"./SettingsMenu.vue?vue&type=script&lang=js&\"\nexport * from \"./SettingsMenu.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport i18n from \"../i18n\";\n\nexport class MainMenu {\n\n    static NULL_PAGE = {\n        id: \"-\",\n        title: \"-\"\n    }\n\n    constructor() {\n        this.isOpen = false;\n        this.pageStack = [];\n    }\n\n    currentPage() {\n        if (this.pageStack.length === 0) return MainMenu.NULL_PAGE;\n        return this.pageStack[this.pageStack.length - 1];\n    }\n\n    openPage(id = \"root\", title = () => i18n.t(\"menu.title\"), data = {}) {\n        if (!this.isOpen){\n            this.pageStack.splice(0, this.pageStack.length);\n            this.isOpen = true;\n        }\n\n        if (typeof title === \"function\"){\n            this.pageStack.push({\n                id: id,\n                get title(){ return title() },\n                ...data\n            });\n        } else {\n            this.pageStack.push({\n                id: id,\n                title: title,\n                ...data\n            });\n        }\n\n    }\n\n    closePage() {\n        this.pageStack.splice(this.pageStack.length - 1, 1);\n\n        if (this.pageStack.length < 1) {\n            this.isOpen = false\n        }\n    }\n\n    reOpenPage() {\n        if (this.pageStack.length === 0){\n            this.openPage();\n        } else if (this.pageStack[0].id !== 'root') {\n            this.pageStack.splice(0, this.pageStack.length);\n            this.openPage();\n        } else {\n            this.isOpen = true;\n        }\n    }\n\n    closeAll() {\n        this.isOpen = false;\n    }\n\n}","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{staticClass:\"marker-sets\"},_vm._l((_vm.filteredMarkerSets),function(markerSet){return _c('MarkerSet',{key:markerSet.id,attrs:{\"marker-set\":markerSet},on:{\"more\":function($event){return _vm.openMore(markerSet)}}})}),1),(_vm.filteredMarkerSets.length > 0 & _vm.thisMarkerSet.markers.length > 0)?_c('hr'):_vm._e(),(_vm.thisMarkerSet.markers.length > 0)?_c('div',{staticClass:\"markers\"},[_c('TextInput',{attrs:{\"value\":_vm.filter.search,\"placeholder\":_vm.$t('markers.searchPlaceholder')},on:{\"input\":function($event){_vm.filter.search = $event.target.value}}}),_vm._l((_vm.filteredMarkers),function(marker){return _c('MarkerItem',{key:marker.id,attrs:{\"marker\":marker}})})],2):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"marker-item\",class:{'marker-hidden': !_vm.marker.visible}},[_c('div',{staticClass:\"marker-button\",attrs:{\"title\":_vm.marker.id},on:{\"click\":function($event){return _vm.click(false)}}},[(_vm.marker.type === 'player')?_c('div',{staticClass:\"icon\"},[_c('img',{attrs:{\"src\":'assets/playerheads/' + _vm.marker.playerUuid + '.png',\"alt\":\"playerhead\"},on:{\"error\":_vm.steve}})]):_vm._e(),_c('div',{staticClass:\"info\"},[_c('div',{staticClass:\"label\"},[_vm._v(_vm._s(_vm.markerLabel))]),_c('div',{staticClass:\"stats\"},[(_vm.appState.debug)?_c('div',[_vm._v(\" \"+_vm._s(_vm.marker.type)+\"-marker \")]):_vm._e(),_c('div',[_vm._v(\" (\"+_vm._s(_vm._f(\"position\")(_vm.marker.position.x))+\" | \"+_vm._s(_vm._f(\"position\")(_vm.marker.position.y))+\" | \"+_vm._s(_vm._f(\"position\")(_vm.marker.position.z))+\") \")])])])]),(_vm.marker.type === 'player')?_c('div',{staticClass:\"follow-player-button\",class:{active: _vm.controls.controls.followingPlayer && _vm.controls.controls.followingPlayer.id === _vm.marker.id},attrs:{\"title\":_vm.$t('markers.followPlayerTitle')},on:{\"click\":function($event){return _vm.click(true)}}},[_c('svg',{attrs:{\"viewBox\":\"0 0 30 30\"}},[_c('circle',{attrs:{\"fill\":\"none\",\"stroke-width\":\"3\",\"stroke-miterlimit\":\"10\",\"cx\":\"15\",\"cy\":\"15\",\"r\":\"10.375\"}}),_c('line',{attrs:{\"fill\":\"none\",\"stroke-width\":\"3\",\"stroke-miterlimit\":\"10\",\"x1\":\"3.25\",\"y1\":\"15\",\"x2\":\"1.063\",\"y2\":\"15\"}}),_c('line',{attrs:{\"fill\":\"none\",\"stroke-width\":\"3\",\"stroke-miterlimit\":\"10\",\"x1\":\"15\",\"y1\":\"26.75\",\"x2\":\"15\",\"y2\":\"28.938\"}}),_c('line',{attrs:{\"fill\":\"none\",\"stroke-width\":\"3\",\"stroke-miterlimit\":\"10\",\"x1\":\"26.75\",\"y1\":\"15\",\"x2\":\"28.938\",\"y2\":\"15\"}}),_c('line',{attrs:{\"fill\":\"none\",\"stroke-width\":\"3\",\"stroke-miterlimit\":\"10\",\"x1\":\"15\",\"y1\":\"3.25\",\"x2\":\"15\",\"y2\":\"1.063\"}}),_c('circle',{attrs:{\"stroke\":\"none\",\"cx\":\"15\",\"cy\":\"15\",\"r\":\"6.042\"}})])]):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"marker-item\" :class=\"{'marker-hidden': !marker.visible}\">\n    <div class=\"marker-button\" :title=\"marker.id\" @click=\"click(false)\">\n      <div class=\"icon\" v-if=\"marker.type === 'player'\">\n        <img :src=\"'assets/playerheads/' + marker.playerUuid + '.png'\" alt=\"playerhead\" @error=\"steve\">\n      </div>\n      <div class=\"info\">\n        <div class=\"label\">{{markerLabel}}</div>\n        <div class=\"stats\">\n          <div v-if=\"appState.debug\">\n            {{marker.type}}-marker\n          </div>\n          <div>\n            ({{marker.position.x | position}} | {{marker.position.y | position}} | {{marker.position.z | position}})\n          </div>\n        </div>\n      </div>\n    </div>\n    <div class=\"follow-player-button\" :class=\"{active: controls.controls.followingPlayer && controls.controls.followingPlayer.id === marker.id}\"\n         v-if=\"marker.type === 'player'\" @click=\"click(true)\" :title=\"$t('markers.followPlayerTitle')\">\n      <svg viewBox=\"0 0 30 30\">\n        <circle fill=\"none\" stroke-width=\"3\" stroke-miterlimit=\"10\" cx=\"15\" cy=\"15\" r=\"10.375\"/>\n        <line fill=\"none\" stroke-width=\"3\" stroke-miterlimit=\"10\" x1=\"3.25\" y1=\"15\" x2=\"1.063\" y2=\"15\"/>\n        <line fill=\"none\" stroke-width=\"3\" stroke-miterlimit=\"10\" x1=\"15\" y1=\"26.75\" x2=\"15\" y2=\"28.938\"/>\n        <line fill=\"none\" stroke-width=\"3\" stroke-miterlimit=\"10\" x1=\"26.75\" y1=\"15\" x2=\"28.938\" y2=\"15\"/>\n        <line fill=\"none\" stroke-width=\"3\" stroke-miterlimit=\"10\" x1=\"15\" y1=\"3.25\" x2=\"15\" y2=\"1.063\"/>\n        <circle stroke=\"none\" cx=\"15\" cy=\"15\" r=\"6.042\"/>\n      </svg>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: \"MarkerItem\",\n  props: {\n    marker: Object,\n  },\n  data() {\n    return {\n      appState: this.$bluemap.appState,\n      controls: this.$bluemap.mapViewer.controlsManager.data,\n    }\n  },\n  computed: {\n    markerLabel() {\n      switch (this.marker.type) {\n        case \"player\" : return this.marker.name;\n        default : break;\n      }\n\n      if (this.marker.label){\n        let strippedLabel = /^(?:<[^>]*>\\s*)*([^<>]*\\S[^<>]*)(?:<|$)/gi.exec(this.marker.label);\n        if (strippedLabel && strippedLabel.length > 1) {\n          return strippedLabel[1];\n        }\n      }\n\n      return this.marker.id;\n    }\n  },\n  filters: {\n    position(v) {\n      return Math.floor(v);\n    }\n  },\n  methods: {\n    async click(follow) {\n      let cm = this.$bluemap.mapViewer.controlsManager;\n      \n      if (cm.controls && cm.controls.stopFollowingPlayerMarker) {\n        cm.controls.stopFollowingPlayerMarker();\n      }\n\n      if (this.marker.type === \"player\") {\n\n        if (this.$bluemap.mapViewer.map.data.world !== this.marker.world) {\n          let matchingMap = null;\n          for (let map of this.$bluemap.maps) {\n            if (map.data.world === this.marker.world) {\n              matchingMap = map;\n              break;\n            }\n          }\n\n          if (!matchingMap) return;\n\n          //this.$bluemap.appState.menu.closeAll();\n          await this.$bluemap.switchMap(matchingMap.data.id);\n        }\n\n        if (follow && cm.controls && cm.controls.followPlayerMarker) {\n          cm.controls.followPlayerMarker(this.marker);\n        }\n\n      } else if (!this.marker.visible) {\n        return;\n      }\n\n      cm.position.copy(this.marker.position);\n    },\n    steve(event) {\n      event.target.src = \"assets/steve.png\";\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\">\n@import \"~@/scss/variables.scss\";\n\n.side-menu .marker-item {\n  display: flex;\n\n  margin: 0.5em 0;\n  &:first-child {\n    margin-top: 0;\n  }\n  &:last-child {\n    margin-bottom: 0;\n  }\n\n  white-space: nowrap;\n  user-select: none;\n\n  &.marker-hidden {\n    opacity: 0.5;\n    filter: grayscale(1);\n  }\n\n  .marker-button {\n    display: flex;\n    flex-grow: 1;\n    cursor: pointer;\n\n    &:hover {\n      background-color: var(--theme-bg-light);\n    }\n\n    > .info {\n      position: relative;\n      flex-grow: 1;\n      overflow-x: hidden;\n      text-overflow: ellipsis;\n\n      .label {\n        line-height: 2em;\n        overflow-x: hidden;\n        text-overflow: ellipsis;\n        margin: 0 0.5em 1.5em 0.5em;\n      }\n\n      .stats {\n        display: flex;\n        margin: 0 0.5em;\n\n        position: absolute;\n        bottom: 0;\n\n        font-size: 0.8em;\n        line-height: 2em;\n        color: var(--theme-fg-light);\n\n        > div {\n          &:not(:first-child) {\n            margin-left: 0.5em;\n            padding-left: 0.5em;\n            border-left: solid 1px var(--theme-bg-light);\n          }\n        }\n      }\n    }\n\n    > .icon {\n      height: 2.5em;\n      margin: 0.5em;\n      flex-shrink: 0;\n\n      img {\n        image-rendering: pixelated;\n        height: 100%;\n      }\n    }\n  }\n\n  > .follow-player-button {\n    width: 2em;\n    cursor: pointer;\n    background-color: var(--theme-bg);\n\n    &:hover, &.active {\n      background-color: var(--theme-bg-light);\n    }\n\n    > svg {\n      position: relative;\n      fill: var(--theme-fg-light);\n      stroke: var(--theme-fg-light);\n\n      top: 50%;\n      transform: translate(0, -50%) scale(0.75);\n    }\n\n    &:active {\n      background-color: var(--theme-fg-light);\n      color: var(--theme-bg);\n\n      > svg {\n        fill: var(--theme-bg-light);\n        stroke: var(--theme-bg-light);\n      }\n    }\n  }\n}\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MarkerItem.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MarkerItem.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./MarkerItem.vue?vue&type=template&id=62ce9235&\"\nimport script from \"./MarkerItem.vue?vue&type=script&lang=js&\"\nexport * from \"./MarkerItem.vue?vue&type=script&lang=js&\"\nimport style0 from \"./MarkerItem.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('input',{staticClass:\"text-input\",attrs:{\"type\":\"text\"},domProps:{\"value\":_vm.value},on:{\"input\":function($event){return _vm.$emit('input', $event)},\"keydown\":function($event){return $event.stopPropagation()}}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <input class=\"text-input\" type=\"text\" :value=\"value\" @input=\"$emit('input', $event)\" @keydown=\"$event.stopPropagation()\">\n</template>\n\n<script>\nexport default {\n  name: \"TextInput\",\n  props: {\n    value: String\n  }\n}\n</script>\n\n<style lang=\"scss\">\n.side-menu .text-input {\n  background-color: var(--theme-bg-light);\n  width: calc(100% - 1em);\n  padding: 0.5em;\n}\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TextInput.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TextInput.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./TextInput.vue?vue&type=template&id=a1c45c0c&\"\nimport script from \"./TextInput.vue?vue&type=script&lang=js&\"\nexport * from \"./TextInput.vue?vue&type=script&lang=js&\"\nimport style0 from \"./TextInput.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"marker-set\",attrs:{\"title\":_vm.markerSet.id}},[_c('div',{staticClass:\"info\",on:{\"click\":_vm.toggle}},[_c('div',{staticClass:\"marker-set-switch\"},[_c('div',{staticClass:\"label\"},[_vm._v(_vm._s(_vm.label))]),(_vm.markerSet.toggleable)?_c('SwitchHandle',{attrs:{\"on\":_vm.markerSet.visible}}):_vm._e()],1),_c('div',{staticClass:\"stats\"},[_c('div',[_vm._v(\" \"+_vm._s(_vm.markerSet.markers.length)+\" \"+_vm._s(_vm.$tc('markers.marker', _vm.markerSet.markers.length))+\" \")]),(_vm.filteredMarkerSets.length > 0)?_c('div',[_vm._v(\" \"+_vm._s(_vm.filteredMarkerSets.length)+\" \"+_vm._s(_vm.$tc('markers.markerSet', _vm.filteredMarkerSets.length))+\" \")]):_vm._e()])]),_c('div',{staticClass:\"open-menu-button\",on:{\"click\":function($event){return _vm.$emit('more', $event)}}},[_c('svg',{attrs:{\"viewBox\":\"0 0 30 30\"}},[_c('path',{attrs:{\"d\":\"M25.004,9.294c0,0.806-0.75,1.46-1.676,1.46H6.671c-0.925,0-1.674-0.654-1.674-1.46l0,0\\n\\tc0-0.807,0.749-1.461,1.674-1.461h16.657C24.254,7.833,25.004,8.487,25.004,9.294L25.004,9.294z\"}}),_c('path',{attrs:{\"d\":\"M25.004,20.706c0,0.807-0.75,1.461-1.676,1.461H6.671c-0.925,0-1.674-0.654-1.674-1.461l0,0\\n\\tc0-0.807,0.749-1.461,1.674-1.461h16.657C24.254,19.245,25.004,19.899,25.004,20.706L25.004,20.706z\"}})])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"marker-set\" :title=\"markerSet.id\">\n    <div class=\"info\" @click=\"toggle\">\n      <div class=\"marker-set-switch\">\n        <div class=\"label\">{{ label }}</div>\n        <SwitchHandle :on=\"markerSet.visible\" v-if=\"markerSet.toggleable\"/>\n      </div>\n      <div class=\"stats\">\n        <div>\n          {{ markerSet.markers.length }}\n          {{ $tc('markers.marker', markerSet.markers.length) }}\n        </div>\n        <div v-if=\"filteredMarkerSets.length > 0\">\n          {{ filteredMarkerSets.length }}\n          {{ $tc('markers.markerSet', filteredMarkerSets.length) }}\n        </div>\n      </div>\n    </div>\n    <div class=\"open-menu-button\" @click=\"$emit('more', $event)\">\n      <svg viewBox=\"0 0 30 30\">\n        <path d=\"M25.004,9.294c0,0.806-0.75,1.46-1.676,1.46H6.671c-0.925,0-1.674-0.654-1.674-1.46l0,0\n\tc0-0.807,0.749-1.461,1.674-1.461h16.657C24.254,7.833,25.004,8.487,25.004,9.294L25.004,9.294z\"/>\n        <path d=\"M25.004,20.706c0,0.807-0.75,1.461-1.676,1.461H6.671c-0.925,0-1.674-0.654-1.674-1.461l0,0\n\tc0-0.807,0.749-1.461,1.674-1.461h16.657C24.254,19.245,25.004,19.899,25.004,20.706L25.004,20.706z\"/>\n      </svg>\n    </div>\n  </div>\n</template>\n\n<script>\nimport SwitchHandle from \"@/components/Menu/SwitchHandle\";\n\nexport default {\n  name: \"MarkerSet\",\n  components: {SwitchHandle},\n  props: {\n    markerSet: Object,\n  },\n  computed: {\n    filteredMarkerSets() {\n      return this.markerSet.markerSets.filter(markerSet => {\n        return (markerSet.id !== \"bm-popup-set\");\n      });\n    },\n    label() {\n      if (this.markerSet.id === \"bm-players\") return this.$t(\"players.title\");\n      return this.markerSet.label;\n    }\n  },\n  methods: {\n    toggle() {\n      if (this.markerSet.toggleable) {\n        this.markerSet.visible = !this.markerSet.visible\n      }\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\">\n.side-menu .marker-set {\n  display: flex;\n  user-select: none;\n\n  line-height: 2em;\n\n  margin: 0.5em 0;\n\n  &:first-child {\n    margin-top: 0;\n  }\n\n  &:last-child {\n    margin-bottom: 0;\n  }\n\n  > .info {\n    flex-grow: 1;\n    cursor: pointer;\n\n    &:hover {\n      background-color: var(--theme-bg-light);\n    }\n\n    > .marker-set-switch {\n      position: relative;\n\n      .label {\n        margin: 0 3em 0 0.5em;\n      }\n\n      > .switch {\n        position: absolute;\n        top: 0.5em;\n        right: 0.5em;\n      }\n    }\n\n    > .stats {\n      display: flex;\n\n      margin: 0 0.5em;\n\n      font-size: 0.8em;\n      line-height: 2em;\n      color: var(--theme-fg-light);\n\n      > div {\n        &:not(:first-child) {\n          margin-left: 0.5em;\n          padding-left: 0.5em;\n          border-left: solid 1px var(--theme-bg-light);\n        }\n      }\n    }\n  }\n\n  > .open-menu-button {\n    width: 2em;\n    cursor: pointer;\n\n    &:hover {\n      background-color: var(--theme-bg-light);\n    }\n\n    > svg {\n      position: relative;\n      fill: var(--theme-fg-light);\n\n      top: 50%;\n      transform: translate(0, -50%) scale(0.75);\n\n      path:nth-child(1) {\n        transform-origin: 15px 9px;\n        transform: translate(0, 10px) rotate(-30deg);\n      }\n\n      path:nth-child(2) {\n        transform-origin: 15px 21px;\n        transform: translate(0, -10px) rotate(30deg);\n      }\n    }\n\n    &:active {\n      background-color: var(--theme-fg-light);\n      color: var(--theme-bg);\n\n      > svg {\n        fill: var(--theme-bg-light);\n      }\n    }\n  }\n}\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MarkerSet.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MarkerSet.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./MarkerSet.vue?vue&type=template&id=56f7b506&\"\nimport script from \"./MarkerSet.vue?vue&type=script&lang=js&\"\nexport * from \"./MarkerSet.vue?vue&type=script&lang=js&\"\nimport style0 from \"./MarkerSet.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\n<div>\n  <div class=\"marker-sets\">\n    <MarkerSet v-for=\"markerSet of filteredMarkerSets\" :key=\"markerSet.id\" :marker-set=\"markerSet\" @more=\"openMore(markerSet)\" />\n  </div>\n  <hr v-if=\"filteredMarkerSets.length > 0 & thisMarkerSet.markers.length > 0\">\n  <div class=\"markers\" v-if=\"thisMarkerSet.markers.length > 0\">\n    <TextInput :value=\"filter.search\" @input=\"filter.search = $event.target.value\" :placeholder=\"$t('markers.searchPlaceholder')\" />\n    <MarkerItem v-for=\"marker of filteredMarkers\" :key=\"marker.id\" :marker=\"marker\" />\n  </div>\n</div>\n</template>\n\n<script>\nimport MarkerItem from \"@/components/Menu/MarkerItem\";\nimport TextInput from \"@/components/Menu/TextInput\";\nimport MarkerSet from \"@/components/Menu/MarkerSet\";\nimport {MainMenu} from \"@/js/MainMenu\";\nexport default {\n  name: \"MarkerSetMenu\",\n  components: {MarkerSet, TextInput, MarkerItem},\n  props: {\n    menu: MainMenu\n  },\n  data() {\n    return {\n      filter: {\n        search: \"\",\n      }\n    }\n  },\n  computed: {\n    thisMarkerSet() {\n      return this.menu.currentPage().markerSet;\n    },\n    filteredMarkers() {\n      return [...this.thisMarkerSet.markers].sort((a, b) => {\n        if (a.id < b.id) return -1;\n        if (a.id > b.id) return 1;\n        return 0;\n      }).filter(marker => {\n        if (!this.filter.search) return true;\n        if (marker.id.includesCI(this.filter.search)) return true;\n        if (marker.label && marker.label.includesCI(this.filter.search)) return true;\n        if (marker.type === \"player\" && (marker.name.includesCI(this.filter.search) || marker.playerUuid.includesCI(this.filter.search))) return true;\n        return false;\n      });\n    },\n    filteredMarkerSets() {\n      return this.thisMarkerSet.markerSets.filter(markerSet => {\n        return (markerSet.id !== \"bm-popup-set\");\n      });\n    }\n  },\n  methods: {\n    openMore(markerSet) {\n      this.menu.openPage(\n          this.menu.currentPage().id,\n          this.menu.currentPage().title + \" > \" + markerSet.label,\n          {markerSet: markerSet}\n      )\n    }\n  }\n}\n</script>\n\n<style>\n\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MarkerSetMenu.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MarkerSetMenu.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./MarkerSetMenu.vue?vue&type=template&id=21f0c4c5&\"\nimport script from \"./MarkerSetMenu.vue?vue&type=script&lang=js&\"\nexport * from \"./MarkerSetMenu.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"map-button\",class:{selected: _vm.map.id === _vm.selectedMapId},attrs:{\"title\":_vm.map.id},on:{\"click\":function($event){return _vm.switchMap(_vm.map.id)}}},[_c('span',{staticClass:\"sky\",style:({color: 'rgb(' + _vm.map.skyColor.r * 255 + ',' + _vm.map.skyColor.g * 255 + ',' + _vm.map.skyColor.b * 255 + ')'})},[_vm._v(\"•\")]),_c('span',{staticClass:\"name\"},[_vm._v(_vm._s(_vm.map.name))])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"map-button\" :class=\"{selected: map.id === selectedMapId}\" @click=\"switchMap(map.id)\" :title=\"map.id\">\n    <span class=\"sky\" :style=\"{color: 'rgb(' + map.skyColor.r * 255 + ',' + map.skyColor.g * 255 + ',' + map.skyColor.b * 255 + ')'}\">&bull;</span>\n    <span class=\"name\">{{map.name}}</span>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: \"MapButton\",\n  props: {\n    map: Object,\n  },\n  data() {\n    return {\n      mapViewer: this.$bluemap.mapViewer.data,\n      appState: this.$bluemap.appState,\n    }\n  },\n  computed: {\n    selectedMapId() {\n      return this.mapViewer.map ? this.mapViewer.map.id : null;\n    }\n  },\n  methods: {\n    switchMap(mapId) {\n      this.$bluemap.switchMap(mapId, true);\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\">\n.side-menu .map-button {\n  position: relative;\n  cursor: pointer;\n  user-select: none;\n\n  height: 2em;\n  line-height: 2em;\n\n  white-space: nowrap;\n  overflow-x: hidden;\n  text-overflow: ellipsis;\n\n  &.selected, &:hover {\n    background-color: var(--theme-bg-light);\n  }\n\n  &:active {\n    background-color: var(--theme-fg-light);\n    color: var(--theme-bg);\n  }\n\n  .sky {\n    float: left;\n    border-radius: 100%;\n\n    width: 0.5em;\n    height: 0.5em;\n\n    margin: 0 0.25em 0 0.5em;\n  }\n\n  .id {\n    font-style: italic;\n    color: var(--theme-fg-light);\n\n    margin: 0 0.5em;\n  }\n}\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MapButton.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MapButton.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./MapButton.vue?vue&type=template&id=5528b08c&\"\nimport script from \"./MapButton.vue?vue&type=script&lang=js&\"\nexport * from \"./MapButton.vue?vue&type=script&lang=js&\"\nimport style0 from \"./MapButton.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\n  <SideMenu :open=\"menu.isOpen\"\n            :title=\"menu.currentPage().title\"\n            :back=\"menu.pageStack.length > 1\"\n            @back=\"menu.closePage()\"\n            @close=\"menu.closeAll()\">\n\n    <div v-if=\"menu.currentPage().id === 'root'\">\n      <SimpleButton @action=\"menu.openPage('maps', () => $t('maps.title'))\" :submenu=\"true\">{{ $t(\"maps.button\") }}</SimpleButton>\n      <SimpleButton @action=\"menu.openPage('markers', () => $t('markers.title'), {markerSet: markers})\" :submenu=\"true\">{{ $t(\"markers.button\") }}</SimpleButton>\n      <SimpleButton @action=\"menu.openPage('settings', () => $t('settings.title'))\" :submenu=\"true\">{{ $t(\"settings.button\") }}</SimpleButton>\n      <SimpleButton @action=\"menu.openPage('info', () => $t('info.title'))\" :submenu=\"true\">{{ $t(\"info.button\") }}</SimpleButton>\n      <hr>\n      <SimpleButton @action=\"goFullscreen\">{{ $t(\"goFullscreen.button\") }}</SimpleButton>\n      <SimpleButton @action=\"$bluemap.resetCamera()\">{{ $t(\"resetCamera.button\") }}</SimpleButton>\n      <SimpleButton @action=\"$bluemap.updateMap()\" :title=\"$t('updateMap.tooltip')\">{{ $t(\"updateMap.button\") }}</SimpleButton>\n    </div>\n\n    <div v-if=\"menu.currentPage().id === 'maps'\">\n      <MapButton v-for=\"map of appState.maps\" :key=\"map.id\" :map=\"map\" />\n    </div>\n\n    <MarkerSetMenu v-if=\"menu.currentPage().id === 'markers'\" :menu=\"menu\" />\n\n    <SettingsMenu v-if=\"menu.currentPage().id === 'settings'\" />\n\n    <div class=\"info-content\" v-if=\"menu.currentPage().id === 'info'\" v-html=\"$t('info.content')\"></div>\n\n  </SideMenu>\n</template>\n\n<script>\nimport SideMenu from \"@/components/Menu/SideMenu\";\nimport SimpleButton from \"@/components/Menu/SimpleButton\";\nimport SettingsMenu from \"@/components/Menu/SettingsMenu\";\nimport {MainMenu} from \"@/js/MainMenu\";\nimport MarkerSetMenu from \"@/components/Menu/MarkerSetMenu\";\nimport MapButton from \"@/components/Menu/MapButton\";\n\nexport default {\n  name: \"MainMenu\",\n  components: {MapButton, MarkerSetMenu, SettingsMenu, SimpleButton, SideMenu},\n  props: {\n    menu: MainMenu\n  },\n  data() {\n    return {\n      appState: this.$bluemap.appState,\n      markers: this.$bluemap.mapViewer.markers.data,\n    }\n  },\n  methods: {\n    goFullscreen() {\n      document.body.requestFullscreen();\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\">\n.info-content {\n  font-size: 0.8em;\n\n  table {\n    border-collapse: collapse;\n    width: 100%;\n\n    tr {\n      th, td {\n        padding: 0.2em 0.5em;\n        border: solid 1px var(--theme-bg-light);\n      }\n\n      th {\n        font-weight: inherit;\n        text-align: inherit;\n      }\n    }\n  }\n}\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MainMenu.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MainMenu.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./MainMenu.vue?vue&type=template&id=bd5a469a&\"\nimport script from \"./MainMenu.vue?vue&type=script&lang=js&\"\nexport * from \"./MainMenu.vue?vue&type=script&lang=js&\"\nimport style0 from \"./MainMenu.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{class:{disabled: !_vm.enabled},attrs:{\"id\":\"ff-mobile-controls\"}},[_c('div',{staticClass:\"move-fields\"},[_c('div',{staticClass:\"button up-button\",on:{\"touchstart\":function($event){_vm.forward = 1; _vm.forwardPointer = $event.changedTouches[0].identifier; $event.preventDefault();}}},[_c('svg',{attrs:{\"viewBox\":\"0 0 100 50\"}},[_c('path',{attrs:{\"d\":\"M6.75,48.375c-2.75,0-3.384-1.565-1.409-3.479L46.41,5.104c1.975-1.914,5.207-1.913,7.182,0l41.067,39.792\\n          c1.975,1.914,1.341,3.479-1.409,3.479H6.75z\"}})])]),_c('div',{staticClass:\"button down-button\",on:{\"touchstart\":function($event){_vm.forward = -1; _vm.forwardPointer = $event.changedTouches[0].identifier; $event.preventDefault();}}},[_c('svg',{staticClass:\"down\",attrs:{\"viewBox\":\"0 0 100 50\"}},[_c('path',{attrs:{\"d\":\"M6.75,48.375c-2.75,0-3.384-1.565-1.409-3.479L46.41,5.104c1.975-1.914,5.207-1.913,7.182,0l41.067,39.792\\n          c1.975,1.914,1.341,3.479-1.409,3.479H6.75z\"}})])])]),_c('div',{staticClass:\"height-fields\"},[_c('div',{staticClass:\"button up-button\",on:{\"touchstart\":function($event){_vm.up = 1; _vm.upPointer = $event.changedTouches[0].identifier; $event.preventDefault();}}},[_c('svg',{attrs:{\"viewBox\":\"0 0 100 50\"}},[_c('path',{attrs:{\"d\":\"M6.75,48.375c-2.75,0-3.384-1.565-1.409-3.479L46.41,5.104c1.975-1.914,5.207-1.913,7.182,0l41.067,39.792\\n          c1.975,1.914,1.341,3.479-1.409,3.479H6.75z\"}})])]),_c('div',{staticClass:\"button down-button\",on:{\"touchstart\":function($event){_vm.up = -1; _vm.upPointer = $event.changedTouches[0].identifier; $event.preventDefault();}}},[_c('svg',{staticClass:\"down\",attrs:{\"viewBox\":\"0 0 100 50\"}},[_c('path',{attrs:{\"d\":\"M6.75,48.375c-2.75,0-3.384-1.565-1.409-3.479L46.41,5.104c1.975-1.914,5.207-1.913,7.182,0l41.067,39.792\\n          c1.975,1.914,1.341,3.479-1.409,3.479H6.75z\"}})])])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div id=\"ff-mobile-controls\" :class=\"{disabled: !enabled}\">\n    <div class=\"move-fields\">\n      <div class=\"button up-button\" @touchstart=\"forward = 1; forwardPointer = $event.changedTouches[0].identifier; $event.preventDefault();\">\n        <svg viewBox=\"0 0 100 50\">\n          <path d=\"M6.75,48.375c-2.75,0-3.384-1.565-1.409-3.479L46.41,5.104c1.975-1.914,5.207-1.913,7.182,0l41.067,39.792\n            c1.975,1.914,1.341,3.479-1.409,3.479H6.75z\"/>\n        </svg>\n      </div>\n      <div class=\"button down-button\" @touchstart=\"forward = -1; forwardPointer = $event.changedTouches[0].identifier; $event.preventDefault();\">\n        <svg viewBox=\"0 0 100 50\" class=\"down\">\n          <path d=\"M6.75,48.375c-2.75,0-3.384-1.565-1.409-3.479L46.41,5.104c1.975-1.914,5.207-1.913,7.182,0l41.067,39.792\n            c1.975,1.914,1.341,3.479-1.409,3.479H6.75z\"/>\n        </svg>\n      </div>\n    </div>\n    <div class=\"height-fields\">\n      <div class=\"button up-button\" @touchstart=\"up = 1; upPointer = $event.changedTouches[0].identifier; $event.preventDefault();\">\n        <svg viewBox=\"0 0 100 50\">\n          <path d=\"M6.75,48.375c-2.75,0-3.384-1.565-1.409-3.479L46.41,5.104c1.975-1.914,5.207-1.913,7.182,0l41.067,39.792\n            c1.975,1.914,1.341,3.479-1.409,3.479H6.75z\"/>\n        </svg>\n      </div>\n      <div class=\"button down-button\" @touchstart=\"up = -1; upPointer = $event.changedTouches[0].identifier; $event.preventDefault();\">\n        <svg viewBox=\"0 0 100 50\" class=\"down\">\n          <path d=\"M6.75,48.375c-2.75,0-3.384-1.565-1.409-3.479L46.41,5.104c1.975-1.914,5.207-1.913,7.182,0l41.067,39.792\n            c1.975,1.914,1.341,3.479-1.409,3.479H6.75z\"/>\n        </svg>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: \"FreeFlightMobileControls\",\n  data() {\n    return {\n      enabled: false,\n      forward: 0,\n      forwardPointer: -1,\n      up: 0,\n      upPointer: -1,\n    }\n  },\n  methods: {\n    onTouchStop(evt) {\n      console.log(\"Stop: \", evt);\n\n      if (evt.changedTouches[0].identifier === this.forwardPointer) this.forward = 0;\n      if (evt.changedTouches[0].identifier === this.upPointer) this.up = 0;\n    },\n    onFrame(evt) {\n      let cm = this.$bluemap.mapViewer.controlsManager;\n      cm.position.x += this.forward * Math.sin(cm.rotation) * evt.detail.delta * 0.02;\n      cm.position.z += this.forward * -Math.cos(cm.rotation) * evt.detail.delta * 0.02;\n      cm.position.y += this.up * evt.detail.delta * 0.01;\n    },\n    enable(evt) {\n      this.enabled = true;\n    },\n  },\n  mounted() {\n    window.addEventListener(\"touchstart\", this.enable);\n\n    window.addEventListener(\"touchend\", this.onTouchStop);\n    window.addEventListener(\"touchcancel\", this.onTouchStop);\n    this.$bluemap.events.addEventListener(\"bluemapRenderFrame\", this.onFrame);\n  },\n  beforeDestroy() {\n    window.removeEventListener(\"touchstart\", this.enable);\n\n    window.removeEventListener(\"touchend\", this.onTouchStop);\n    window.removeEventListener(\"touchcancel\", this.onTouchStop);\n    this.$bluemap.events.removeEventListener(\"bluemapRenderFrame\", this.onFrame);\n  }\n}\n</script>\n\n<style lang=\"scss\">\n\n#ff-mobile-controls {\n  font-size: 15vw;\n\n  &.disabled {\n    display: none;\n  }\n\n  @media (orientation: portrait) {\n    font-size: 15vh;\n  }\n\n  .button {\n    width: 1em;\n    margin: 0.1em;\n    opacity: 0.5;\n\n    pointer-events: auto;\n\n    svg {\n      fill: var(--theme-bg);\n\n      &:active {\n        fill: var(--theme-bg-light);\n        opacity: 0.8;\n      }\n\n      &.down {\n        transform: scaleY(-1);\n      }\n    }\n  }\n\n  .move-fields {\n    position: fixed;\n\n    bottom: 0.2em;\n    left: 0.2em;\n\n  }\n\n  .height-fields {\n    position: fixed;\n\n    bottom: 0.2em;\n    right: 0.2em;\n  }\n\n}\n\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FreeFlightMobileControls.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FreeFlightMobileControls.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./FreeFlightMobileControls.vue?vue&type=template&id=3e2107aa&\"\nimport script from \"./FreeFlightMobileControls.vue?vue&type=script&lang=js&\"\nexport * from \"./FreeFlightMobileControls.vue?vue&type=script&lang=js&\"\nimport style0 from \"./FreeFlightMobileControls.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div id=\"app\" :class=\"{'theme-light': appState.theme === 'light', 'theme-dark': appState.theme === 'dark'}\">\n    <FreeFlightMobileControls v-if=\"appState.controls.state === 'free'\" />\n    <ControlBar />\n    <MainMenu :menu=\"appState.menu\" />\n  </div>\n</template>\n\n<script>\nimport ControlBar from \"@/components/ControlBar/ControlBar\";\nimport MainMenu from \"@/components/Menu/MainMenu\";\nimport FreeFlightMobileControls from \"@/components/Controls/FreeFlightMobileControls\";\n\nexport default {\n  name: 'App',\n  components: {\n    FreeFlightMobileControls,\n    MainMenu,\n    ControlBar\n  },\n  data() {\n    return {\n      appState: this.$bluemap.appState,\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\">\n  @import \"~@/scss/global.scss\";\n\n  #map-container {\n    position: absolute;\n    width: 100%;\n    height: 100%;\n  }\n\n  #app {\n    position: absolute;\n    width: 100%;\n    height: 100%;\n\n    z-index: 100; // put over bluemap markers\n\n    pointer-events: none;\n\n    font-size: 1rem;\n    @media (max-width: $mobile-break) {\n      font-size: 1.5rem;\n    }\n  }\n</style>\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=bb279048&\"\nimport script from \"./App.vue?vue&type=script&lang=js&\"\nexport * from \"./App.vue?vue&type=script&lang=js&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nexport class Tile {\n\n    /**\n     * @param x {number}\n     * @param z {number}\n     * @param onLoad {function(Tile)}\n     * @param onUnload {function(Tile)}\n     */\n    constructor(x, z, onLoad, onUnload) {\n        Object.defineProperty( this, 'isTile', { value: true } );\n\n        /** @type {THREE.Mesh} */\n        this.model = null;\n\n        this.onLoad = onLoad;\n        this.onUnload = onUnload;\n\n        this.x = x;\n        this.z = z;\n\n        this.unloaded = true;\n        this.loading = false;\n    }\n\n    /**\n     * @param tileLoader {TileLoader}\n     * @returns {Promise<void>}\n     */\n    load(tileLoader) {\n        if (this.loading) return Promise.reject(\"tile is already loading!\");\n        this.loading = true;\n\n        this.unload();\n\n        this.unloaded = false;\n        return tileLoader.load(this.x, this.z)\n            .then(model => {\n                if (this.unloaded){\n                    model.geometry.dispose();\n                    return;\n                }\n\n                this.model = model;\n                this.onLoad(this);\n            })\n            .finally(() => {\n                this.loading = false;\n            });\n    }\n\n    unload() {\n        this.unloaded = true;\n        if (this.model) {\n            this.onUnload(this);\n\n            this.model.geometry.dispose();\n            this.model = null;\n        }\n    }\n\n    /**\n     * @returns {boolean}\n     */\n    get loaded() {\n        return !!this.model;\n    }\n}\n","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport {ClampToEdgeWrapping, LinearFilter, Texture} from \"three\";\n\nexport class TileMap {\n\n    static EMPTY = \"#000\";\n    static LOADED = \"#fff\";\n\n    /**\n     * @param width {number}\n     * @param height {number}\n     */\n    constructor(width, height) {\n        this.canvas = document.createElementNS('http://www.w3.org/1999/xhtml', 'canvas');\n        this.canvas.width = width;\n        this.canvas.height = height;\n\n        /**\n         * @type CanvasRenderingContext2D\n         */\n        this.tileMapContext = this.canvas.getContext('2d', {\n            alpha: false,\n            willReadFrequently: true,\n        });\n\n        this.texture = new Texture(this.canvas);\n        this.texture.generateMipmaps = false;\n        this.texture.magFilter = LinearFilter;\n        this.texture.minFilter = LinearFilter;\n        this.texture.wrapS = ClampToEdgeWrapping;\n        this.texture.wrapT = ClampToEdgeWrapping;\n        this.texture.flipY = false;\n        this.texture.needsUpdate = true;\n    }\n\n    /**\n     * @param state {string}\n     */\n    setAll(state) {\n        this.tileMapContext.fillStyle = state;\n        this.tileMapContext.fillRect(0, 0, this.canvas.width, this.canvas.height);\n\n        this.texture.needsUpdate = true;\n    }\n\n    /**\n     * @param x {number}\n     * @param z {number}\n     * @param state {string}\n     */\n    setTile(x, z, state) {\n        this.tileMapContext.fillStyle = state;\n        this.tileMapContext.fillRect(x, z, 1, 1);\n\n        this.texture.needsUpdate = true;\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport { Vector2 } from 'three';\nimport  { Tile } from './Tile.js';\nimport {alert, hashTile} from '../util/Utils.js';\nimport {TileMap} from \"./TileMap\";\n\nexport class TileManager {\n\n    static tileMapSize = 100;\n    static tileMapHalfSize = TileManager.tileMapSize / 2;\n\n    /**\n     * @param scene {THREE.Scene}\n     * @param tileLoader {TileLoader}\n     * @param onTileLoad {function(Tile)}\n     * @param onTileUnload {function(Tile)}\n     * @param events {EventTarget}\n     */\n    constructor(scene, tileLoader, onTileLoad = null, onTileUnload = null, events = null) {\n        Object.defineProperty( this, 'isTileManager', { value: true } );\n\n        this.events = events;\n        this.scene = scene;\n        this.tileLoader = tileLoader;\n\n        this.onTileLoad = onTileLoad || function(){};\n        this.onTileUnload = onTileUnload || function(){};\n\n        this.viewDistanceX = 1;\n        this.viewDistanceZ = 1;\n        this.centerTile = new Vector2(0, 0);\n\n        this.currentlyLoading = 0;\n        this.loadTimeout = null;\n\n        //map of loaded tiles\n        this.tiles = new Map();\n\n        // a canvas that keeps track of the loaded tiles, used for shaders\n        this.tileMap = new TileMap(TileManager.tileMapSize, TileManager.tileMapSize);\n\n        this.unloaded = true;\n    }\n\n    /**\n     * @param x {number}\n     * @param z {number}\n     * @param viewDistanceX {number}\n     * @param viewDistanceZ {number}\n     */\n    loadAroundTile(x, z, viewDistanceX, viewDistanceZ) {\n        this.unloaded = false;\n\n        let unloadTiles = false;\n        if (this.viewDistanceX > viewDistanceX || this.viewDistanceZ > viewDistanceZ) {\n            unloadTiles = true;\n        }\n\n        this.viewDistanceX = viewDistanceX;\n        this.viewDistanceZ = viewDistanceZ;\n\n        if (unloadTiles || this.centerTile.x !== x || this.centerTile.y !== z) {\n            this.centerTile.set(x, z);\n            this.removeFarTiles();\n\n            this.tileMap.setAll(TileMap.EMPTY);\n            this.tiles.forEach(tile => {\n                if (!tile.loading) {\n                    this.tileMap.setTile(tile.x - this.centerTile.x + TileManager.tileMapHalfSize, tile.z - this.centerTile.y + TileManager.tileMapHalfSize, TileMap.LOADED);\n                }\n            });\n        }\n\n        this.loadCloseTiles();\n    }\n\n    unload() {\n        this.unloaded = true;\n        this.removeAllTiles();\n    }\n\n    removeFarTiles() {\n        this.tiles.forEach((tile, hash, map) => {\n            if (\n                tile.x + this.viewDistanceX < this.centerTile.x ||\n                tile.x - this.viewDistanceX > this.centerTile.x ||\n                tile.z + this.viewDistanceZ < this.centerTile.y ||\n                tile.z - this.viewDistanceZ > this.centerTile.y\n            ) {\n                tile.unload();\n                map.delete(hash);\n            }\n        });\n    }\n\n    removeAllTiles() {\n        this.tileMap.setAll(TileMap.EMPTY);\n\n        this.tiles.forEach(tile => {\n            tile.unload();\n        });\n        this.tiles.clear();\n    }\n\n    loadCloseTiles = () => {\n        if (this.unloaded) return;\n        if (!this.loadNextTile()) return;\n\n        if (this.loadTimeout) clearTimeout(this.loadTimeout);\n\n        if (this.currentlyLoading < 8) {\n            this.loadTimeout = setTimeout(this.loadCloseTiles, 0);\n        } else {\n            this.loadTimeout = setTimeout(this.loadCloseTiles, 1000);\n        }\n    }\n\n    /**\n     * @returns {boolean}\n     */\n    loadNextTile() {\n        if (this.unloaded) return false;\n\n        let x = 0;\n        let z = 0;\n        let d = 1;\n        let m = 1;\n\n        while (m < Math.max(this.viewDistanceX, this.viewDistanceZ) * 2 + 1) {\n            while (2 * x * d < m) {\n                if (this.tryLoadTile(this.centerTile.x + x, this.centerTile.y + z)) return true;\n                x = x + d;\n            }\n            while (2 * z * d < m) {\n                if (this.tryLoadTile(this.centerTile.x + x, this.centerTile.y + z)) return true;\n                z = z + d;\n            }\n            d = -1 * d;\n            m = m + 1;\n        }\n\n        return false;\n    }\n\n    /**\n     * @param x {number}\n     * @param z {number}\n     * @returns {boolean}\n     */\n    tryLoadTile(x, z) {\n        if (this.unloaded) return false;\n\n        if (Math.abs(x - this.centerTile.x) > this.viewDistanceX) return false;\n        if (Math.abs(z - this.centerTile.y) > this.viewDistanceZ) return false;\n\n        let tileHash = hashTile(x, z);\n\n        let tile = this.tiles.get(tileHash);\n        if (tile !== undefined) return false;\n\n        this.currentlyLoading++;\n\n        tile = new Tile(x, z, this.handleLoadedTile, this.handleUnloadedTile);\n        this.tiles.set(tileHash, tile);\n        tile.load(this.tileLoader)\n            .then(() => {\n                this.tileMap.setTile(tile.x - this.centerTile.x + TileManager.tileMapHalfSize, tile.z - this.centerTile.y + TileManager.tileMapHalfSize, TileMap.LOADED);\n\n                if (this.loadTimeout) clearTimeout(this.loadTimeout);\n                this.loadTimeout = setTimeout(this.loadCloseTiles, 0);\n            })\n            .catch(error => {\n                if (error.status && error.status === \"empty\") return;\n                if (error.target && error.target.status === 404) return;\n                if (error.type && error.type === \"abort\") return;\n\n                alert(this.events, \"Failed to load tile: \" + error, \"warning\");\n            })\n            .finally(() => {\n                this.tileMap.setTile(tile.x - this.centerTile.x + TileManager.tileMapHalfSize, tile.z - this.centerTile.y + TileManager.tileMapHalfSize, TileMap.LOADED);\n                this.currentlyLoading--;\n            });\n\n        return true;\n    }\n\n    handleLoadedTile = tile => {\n        //this.tileMap.setTile(tile.x - this.centerTile.x + TileManager.tileMapHalfSize, tile.z - this.centerTile.y + TileManager.tileMapHalfSize, TileMap.LOADED);\n\n        this.scene.add(tile.model);\n        this.onTileLoad(tile);\n    }\n\n    handleUnloadedTile = tile => {\n        this.tileMap.setTile(tile.x - this.centerTile.x + TileManager.tileMapHalfSize, tile.z - this.centerTile.y + TileManager.tileMapHalfSize, TileMap.EMPTY);\n\n        this.scene.remove(tile.model);\n        this.onTileUnload(tile);\n    }\n}\n","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport {pathFromCoords} from \"../util/Utils\";\nimport {BufferGeometryLoader, FileLoader, Mesh} from \"three\";\n\nexport class TileLoader {\n\n    /**\n     * @param tilePath {string}\n     * @param material {THREE.Material | THREE.Material[]}\n     * @param tileSettings {{\n     *      tileSize: {x: number, z: number},\n     *\t    scale: {x: number, z: number},\n     *      translate: {x: number, z: number}\n     * }}\n     * @param tileCacheHash {number}\n     * @param layer {number}\n     */\n    constructor(tilePath, material, tileSettings, tileCacheHash = 0, layer = 0) {\n        Object.defineProperty( this, 'isTileLoader', { value: true } );\n\n        this.tilePath = tilePath;\n        this.material = material;\n        this.tileSettings = tileSettings;\n\n        this.layer = layer;\n\n        this.tileCacheHash = tileCacheHash;\n\n        this.fileLoader = new FileLoader();\n        this.fileLoader.setResponseType('json');\n\n        this.bufferGeometryLoader = new BufferGeometryLoader();\n    }\n\n    load = (tileX, tileZ) => {\n        let tileUrl = this.tilePath + pathFromCoords(tileX, tileZ) + '.json';\n\n        return new Promise((resolve, reject) => {\n            this.fileLoader.load(tileUrl + '?' + this.tileCacheHash,\n                geometryJson => {\n                    if (!geometryJson.type || geometryJson.type !== 'BufferGeometry'){\n                        reject({status: \"empty\"});\n                        return;\n                    }\n\n                    let geometry = this.bufferGeometryLoader.parse(geometryJson);\n\n                    let object = new Mesh(geometry, this.material);\n                    if (this.layer) object.layers.set(this.layer);\n\n                    let tileSize = this.tileSettings.tileSize;\n                    let translate = this.tileSettings.translate;\n                    let scale = this.tileSettings.scale;\n                    object.position.set(tileX * tileSize.x + translate.x, 0, tileZ * tileSize.z + translate.z);\n                    object.scale.set(scale.x, 1, scale.z);\n\n                    object.userData.tileUrl = tileUrl;\n\n                    object.updateMatrixWorld(true);\n\n                    resolve(object);\n                },\n                () => {},\n                reject\n            );\n        });\n    }\n\n}\n","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport {Scene} from \"three\";\n\nexport class MarkerSet extends Scene {\n\n    /**\n     * @param id {string}\n     */\n    constructor(id) {\n        super();\n        Object.defineProperty(this, 'isMarkerSet', {value: true});\n\n        this.data = {\n            id: id,\n            label: id,\n            toggleable: true,\n            defaultHide: false,\n            markerSets: [],\n            markers: [],\n            visible: this.visible,\n        };\n\n        Object.defineProperty(this, \"visible\", {\n            get() { return this.data.visible },\n            set(value) { this.data.visible = value }\n        });\n    }\n\n    add(...object) {\n        if (object.length === 1) { //super.add() will re-invoke this method for each array-entry if its more than one\n            let o = object[0];\n            if (o.isMarkerSet) {\n                this.data.markerSets.push(o.data);\n            }\n            if (o.isMarker) {\n                this.data.markers.push(o.data);\n            }\n        }\n\n        return super.add(...object);\n    }\n\n    remove(...object) {\n        if (object.length === 1) { //super.remove() will re-invoke this method for each array-entry if its more than one\n            let o = object[0];\n            if (o.isMarkerSet) {\n                let i = this.data.markerSets.indexOf(o.data);\n                if (i > -1) this.data.markerSets.splice(i, 1);\n            }\n            if (o.isMarker) {\n                let i = this.data.markers.indexOf(o.data);\n                if (i > -1) this.data.markers.splice(i, 1);\n            }\n        }\n\n        return super.remove(...object);\n    }\n\n    dispose() {\n        this.children.forEach(child => {\n            if (child.dispose) child.dispose();\n        });\n    }\n\n}","import {\n\tShaderLib,\n\tShaderMaterial,\n\tUniformsLib,\n\tUniformsUtils,\n\tVector2\n} from \"three\";\n/**\n * parameters = {\n *  color: <hex>,\n *  linewidth: <float>,\n *  dashed: <boolean>,\n *  dashScale: <float>,\n *  dashSize: <float>,\n *  gapSize: <float>,\n *  resolution: <Vector2>, // to be set by renderer\n * }\n */\n\nUniformsLib.line = {\n\n\tlinewidth: { value: 1 },\n\tresolution: { value: new Vector2( 1, 1 ) },\n\tdashScale: { value: 1 },\n\tdashSize: { value: 1 },\n\tgapSize: { value: 1 },\n\topacity: { value: 1 }\n\n};\n\nShaderLib[ 'line' ] = {\n\n\tuniforms: UniformsUtils.merge( [\n\t\tUniformsLib.common,\n\t\tUniformsLib.fog,\n\t\tUniformsLib.line\n\t] ),\n\n\tvertexShader:\n\t\t`\n\t\t#include <common>\n\t\t#include <color_pars_vertex>\n\t\t#include <fog_pars_vertex>\n\t\t#include <logdepthbuf_pars_vertex>\n\t\t#include <clipping_planes_pars_vertex>\n\n\t\tuniform float linewidth;\n\t\tuniform vec2 resolution;\n\n\t\tattribute vec3 instanceStart;\n\t\tattribute vec3 instanceEnd;\n\n\t\tattribute vec3 instanceColorStart;\n\t\tattribute vec3 instanceColorEnd;\n\n\t\tvarying vec2 vUv;\n\t\t\n\t\tvarying float vDistance;\n\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashScale;\n\t\t\tattribute float instanceDistanceStart;\n\t\t\tattribute float instanceDistanceEnd;\n\t\t\tvarying float vLineDistance;\n\n\t\t#endif\n\n\t\tvoid trimSegment( const in vec4 start, inout vec4 end ) {\n\n\t\t\t// trim end segment so it terminates between the camera plane and the near plane\n\n\t\t\t// conservative estimate of the near plane\n\t\t\tfloat a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column\n\t\t\tfloat b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column\n\t\t\tfloat nearEstimate = - 0.5 * b / a;\n\n\t\t\tfloat alpha = ( nearEstimate - start.z ) / ( end.z - start.z );\n\n\t\t\tend.xyz = mix( start.xyz, end.xyz, alpha );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\t#ifdef USE_COLOR\n\n\t\t\t\tvColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;\n\n\t\t\t#endif\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tvLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;\n\n\t\t\t#endif\n\n\t\t\tfloat aspect = resolution.x / resolution.y;\n\n\t\t\tvUv = uv;\n\n\t\t\t// camera space\n\t\t\tvec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );\n\t\t\tvec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );\n\n\t\t\t// special case for perspective projection, and segments that terminate either in, or behind, the camera plane\n\t\t\t// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space\n\t\t\t// but we need to perform ndc-space calculations in the shader, so we must address this issue directly\n\t\t\t// perhaps there is a more elegant solution -- WestLangley\n\n\t\t\tbool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column\n\n\t\t\tif ( perspective ) {\n\n\t\t\t\tif ( start.z < 0.0 && end.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( start, end );\n\n\t\t\t\t} else if ( end.z < 0.0 && start.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( end, start );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// clip space\n\t\t\tvec4 clipStart = projectionMatrix * start;\n\t\t\tvec4 clipEnd = projectionMatrix * end;\n\n\t\t\t// ndc space\n\t\t\tvec2 ndcStart = clipStart.xy / clipStart.w;\n\t\t\tvec2 ndcEnd = clipEnd.xy / clipEnd.w;\n\n\t\t\t// direction\n\t\t\tvec2 dir = ndcEnd - ndcStart;\n\n\t\t\t// account for clip-space aspect ratio\n\t\t\tdir.x *= aspect;\n\t\t\tdir = normalize( dir );\n\n\t\t\t// perpendicular to dir\n\t\t\tvec2 offset = vec2( dir.y, - dir.x );\n\n\t\t\t// undo aspect ratio adjustment\n\t\t\tdir.x /= aspect;\n\t\t\toffset.x /= aspect;\n\n\t\t\t// sign flip\n\t\t\tif ( position.x < 0.0 ) offset *= - 1.0;\n\n\t\t\t// endcaps\n\t\t\tif ( position.y < 0.0 ) {\n\n\t\t\t\toffset += - dir;\n\n\t\t\t} else if ( position.y > 1.0 ) {\n\n\t\t\t\toffset += dir;\n\n\t\t\t}\n\n\t\t\t// adjust for linewidth\n\t\t\toffset *= linewidth;\n\n\t\t\t// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...\n\t\t\toffset /= resolution.y;\n\n\t\t\t// select end\n\t\t\tvec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;\n\n\t\t\t// back to clip space\n\t\t\toffset *= clip.w;\n\n\t\t\tclip.xy += offset;\n\n\t\t\tgl_Position = clip;\n\n\t\t\tvec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation\n\t\t\t\n\t\t\tvDistance = -mvPosition.z;\n\n\t\t\t#include <logdepthbuf_vertex>\n\t\t\t#include <clipping_planes_vertex>\n\t\t\t#include <fog_vertex>\n\n\t\t}\n\t\t`,\n\n\tfragmentShader:\n\t\t`\n\t\t#define FLT_MAX 3.402823466e+38\n\n\t\tuniform vec3 diffuse;\n\t\tuniform float opacity;\n\t\t\n\t\tuniform float fadeDistanceMax;\n\t\tuniform float fadeDistanceMin;\n\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashSize;\n\t\t\tuniform float gapSize;\n\n\t\t#endif\n\n\t\tvarying float vLineDistance;\n\n\t\t#include <common>\n\t\t#include <color_pars_fragment>\n\t\t#include <fog_pars_fragment>\n\t\t#include <logdepthbuf_pars_fragment>\n\t\t#include <clipping_planes_pars_fragment>\n\n\t\tvarying vec2 vUv;\n\t\t\n\t\tvarying float vDistance;\n\n\t\tvoid main() {\n\n\t\t\t#include <clipping_planes_fragment>\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tif ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps\n\n\t\t\t\tif ( mod( vLineDistance, dashSize + gapSize ) > dashSize ) discard; // todo - FIX\n\n\t\t\t#endif\n\n\t\t\tif ( abs( vUv.y ) > 1.0 ) {\n\n\t\t\t\tfloat a = vUv.x;\n\t\t\t\tfloat b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n\t\t\t\tfloat len2 = a * a + b * b;\n\n\t\t\t\tif ( len2 > 1.0 ) discard;\n\n\t\t\t}\n\n\t\t\t// distance fading\n\t\t\tfloat fdMax = FLT_MAX;\n\t\t\tif ( fadeDistanceMax > 0.0 ) fdMax = fadeDistanceMax;\n\t\t\t\n\t\t\tfloat minDelta = (vDistance - fadeDistanceMin) / fadeDistanceMin;\n\t\t\tfloat maxDelta = (vDistance - fadeDistanceMax) / (fadeDistanceMax * 0.5);\n\t\t\tfloat distanceOpacity = min(\n\t\t\t\tclamp(minDelta, 0.0, 1.0),\n\t\t\t\t1.0 - clamp(maxDelta + 1.0, 0.0, 1.0)\n\t\t\t);\n\n\t\t\tvec4 diffuseColor = vec4( diffuse, opacity * distanceOpacity );\n\n\t\t\t#include <logdepthbuf_fragment>\n\t\t\t#include <color_fragment>\n\n\t\t\tgl_FragColor = vec4( diffuseColor.rgb, diffuseColor.a );\n\n\t\t\t#include <tonemapping_fragment>\n\t\t\t#include <encodings_fragment>\n\t\t\t#include <fog_fragment>\n\t\t\t#include <premultiplied_alpha_fragment>\n\n\t\t}\n\t\t`\n};\n\nvar LineMaterial = function ( parameters ) {\n\n\tShaderMaterial.call( this, {\n\n\t\ttype: 'LineMaterial',\n\n\t\tuniforms: UniformsUtils.clone( ShaderLib[ 'line' ].uniforms ),\n\n\t\tvertexShader: ShaderLib[ 'line' ].vertexShader,\n\t\tfragmentShader: ShaderLib[ 'line' ].fragmentShader,\n\n\t\tclipping: true // required for clipping support\n\n\t} );\n\n\tthis.dashed = false;\n\n\tObject.defineProperties( this, {\n\n\t\tcolor: {\n\n\t\t\tenumerable: true,\n\n\t\t\tget: function () {\n\n\t\t\t\treturn this.uniforms.diffuse.value;\n\n\t\t\t},\n\n\t\t\tset: function ( value ) {\n\n\t\t\t\tthis.uniforms.diffuse.value = value;\n\n\t\t\t}\n\n\t\t},\n\n\t\tlinewidth: {\n\n\t\t\tenumerable: true,\n\n\t\t\tget: function () {\n\n\t\t\t\treturn this.uniforms.linewidth.value;\n\n\t\t\t},\n\n\t\t\tset: function ( value ) {\n\n\t\t\t\tthis.uniforms.linewidth.value = value;\n\n\t\t\t}\n\n\t\t},\n\n\t\tdashScale: {\n\n\t\t\tenumerable: true,\n\n\t\t\tget: function () {\n\n\t\t\t\treturn this.uniforms.dashScale.value;\n\n\t\t\t},\n\n\t\t\tset: function ( value ) {\n\n\t\t\t\tthis.uniforms.dashScale.value = value;\n\n\t\t\t}\n\n\t\t},\n\n\t\tdashSize: {\n\n\t\t\tenumerable: true,\n\n\t\t\tget: function () {\n\n\t\t\t\treturn this.uniforms.dashSize.value;\n\n\t\t\t},\n\n\t\t\tset: function ( value ) {\n\n\t\t\t\tthis.uniforms.dashSize.value = value;\n\n\t\t\t}\n\n\t\t},\n\n\t\tgapSize: {\n\n\t\t\tenumerable: true,\n\n\t\t\tget: function () {\n\n\t\t\t\treturn this.uniforms.gapSize.value;\n\n\t\t\t},\n\n\t\t\tset: function ( value ) {\n\n\t\t\t\tthis.uniforms.gapSize.value = value;\n\n\t\t\t}\n\n\t\t},\n\n\t\topacity: {\n\n\t\t\tenumerable: true,\n\n\t\t\tget: function () {\n\n\t\t\t\treturn this.uniforms.opacity.value;\n\n\t\t\t},\n\n\t\t\tset: function ( value ) {\n\n\t\t\t\tthis.uniforms.opacity.value = value;\n\n\t\t\t}\n\n\t\t},\n\n\t\tresolution: {\n\n\t\t\tenumerable: true,\n\n\t\t\tget: function () {\n\n\t\t\t\treturn this.uniforms.resolution.value;\n\n\t\t\t},\n\n\t\t\tset: function ( value ) {\n\n\t\t\t\tthis.uniforms.resolution.value.copy( value );\n\n\t\t\t}\n\n\t\t}\n\n\t} );\n\n\tthis.setValues( parameters );\n\n};\n\nLineMaterial.prototype = Object.create( ShaderMaterial.prototype );\nLineMaterial.prototype.constructor = LineMaterial;\n\nLineMaterial.prototype.isLineMaterial = true;\n\nexport { LineMaterial };\n","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the 'Software'), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport { ShaderChunk } from 'three';\n\nexport const MARKER_FILL_VERTEX_SHADER = `\n#include <common>\n${ShaderChunk.logdepthbuf_pars_vertex}\n\nvarying vec3 vPosition;\n//varying vec3 vWorldPosition;\n//varying vec3 vNormal;\n//varying vec2 vUv;\n//varying vec3 vColor;\nvarying float vDistance;\n\nvoid main() {\n\tvec4 worldPos = modelMatrix * vec4(position, 1);\n\tvec4 viewPos = viewMatrix * worldPos;\n\t\n\tvPosition = position;\n\t//vWorldPosition = worldPos.xyz;\n\t//vNormal = normal;\n\t//vUv = uv;\n\t//vColor = vec3(1.0);\n\tvDistance = -viewPos.z;\n\t\n\tgl_Position = projectionMatrix * viewPos;\n\t\n\t${ShaderChunk.logdepthbuf_vertex} \n}\n`;\n","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the 'Software'), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport { ShaderChunk } from 'three';\n\nexport const MARKER_FILL_FRAGMENT_SHADER = `\n${ShaderChunk.logdepthbuf_pars_fragment}\n\n#define FLT_MAX 3.402823466e+38\n\nvarying vec3 vPosition;\n//varying vec3 vWorldPosition;\n//varying vec3 vNormal;\n//varying vec2 vUv;\n//varying vec3 vColor;\nvarying float vDistance;\n\nuniform vec3 markerColor;\nuniform float markerOpacity;\n\nuniform float fadeDistanceMax;\nuniform float fadeDistanceMin;\n\nvoid main() {\n\tvec4 color = vec4(markerColor, markerOpacity);\n\t\n\t// distance fading\n\tfloat fdMax = FLT_MAX;\n\tif ( fadeDistanceMax > 0.0 ) fdMax = fadeDistanceMax;\n\t\n\tfloat minDelta = (vDistance - fadeDistanceMin) / fadeDistanceMin;\n\tfloat maxDelta = (vDistance - fadeDistanceMax) / (fadeDistanceMax * 0.5);\n\tfloat distanceOpacity = min(\n\t\tclamp(minDelta, 0.0, 1.0),\n\t\t1.0 - clamp(maxDelta + 1.0, 0.0, 1.0)\n\t);\n\t\n\tcolor.a *= distanceOpacity;\n\t\n\t// apply vertex-color\n\t//color.rgb *= vColor.rgb;\n\t\n\tgl_FragColor = color;\n\t\n\t${ShaderChunk.logdepthbuf_fragment}\n}\n`;\n","import {\n\tBox3,\n\tFloat32BufferAttribute,\n\tInstancedBufferGeometry,\n\tInstancedInterleavedBuffer,\n\tInterleavedBufferAttribute,\n\tSphere,\n\tVector3,\n\tWireframeGeometry\n} from \"three\";\n\nvar LineSegmentsGeometry = function () {\n\n\tInstancedBufferGeometry.call( this );\n\n\tthis.type = 'LineSegmentsGeometry';\n\n\tvar positions = [ - 1, 2, 0, 1, 2, 0, - 1, 1, 0, 1, 1, 0, - 1, 0, 0, 1, 0, 0, - 1, - 1, 0, 1, - 1, 0 ];\n\tvar uvs = [ - 1, 2, 1, 2, - 1, 1, 1, 1, - 1, - 1, 1, - 1, - 1, - 2, 1, - 2 ];\n\tvar index = [ 0, 2, 1, 2, 3, 1, 2, 4, 3, 4, 5, 3, 4, 6, 5, 6, 7, 5 ];\n\n\tthis.setIndex( index );\n\tthis.setAttribute( 'position', new Float32BufferAttribute( positions, 3 ) );\n\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\n};\n\nLineSegmentsGeometry.prototype = Object.assign( Object.create( InstancedBufferGeometry.prototype ), {\n\n\tconstructor: LineSegmentsGeometry,\n\n\tisLineSegmentsGeometry: true,\n\n\tapplyMatrix4: function ( matrix ) {\n\n\t\tvar start = this.attributes.instanceStart;\n\t\tvar end = this.attributes.instanceEnd;\n\n\t\tif ( start !== undefined ) {\n\n\t\t\tstart.applyMatrix4( matrix );\n\n\t\t\tend.applyMatrix4( matrix );\n\n\t\t\tstart.needsUpdate = true;\n\n\t\t}\n\n\t\tif ( this.boundingBox !== null ) {\n\n\t\t\tthis.computeBoundingBox();\n\n\t\t}\n\n\t\tif ( this.boundingSphere !== null ) {\n\n\t\t\tthis.computeBoundingSphere();\n\n\t\t}\n\n\t\treturn this;\n\n\t},\n\n\tsetPositions: function ( array ) {\n\n\t\tvar lineSegments;\n\n\t\tif ( array instanceof Float32Array ) {\n\n\t\t\tlineSegments = array;\n\n\t\t} else if ( Array.isArray( array ) ) {\n\n\t\t\tlineSegments = new Float32Array( array );\n\n\t\t}\n\n\t\tvar instanceBuffer = new InstancedInterleavedBuffer( lineSegments, 6, 1 ); // xyz, xyz\n\n\t\tthis.setAttribute( 'instanceStart', new InterleavedBufferAttribute( instanceBuffer, 3, 0 ) ); // xyz\n\t\tthis.setAttribute( 'instanceEnd', new InterleavedBufferAttribute( instanceBuffer, 3, 3 ) ); // xyz\n\n\t\t//\n\n\t\tthis.computeBoundingBox();\n\t\tthis.computeBoundingSphere();\n\n\t\treturn this;\n\n\t},\n\n\tsetColors: function ( array ) {\n\n\t\tvar colors;\n\n\t\tif ( array instanceof Float32Array ) {\n\n\t\t\tcolors = array;\n\n\t\t} else if ( Array.isArray( array ) ) {\n\n\t\t\tcolors = new Float32Array( array );\n\n\t\t}\n\n\t\tvar instanceColorBuffer = new InstancedInterleavedBuffer( colors, 6, 1 ); // rgb, rgb\n\n\t\tthis.setAttribute( 'instanceColorStart', new InterleavedBufferAttribute( instanceColorBuffer, 3, 0 ) ); // rgb\n\t\tthis.setAttribute( 'instanceColorEnd', new InterleavedBufferAttribute( instanceColorBuffer, 3, 3 ) ); // rgb\n\n\t\treturn this;\n\n\t},\n\n\tfromWireframeGeometry: function ( geometry ) {\n\n\t\tthis.setPositions( geometry.attributes.position.array );\n\n\t\treturn this;\n\n\t},\n\n\tfromEdgesGeometry: function ( geometry ) {\n\n\t\tthis.setPositions( geometry.attributes.position.array );\n\n\t\treturn this;\n\n\t},\n\n\tfromMesh: function ( mesh ) {\n\n\t\tthis.fromWireframeGeometry( new WireframeGeometry( mesh.geometry ) );\n\n\t\t// set colors, maybe\n\n\t\treturn this;\n\n\t},\n\n\tfromLineSegments: function ( lineSegments ) {\n\n\t\tvar geometry = lineSegments.geometry;\n\n\t\tif ( geometry.isGeometry ) {\n\n\t\t\tthis.setPositions( geometry.vertices );\n\n\t\t} else if ( geometry.isBufferGeometry ) {\n\n\t\t\tthis.setPositions( geometry.attributes.position.array ); // assumes non-indexed\n\n\t\t}\n\n\t\t// set colors, maybe\n\n\t\treturn this;\n\n\t},\n\n\tcomputeBoundingBox: function () {\n\n\t\tvar box = new Box3();\n\n\t\treturn function computeBoundingBox() {\n\n\t\t\tif ( this.boundingBox === null ) {\n\n\t\t\t\tthis.boundingBox = new Box3();\n\n\t\t\t}\n\n\t\t\tvar start = this.attributes.instanceStart;\n\t\t\tvar end = this.attributes.instanceEnd;\n\n\t\t\tif ( start !== undefined && end !== undefined ) {\n\n\t\t\t\tthis.boundingBox.setFromBufferAttribute( start );\n\n\t\t\t\tbox.setFromBufferAttribute( end );\n\n\t\t\t\tthis.boundingBox.union( box );\n\n\t\t\t}\n\n\t\t};\n\n\t}(),\n\n\tcomputeBoundingSphere: function () {\n\n\t\tvar vector = new Vector3();\n\n\t\treturn function computeBoundingSphere() {\n\n\t\t\tif ( this.boundingSphere === null ) {\n\n\t\t\t\tthis.boundingSphere = new Sphere();\n\n\t\t\t}\n\n\t\t\tif ( this.boundingBox === null ) {\n\n\t\t\t\tthis.computeBoundingBox();\n\n\t\t\t}\n\n\t\t\tvar start = this.attributes.instanceStart;\n\t\t\tvar end = this.attributes.instanceEnd;\n\n\t\t\tif ( start !== undefined && end !== undefined ) {\n\n\t\t\t\tvar center = this.boundingSphere.center;\n\n\t\t\t\tthis.boundingBox.getCenter( center );\n\n\t\t\t\tvar maxRadiusSq = 0;\n\n\t\t\t\tfor ( var i = 0, il = start.count; i < il; i ++ ) {\n\n\t\t\t\t\tvector.fromBufferAttribute( start, i );\n\t\t\t\t\tmaxRadiusSq = Math.max( maxRadiusSq, center.distanceToSquared( vector ) );\n\n\t\t\t\t\tvector.fromBufferAttribute( end, i );\n\t\t\t\t\tmaxRadiusSq = Math.max( maxRadiusSq, center.distanceToSquared( vector ) );\n\n\t\t\t\t}\n\n\t\t\t\tthis.boundingSphere.radius = Math.sqrt( maxRadiusSq );\n\n\t\t\t\tif ( isNaN( this.boundingSphere.radius ) ) {\n\n\t\t\t\t\tconsole.error( 'THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.', this );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t};\n\n\t}(),\n\n\ttoJSON: function () {\n\n\t},\n\n\tapplyMatrix: function ( matrix ) {\n\n\t\tconsole.warn( 'THREE.LineSegmentsGeometry: applyMatrix() has been renamed to applyMatrix4().' );\n\n\t\treturn this.applyMatrix4( matrix );\n\n\t}\n\n} );\n\nexport { LineSegmentsGeometry };\n","\nimport { LineSegmentsGeometry } from \"./LineSegmentsGeometry\";\n\nvar LineGeometry = function () {\n\n\tLineSegmentsGeometry.call( this );\n\n\tthis.type = 'LineGeometry';\n\n};\n\nLineGeometry.prototype = Object.assign( Object.create( LineSegmentsGeometry.prototype ), {\n\n\tconstructor: LineGeometry,\n\n\tisLineGeometry: true,\n\n\tsetPositions: function ( array ) {\n\n\t\t// converts [ x1, y1, z1,  x2, y2, z2, ... ] to pairs format\n\n\t\tvar length = array.length - 3;\n\t\tvar points = new Float32Array( 2 * length );\n\n\t\tfor ( var i = 0; i < length; i += 3 ) {\n\n\t\t\tpoints[ 2 * i ] = array[ i ];\n\t\t\tpoints[ 2 * i + 1 ] = array[ i + 1 ];\n\t\t\tpoints[ 2 * i + 2 ] = array[ i + 2 ];\n\n\t\t\tpoints[ 2 * i + 3 ] = array[ i + 3 ];\n\t\t\tpoints[ 2 * i + 4 ] = array[ i + 4 ];\n\t\t\tpoints[ 2 * i + 5 ] = array[ i + 5 ];\n\n\t\t}\n\n\t\tLineSegmentsGeometry.prototype.setPositions.call( this, points );\n\n\t\treturn this;\n\n\t},\n\n\tsetColors: function ( array ) {\n\n\t\t// converts [ r1, g1, b1,  r2, g2, b2, ... ] to pairs format\n\n\t\tvar length = array.length - 3;\n\t\tvar colors = new Float32Array( 2 * length );\n\n\t\tfor ( var i = 0; i < length; i += 3 ) {\n\n\t\t\tcolors[ 2 * i ] = array[ i ];\n\t\t\tcolors[ 2 * i + 1 ] = array[ i + 1 ];\n\t\t\tcolors[ 2 * i + 2 ] = array[ i + 2 ];\n\n\t\t\tcolors[ 2 * i + 3 ] = array[ i + 3 ];\n\t\t\tcolors[ 2 * i + 4 ] = array[ i + 4 ];\n\t\t\tcolors[ 2 * i + 5 ] = array[ i + 5 ];\n\n\t\t}\n\n\t\tLineSegmentsGeometry.prototype.setColors.call( this, colors );\n\n\t\treturn this;\n\n\t},\n\n\tfromLine: function ( line ) {\n\n\t\tvar geometry = line.geometry;\n\n\t\tif ( geometry.isGeometry ) {\n\n\t\t\tthis.setPositions( geometry.vertices );\n\n\t\t} else if ( geometry.isBufferGeometry ) {\n\n\t\t\tthis.setPositions( geometry.attributes.position.array ); // assumes non-indexed\n\n\t\t}\n\n\t\t// set colors, maybe\n\n\t\treturn this;\n\n\t},\n\n\tcopy: function ( /* source */ ) {\n\n\t\treturn this;\n\n\t}\n\n} );\n\nexport { LineGeometry };\n","import {\n\tInstancedInterleavedBuffer,\n\tInterleavedBufferAttribute,\n\tLine3,\n\tMathUtils,\n\tMatrix4,\n\tMesh,\n\tVector3,\n\tVector4\n} from \"three\";\nimport { LineSegmentsGeometry } from \"./LineSegmentsGeometry\";\nimport { LineMaterial } from \"./LineMaterial\";\n\nvar LineSegments2 = function ( geometry, material ) {\n\n\tif ( geometry === undefined ) geometry = new LineSegmentsGeometry();\n\tif ( material === undefined ) material = new LineMaterial( { color: Math.random() * 0xffffff } );\n\n\tMesh.call( this, geometry, material );\n\n\tthis.type = 'LineSegments2';\n\n};\n\nLineSegments2.prototype = Object.assign( Object.create( Mesh.prototype ), {\n\n\tconstructor: LineSegments2,\n\n\tisLineSegments2: true,\n\n\tcomputeLineDistances: ( function () { // for backwards-compatability, but could be a method of LineSegmentsGeometry...\n\n\t\tvar start = new Vector3();\n\t\tvar end = new Vector3();\n\n\t\treturn function computeLineDistances() {\n\n\t\t\tvar geometry = this.geometry;\n\n\t\t\tvar instanceStart = geometry.attributes.instanceStart;\n\t\t\tvar instanceEnd = geometry.attributes.instanceEnd;\n\t\t\tvar lineDistances = new Float32Array( 2 * instanceStart.data.count );\n\n\t\t\tfor ( var i = 0, j = 0, l = instanceStart.data.count; i < l; i ++, j += 2 ) {\n\n\t\t\t\tstart.fromBufferAttribute( instanceStart, i );\n\t\t\t\tend.fromBufferAttribute( instanceEnd, i );\n\n\t\t\t\tlineDistances[ j ] = ( j === 0 ) ? 0 : lineDistances[ j - 1 ];\n\t\t\t\tlineDistances[ j + 1 ] = lineDistances[ j ] + start.distanceTo( end );\n\n\t\t\t}\n\n\t\t\tvar instanceDistanceBuffer = new InstancedInterleavedBuffer( lineDistances, 2, 1 ); // d0, d1\n\n\t\t\tgeometry.setAttribute( 'instanceDistanceStart', new InterleavedBufferAttribute( instanceDistanceBuffer, 1, 0 ) ); // d0\n\t\t\tgeometry.setAttribute( 'instanceDistanceEnd', new InterleavedBufferAttribute( instanceDistanceBuffer, 1, 1 ) ); // d1\n\n\t\t\treturn this;\n\n\t\t};\n\n\t}() ),\n\n\traycast: ( function () {\n\n\t\tvar start = new Vector4();\n\t\tvar end = new Vector4();\n\n\t\tvar ssOrigin = new Vector4();\n\t\tvar ssOrigin3 = new Vector3();\n\t\tvar mvMatrix = new Matrix4();\n\t\tvar line = new Line3();\n\t\tvar closestPoint = new Vector3();\n\n\t\treturn function raycast( raycaster, intersects ) {\n\n\t\t\tif ( raycaster.camera === null ) {\n\n\t\t\t\tconsole.error( 'LineSegments2: \"Raycaster.camera\" needs to be set in order to raycast against LineSegments2.' );\n\n\t\t\t}\n\n\t\t\tvar threshold = ( raycaster.params.Line2 !== undefined ) ? raycaster.params.Line2.threshold || 0 : 0;\n\n\t\t\tvar ray = raycaster.ray;\n\t\t\tvar camera = raycaster.camera;\n\t\t\tvar projectionMatrix = camera.projectionMatrix;\n\n\t\t\tvar geometry = this.geometry;\n\t\t\tvar material = this.material;\n\t\t\tvar resolution = material.resolution;\n\t\t\tvar lineWidth = material.linewidth + threshold;\n\n\t\t\tvar instanceStart = geometry.attributes.instanceStart;\n\t\t\tvar instanceEnd = geometry.attributes.instanceEnd;\n\n\t\t\t// pick a point 1 unit out along the ray to avoid the ray origin\n\t\t\t// sitting at the camera origin which will cause \"w\" to be 0 when\n\t\t\t// applying the projection matrix.\n\t\t\tray.at( 1, ssOrigin );\n\n\t\t\t// ndc space [ - 1.0, 1.0 ]\n\t\t\tssOrigin.w = 1;\n\t\t\tssOrigin.applyMatrix4( camera.matrixWorldInverse );\n\t\t\tssOrigin.applyMatrix4( projectionMatrix );\n\t\t\tssOrigin.multiplyScalar( 1 / ssOrigin.w );\n\n\t\t\t// screen space\n\t\t\tssOrigin.x *= resolution.x / 2;\n\t\t\tssOrigin.y *= resolution.y / 2;\n\t\t\tssOrigin.z = 0;\n\n\t\t\tssOrigin3.copy( ssOrigin );\n\n\t\t\tvar matrixWorld = this.matrixWorld;\n\t\t\tmvMatrix.multiplyMatrices( camera.matrixWorldInverse, matrixWorld );\n\n\t\t\tfor ( var i = 0, l = instanceStart.count; i < l; i ++ ) {\n\n\t\t\t\tstart.fromBufferAttribute( instanceStart, i );\n\t\t\t\tend.fromBufferAttribute( instanceEnd, i );\n\n\t\t\t\tstart.w = 1;\n\t\t\t\tend.w = 1;\n\n\t\t\t\t// camera space\n\t\t\t\tstart.applyMatrix4( mvMatrix );\n\t\t\t\tend.applyMatrix4( mvMatrix );\n\n\t\t\t\t// clip space\n\t\t\t\tstart.applyMatrix4( projectionMatrix );\n\t\t\t\tend.applyMatrix4( projectionMatrix );\n\n\t\t\t\t// ndc space [ - 1.0, 1.0 ]\n\t\t\t\tstart.multiplyScalar( 1 / start.w );\n\t\t\t\tend.multiplyScalar( 1 / end.w );\n\n\t\t\t\t// skip the segment if it's outside the camera near and far planes\n\t\t\t\tvar isBehindCameraNear = start.z < - 1 && end.z < - 1;\n\t\t\t\tvar isPastCameraFar = start.z > 1 && end.z > 1;\n\t\t\t\tif ( isBehindCameraNear || isPastCameraFar ) {\n\n\t\t\t\t\tcontinue;\n\n\t\t\t\t}\n\n\t\t\t\t// screen space\n\t\t\t\tstart.x *= resolution.x / 2;\n\t\t\t\tstart.y *= resolution.y / 2;\n\n\t\t\t\tend.x *= resolution.x / 2;\n\t\t\t\tend.y *= resolution.y / 2;\n\n\t\t\t\t// create 2d segment\n\t\t\t\tline.start.copy( start );\n\t\t\t\tline.start.z = 0;\n\n\t\t\t\tline.end.copy( end );\n\t\t\t\tline.end.z = 0;\n\n\t\t\t\t// get closest point on ray to segment\n\t\t\t\tvar param = line.closestPointToPointParameter( ssOrigin3, true );\n\t\t\t\tline.at( param, closestPoint );\n\n\t\t\t\t// check if the intersection point is within clip space\n\t\t\t\tvar zPos = MathUtils.lerp( start.z, end.z, param );\n\t\t\t\tvar isInClipSpace = zPos >= - 1 && zPos <= 1;\n\n\t\t\t\tvar isInside = ssOrigin3.distanceTo( closestPoint ) < lineWidth * 0.5;\n\n\t\t\t\tif ( isInClipSpace && isInside ) {\n\n\t\t\t\t\tline.start.fromBufferAttribute( instanceStart, i );\n\t\t\t\t\tline.end.fromBufferAttribute( instanceEnd, i );\n\n\t\t\t\t\tline.start.applyMatrix4( matrixWorld );\n\t\t\t\t\tline.end.applyMatrix4( matrixWorld );\n\n\t\t\t\t\tvar pointOnLine = new Vector3();\n\t\t\t\t\tvar point = new Vector3();\n\n\t\t\t\t\tray.distanceSqToSegment( line.start, line.end, point, pointOnLine );\n\n\t\t\t\t\tintersects.push( {\n\n\t\t\t\t\t\tpoint: point,\n\t\t\t\t\t\tpointOnLine: pointOnLine,\n\t\t\t\t\t\tdistance: ray.origin.distanceTo( point ),\n\n\t\t\t\t\t\tobject: this,\n\t\t\t\t\t\tface: null,\n\t\t\t\t\t\tfaceIndex: i,\n\t\t\t\t\t\tuv: null,\n\t\t\t\t\t\tuv2: null,\n\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t};\n\n\t}() )\n\n} );\n\nexport { LineSegments2 };\n","\nimport { LineSegments2 } from \"./LineSegments2\";\nimport { LineGeometry } from \"./LineGeometry\";\nimport { LineMaterial } from \"./LineMaterial\";\n\nvar Line2 = function ( geometry, material ) {\n\n\tif ( geometry === undefined ) geometry = new LineGeometry();\n\tif ( material === undefined ) material = new LineMaterial( { color: Math.random() * 0xffffff } );\n\n\tLineSegments2.call( this, geometry, material );\n\n\tthis.type = 'Line2';\n\n};\n\nLine2.prototype = Object.assign( Object.create( LineSegments2.prototype ), {\n\n\tconstructor: Line2,\n\n\tisLine2: true\n\n} );\n\nexport { Line2 };\n","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport {MathUtils, Object3D, Vector3} from \"three\";\n\nexport class Marker extends Object3D {\n\n    /**\n     * @param markerId {string}\n     */\n    constructor(markerId) {\n        super();\n        Object.defineProperty(this, 'isMarker', {value: true});\n\n        this.data = {\n            id: markerId,\n            type: \"marker\",\n            position: this.position,\n            visible: this.visible\n        };\n\n        // redirect parent properties\n        Object.defineProperty(this, \"position\", {\n            get() { return this.data.position },\n            set(value) { this.data.position = value }\n        });\n        Object.defineProperty(this, \"visible\", {\n            get() { return this.data.visible },\n            set(value) { this.data.visible = value }\n        });\n    }\n\n    dispose() {}\n\n    /**\n     * Updates this marker from the provided data object, usually parsed form json from a markers.json\n     * @param markerData {object}\n     */\n    updateFromData(markerData) {}\n\n    // -- helper methods --\n\n    static _posRelativeToCamera = new Vector3();\n    static _cameraDirection = new Vector3();\n\n    /**\n     * @param position {Vector3}\n     * @param camera {THREE.Camera}\n     * @param fadeDistanceMax {number}\n     * @param fadeDistanceMin {number}\n     * @returns {number} - opacity between 0 and 1\n     */\n    static calculateDistanceOpacity(position, camera, fadeDistanceMin, fadeDistanceMax) {\n        let distance = Marker.calculateDistanceToCameraPlane(position, camera);\n        let minDelta = (distance - fadeDistanceMin) / fadeDistanceMin;\n        let maxDelta = (distance - fadeDistanceMax) / (fadeDistanceMax * 0.5);\n        return Math.min(\n            MathUtils.clamp(minDelta, 0, 1),\n            1 - MathUtils.clamp(maxDelta + 1, 0, 1)\n        );\n    }\n\n    /**\n     * @param position {Vector3}\n     * @param camera {THREE.Camera}\n     * @returns {number}\n     */\n    static calculateDistanceToCameraPlane (position, camera) {\n        Marker._posRelativeToCamera.subVectors(position, camera.position);\n        camera.getWorldDirection(Marker._cameraDirection);\n        return Marker._posRelativeToCamera.dot(Marker._cameraDirection);\n    }\n\n}","/**\n * @author mrdoob / http://mrdoob.com/\n *\n * adapted for bluemap's purposes\n */\n\nimport {\n    Matrix4,\n    Object3D, Vector2,\n    Vector3\n} from \"three\";\nimport {dispatchEvent, htmlToElement} from \"./Utils\";\n\nvar CSS2DObject = function ( element ) {\n\n    Object3D.call( this );\n\n    this.element = document.createElement(\"div\");\n    let parent = element.parentNode;\n    parent.replaceChild(this.element, element);\n    this.element.appendChild(element);\n\n    this.element.style.position = 'absolute';\n\n    this.anchor = new Vector2();\n\n    this.events = null;\n\n    this.addEventListener( 'removed', function () {\n\n        this.traverse( function ( object ) {\n\n            if ( object.element instanceof Element && object.element.parentNode !== null ) {\n\n                object.element.parentNode.removeChild( object.element );\n\n            }\n\n        } );\n\n    } );\n\n    let lastClick = -1;\n    let handleClick = event => {\n        let doubleTap = false;\n\n        let now = Date.now();\n        if (now - lastClick < 500){\n            doubleTap = true;\n        }\n\n        lastClick = now;\n\n        let data = {doubleTap: doubleTap};\n\n        if (this.onClick( {event: event, data: data} )) {\n            event.preventDefault();\n            event.stopPropagation();\n        } else {\n            // fire event\n            dispatchEvent(this.events, \"bluemapMapInteraction\", {\n                data: data,\n                object: this,\n            });\n        }\n    }\n\n    this.element.addEventListener(\"click\", handleClick);\n    this.element.addEventListener(\"touch\", handleClick);\n\n};\n\nCSS2DObject.prototype = Object.create( Object3D.prototype );\nCSS2DObject.prototype.constructor = CSS2DObject;\n\n//\n\nvar CSS2DRenderer = function (events = null) {\n\n    var _this = this;\n\n    var _width, _height;\n    var _widthHalf, _heightHalf;\n\n    var vector = new Vector3();\n    var viewMatrix = new Matrix4();\n    var viewProjectionMatrix = new Matrix4();\n\n    var cache = {\n        objects: new WeakMap()\n    };\n\n    var domElement = document.createElement( 'div' );\n    domElement.style.overflow = 'hidden';\n\n    this.domElement = domElement;\n\n    this.events = events;\n\n    this.getSize = function () {\n\n        return {\n            width: _width,\n            height: _height\n        };\n\n    };\n\n    this.setSize = function ( width, height ) {\n\n        _width = width;\n        _height = height;\n\n        _widthHalf = _width / 2;\n        _heightHalf = _height / 2;\n\n        domElement.style.width = width + 'px';\n        domElement.style.height = height + 'px';\n\n    };\n\n    var renderObject = function ( object, scene, camera, parentVisible ) {\n\n        if ( object instanceof CSS2DObject ) {\n\n            object.events = _this.events;\n\n            object.onBeforeRender( _this, scene, camera );\n\n            vector.setFromMatrixPosition( object.matrixWorld );\n            vector.applyMatrix4( viewProjectionMatrix );\n\n            var element = object.element;\n            var style = 'translate(' + ( vector.x * _widthHalf + _widthHalf - object.anchor.x) + 'px,' + ( - vector.y * _heightHalf + _heightHalf - object.anchor.y ) + 'px)';\n\n            element.style.WebkitTransform = style;\n            element.style.MozTransform = style;\n            element.style.oTransform = style;\n            element.style.transform = style;\n\n            element.style.display = ( parentVisible && object.visible && vector.z >= - 1 && vector.z <= 1 && element.style.opacity !== \"0\" ) ? '' : 'none';\n\n            var objectData = {\n                distanceToCameraSquared: getDistanceToSquared( camera, object )\n            };\n\n            cache.objects.set( object, objectData );\n\n            if ( element.parentNode !== domElement ) {\n\n                domElement.appendChild( element );\n\n            }\n\n            object.onAfterRender( _this, scene, camera );\n\n        }\n\n        for ( var i = 0, l = object.children.length; i < l; i ++ ) {\n\n            renderObject( object.children[ i ], scene, camera, parentVisible && object.visible );\n\n        }\n\n    };\n\n    var getDistanceToSquared = function () {\n\n        var a = new Vector3();\n        var b = new Vector3();\n\n        return function ( object1, object2 ) {\n\n            a.setFromMatrixPosition( object1.matrixWorld );\n            b.setFromMatrixPosition( object2.matrixWorld );\n\n            return a.distanceToSquared( b );\n\n        };\n\n    }();\n\n    var filterAndFlatten = function ( scene ) {\n\n        var result = [];\n\n        scene.traverse( function ( object ) {\n\n            if ( object instanceof CSS2DObject ) result.push( object );\n\n        } );\n\n        return result;\n\n    };\n\n    var zOrder = function ( scene ) {\n\n        var sorted = filterAndFlatten( scene ).sort( function ( a, b ) {\n\n            var distanceA = cache.objects.get( a ).distanceToCameraSquared;\n            var distanceB = cache.objects.get( b ).distanceToCameraSquared;\n\n            return distanceA - distanceB;\n\n        } );\n\n        var zMax = sorted.length;\n\n        for ( var i = 0, l = sorted.length; i < l; i ++ ) {\n\n            sorted[ i ].element.style.zIndex = zMax - i;\n\n        }\n\n    };\n\n    this.render = function ( scene, camera ) {\n\n        if ( scene.autoUpdate === true ) scene.updateMatrixWorld();\n        if ( camera.parent === null ) camera.updateMatrixWorld();\n\n        viewMatrix.copy( camera.matrixWorldInverse );\n        viewProjectionMatrix.multiplyMatrices( camera.projectionMatrix, viewMatrix );\n\n        renderObject( scene, scene, camera, true );\n        zOrder( scene );\n\n    };\n\n};\n\nexport { CSS2DObject, CSS2DRenderer };","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport {Marker} from \"./Marker\";\nimport {CSS2DObject} from \"../util/CSS2DRenderer\";\nimport {animate, htmlToElement} from \"../util/Utils\";\nimport {Vector3} from \"three\";\n\nexport class ObjectMarker extends Marker {\n\n    /**\n     * @param markerId {string}\n     */\n    constructor(markerId) {\n        super(markerId);\n        Object.defineProperty(this, 'isObjectMarker', {value: true});\n        this.data.type = \"object\";\n\n        this.data.label = null;\n        this.data.detail = null;\n        this.data.link = null;\n        this.data.newTab = true;\n\n        this.lastClick = -1;\n    }\n\n    onClick(event) {\n        let pos = new Vector3();\n        if (event.intersection) {\n            pos.copy(event.intersection.pointOnLine || event.intersection.point);\n            pos.sub(this.position);\n        }\n\n        if (event.data.doubleTap) return false;\n\n        if (this.data.detail || this.data.label) {\n            let popup = new LabelPopup(this.data.detail || this.data.label);\n            popup.position.copy(pos);\n            this.add(popup);\n            popup.open();\n        }\n\n        if (this.data.link){\n            window.open(this.data.link, this.data.newTab ? '_blank' : '_self');\n        }\n\n        return true;\n    }\n\n    /**\n     * @param markerData {{\n     *      position: {x: number, y: number, z: number},\n     *      label: string,\n     *      detail: string,\n     *      link: string,\n     *      newTab: boolean\n     *      }}\n     */\n    updateFromData(markerData) {\n\n        // update position\n        let pos = markerData.position || {};\n        this.position.setX(pos.x || 0);\n        this.position.setY(pos.y || 0);\n        this.position.setZ(pos.z || 0);\n\n        // update label\n        this.data.label = markerData.label || null;\n\n        //update detail\n        this.data.detail = markerData.detail || null;\n\n        // update link\n        this.data.link = markerData.link || null;\n        this.data.newTab = !!markerData.newTab;\n    }\n\n}\n\nexport class LabelPopup extends CSS2DObject {\n\n    /**\n     * @param label {string}\n     */\n    constructor(label) {\n        super(htmlToElement(`<div class=\"bm-marker-labelpopup\">${label}</div>`));\n    }\n\n    /**\n     * @param autoClose {boolean} - whether this object should be automatically closed and removed again on any other interaction\n     */\n    open(autoClose = true) {\n        let targetOpacity = this.element.style.opacity || 1;\n\n        this.element.style.opacity = 0;\n        let inAnimation = animate(progress => {\n            this.element.style.opacity = (progress * targetOpacity).toString();\n        }, 300);\n\n        if (autoClose) {\n            let removeHandler = evt => {\n                if (evt.composedPath().includes(this.element)) return;\n\n                inAnimation.cancel();\n                this.close();\n\n                window.removeEventListener(\"mousedown\", removeHandler);\n                window.removeEventListener(\"touchstart\", removeHandler);\n                window.removeEventListener(\"keydown\", removeHandler);\n                window.removeEventListener(\"mousewheel\", removeHandler);\n            };\n\n            window.addEventListener(\"mousedown\", removeHandler);\n            window.addEventListener(\"touchstart\", removeHandler);\n            window.addEventListener(\"keydown\", removeHandler);\n            window.addEventListener(\"mousewheel\", removeHandler);\n        }\n    }\n\n    /**\n     * @param remove {boolean} - whether this object should be removed from its parent when the close-animation finished\n     */\n    close(remove = true) {\n        let startOpacity = parseFloat(this.element.style.opacity);\n\n        animate(progress => {\n            this.element.style.opacity = (startOpacity - progress * startOpacity).toString();\n        }, 300, completed => {\n            if (remove && completed && this.parent) {\n                this.parent.remove(this);\n            }\n        });\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport {Color, DoubleSide, Mesh, ShaderMaterial, Shape, ShapeBufferGeometry, Vector2} from \"three\";\nimport {LineMaterial} from \"../util/lines/LineMaterial\";\nimport {MARKER_FILL_VERTEX_SHADER} from \"./MarkerFillVertexShader\";\nimport {MARKER_FILL_FRAGMENT_SHADER} from \"./MarkerFillFragmentShader\";\nimport {LineGeometry} from \"../util/lines/LineGeometry\";\nimport {Line2} from \"../util/lines/Line2\";\nimport {deepEquals} from \"../util/Utils\";\nimport {ObjectMarker} from \"./ObjectMarker\";\n\nexport class ShapeMarker extends ObjectMarker {\n\n    /**\n     * @param markerId {string}\n     */\n    constructor(markerId) {\n        super(markerId);\n        Object.defineProperty(this, 'isShapeMarker', {value: true});\n        this.data.type = \"shape\";\n\n        let zero = new Vector2();\n        let shape = new Shape([zero, zero, zero]);\n        this.fill = new ShapeMarkerFill(shape);\n        this.border = new ShapeMarkerBorder(shape);\n        this.border.renderOrder = -1; // render border before fill\n\n        this.add(this.border, this.fill);\n\n        this._markerData = {};\n    }\n\n    /**\n     * @param y {number}\n     */\n    setShapeY(y) {\n        let relativeY = y - this.position.y;\n        this.fill.position.y = relativeY;\n        this.border.position.y = relativeY;\n    }\n\n    /**\n     * @param shape {Shape}\n     */\n    setShape(shape) {\n        this.fill.updateGeometry(shape);\n        this.border.updateGeometry(shape);\n    }\n\n    /**\n     * @typedef {{r: number, g: number, b: number, a: number}} ColorLike\n     */\n\n    /**\n     * @param markerData {{\n     *      position: {x: number, y: number, z: number},\n     *      label: string,\n     *      detail: string,\n     *      shape: {x: number, z: number}[],\n     *      shapeY: number,\n     *      height: number,\n     *      link: string,\n     *      newTab: boolean,\n     *      depthTest: boolean,\n     *      lineWidth: number,\n     *      borderColor: ColorLike,\n     *      lineColor: ColorLike,\n     *      fillColor: ColorLike,\n     *      minDistance: number,\n     *      maxDistance: number\n     *      }}\n     */\n    updateFromData(markerData) {\n        super.updateFromData(markerData);\n\n        // update shape only if needed, based on last update-data\n        if (\n            !this._markerData.shape || !deepEquals(markerData.shape, this._markerData.shape) ||\n            !this._markerData.position || !deepEquals(markerData.position, this._markerData.position)\n        ){\n            this.setShape(this.createShapeFromData(markerData.shape));\n        }\n\n        // update shapeY\n        this.setShapeY((markerData.shapeY || markerData.height || 0) + 0.01); //\"height\" for backwards compatibility, adding 0.01 to avoid z-fighting\n\n        // update depthTest\n        this.border.depthTest = !!markerData.depthTest;\n        this.fill.depthTest = !!markerData.depthTest;\n\n        // update border-width\n        this.border.linewidth = markerData.lineWidth !== undefined ? markerData.lineWidth : 2;\n\n        // update border-color\n        let bc = markerData.lineColor || markerData.borderColor || {}; //\"borderColor\" for backwards compatibility\n        this.border.color.setRGB((bc.r || 0) / 255, (bc.g || 0) / 255, (bc.b || 0) / 255);\n        this.border.opacity = bc.a || 0;\n\n        // update fill-color\n        let fc = markerData.fillColor || {};\n        this.fill.color.setRGB((fc.r || 0) / 255, (fc.g || 0) / 255, (fc.b || 0) / 255);\n        this.fill.opacity = fc.a || 0;\n\n        // update min/max distances\n        let minDist = markerData.minDistance || 0;\n        let maxDist = markerData.maxDistance !== undefined ? markerData.maxDistance : Number.MAX_VALUE;\n        this.border.fadeDistanceMin = minDist;\n        this.border.fadeDistanceMax = maxDist;\n        this.fill.fadeDistanceMin = minDist;\n        this.fill.fadeDistanceMax = maxDist;\n\n        // save used marker data for next update\n        this._markerData = markerData;\n    }\n\n    dispose() {\n        super.dispose();\n\n        this.fill.dispose();\n        this.border.dispose();\n    }\n\n    /**\n     * @private\n     * Creates a shape from a data object, usually parsed json from a markers.json\n     * @param shapeData {object}\n     * @returns {Shape}\n     */\n    createShapeFromData(shapeData) {\n        /** @type {THREE.Vector2[]} **/\n        let points = [];\n\n        if (Array.isArray(shapeData)){\n            shapeData.forEach(point => {\n                let x = (point.x || 0) - this.position.x;\n                let z = (point.z || 0) - this.position.z;\n\n                points.push(new Vector2(x, z));\n            });\n        }\n\n        return new Shape(points);\n    }\n\n}\n\nclass ShapeMarkerFill extends Mesh {\n\n    /**\n     * @param shape {Shape}\n     */\n    constructor(shape) {\n        let geometry = ShapeMarkerFill.createGeometry(shape);\n        let material = new ShaderMaterial({\n            vertexShader: MARKER_FILL_VERTEX_SHADER,\n            fragmentShader: MARKER_FILL_FRAGMENT_SHADER,\n            side: DoubleSide,\n            depthTest: true,\n            transparent: true,\n            uniforms: {\n                markerColor: { value: new Color() },\n                markerOpacity: { value: 0 },\n                fadeDistanceMin: { value: 0 },\n                fadeDistanceMax: { value: Number.MAX_VALUE },\n            }\n        });\n\n        super(geometry, material);\n    }\n\n    /**\n     * @returns {Color}\n     */\n    get color(){\n        return this.material.uniforms.markerColor.value;\n    }\n\n    /**\n     * @returns {number}\n     */\n    get opacity() {\n        return this.material.uniforms.markerOpacity.value;\n    }\n\n    /**\n     * @param opacity {number}\n     */\n    set opacity(opacity) {\n        this.material.uniforms.markerOpacity.value = opacity;\n        this.visible = opacity > 0;\n    }\n\n    /**\n     * @returns {boolean}\n     */\n    get depthTest() {\n        return this.material.depthTest;\n    }\n\n    /**\n     * @param test {boolean}\n     */\n    set depthTest(test) {\n        this.material.depthTest = test;\n    }\n\n    /**\n     * @returns {number}\n     */\n    get fadeDistanceMin() {\n        return this.material.uniforms.fadeDistanceMin.value;\n    }\n\n    /**\n     * @param min {number}\n     */\n    set fadeDistanceMin(min) {\n        this.material.uniforms.fadeDistanceMin.value = min;\n    }\n\n    /**\n     * @returns {number}\n     */\n    get fadeDistanceMax() {\n        return this.material.uniforms.fadeDistanceMax.value;\n    }\n\n    /**\n     * @param max {number}\n     */\n    set fadeDistanceMax(max) {\n        this.material.uniforms.fadeDistanceMax.value = max;\n    }\n\n    onClick(event) {\n        if (event.intersection) {\n            if (event.intersection.distance > this.fadeDistanceMax) return false;\n            if (event.intersection.distance < this.fadeDistanceMin) return false;\n        }\n\n        return super.onClick(event);\n    }\n\n    /**\n     * @param shape {Shape}\n     */\n    updateGeometry(shape) {\n        this.geometry.dispose();\n        this.geometry = ShapeMarkerFill.createGeometry(shape);\n    }\n\n    dispose() {\n        this.geometry.dispose();\n        this.material.dispose();\n    }\n\n    /**\n     * @param shape {Shape}\n     * @returns {ShapeBufferGeometry}\n     */\n    static createGeometry(shape) {\n        let geometry = new ShapeBufferGeometry(shape, 5);\n        geometry.rotateX(Math.PI / 2); //make y to z\n\n        return geometry;\n    }\n\n}\n\nclass ShapeMarkerBorder extends Line2 {\n\n    /**\n     * @param shape {Shape}\n     */\n    constructor(shape) {\n        let geometry = new LineGeometry();\n        geometry.setPositions(ShapeMarkerBorder.createLinePoints(shape));\n\n        let material = new LineMaterial({\n            color: new Color(),\n            opacity: 0,\n            transparent: true,\n            linewidth: 1,\n            depthTest: true,\n            vertexColors: false,\n            dashed: false,\n        });\n        material.uniforms.fadeDistanceMin = { value: 0 };\n        material.uniforms.fadeDistanceMax = { value: Number.MAX_VALUE };\n\n        material.resolution.set(window.innerWidth, window.innerHeight);\n\n        super(geometry, material);\n\n        this.computeLineDistances();\n    }\n\n    /**\n     * @returns {Color}\n     */\n    get color(){\n        return this.material.color;\n    }\n\n    /**\n     * @returns {number}\n     */\n    get opacity() {\n        return this.material.opacity;\n    }\n\n    /**\n     * @param opacity {number}\n     */\n    set opacity(opacity) {\n        this.material.opacity = opacity;\n        this.visible = opacity > 0;\n    }\n\n    /**\n     * @returns {number}\n     */\n    get linewidth() {\n        return this.material.linewidth;\n    }\n\n    /**\n     * @param width {number}\n     */\n    set linewidth(width) {\n        this.material.linewidth = width;\n    }\n\n    /**\n     * @returns {boolean}\n     */\n    get depthTest() {\n        return this.material.depthTest;\n    }\n\n    /**\n     * @param test {boolean}\n     */\n    set depthTest(test) {\n        this.material.depthTest = test;\n    }\n\n    /**\n     * @returns {number}\n     */\n    get fadeDistanceMin() {\n        return this.material.uniforms.fadeDistanceMin.value;\n    }\n\n    /**\n     * @param min {number}\n     */\n    set fadeDistanceMin(min) {\n        this.material.uniforms.fadeDistanceMin.value = min;\n    }\n\n    /**\n     * @returns {number}\n     */\n    get fadeDistanceMax() {\n        return this.material.uniforms.fadeDistanceMax.value;\n    }\n\n    /**\n     * @param max {number}\n     */\n    set fadeDistanceMax(max) {\n        this.material.uniforms.fadeDistanceMax.value = max;\n    }\n\n    onClick(event) {\n        if (event.intersection) {\n            if (event.intersection.distance > this.fadeDistanceMax) return false;\n            if (event.intersection.distance < this.fadeDistanceMin) return false;\n        }\n\n        return super.onClick(event);\n    }\n\n    /**\n     * @param shape {Shape}\n     */\n    updateGeometry(shape) {\n        this.geometry = new LineGeometry();\n        this.geometry.setPositions(ShapeMarkerBorder.createLinePoints(shape));\n        this.computeLineDistances();\n    }\n\n    /**\n     * @param renderer {THREE.WebGLRenderer}\n     */\n    onBeforeRender(renderer) {\n        renderer.getSize(this.material.resolution);\n    }\n\n    dispose() {\n        this.geometry.dispose();\n        this.material.dispose();\n    }\n\n    /**\n     * @param shape {Shape}\n     * @returns {number[]}\n     */\n    static createLinePoints(shape) {\n        let points3d = [];\n        let points = shape.getPoints(5);\n        points.forEach(point => points3d.push(point.x, 0, point.y));\n        points3d.push(points[0].x, 0, points[0].y);\n\n        return points3d;\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport {Color, DoubleSide, ExtrudeBufferGeometry, Mesh, ShaderMaterial, Shape, Vector2} from \"three\";\nimport {LineMaterial} from \"../util/lines/LineMaterial\";\nimport {MARKER_FILL_VERTEX_SHADER} from \"./MarkerFillVertexShader\";\nimport {MARKER_FILL_FRAGMENT_SHADER} from \"./MarkerFillFragmentShader\";\nimport {Line2} from \"../util/lines/Line2\";\nimport {deepEquals} from \"../util/Utils\";\nimport {LineSegmentsGeometry} from \"../util/lines/LineSegmentsGeometry\";\nimport {ObjectMarker} from \"./ObjectMarker\";\n\nexport class ExtrudeMarker extends ObjectMarker {\n\n    /**\n     * @param markerId {string}\n     */\n    constructor(markerId) {\n        super(markerId);\n        Object.defineProperty(this, 'isExtrudeMarker', {value: true});\n        this.data.type = \"extrude\";\n\n        let zero = new Vector2();\n        let shape = new Shape([zero, zero, zero]);\n        this.fill = new ExtrudeMarkerFill(shape);\n        this.border = new ExtrudeMarkerBorder(shape);\n        this.border.renderOrder = -1; // render border before fill\n\n        this.add(this.border, this.fill);\n\n        this._markerData = {};\n    }\n\n    /**\n     * @param minY {number}\n     * @param maxY {number}\n     */\n    setShapeY(minY, maxY) {\n        let relativeY = maxY - this.position.y;\n        let height = maxY - minY;\n        this.fill.position.y = relativeY;\n        this.border.position.y = relativeY;\n        this.fill.scale.y = height;\n        this.border.scale.y = height;\n    }\n\n    /**\n     * @param shape {Shape}\n     */\n    setShape(shape) {\n        this.fill.updateGeometry(shape);\n        this.border.updateGeometry(shape);\n    }\n\n    /**\n     * @typedef {{r: number, g: number, b: number, a: number}} ColorLike\n     */\n\n    /**\n     * @param markerData {{\n     *      position: {x: number, y: number, z: number},\n     *      label: string,\n     *      detail: string,\n     *      shape: {x: number, z: number}[],\n     *      shapeMinY: number,\n     *      shapeMaxY: number,\n     *      link: string,\n     *      newTab: boolean,\n     *      depthTest: boolean,\n     *      lineWidth: number,\n     *      lineColor: ColorLike,\n     *      fillColor: ColorLike,\n     *      minDistance: number,\n     *      maxDistance: number\n     *      }}\n     */\n    updateFromData(markerData) {\n        super.updateFromData(markerData);\n\n        // update shape only if needed, based on last update-data\n        if (\n            !this._markerData.shape || !deepEquals(markerData.shape, this._markerData.shape) ||\n            !this._markerData.position || !deepEquals(markerData.position, this._markerData.position)\n        ){\n            this.setShape(this.createShapeFromData(markerData.shape));\n        }\n\n        // update shapeY\n        this.setShapeY((markerData.shapeMinY || 0) - 0.01, (markerData.shapeMaxY || 0) + 0.01); // offset by 0.01 to avoid z-fighting\n\n        // update depthTest\n        this.border.depthTest = !!markerData.depthTest;\n        this.fill.depthTest = !!markerData.depthTest;\n\n        // update border-width\n        this.border.linewidth = markerData.lineWidth !== undefined ? markerData.lineWidth : 2;\n\n        // update border-color\n        let bc = markerData.lineColor || {};\n        this.border.color.setRGB((bc.r || 0) / 255, (bc.g || 0) / 255, (bc.b || 0) / 255);\n        this.border.opacity = bc.a || 0;\n\n        // update fill-color\n        let fc = markerData.fillColor || {};\n        this.fill.color.setRGB((fc.r || 0) / 255, (fc.g || 0) / 255, (fc.b || 0) / 255);\n        this.fill.opacity = fc.a || 0;\n\n        // update min/max distances\n        let minDist = markerData.minDistance || 0;\n        let maxDist = markerData.maxDistance !== undefined ? markerData.maxDistance : Number.MAX_VALUE;\n        this.border.fadeDistanceMin = minDist;\n        this.border.fadeDistanceMax = maxDist;\n        this.fill.fadeDistanceMin = minDist;\n        this.fill.fadeDistanceMax = maxDist;\n\n        // save used marker data for next update\n        this._markerData = markerData;\n    }\n\n    dispose() {\n        super.dispose();\n\n        this.fill.dispose();\n        this.border.dispose();\n    }\n\n    /**\n     * @private\n     * Creates a shape from a data object, usually parsed json from a markers.json\n     * @param shapeData {object}\n     * @returns {Shape}\n     */\n    createShapeFromData(shapeData) {\n        /** @type {THREE.Vector2[]} **/\n        let points = [];\n\n        if (Array.isArray(shapeData)){\n            shapeData.forEach(point => {\n                let x = (point.x || 0) - this.position.x + 0.01; // offset by 0.01 to avoid z-fighting\n                let z = (point.z || 0) - this.position.z + 0.01;\n\n                points.push(new Vector2(x, z));\n            });\n        }\n\n        return new Shape(points);\n    }\n\n}\n\nclass ExtrudeMarkerFill extends Mesh {\n\n    /**\n     * @param shape {Shape}\n     */\n    constructor(shape) {\n        let geometry = ExtrudeMarkerFill.createGeometry(shape);\n        let material = new ShaderMaterial({\n            vertexShader: MARKER_FILL_VERTEX_SHADER,\n            fragmentShader: MARKER_FILL_FRAGMENT_SHADER,\n            side: DoubleSide,\n            depthTest: true,\n            transparent: true,\n            uniforms: {\n                markerColor: { value: new Color() },\n                markerOpacity: { value: 0 },\n                fadeDistanceMin: { value: 0 },\n                fadeDistanceMax: { value: Number.MAX_VALUE },\n            }\n        });\n\n        super(geometry, material);\n    }\n\n    /**\n     * @returns {Color}\n     */\n    get color(){\n        return this.material.uniforms.markerColor.value;\n    }\n\n    /**\n     * @returns {number}\n     */\n    get opacity() {\n        return this.material.uniforms.markerOpacity.value;\n    }\n\n    /**\n     * @param opacity {number}\n     */\n    set opacity(opacity) {\n        this.material.uniforms.markerOpacity.value = opacity;\n        this.visible = opacity > 0;\n    }\n\n    /**\n     * @returns {boolean}\n     */\n    get depthTest() {\n        return this.material.depthTest;\n    }\n\n    /**\n     * @param test {boolean}\n     */\n    set depthTest(test) {\n        this.material.depthTest = test;\n    }\n\n    /**\n     * @returns {number}\n     */\n    get fadeDistanceMin() {\n        return this.material.uniforms.fadeDistanceMin.value;\n    }\n\n    /**\n     * @param min {number}\n     */\n    set fadeDistanceMin(min) {\n        this.material.uniforms.fadeDistanceMin.value = min;\n    }\n\n    /**\n     * @returns {number}\n     */\n    get fadeDistanceMax() {\n        return this.material.uniforms.fadeDistanceMax.value;\n    }\n\n    /**\n     * @param max {number}\n     */\n    set fadeDistanceMax(max) {\n        this.material.uniforms.fadeDistanceMax.value = max;\n    }\n\n    onClick(event) {\n        if (event.intersection) {\n            if (event.intersection.distance > this.fadeDistanceMax) return false;\n            if (event.intersection.distance < this.fadeDistanceMin) return false;\n        }\n\n        return super.onClick(event);\n    }\n\n    /**\n     * @param shape {Shape}\n     */\n    updateGeometry(shape) {\n        this.geometry.dispose();\n        this.geometry = ExtrudeMarkerFill.createGeometry(shape);\n    }\n\n    dispose() {\n        this.geometry.dispose();\n        this.material.dispose();\n    }\n\n    /**\n     * @param shape {Shape}\n     * @returns {ExtrudeBufferGeometry}\n     */\n    static createGeometry(shape) {\n        let geometry = new ExtrudeBufferGeometry(shape, {\n            depth: 1,\n            steps: 5,\n            bevelEnabled: false\n        });\n        geometry.rotateX(Math.PI / 2); //make y to z\n\n        return geometry;\n    }\n\n}\n\nclass ExtrudeMarkerBorder extends Line2 {\n\n    /**\n     * @param shape {Shape}\n     */\n    constructor(shape) {\n        let geometry = new LineSegmentsGeometry();\n        geometry.setPositions(ExtrudeMarkerBorder.createLinePoints(shape));\n\n        let material = new LineMaterial({\n            color: new Color(),\n            opacity: 0,\n            transparent: true,\n            linewidth: 1,\n            depthTest: true,\n            vertexColors: false,\n            dashed: false,\n        });\n        material.uniforms.fadeDistanceMin = { value: 0 };\n        material.uniforms.fadeDistanceMax = { value: Number.MAX_VALUE };\n\n        material.resolution.set(window.innerWidth, window.innerHeight);\n\n        super(geometry, material);\n\n        this.computeLineDistances();\n    }\n\n    /**\n     * @returns {Color}\n     */\n    get color(){\n        return this.material.color;\n    }\n\n    /**\n     * @returns {number}\n     */\n    get opacity() {\n        return this.material.opacity;\n    }\n\n    /**\n     * @param opacity {number}\n     */\n    set opacity(opacity) {\n        this.material.opacity = opacity;\n        this.visible = opacity > 0;\n    }\n\n    /**\n     * @returns {number}\n     */\n    get linewidth() {\n        return this.material.linewidth;\n    }\n\n    /**\n     * @param width {number}\n     */\n    set linewidth(width) {\n        this.material.linewidth = width;\n    }\n\n    /**\n     * @returns {boolean}\n     */\n    get depthTest() {\n        return this.material.depthTest;\n    }\n\n    /**\n     * @param test {boolean}\n     */\n    set depthTest(test) {\n        this.material.depthTest = test;\n    }\n\n    /**\n     * @returns {number}\n     */\n    get fadeDistanceMin() {\n        return this.material.uniforms.fadeDistanceMin.value;\n    }\n\n    /**\n     * @param min {number}\n     */\n    set fadeDistanceMin(min) {\n        this.material.uniforms.fadeDistanceMin.value = min;\n    }\n\n    /**\n     * @returns {number}\n     */\n    get fadeDistanceMax() {\n        return this.material.uniforms.fadeDistanceMax.value;\n    }\n\n    /**\n     * @param max {number}\n     */\n    set fadeDistanceMax(max) {\n        this.material.uniforms.fadeDistanceMax.value = max;\n    }\n\n    onClick(event) {\n        if (event.intersection) {\n            if (event.intersection.distance > this.fadeDistanceMax) return false;\n            if (event.intersection.distance < this.fadeDistanceMin) return false;\n        }\n\n        return super.onClick(event);\n    }\n\n    /**\n     * @param shape {Shape}\n     */\n    updateGeometry(shape) {\n        this.geometry = new LineSegmentsGeometry();\n        this.geometry.setPositions(ExtrudeMarkerBorder.createLinePoints(shape));\n        this.computeLineDistances();\n    }\n\n    /**\n     * @param renderer {THREE.WebGLRenderer}\n     */\n    onBeforeRender(renderer) {\n        renderer.getSize(this.material.resolution);\n    }\n\n    dispose() {\n        this.geometry.dispose();\n        this.material.dispose();\n    }\n\n    /**\n     * @param shape {Shape}\n     * @returns {number[]}\n     */\n    static createLinePoints(shape) {\n        let points3d = [];\n        let points = shape.getPoints(5);\n        points.push(points[0]);\n\n        let prevPoint = null;\n        points.forEach(point => {\n\n            // vertical line\n            points3d.push(point.x, 0, point.y);\n            points3d.push(point.x, -1, point.y);\n\n            if (prevPoint) {\n                // line to previous point top\n                points3d.push(prevPoint.x, 0, prevPoint.y);\n                points3d.push(point.x, 0, point.y);\n\n                // line to previous point bottom\n                points3d.push(prevPoint.x, -1, prevPoint.y);\n                points3d.push(point.x, -1, point.y);\n            }\n\n            prevPoint = point;\n        });\n\n        return points3d;\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport {Color} from \"three\";\nimport {LineMaterial} from \"../util/lines/LineMaterial\";\nimport {LineGeometry} from \"../util/lines/LineGeometry\";\nimport {Line2} from \"../util/lines/Line2\";\nimport {deepEquals} from \"../util/Utils\";\nimport {ObjectMarker} from \"./ObjectMarker\";\n\nexport class LineMarker extends ObjectMarker {\n\n    /**\n     * @param markerId {string}\n     */\n    constructor(markerId) {\n        super(markerId);\n        Object.defineProperty(this, 'isLineMarker', {value: true});\n        this.data.type = \"line\";\n\n        this.line = new LineMarkerLine([0, 0, 0]);\n\n        this.add(this.line);\n\n        this._markerData = {};\n    }\n\n    /**\n     * @param line {number[] | THREE.Vector3[] | THREE.Curve}\n     */\n    setLine(line) {\n        /** @type {number[]} */\n        let points;\n\n        if (line.type === 'Curve' || line.type === 'CurvePath') {\n            line = line.getPoints(5);\n        }\n\n        if (Array.isArray(line)) {\n            if (line.length === 0){\n                points = [];\n            } else if (line[0].isVector3) {\n                points = [];\n                line.forEach(point => {\n                    points.push(point.x, point.y, point.z);\n                });\n            } else {\n                points = line;\n            }\n        } else {\n            throw new Error(\"Invalid argument type!\");\n        }\n\n        this.line.updateGeometry(points);\n    }\n\n    /**\n     * @typedef {{r: number, g: number, b: number, a: number}} ColorLike\n     */\n\n    /**\n     * @param markerData {{\n     *      position: {x: number, y: number, z: number},\n     *      label: string,\n     *      detail: string,\n     *      line: {x: number, y: number, z: number}[],\n     *      link: string,\n     *      newTab: boolean,\n     *      depthTest: boolean,\n     *      lineWidth: number,\n     *      lineColor: ColorLike,\n     *      minDistance: number,\n     *      maxDistance: number\n     *      }}\n     */\n    updateFromData(markerData) {\n        super.updateFromData(markerData);\n\n        // update shape only if needed, based on last update-data\n        if (\n            !this._markerData.line || !deepEquals(markerData.line, this._markerData.line) ||\n            !this._markerData.position || !deepEquals(markerData.position, this._markerData.position)\n        ){\n            this.setLine(this.createPointsFromData(markerData.line));\n        }\n\n        // update depthTest\n        this.line.depthTest = !!markerData.depthTest;\n\n        // update border-width\n        this.line.linewidth = markerData.lineWidth !== undefined ? markerData.lineWidth : 2;\n\n        // update line-color\n        let lc = markerData.lineColor || {};\n        this.line.color.setRGB((lc.r || 0) / 255, (lc.g || 0) / 255, (lc.b || 0) / 255);\n        this.line.opacity = lc.a || 0;\n\n        // update min/max distances\n        let minDist = markerData.minDistance || 0;\n        let maxDist = markerData.maxDistance !== undefined ? markerData.maxDistance : Number.MAX_VALUE;\n        this.line.fadeDistanceMin = minDist;\n        this.line.fadeDistanceMax = maxDist;\n\n        // save used marker data for next update\n        this._markerData = markerData;\n    }\n\n    dispose() {\n        super.dispose();\n\n        this.line.dispose();\n    }\n\n    /**\n     * @private\n     * Creates a shape from a data object, usually parsed json from a markers.json\n     * @param shapeData {object}\n     * @returns {number[]}\n     */\n    createPointsFromData(shapeData) {\n        /** @type {number[]} **/\n        let points = [];\n\n        if (Array.isArray(shapeData)){\n            shapeData.forEach(point => {\n                let x = (point.x || 0) - this.position.x;\n                let y = (point.y || 0) - this.position.y;\n                let z = (point.z || 0) - this.position.z;\n\n                points.push(x, y, z);\n            });\n        }\n\n        return points;\n    }\n\n}\n\nclass LineMarkerLine extends Line2 {\n\n    /**\n     * @param points {number[]}\n     */\n    constructor(points) {\n        let geometry = new LineGeometry();\n        geometry.setPositions(points);\n\n        let material = new LineMaterial({\n            color: new Color(),\n            opacity: 0,\n            transparent: true,\n            linewidth: 1,\n            depthTest: true,\n            vertexColors: false,\n            dashed: false,\n        });\n        material.uniforms.fadeDistanceMin = { value: 0 };\n        material.uniforms.fadeDistanceMax = { value: Number.MAX_VALUE };\n\n        material.resolution.set(window.innerWidth, window.innerHeight);\n\n        super(geometry, material);\n\n        this.computeLineDistances();\n    }\n\n    /**\n     * @returns {Color}\n     */\n    get color(){\n        return this.material.color;\n    }\n\n    /**\n     * @returns {number}\n     */\n    get opacity() {\n        return this.material.opacity;\n    }\n\n    /**\n     * @param opacity {number}\n     */\n    set opacity(opacity) {\n        this.material.opacity = opacity;\n        this.visible = opacity > 0;\n    }\n\n    /**\n     * @returns {number}\n     */\n    get linewidth() {\n        return this.material.linewidth;\n    }\n\n    /**\n     * @param width {number}\n     */\n    set linewidth(width) {\n        this.material.linewidth = width;\n    }\n\n    /**\n     * @returns {boolean}\n     */\n    get depthTest() {\n        return this.material.depthTest;\n    }\n\n    /**\n     * @param test {boolean}\n     */\n    set depthTest(test) {\n        this.material.depthTest = test;\n    }\n\n    /**\n     * @returns {number}\n     */\n    get fadeDistanceMin() {\n        return this.material.uniforms.fadeDistanceMin.value;\n    }\n\n    /**\n     * @param min {number}\n     */\n    set fadeDistanceMin(min) {\n        this.material.uniforms.fadeDistanceMin.value = min;\n    }\n\n    /**\n     * @returns {number}\n     */\n    get fadeDistanceMax() {\n        return this.material.uniforms.fadeDistanceMax.value;\n    }\n\n    /**\n     * @param max {number}\n     */\n    set fadeDistanceMax(max) {\n        this.material.uniforms.fadeDistanceMax.value = max;\n    }\n\n    onClick(event) {\n        if (event.intersection) {\n            if (event.intersection.distance > this.fadeDistanceMax) return false;\n            if (event.intersection.distance < this.fadeDistanceMin) return false;\n        }\n\n        return super.onClick(event);\n    }\n\n    /**\n     * @param points {number[]}\n     */\n    updateGeometry(points) {\n        this.geometry = new LineGeometry();\n        this.geometry.setPositions(points);\n        this.computeLineDistances();\n    }\n\n    /**\n     * @param renderer {THREE.WebGLRenderer}\n     */\n    onBeforeRender(renderer) {\n        renderer.getSize(this.material.resolution);\n    }\n\n    dispose() {\n        this.geometry.dispose();\n        this.material.dispose();\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport {Marker} from \"./Marker\";\nimport {CSS2DObject} from \"../util/CSS2DRenderer\";\nimport {htmlToElement} from \"../util/Utils\";\n\nexport class HtmlMarker extends Marker {\n\n    /**\n     * @param markerId {string}\n     */\n    constructor(markerId) {\n        super(markerId);\n        Object.defineProperty(this, 'isHtmlMarker', {value: true});\n        this.data.type = \"html\";\n\n        this.data.label = null;\n\n        this.elementObject = new CSS2DObject(htmlToElement(`<div id=\"bm-marker-${this.data.id}\" class=\"bm-marker-${this.data.type}\"></div>`));\n        this.elementObject.onBeforeRender = (renderer, scene, camera) => this.onBeforeRender(renderer, scene, camera);\n\n        this.fadeDistanceMin = 0;\n        this.fadeDistanceMax = Number.MAX_VALUE;\n\n        this.addEventListener( 'removed', () => {\n            if (this.element.parentNode) this.element.parentNode.removeChild(this.element);\n        });\n\n        this.add(this.elementObject);\n    }\n\n    onBeforeRender(renderer, scene, camera) {\n        if (this.fadeDistanceMax === Number.MAX_VALUE && this.fadeDistanceMin <= 0){\n            this.element.style.opacity = undefined;\n        } else {\n            this.element.style.opacity = Marker.calculateDistanceOpacity(this.position, camera, this.fadeDistanceMin, this.fadeDistanceMax).toString();\n        }\n    }\n\n    /**\n     * @returns {string}\n     */\n    get html() {\n        return this.element.innerHTML;\n    }\n\n    /**\n     * @param html {string}\n     */\n    set html(html) {\n        this.element.innerHTML = html;\n    }\n\n    /**\n     * @returns {THREE.Vector2}\n     */\n    get anchor() {\n        return this.elementObject.anchor;\n    }\n\n    /**\n     * @returns {Element}\n     */\n    get element() {\n        return this.elementObject.element.getElementsByTagName(\"div\")[0];\n    }\n\n    /**\n     * @param markerData {{\n     *      position: {x: number, y: number, z: number},\n     *      label: string,\n     *      anchor: {x: number, y: number},\n     *      html: string,\n     *      minDistance: number,\n     *      maxDistance: number\n     *      }}\n     */\n    updateFromData(markerData) {\n\n        // update position\n        let pos = markerData.position || {};\n        this.position.setX(pos.x || 0);\n        this.position.setY(pos.y || 0);\n        this.position.setZ(pos.z || 0);\n\n        // update label\n        this.data.label = markerData.label || null;\n\n        // update anchor\n        let anch = markerData.anchor || {};\n        this.anchor.setX(anch.x || 0);\n        this.anchor.setY(anch.y || 0);\n\n        // update html\n        if (this.element.innerHTML !== markerData.html){\n            this.element.innerHTML = markerData.html;\n        }\n\n        // update min/max distances\n        this.fadeDistanceMin = markerData.minDistance || 0;\n        this.fadeDistanceMax = markerData.maxDistance !== undefined ? markerData.maxDistance : Number.MAX_VALUE;\n\n    }\n\n    dispose() {\n        super.dispose();\n\n        if (this.element.parentNode) this.element.parentNode.removeChild(this.element);\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport {HtmlMarker} from \"./HtmlMarker\";\n\nexport class PoiMarker extends HtmlMarker {\n\n    /**\n     * @param markerId {string}\n     */\n    constructor(markerId) {\n        super(markerId);\n        Object.defineProperty(this, 'isPoiMarker', {value: true});\n        this.data.type = \"poi\";\n\n        this.html = `<img src=\"\" alt=\"POI Icon (${this.data.id})\" class=\"bm-marker-poi-icon\" draggable=\"false\" style=\"pointer-events: auto\"><div class=\"bm-marker-poi-label\"></div>`;\n\n        this.iconElement = this.element.getElementsByTagName(\"img\").item(0);\n        this.labelElement = this.element.getElementsByTagName(\"div\").item(0);\n\n        this._lastIcon = null;\n    }\n\n    onClick(event) {\n        if (event.data.doubleTap) return false;\n\n        if (this.highlight || !this.data.label) return true;\n        this.highlight = true;\n\n        let eventHandler = evt => {\n            if (evt.composedPath().includes(this.element)) return;\n\n            this.highlight = false;\n\n            window.removeEventListener(\"mousedown\", eventHandler);\n            window.removeEventListener(\"touchstart\", eventHandler);\n            window.removeEventListener(\"keydown\", eventHandler);\n            window.removeEventListener(\"mousewheel\", eventHandler);\n        };\n\n        setTimeout(function () {\n            window.addEventListener(\"mousedown\", eventHandler);\n            window.addEventListener(\"touchstart\", eventHandler);\n            window.addEventListener(\"keydown\", eventHandler);\n            window.addEventListener(\"mousewheel\", eventHandler);\n        }, 0);\n\n        return true;\n    }\n\n    set highlight(highlight) {\n        if (highlight) {\n            this.element.classList.add(\"bm-marker-highlight\");\n        } else {\n            this.element.classList.remove(\"bm-marker-highlight\");\n        }\n    }\n\n    get highlight() {\n        return this.element.classList.contains(\"bm-marker-highlight\");\n    }\n\n    /**\n     * @param markerData {{\n     *      position: {x: number, y: number, z: number},\n     *      anchor: {x: number, y: number},\n     *      iconAnchor: {x: number, y: number},\n     *      label: string,\n     *      icon: string,\n     *      minDistance: number,\n     *      maxDistance: number\n     * }}\n     */\n    updateFromData(markerData) {\n\n        // update position\n        let pos = markerData.position || {};\n        this.position.setX(pos.x || 0);\n        this.position.setY(pos.y || 0);\n        this.position.setZ(pos.z || 0);\n\n        // update anchor\n        let anch = markerData.anchor || markerData.iconAnchor || {}; //\"iconAnchor\" for backwards compatibility\n        this.iconElement.style.transform = `translate(${-anch.x}px, ${-anch.y}px)`;\n        //this.anchor.setX(anch.x || 0);\n        //this.anchor.setY(anch.y || 0);\n\n\n        // update label\n        if (this.data.label !== markerData.label){\n            this.data.label = markerData.label || \"\";\n            this.labelElement.innerHTML = this.data.label || \"\";\n        }\n\n        // update icon\n        if (this._lastIcon !== markerData.icon){\n            this.iconElement.src = markerData.icon || \"assets/poi.svg\";\n            this._lastIcon = markerData.icon;\n        }\n\n        // update min/max distances\n        this.fadeDistanceMin = markerData.minDistance || 0;\n        this.fadeDistanceMax = markerData.maxDistance !== undefined ? markerData.maxDistance : Number.MAX_VALUE;\n\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport {FileLoader, Scene} from \"three\";\nimport {MarkerSet} from \"./MarkerSet\";\nimport {alert, generateCacheHash} from \"../util/Utils\";\n\n/**\n * A manager for loading and updating markers from a file\n */\nexport class MarkerManager {\n\n    /**\n     * @constructor\n     * @param markerScene {Scene} - The scene to which all markers will be added\n     * @param fileUrl {string} - The marker file from which this manager updates its markers\n     * @param events {EventTarget}\n     */\n    constructor(markerScene, fileUrl, events = null) {\n        Object.defineProperty(this, 'isMarkerManager', {value: true});\n\n        this.markerScene = markerScene;\n        this.fileUrl = fileUrl;\n        this.events = events;\n\n        /** @type {Map<string, MarkerSet>} */\n        this.markerSets = new Map();\n        /** @type {Map<string, Marker>} */\n        this.markers = new Map();\n\n        /** @type {NodeJS.Timeout} */\n        this._updateInterval = null;\n    }\n\n    /**\n     * Sets the automatic-update frequency, setting this to 0 or negative disables automatic updates (default).\n     * This is better than using setInterval() on update() because this will wait for the update to finish before requesting the next update.\n     * @param ms - interval in milliseconds\n     */\n    setAutoUpdateInterval(ms) {\n        if (this._updateInterval) clearTimeout(this._updateInterval);\n        if (ms > 0) {\n            let autoUpdate = () => {\n                this.update()\n                    .then(success => {\n                        if (success) {\n                            this._updateInterval = setTimeout(autoUpdate, ms);\n                        } else {\n                            this._updateInterval = setTimeout(autoUpdate, Math.max(ms, 1000 * 15));\n                        }\n                    })\n                    .catch(e => {\n                        alert(this.events, e, \"warning\");\n                        this._updateInterval = setTimeout(autoUpdate, Math.max(ms, 1000 * 15));\n                    });\n            };\n\n            this._updateInterval = setTimeout(autoUpdate, ms);\n        }\n    }\n\n    /**\n     * Loads the marker-file and updates all managed markers.\n     * @returns {Promise<object>} - A promise completing when the markers finished updating\n     */\n    update() {\n        return this.loadMarkerFile()\n            .then(markerFileData => this.updateFromData(markerFileData));\n    }\n\n    /**\n     * Stops automatic-updates and disposes all markersets and markers managed by this manager\n     */\n    dispose() {\n        this.setAutoUpdateInterval(0);\n        this.markerSets.forEach(markerSet => markerSet.dispose());\n    }\n\n    /**\n     * Removes all markers managed by this marker-manager\n     */\n    clear() {\n        this.markerSets.forEach(markerSet => this.removeMarkerSet(markerSet.data.id));\n    }\n\n    /**\n     * @protected\n     * Adds a MarkerSet to this Manager, removing any existing markerSet with this id first.\n     * @param markerSet {MarkerSet}\n     */\n    addMarkerSet(markerSet) {\n        this.removeMarkerSet(markerSet.data.id);\n\n        this.markerSets.set(markerSet.data.id, markerSet);\n        this.markerScene.add(markerSet);\n    }\n\n    /**\n     * @protected\n     * Removes a MarkerSet from this Manager\n     * @param setId {string} - The id of the MarkerSet\n     */\n    removeMarkerSet(setId) {\n        let markerSet = this.markerSets.get(setId);\n\n        if (markerSet) {\n            this.markerScene.remove(markerSet);\n            this.markerSets.delete(setId);\n            markerSet.dispose();\n        }\n    }\n\n    /**\n     * @protected\n     * Adds a marker to this manager\n     * @param markerSet {MarkerSet}\n     * @param marker {Marker}\n     */\n    addMarker(markerSet, marker) {\n        this.removeMarker(marker.data.id);\n\n        this.markers.set(marker.data.id, marker);\n        markerSet.add(marker);\n    }\n\n    /**\n     * @protected\n     * Removes a marker from this manager\n     * @param markerId {string}\n     */\n    removeMarker(markerId) {\n        let marker = this.markers.get(markerId);\n\n        if (marker) {\n            if (marker.parent) marker.parent.remove(marker);\n            this.markers.delete(markerId);\n            marker.dispose();\n        }\n    }\n\n    /**\n     * Updates all managed markers using the provided data.\n     * @param markerData {object} - The data object, usually parsed json from a markers.json\n     * @returns {boolean} - If the update was successful\n     */\n    updateFromData(markerData) {\n        return false;\n    }\n\n    /**\n     * @private\n     * Loads the marker file\n     * @returns {Promise<Object>} - A promise completing with the parsed json object from the loaded file\n     */\n    loadMarkerFile() {\n        return new Promise((resolve, reject) => {\n            let loader = new FileLoader();\n            loader.setResponseType(\"json\");\n            loader.load(this.fileUrl + \"?\" + generateCacheHash(),\n                markerFileData => {\n                    if (!markerFileData) reject(`Failed to parse '${this.fileUrl}'!`);\n                    else resolve(markerFileData);\n                },\n                () => {},\n                () => reject(`Failed to load '${this.fileUrl}'!`)\n            )\n        });\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport {Scene} from \"three\";\nimport {MarkerSet} from \"./MarkerSet\";\nimport {ShapeMarker} from \"./ShapeMarker\";\nimport {alert} from \"../util/Utils\";\nimport {ExtrudeMarker} from \"./ExtrudeMarker\";\nimport {LineMarker} from \"./LineMarker\";\nimport {HtmlMarker} from \"./HtmlMarker\";\nimport {PoiMarker} from \"./PoiMarker\";\nimport {MarkerManager} from \"./MarkerManager\";\n\n/**\n * A manager for loading and updating markers from a markers.json file\n */\nexport class MarkerFileManager extends MarkerManager {\n\n    /**\n     * @constructor\n     * @param markerScene {Scene} - The scene to which all markers will be added\n     * @param fileUrl {string} - The marker file from which this manager updates its markers\n     * @param mapId {string} - The mapId of the map for which the markers should be loaded\n     * @param events {EventTarget}\n     */\n    constructor(markerScene, fileUrl, mapId, events = null) {\n        super(markerScene, fileUrl, events);\n        Object.defineProperty(this, 'isMarkerFileManager', {value: true});\n\n        this.mapId = mapId;\n    }\n\n    updateFromData(markerData) {\n        if (!Array.isArray(markerData.markerSets)) return false;\n        let updatedMarkerSets = new Set();\n\n        // add & update\n        markerData.markerSets.forEach(markerSetData => {\n            try {\n                let markerSet = this.updateMarkerSetFromData(markerSetData);\n                updatedMarkerSets.add(markerSet);\n            } catch (err) {\n                alert(this.events, err, \"fine\");\n            }\n        });\n\n        // remove not updated MarkerSets\n        this.markerSets.forEach((markerSet, setId) => {\n            if (!updatedMarkerSets.has(markerSet)) {\n                this.removeMarkerSet(setId);\n            }\n        });\n\n        return true;\n    }\n\n    /**\n     * @private\n     * Updates a managed MarkerSet using the provided data\n     * @param markerSetData {object} - The data object for a MarkerSet, usually parsed json from a markers.json\n     * @returns {MarkerSet} - The updated MarkerSet\n     * @throws {Error} - On invalid / missing data\n     */\n    updateMarkerSetFromData(markerSetData) {\n        if (!markerSetData.id) throw new Error(\"markerset-data has no id!\");\n        let markerSet = this.markerSets.get(markerSetData.id);\n\n        // create new if not existent\n        if (!markerSet) {\n            markerSet = new MarkerSet(markerSetData.id);\n            this.addMarkerSet(markerSet);\n\n            if (markerSetData.defaultHide) {\n                markerSet.visible = false;\n            }\n        }\n\n        // update set info\n        markerSet.data.label = markerSetData.label || markerSetData.id;\n        markerSet.data.toggleable = !!markerSetData.toggleable;\n        markerSet.data.defaultHide = !!markerSetData.defaultHide;\n\n        // update markers\n        let updatedMarkers = new Set();\n\n        if (Array.isArray(markerSetData.marker)) {\n            markerSetData.marker.forEach(markerData => {\n                if (markerData.map && markerData.map !== this.mapId) return;\n\n                try {\n                    let marker = this.updateMarkerFromData(markerSet, markerData);\n                    updatedMarkers.add(marker);\n                } catch (err) {\n                    alert(this.events, err, \"fine\");\n                    console.debug(err);\n                }\n            });\n        }\n\n        // remove not updated Markers\n        markerSet.children.forEach((marker) => {\n            if (marker.isMarker && !updatedMarkers.has(marker)) {\n                this.removeMarker(marker.data.id);\n            }\n        });\n\n        return markerSet;\n    }\n\n    /**\n     * @private\n     * Updates a managed Marker using the provided data\n     * @param markerSet {MarkerSet} - The MarkerSet this marker should be in\n     * @param markerData {object}\n     * @returns {Marker} - The updated Marker\n     * @throws {Error} - On invalid / missing data\n     */\n    updateMarkerFromData(markerSet, markerData) {\n        if (!markerData.id) throw new Error(\"marker-data has no id!\");\n        if (!markerData.type) throw new Error(\"marker-data has no type!\");\n        let marker = this.markers.get(markerData.id);\n\n        // create new if not existent of wrong type\n        if (!marker || marker.data.type !== markerData.type) {\n            switch (markerData.type) {\n                case \"shape\" : marker = new ShapeMarker(markerData.id); break;\n                case \"extrude\" : marker = new ExtrudeMarker(markerData.id); break;\n                case \"line\" : marker = new LineMarker(markerData.id); break;\n                case \"html\" : marker = new HtmlMarker(markerData.id); break;\n                case \"poi\" : marker = new PoiMarker(markerData.id); break;\n                default : throw new Error(`Unknown marker-type: '${markerData.type}'`);\n            }\n\n            this.addMarker(markerSet, marker);\n        }\n\n        // make sure marker is in the correct MarkerSet\n        if (marker.parent !== markerSet) markerSet.add(marker);\n\n        // update marker\n        marker.updateFromData(markerData);\n\n        return marker;\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport {Marker} from \"./Marker\";\nimport {CSS2DObject} from \"../util/CSS2DRenderer\";\nimport {animate, EasingFunctions, htmlToElement} from \"../util/Utils\";\n\nexport class PlayerMarker extends Marker {\n\n    /**\n     * @param markerId {string}\n     * @param playerUuid {string}\n     */\n    constructor(markerId, playerUuid) {\n        super(markerId);\n        Object.defineProperty(this, 'isPlayerMarker', {value: true});\n        this.data.type = \"player\";\n\n        this.data.playerUuid = playerUuid;\n        this.data.name = playerUuid;\n\n        this.data.world = \"?\";\n\n        this.elementObject = new CSS2DObject(htmlToElement(`\n<div id=\"bm-marker-${this.data.id}\" class=\"bm-marker-${this.data.type}\">\n    <img src=\"assets/playerheads/${this.data.playerUuid}.png\" alt=\"playerhead\" draggable=\"false\">\n    <div class=\"bm-player-name\"></div>\n</div>\n        `));\n        this.elementObject.onBeforeRender = (renderer, scene, camera) => this.onBeforeRender(renderer, scene, camera);\n\n        this.playerHeadElement = this.element.getElementsByTagName(\"img\")[0];\n        this.playerNameElement = this.element.getElementsByTagName(\"div\")[0];\n\n        this.addEventListener( 'removed', () => {\n            if (this.element.parentNode) this.element.parentNode.removeChild(this.element);\n        });\n\n        this.playerHeadElement.addEventListener('error', () => {\n            this.playerHeadElement.src = \"assets/steve.png\";\n        }, {once: true});\n\n        this.add(this.elementObject);\n    }\n\n    /**\n     * @returns {Element}\n     */\n    get element() {\n        return this.elementObject.element.getElementsByTagName(\"div\")[0];\n    }\n\n    onBeforeRender(renderer, scene, camera) {\n        let distance = Marker.calculateDistanceToCameraPlane(this.position, camera);\n\n        let value = \"near\";\n        if (distance > 1000) {\n            value = \"med\";\n        }\n        if (distance > 5000) {\n            value = \"far\";\n        }\n\n        this.element.setAttribute(\"distance-data\", value);\n    }\n\n    /**\n     * @typedef PlayerLike {{\n     *      uuid: string,\n     *      name: string,\n     *      world: string,\n     *      position: {x: number, y: number, z: number},\n     *      rotation: {yaw: number, pitch: number, roll: number}\n     * }}\n     */\n\n    /**\n     * @param markerData {PlayerLike}\n     */\n    updateFromData(markerData) {\n\n        // animate position update\n        let pos = markerData.position || {};\n        if (!this.position.x && !this.position.y && !this.position.z) {\n            this.position.set(\n                pos.x || 0,\n                pos.y || 0,\n                pos.z || 0\n            );\n        } else {\n            let startPos = {\n                x: this.position.x,\n                y: this.position.y,\n                z: this.position.z,\n            }\n            let deltaPos = {\n                x: (pos.x || 0) - startPos.x,\n                y: ((pos.y || 0) + 1.8) - startPos.y,\n                z: (pos.z || 0) - startPos.z,\n            }\n            if (deltaPos.x || deltaPos.y || deltaPos.z) {\n                animate(progress => {\n                    let ease = EasingFunctions.easeInOutCubic(progress);\n                    this.position.set(\n                        startPos.x + deltaPos.x * ease || 0,\n                        startPos.y + deltaPos.y * ease || 0,\n                        startPos.z + deltaPos.z * ease || 0\n                    );\n                }, 500);\n            }\n        }\n\n        // update name\n        let name = markerData.name || this.data.playerUuid;\n        this.data.name = name;\n        if (this.playerNameElement.innerHTML !== name)\n            this.playerNameElement.innerHTML = name;\n\n        // update world\n        this.data.world = markerData.world || \"?\";\n\n    }\n\n    dispose() {\n        super.dispose();\n\n        let element = this.elementObject.element;\n        if (element.parentNode) element.parentNode.removeChild(element);\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport {MarkerManager} from \"./MarkerManager\";\nimport {alert} from \"../util/Utils\";\nimport {MarkerSet} from \"./MarkerSet\";\nimport {PlayerMarker} from \"./PlayerMarker\";\n\nexport class PlayerMarkerManager extends MarkerManager {\n\n    /**\n     * @constructor\n     * @param markerScene {THREE.Scene} - The scene to which all markers will be added\n     * @param playerDataUrl {string} - The marker file from which this manager updates its markers\n     * @param worldId {string} - The worldId of the world for which the markers should be loaded\n     * @param events {EventTarget}\n     */\n    constructor(markerScene, playerDataUrl, worldId, events = null) {\n        super(markerScene, playerDataUrl, events);\n        Object.defineProperty(this, 'isPlayerMarkerManager', {value: true});\n\n        this.worldId = worldId;\n\n        this.getPlayerMarkerSet();\n    }\n\n    /**\n     * @param markerData {{players: PlayerLike[]}}\n     */\n    updateFromData(markerData) {\n\n        if (!Array.isArray(markerData.players)) {\n            this.clear();\n            return false;\n        }\n\n        /** @type Set<Marker> */\n        let updatedPlayerMarkers = new Set();\n\n        // update\n        markerData.players.forEach(playerData => {\n            try {\n                let playerMarker = this.updatePlayerMarkerFromData(playerData);\n                updatedPlayerMarkers.add(playerMarker);\n            } catch (err) {\n                alert(this.events, err, \"fine\");\n            }\n        });\n\n        // remove\n        this.markers.forEach((playerMarker, markerId) => {\n            if (!updatedPlayerMarkers.has(playerMarker)) {\n                this.removeMarker(markerId);\n            }\n        });\n\n        return true;\n    }\n\n    /**\n     * @private\n     * @param markerData {PlayerLike}\n     * @returns PlayerMarker\n     */\n    updatePlayerMarkerFromData(markerData) {\n        let playerUuid = markerData.uuid;\n        if (!playerUuid) throw new Error(\"player-data has no uuid!\");\n        let markerId = \"bm-player-\" + playerUuid;\n\n        /** @type PlayerMarker */\n        let marker = this.markers.get(markerId);\n\n        let markerSet = this.getPlayerMarkerSet();\n\n        // create new if not existent of wrong type\n        if (!marker || !marker.isPlayerMarker) {\n            marker = new PlayerMarker(markerId, playerUuid);\n            this.addMarker(markerSet, marker);\n        }\n\n        // make sure marker is in the correct MarkerSet\n        if (marker.parent !== markerSet) markerSet.add(marker);\n\n        // update\n        marker.updateFromData(markerData);\n\n        // hide if wrong world\n        marker.visible = markerData.world === this.worldId;\n\n        return marker;\n    }\n\n    /**\n     * @private\n     * @returns {MarkerSet}\n     */\n    getPlayerMarkerSet() {\n        let playerMarkerSet = this.markerSets.get(\"bm-players\");\n\n        if (!playerMarkerSet) {\n            playerMarkerSet = new MarkerSet(\"bm-players\");\n            playerMarkerSet.data.label = \"Players\";\n            this.addMarkerSet(playerMarkerSet);\n        }\n\n        return playerMarkerSet;\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport {\n\tClampToEdgeWrapping, Color,\n\tFileLoader, FrontSide, NearestFilter, NearestMipMapLinearFilter, Raycaster,\n\tScene, ShaderMaterial, Texture, Vector2, Vector3, VertexColors\n} from \"three\";\nimport {alert, dispatchEvent, generateCacheHash, hashTile, stringToImage} from \"../util/Utils\";\nimport {TileManager} from \"./TileManager\";\nimport {TileLoader} from \"./TileLoader\";\nimport {MarkerFileManager} from \"../markers/MarkerFileManager\";\nimport {PlayerMarkerManager} from \"../markers/PlayerMarkerManager\";\n\nexport class Map {\n\n\t/**\n\t * @param id {string}\n\t * @param dataUrl {string}\n\t * @param settingsUrl {string}\n\t * @param texturesUrl {string}\n\t * @param events {EventTarget}\n\t */\n\tconstructor(id, dataUrl, settingsUrl, texturesUrl, events = null) {\n\t\tObject.defineProperty( this, 'isMap', { value: true } );\n\n\t\tthis.events = events;\n\n\t\tthis.data = {\n\t\t\tid: id,\n\t\t\tdataUrl: dataUrl,\n\t\t\tsettingsUrl: settingsUrl,\n\t\t\ttexturesUrl: texturesUrl,\n\t\t\tname: id,\n\t\t\tworld: \"-\",\n\t\t\tstartPos: {x: 0, z: 0},\n\t\t\tskyColor: new Color(),\n\t\t\tambientLight: 0,\n\t\t\thires: {\n\t\t\t\ttileSize: {x: 32, z: 32},\n\t\t\t\tscale: {x: 1, z: 1},\n\t\t\t\ttranslate: {x: 2, z: 2}\n\t\t\t},\n\t\t\tlowres: {\n\t\t\t\ttileSize: {x: 32, z: 32},\n\t\t\t\tscale: {x: 1, z: 1},\n\t\t\t\ttranslate: {x: 2, z: 2}\n\t\t\t}\n\t\t};\n\n\t\tthis.raycaster = new Raycaster();\n\n\t\t/** @type {ShaderMaterial[]} */\n\t\tthis.hiresMaterial = null;\n\t\t/** @type {ShaderMaterial} */\n\t\tthis.lowresMaterial = null;\n\t\t/** @type {Texture[]} */\n\t\tthis.loadedTextures = [];\n\n\t\t/** @type {TileManager} */\n\t\tthis.hiresTileManager = null;\n\t\t/** @type {TileManager} */\n\t\tthis.lowresTileManager = null;\n\t}\n\n\t/**\n\t * Loads textures and materials for this map so it is ready to load map-tiles\n\t * @param hiresVertexShader {string}\n\t * @param hiresFragmentShader {string}\n\t * @param lowresVertexShader {string}\n\t * @param lowresFragmentShader {string}\n\t * @param uniforms {object}\n\t * @param tileCacheHash {number}\n\t * @returns {Promise<void>}\n\t */\n\tload(hiresVertexShader, hiresFragmentShader, lowresVertexShader, lowresFragmentShader, uniforms, tileCacheHash = 0) {\n\t\tthis.unload()\n\n\t\tlet settingsPromise = this.loadSettings();\n\t\tlet textureFilePromise = this.loadTexturesFile();\n\n\t\tthis.lowresMaterial = this.createLowresMaterial(lowresVertexShader, lowresFragmentShader, uniforms);\n\n\t\treturn Promise.all([settingsPromise, textureFilePromise])\n            .then(values => {\n                let textures = values[1];\n                if (textures === null) throw new Error(\"Failed to parse textures.json!\");\n\n                this.hiresMaterial = this.createHiresMaterial(hiresVertexShader, hiresFragmentShader, uniforms, textures);\n\n                this.hiresTileManager = new TileManager(new Scene(), new TileLoader(`${this.data.dataUrl}hires/`, this.hiresMaterial, this.data.hires, tileCacheHash), this.onTileLoad(\"hires\"), this.onTileUnload(\"hires\"), this.events);\n                this.lowresTileManager = new TileManager(new Scene(), new TileLoader(`${this.data.dataUrl}lowres/`, this.lowresMaterial, this.data.lowres, tileCacheHash), this.onTileLoad(\"lowres\"), this.onTileUnload(\"lowres\"), this.events);\n\n                this.hiresTileManager.scene.autoUpdate = false;\n                this.lowresTileManager.scene.autoUpdate = false;\n\n                alert(this.events, `Map '${this.data.id}' is loaded.`, \"fine\");\n            });\n\t}\n\n\t/**\n\t * Loads the settings of this map\n\t * @returns {Promise<void>}\n\t */\n\tloadSettings() {\n\t\treturn this.loadSettingsFile()\n\t\t\t.then(worldSettings => {\n\t\t\t\tthis.data.name = worldSettings.name ? worldSettings.name : this.data.name;\n\t\t\t\tthis.data.world = worldSettings.world ? worldSettings.world : this.data.world;\n\n\t\t\t\tthis.data.startPos = {...this.data.startPos, ...worldSettings.startPos};\n\t\t\t\tthis.data.skyColor.setRGB(\n\t\t\t\t\tworldSettings.skyColor.r !== undefined ? worldSettings.skyColor.r : this.data.skyColor.r,\n\t\t\t\t\tworldSettings.skyColor.g !== undefined ? worldSettings.skyColor.g : this.data.skyColor.g,\n\t\t\t\t\tworldSettings.skyColor.b !== undefined ? worldSettings.skyColor.b : this.data.skyColor.b\n\t\t\t\t);\n\t\t\t\tthis.data.ambientLight = worldSettings.ambientLight ? worldSettings.ambientLight : this.data.ambientLight;\n\n\t\t\t\tif (worldSettings.hires === undefined) worldSettings.hires = {};\n\t\t\t\tif (worldSettings.lowres === undefined) worldSettings.lowres = {};\n\n\t\t\t\tthis.data.hires = {\n\t\t\t\t\ttileSize: {...this.data.hires.tileSize, ...worldSettings.hires.tileSize},\n\t\t\t\t\tscale: {...this.data.hires.scale, ...worldSettings.hires.scale},\n\t\t\t\t\ttranslate: {...this.data.hires.translate, ...worldSettings.hires.translate}\n\t\t\t\t};\n\t\t\t\tthis.data.lowres = {\n\t\t\t\t\ttileSize: {...this.data.lowres.tileSize, ...worldSettings.lowres.tileSize},\n\t\t\t\t\tscale: {...this.data.lowres.scale, ...worldSettings.lowres.scale},\n\t\t\t\t\ttranslate: {...this.data.lowres.translate, ...worldSettings.lowres.translate}\n\t\t\t\t};\n\n\t\t\t\talert(this.events, `Settings for map '${this.data.id}' loaded.`, \"fine\");\n\t\t\t});\n\t}\n\n\tonTileLoad = layer => tile => {\n\t\tdispatchEvent(this.events, \"bluemapMapTileLoaded\", {\n\t\t\ttile: tile,\n\t\t\tlayer: layer\n\t\t});\n\t}\n\n\tonTileUnload = layer => tile => {\n\t\tdispatchEvent(this.events, \"bluemapMapTileUnloaded\", {\n\t\t\ttile: tile,\n\t\t\tlayer: layer\n\t\t});\n\t}\n\n\t/**\n\t * @param x {number}\n\t * @param z {number}\n\t * @param hiresViewDistance {number}\n\t * @param lowresViewDistance {number}\n\t */\n\tloadMapArea(x, z, hiresViewDistance, lowresViewDistance) {\n\t\tif (!this.isLoaded) return;\n\n\t\tlet hiresX = Math.floor((x - this.data.hires.translate.x) / this.data.hires.tileSize.x);\n\t\tlet hiresZ = Math.floor((z - this.data.hires.translate.z) / this.data.hires.tileSize.z);\n\t\tlet hiresViewX = Math.floor(hiresViewDistance / this.data.hires.tileSize.x);\n\t\tlet hiresViewZ = Math.floor(hiresViewDistance / this.data.hires.tileSize.z);\n\n\t\tlet lowresX = Math.floor((x - this.data.lowres.translate.x) / this.data.lowres.tileSize.x);\n\t\tlet lowresZ = Math.floor((z - this.data.lowres.translate.z) / this.data.lowres.tileSize.z);\n\t\tlet lowresViewX = Math.floor(lowresViewDistance / this.data.lowres.tileSize.x);\n\t\tlet lowresViewZ = Math.floor(lowresViewDistance / this.data.lowres.tileSize.z);\n\n\t\tthis.hiresTileManager.loadAroundTile(hiresX, hiresZ, hiresViewX, hiresViewZ);\n\t\tthis.lowresTileManager.loadAroundTile(lowresX, lowresZ, lowresViewX, lowresViewZ);\n\t}\n\n    /**\n     * Loads the settings.json file for this map\n     * @returns {Promise<Object>}\n     */\n    loadSettingsFile() {\n        return new Promise((resolve, reject) => {\n            alert(this.events, `Loading settings for map '${this.data.id}'...`, \"fine\");\n\n            let loader = new FileLoader();\n            loader.setResponseType(\"json\");\n            loader.load(this.data.settingsUrl + \"?\" + generateCacheHash(),\n                settings => {\n                    if (settings.maps && settings.maps[this.data.id]) {\n                        resolve(settings.maps[this.data.id]);\n                    } else {\n                        reject(`the settings.json does not contain information for map: ${this.data.id}`);\n                    }\n                },\n                () => {},\n                () => reject(`Failed to load the settings.json for map: ${this.data.id}`)\n            )\n        });\n    }\n\n\t/**\n\t * Loads the textures.json file for this map\n\t * @returns {Promise<Object>}\n\t */\n\tloadTexturesFile() {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\talert(this.events, `Loading textures for map '${this.data.id}'...`, \"fine\");\n\n\t\t\tlet loader = new FileLoader();\n\t\t\tloader.setResponseType(\"json\");\n\t\t\tloader.load(this.data.texturesUrl + \"?\" + generateCacheHash(),\n\t\t\t\tresolve,\n\t\t\t\t() => {},\n\t\t\t\t() => reject(`Failed to load the textures.json for map: ${this.data.id}`)\n\t\t\t)\n\t\t});\n\t}\n\n\t/**\n\t * Creates a hires Material with the given textures\n\t * @param vertexShader {string}\n\t * @param fragmentShader {string}\n\t * @param uniforms {object}\n\t * @param textures {object} the textures-data\n\t * @returns {ShaderMaterial[]} the hires Material (array because its a multi-material)\n\t */\n\tcreateHiresMaterial(vertexShader, fragmentShader, uniforms, textures) {\n\t\tlet materials = [];\n\t\tif (!Array.isArray(textures.textures)) throw new Error(\"Invalid texture.json: 'textures' is not an array!\")\n\t\tfor (let i = 0; i < textures.textures.length; i++) {\n\t\t\tlet textureSettings = textures.textures[i];\n\n\t\t\tlet color = textureSettings.color;\n\t\t\tif (!Array.isArray(color) || color.length < 4){\n\t\t\t\tcolor = [0, 0, 0, 0];\n\t\t\t}\n\n\t\t\tlet opaque = color[3] === 1;\n\t\t\tlet transparent = !!textureSettings.transparent;\n\n\t\t\tlet texture = new Texture();\n\t\t\ttexture.image = stringToImage(textureSettings.texture);\n\n\t\t\ttexture.anisotropy = 1;\n\t\t\ttexture.generateMipmaps = opaque || transparent;\n\t\t\ttexture.magFilter = NearestFilter;\n\t\t\ttexture.minFilter = texture.generateMipmaps ? NearestMipMapLinearFilter : NearestFilter;\n\t\t\ttexture.wrapS = ClampToEdgeWrapping;\n\t\t\ttexture.wrapT = ClampToEdgeWrapping;\n\t\t\ttexture.flipY = false;\n\t\t\ttexture.flatShading = true;\n\t\t\ttexture.image.addEventListener(\"load\", () => texture.needsUpdate = true);\n\n\t\t\tthis.loadedTextures.push(texture);\n\n\t\t\tlet material = new ShaderMaterial({\n\t\t\t\tuniforms: {\n\t\t\t\t\t...uniforms,\n\t\t\t\t\ttextureImage: {\n\t\t\t\t\t\ttype: 't',\n\t\t\t\t\t\tvalue: texture\n\t\t\t\t\t},\n\t\t\t\t\ttransparent: { value: transparent }\n\t\t\t\t},\n\t\t\t\tvertexShader: vertexShader,\n\t\t\t\tfragmentShader: fragmentShader,\n\t\t\t\ttransparent: transparent,\n\t\t\t\tdepthWrite: true,\n\t\t\t\tdepthTest: true,\n\t\t\t\tvertexColors: VertexColors,\n\t\t\t\tside: FrontSide,\n\t\t\t\twireframe: false,\n\t\t\t});\n\n\t\t\tmaterial.needsUpdate = true;\n\t\t\tmaterials[i] = material;\n\t\t}\n\n\t\treturn materials;\n\t}\n\n\t/**\n\t * Creates a lowres Material\n\t * @param vertexShader {string}\n\t * @param fragmentShader {string}\n\t * @param uniforms {object}\n\t * @returns {ShaderMaterial} the hires Material\n\t */\n\tcreateLowresMaterial(vertexShader, fragmentShader, uniforms) {\n\t\treturn new ShaderMaterial({\n\t\t\tuniforms: uniforms,\n\t\t\tvertexShader: vertexShader,\n\t\t\tfragmentShader: fragmentShader,\n\t\t\ttransparent: false,\n\t\t\tdepthWrite: true,\n\t\t\tdepthTest: true,\n\t\t\tvertexColors: VertexColors,\n\t\t\tside: FrontSide,\n\t\t\twireframe: false\n\t\t});\n\t}\n\n\tunload() {\n\t\tif (this.hiresTileManager) this.hiresTileManager.unload();\n\t\tthis.hiresTileManager = null;\n\n\t\tif (this.lowresTileManager) this.lowresTileManager.unload();\n\t\tthis.lowresTileManager = null;\n\n\t\tif (this.hiresMaterial) this.hiresMaterial.forEach(material => material.dispose());\n\t\tthis.hiresMaterial = null;\n\n\t\tif (this.lowresMaterial) this.lowresMaterial.dispose();\n\t\tthis.lowresMaterial = null;\n\n\t\tthis.loadedTextures.forEach(texture => texture.dispose());\n\t\tthis.loadedTextures = [];\n\t}\n\n\t/**\n\t * Ray-traces and returns the terrain-height at a specific location, returns <code>false</code> if there is no map-tile loaded at that location\n\t * @param x {number}\n\t * @param z {number}\n\t * @returns {boolean|number}\n\t */\n\tterrainHeightAt(x, z) {\n\t\tif (!this.isLoaded) return false;\n\n\t\tthis.raycaster.set(\n\t\t\tnew Vector3(x, 300, z), // ray-start\n\t\t\tnew Vector3(0, -1, 0) // ray-direction\n\t\t);\n\t\tthis.raycaster.near = 1;\n\t\tthis.raycaster.far = 300;\n\t\tthis.raycaster.layers.enableAll();\n\n\t\tlet hiresTileHash = hashTile(Math.floor((x - this.data.hires.translate.x) / this.data.hires.tileSize.x), Math.floor((z - this.data.hires.translate.z) / this.data.hires.tileSize.z));\n\t\tlet tile = this.hiresTileManager.tiles.get(hiresTileHash);\n\t\tif (!tile || !tile.model) {\n\t\t\tlet lowresTileHash = hashTile(Math.floor((x - this.data.lowres.translate.x) / this.data.lowres.tileSize.x), Math.floor((z - this.data.lowres.translate.z) / this.data.lowres.tileSize.z));\n\t\t\ttile = this.lowresTileManager.tiles.get(lowresTileHash);\n\t\t}\n\n\t\tif (!tile || !tile.model){\n\t\t\treturn false;\n\t\t}\n\n\t\ttry {\n\t\t\tlet intersects = this.raycaster.intersectObjects([tile.model]);\n\t\t\tif (intersects.length > 0) {\n\t\t\t\treturn intersects[0].point.y;\n\t\t\t}\n\t\t} catch (err) {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tdispose() {\n\t\tthis.unload();\n\t}\n\n\t/**\n\t * @returns {boolean}\n\t */\n\tget isLoaded() {\n\t\treturn !!(this.hiresMaterial && this.lowresMaterial);\n\t}\n\n}\n","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nexport const SKY_FRAGMENT_SHADER = `\nuniform float sunlightStrength;\nuniform float ambientLight;\nuniform vec3 skyColor;\n\nvarying vec3 vPosition;\n\nvoid main() {\n\tfloat horizonWidth = 0.005;\n\tfloat horizonHeight = 0.0;\n\t\n\tvec4 color = vec4(skyColor * max(sunlightStrength * sunlightStrength, ambientLight), 1.0);\n\tfloat voidMultiplier = (clamp(vPosition.y - horizonHeight, -horizonWidth, horizonWidth) + horizonWidth) / (horizonWidth * 2.0);\n\tcolor.rgb *= voidMultiplier;\n\n\tgl_FragColor = color;\n}\n`;\n","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nexport const SKY_VERTEX_SHADER = `\nvarying vec3 vPosition;\nvoid main() {\n\tvPosition = position;\n\t\n\tgl_Position = \n\t\tprojectionMatrix *\n\t\tmodelViewMatrix *\n\t\tvec4(position, 1);\n}\n`;\n","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport {BackSide, Mesh, Scene, ShaderMaterial, SphereGeometry} from 'three';\n\nimport {SKY_FRAGMENT_SHADER} from './SkyFragmentShader';\nimport {SKY_VERTEX_SHADER} from './SkyVertexShader';\n\nexport class SkyboxScene extends Scene {\n\n\tconstructor(uniforms) {\n\t\tsuper();\n\n\t\tthis.autoUpdate = false;\n\n\t\tObject.defineProperty(this, 'isSkyboxScene', {value: true});\n\n\t\tlet geometry = new SphereGeometry(1, 40, 5);\n\t\tlet material = new ShaderMaterial({\n\t\t\tuniforms: uniforms,\n\t\t\tvertexShader: SKY_VERTEX_SHADER,\n\t\t\tfragmentShader: SKY_FRAGMENT_SHADER,\n\t\t\tside: BackSide\n\t\t});\n\t\tlet skybox = new Mesh(geometry, material);\n\n\t\tthis.add(skybox);\n\t}\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\nimport {MathUtils, Vector3} from \"three\";\nimport {dispatchEvent} from \"../util/Utils\";\nimport {Map} from \"../map/Map\";\n\nexport class ControlsManager {\n\n\t/**\n\t * @param mapViewer {MapViewer}\n\t * @param camera {CombinedCamera}\n\t */\n\tconstructor(mapViewer, camera) {\n\t\tObject.defineProperty( this, 'isControlsManager', { value: true } );\n\n\t\tthis.data = {\n\t\t\tmapViewer: null,\n\t\t\tcamera: null,\n\t\t\tcontrols: null,\n\t\t\tposition: new Vector3(0, 0, 0),\n\t\t\trotation: 0,\n\t\t\tangle: 0,\n\t\t\ttilt: 0,\n\t\t};\n\n\t\tthis.mapViewer = mapViewer;\n\t\tthis.camera = camera;\n\n\t\t/** @type {Vector3} */\n\t\tthis.lastPosition = this.position.clone();\n\t\tthis.lastRotation = this.rotation;\n\t\tthis.lastAngle = this.angle;\n\t\tthis.lastDistance = this.distance;\n\t\tthis.lastOrtho = this.ortho;\n\t\tthis.lastTilt = this.tilt;\n\n\t\tthis.lastMapUpdatePosition = this.position.clone();\n\n\t\tthis.averageDeltaTime = 16;\n\n\t\tthis._controls = null;\n\n\t\t// start\n\t\tthis.distance = 300;\n\t\tthis.position.set(0, 0, 0);\n\t\tthis.rotation = 0;\n\t\tthis.angle = 0;\n\t\tthis.tilt = 0;\n\t\tthis.ortho = 0;\n\n\t\tthis.updateCamera();\n\t}\n\n\t/**\n\t * @param deltaTime {number}\n\t * @param map {Map}\n\t */\n\tupdate(deltaTime, map) {\n\t\tif (deltaTime > 50) deltaTime = 50; // assume min 20 UPS\n\t\tthis.averageDeltaTime = this.averageDeltaTime * 0.9 + deltaTime * 0.1; // average delta-time to avoid choppy controls on lag-spikes\n\n\t\tif (this._controls) this._controls.update(this.averageDeltaTime, map);\n\n\t\tthis.updateCamera();\n\t}\n\n\tupdateCamera() {\n\t\tlet valueChanged = this.isValueChanged();\n\n\t\tif (valueChanged) {\n\t\t\tthis.resetValueChanged();\n\n\t\t\t// wrap rotation\n\t\t\twhile (this.rotation >= Math.PI) this.rotation -= Math.PI * 2;\n\t\t\twhile (this.rotation <= -Math.PI) this.rotation += Math.PI * 2;\n\n\t\t\t// prevent problems with the rotation when the angle is 0 (top-down) or distance is 0 (first-person)\n\t\t\tlet rotatableAngle = this.angle;\n\t\t\tif (Math.abs(rotatableAngle) <= 0.0001) rotatableAngle = 0.0001;\n\t\t\telse if (Math.abs(rotatableAngle) - Math.PI <= 0.0001) rotatableAngle = rotatableAngle - 0.0001;\n\t\t\tlet rotatableDistance = this.distance;\n\t\t\tif (Math.abs(rotatableDistance) <= 0.0001) rotatableDistance = 0.0001;\n\n\t\t\t// fix distance for orthogonal-camera\n\t\t\tif (this.ortho > 0) {\n\t\t\t\trotatableDistance = MathUtils.lerp(rotatableDistance, Math.max(rotatableDistance, 300), Math.pow(this.ortho, 8));\n\t\t\t}\n\n\t\t\t// calculate rotationVector\n\t\t\tlet rotationVector = new Vector3(Math.sin(this.rotation), 0, -Math.cos(this.rotation)); // 0 is towards north\n\t\t\tlet angleRotationAxis = new Vector3(0, 1, 0).cross(rotationVector);\n\t\t\trotationVector.applyAxisAngle(angleRotationAxis, (Math.PI / 2) - rotatableAngle);\n\t\t\trotationVector.multiplyScalar(rotatableDistance);\n\n\t\t\t// position camera\n\t\t\tthis.camera.rotation.set(0, 0, 0);\n\t\t\tthis.camera.position.copy(this.position).sub(rotationVector);\n\t\t\tthis.camera.lookAt(this.position);\n\t\t\tthis.camera.rotateZ(this.tilt + rotatableAngle < 0 ? Math.PI : 0);\n\n\t\t\t// optimize far/near planes\n\t\t\tif (this.ortho <= 0) {\n\t\t\t\tlet near = MathUtils.clamp(rotatableDistance / 1000, 0.01, 1);\n\t\t\t\tlet far = MathUtils.clamp(rotatableDistance * 2, Math.max(near + 1, 2000), rotatableDistance + 5000);\n\t\t\t\tif (far - near > 10000) near = far - 10000;\n\t\t\t\tthis.camera.near = near;\n\t\t\t\tthis.camera.far = far;\n\t\t\t} else if (this.angle === 0) {\n\t\t\t\tthis.camera.near = 1;\n\t\t\t\tthis.camera.far = rotatableDistance + 300;\n\t\t\t} else {\n\t\t\t\tthis.camera.near = 1;\n\t\t\t\tthis.camera.far = 100000;\n\t\t\t}\n\n\t\t\t// event\n\t\t\tdispatchEvent(this.mapViewer.events, \"bluemapCameraMoved\", {\n\t\t\t\tcontrolsManager: this,\n\t\t\t\tcamera: this.camera\n\t\t\t});\n\t\t}\n\n\t\t// if the position changed, update map to show new position\n\t\tif (this.mapViewer.map) {\n\t\t\tlet triggerDistance = 1;\n\t\t\tif (valueChanged) {\n\t\t\t\tif (this.distance > 300) {\n\t\t\t\t\ttriggerDistance = this.mapViewer.data.loadedLowresViewDistance * 0.5;\n\t\t\t\t} else {\n\t\t\t\t\ttriggerDistance = this.mapViewer.data.loadedHiresViewDistance * 0.5;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tMath.abs(this.lastMapUpdatePosition.x - this.position.x) >= triggerDistance ||\n\t\t\t\tMath.abs(this.lastMapUpdatePosition.z - this.position.z) >= triggerDistance\n\t\t\t) {\n\t\t\t\tthis.lastMapUpdatePosition = this.position.clone();\n\t\t\t\tthis.mapViewer.loadMapArea(this.position.x, this.position.z);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Triggers an interaction on the screen (map), e.g. a mouse-click\n\t * @param screenPosition {THREE.Vector2} - Clicked position on the screen (usually event.x, event.y)\n\t * @param data {object} - Custom event data that will be added to the interaction-event\n\t */\n\thandleMapInteraction(screenPosition, data = {}) {\n\t\tthis.mapViewer.handleMapInteraction(screenPosition, data);\n\t}\n\n\tisValueChanged() {\n\t\treturn !(\n\t\t\tthis.data.position.equals(this.lastPosition) &&\n\t\t\tthis.data.rotation === this.lastRotation &&\n\t\t\tthis.data.angle === this.lastAngle &&\n\t\t\tthis.distance === this.lastDistance &&\n\t\t\tthis.ortho === this.lastOrtho &&\n\t\t\tthis.data.tilt === this.lastTilt\n\t\t);\n\t}\n\n\tresetValueChanged() {\n\t\tthis.lastPosition.copy(this.data.position);\n\t\tthis.lastRotation = this.data.rotation;\n\t\tthis.lastAngle = this.data.angle;\n\t\tthis.lastDistance = this.distance;\n\t\tthis.lastOrtho = this.ortho;\n\t\tthis.lastTilt = this.data.tilt;\n\t}\n\n\t/**\n\t * @returns {number}\n\t */\n\tget ortho() {\n\t\treturn this.camera.ortho;\n\t}\n\n\t/**\n\t * @param ortho {number}\n\t */\n\tset ortho(ortho) {\n\t\tthis.camera.ortho = ortho;\n\t}\n\n\tget distance() {\n\t\treturn this.camera.distance;\n\t}\n\n\tset distance(distance) {\n\t\tthis.camera.distance = distance;\n\t}\n\n\t/** @typedef ControlsLike {{\n\t * \t\tstart: function(controls: ControlsManager),\n\t * \t\tstop: function(),\n\t * \t\tupdate: function(deltaTime: number, map: Map)\n\t * \t}}\n\n\t/**\n\t * @param controls {ControlsLike}\n\t */\n\tset controls(controls) {\n\t\tif (this._controls && this._controls.stop)\n\t\t\tthis._controls.stop();\n\n\t\tthis._controls = controls;\n\t\tif (controls) this.data.controls = controls.data || null\n\n\t\tif (this._controls && this._controls.start)\n\t\t\tthis._controls.start(this);\n\t}\n\n\t/**\n\t * @returns {ControlsLike}\n\t */\n\tget controls() {\n\t\treturn this._controls;\n\t}\n\n\t/**\n\t * @returns {MapViewer}\n\t */\n\tget mapViewer() {\n\t\treturn this._mapViewer;\n\t}\n\n\t/**\n\t * @param value {MapViewer}\n\t */\n\tset mapViewer(value) {\n\t\tthis._mapViewer = value;\n\t\tthis.data.mapViewer = value.data;\n\t}\n\n\t/**\n\t * @returns {CombinedCamera}\n\t */\n\tget camera() {\n\t\treturn this._camera;\n\t}\n\n\t/**\n\t * @param value {CombinedCamera}\n\t */\n\tset camera(value) {\n\t\tthis._camera = value;\n\t\tthis.data.camera = value.data;\n\t}\n\n\t/**\n\t * @returns {Vector3}\n\t */\n\tget position() {\n\t\treturn this.data.position;\n\t}\n\n\t/**\n\t * @param value {Vector3}\n\t */\n\tset position(value) {\n\t\tthis.data.position = value;\n\t}\n\n\t/**\n\t * @returns {number}\n\t */\n\tget rotation() {\n\t\treturn this.data.rotation;\n\t}\n\n\t/**\n\t * @param value {number}\n\t */\n\tset rotation(value) {\n\t\tthis.data.rotation = value;\n\t}\n\n\t/**\n\t * @returns {number}\n\t */\n\tget angle() {\n\t\treturn this.data.angle;\n\t}\n\n\t/**\n\t * @param value {number}\n\t */\n\tset angle(value) {\n\t\tthis.data.angle = value;\n\t}\n\n\t/**\n\t * @returns {number}\n\t */\n\tget tilt() {\n\t\treturn this.data.tilt;\n\t}\n\n\t/**\n\t * @param value {number}\n\t */\n\tset tilt(value) {\n\t\tthis.data.tilt = value;\n\t}\n}","/**\n * Taken from https://github.com/mrdoob/three.js/blob/master/examples/jsm/libs/stats.module.js\n */\nlet Stats = function () {\n\n    let mode = 0;\n\n    let container = document.createElement( 'div' );\n    container.style.cssText = 'position:absolute;bottom:5px;right:5px;cursor:pointer;opacity:0.9;z-index:10000';\n    container.addEventListener( 'click', function ( event ) {\n\n        event.preventDefault();\n        showPanel( ++ mode % container.children.length );\n\n    }, false );\n\n    //\n\n    function addPanel( panel ) {\n\n        container.appendChild( panel.dom );\n        return panel;\n\n    }\n\n    function showPanel( id ) {\n\n        for ( let i = 0; i < container.children.length; i ++ ) {\n\n            container.children[ i ].style.display = i === id ? 'block' : 'none';\n\n        }\n\n        mode = id;\n\n    }\n\n    function hide() {\n        showPanel(-1);\n    }\n\n    //\n\n    let beginTime = ( performance || Date ).now(), prevTime = beginTime, frames = 0;\n    let prevFrameTime = beginTime;\n\n    let fpsPanel = addPanel( new Stats.Panel( 'FPS', '#0ff', '#002' ) );\n    let msPanel = addPanel( new Stats.Panel( 'MS (render)', '#0f0', '#020' ) );\n    let lastFrameMsPanel = addPanel( new Stats.Panel( 'MS (all)', '#f80', '#210' ) );\n\n    let memPanel = null;\n    if ( self.performance && self.performance.memory ) {\n\n        memPanel = addPanel( new Stats.Panel( 'MB', '#f08', '#201' ) );\n\n    }\n\n    showPanel( 0 );\n\n    return {\n\n        REVISION: 16,\n\n        dom: container,\n\n        addPanel: addPanel,\n        showPanel: showPanel,\n        hide: hide,\n\n        begin: function () {\n\n            beginTime = ( performance || Date ).now();\n\n        },\n\n        end: function () {\n\n            frames ++;\n\n            let time = ( performance || Date ).now();\n\n            msPanel.update( time - beginTime, 200 );\n            lastFrameMsPanel.update( time - prevFrameTime, 200 )\n\n            if ( time >= prevTime + 1000 ) {\n\n                fpsPanel.update( ( frames * 1000 ) / ( time - prevTime ), 100 );\n\n                prevTime = time;\n                frames = 0;\n\n                if ( memPanel ) {\n\n                    let memory = performance.memory;\n                    memPanel.update( memory.usedJSHeapSize / 1048576, memory.jsHeapSizeLimit / 1048576 );\n\n                }\n\n            }\n\n            return time;\n\n        },\n\n        update: function () {\n\n            beginTime = this.end();\n            prevFrameTime = beginTime;\n\n        },\n\n        // Backwards Compatibility\n\n        domElement: container,\n        setMode: showPanel\n\n    };\n\n};\n\nStats.Panel = function ( name, fg, bg ) {\n\n    let min = Infinity, max = 0, round = Math.round;\n    let PR = round( window.devicePixelRatio || 1 );\n\n    let WIDTH = 160 * PR, HEIGHT = 96 * PR,\n        TEXT_X = 3 * PR, TEXT_Y = 3 * PR,\n        GRAPH_X = 3 * PR, GRAPH_Y = 15 * PR,\n        GRAPH_WIDTH = 154 * PR, GRAPH_HEIGHT = 77 * PR;\n\n    let canvas = document.createElement( 'canvas' );\n    canvas.width = WIDTH;\n    canvas.height = HEIGHT;\n    canvas.style.cssText = 'width:160px;height:96px';\n\n    let context = canvas.getContext( '2d' );\n    context.font = 'bold ' + ( 9 * PR ) + 'px Helvetica,Arial,sans-serif';\n    context.textBaseline = 'top';\n\n    context.fillStyle = bg;\n    context.fillRect( 0, 0, WIDTH, HEIGHT );\n\n    context.fillStyle = fg;\n    context.fillText( name, TEXT_X, TEXT_Y );\n    context.fillRect( GRAPH_X, GRAPH_Y, GRAPH_WIDTH, GRAPH_HEIGHT );\n\n    context.fillStyle = bg;\n    context.globalAlpha = 0.9;\n    context.fillRect( GRAPH_X, GRAPH_Y, GRAPH_WIDTH, GRAPH_HEIGHT );\n\n    return {\n\n        dom: canvas,\n\n        update: function ( value, maxValue ) {\n\n            min = Math.min( min, value );\n            max = Math.max( max, value );\n\n            context.fillStyle = bg;\n            context.globalAlpha = 1;\n            context.fillRect( 0, 0, WIDTH, GRAPH_Y );\n            context.fillStyle = fg;\n            context.fillText( round( value ) + ' ' + name + ' (' + round( min ) + '-' + round( max ) + ')', TEXT_X, TEXT_Y );\n\n            context.drawImage( canvas, GRAPH_X + PR, GRAPH_Y, GRAPH_WIDTH - PR, GRAPH_HEIGHT, GRAPH_X, GRAPH_Y, GRAPH_WIDTH - PR, GRAPH_HEIGHT );\n\n            context.fillRect( GRAPH_X + GRAPH_WIDTH - PR, GRAPH_Y, PR, GRAPH_HEIGHT );\n\n            context.fillStyle = bg;\n            context.globalAlpha = 0.9;\n            context.fillRect( GRAPH_X + GRAPH_WIDTH - PR, GRAPH_Y, PR, round( ( 1 - ( value / maxValue ) ) * GRAPH_HEIGHT ) );\n\n        }\n\n    };\n\n};\n\nexport default Stats;","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the 'Software'), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport { ShaderChunk } from 'three';\n\nexport const HIRES_VERTEX_SHADER = `\n#include <common>\n${ShaderChunk.logdepthbuf_pars_vertex}\n\nattribute float ao;\nattribute float sunlight;\nattribute float blocklight;\n\nvarying vec3 vPosition;\n//varying vec3 vWorldPosition;\nvarying vec3 vNormal;\nvarying vec2 vUv;\nvarying vec3 vColor;\nvarying float vAo;\nvarying float vSunlight;\nvarying float vBlocklight;\n//varying float vDistance;\n\nvoid main() {\n\tvec4 worldPos = modelMatrix * vec4(position, 1);\n\tvec4 viewPos = viewMatrix * worldPos;\n\n\tvPosition = position;\n\t//vWorldPosition = worldPos.xyz;\n\tvNormal = normal;\n\tvUv = uv;\n\tvColor = color;\n\tvAo = ao;\n\tvSunlight = sunlight;\n\tvBlocklight = blocklight;\n\t//vDistance = -viewPos.z\n\t\n\tgl_Position = projectionMatrix * viewPos;\n\t\n\t${ShaderChunk.logdepthbuf_vertex} \n}\n`;\n","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the 'Software'), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport { ShaderChunk } from 'three';\n\nexport const HIRES_FRAGMENT_SHADER = `\n${ShaderChunk.logdepthbuf_pars_fragment}\n\n#ifndef texture\n\t#define texture texture2D\n#endif\n\nuniform sampler2D textureImage;\nuniform float sunlightStrength;\nuniform float ambientLight;\n\nvarying vec3 vPosition;\n//varying vec3 vWorldPosition;\nvarying vec3 vNormal;\nvarying vec2 vUv;\nvarying vec3 vColor;\nvarying float vAo;\nvarying float vSunlight;\nvarying float vBlocklight;\n//varying float vDistance;\n\nvoid main() {\n\tvec4 color = texture(textureImage, vUv);\n\tif (color.a == 0.0) discard;\n\t\n\t//apply vertex-color\n\tcolor.rgb *= vColor.rgb;\n\n\t//apply ao\n\tcolor.rgb *= vAo;\n\t\n\t//apply light\n\tfloat light = mix(vBlocklight, max(vSunlight, vBlocklight), sunlightStrength);\n\tcolor.rgb *= mix(ambientLight, 1.0, light / 15.0);\n\t\n\tgl_FragColor = color;\n\t\n\t${ShaderChunk.logdepthbuf_fragment}\n}\n`;\n","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the 'Software'), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport { ShaderChunk } from 'three';\n\nexport const LOWRES_VERTEX_SHADER = `\n#include <common>\n${ShaderChunk.logdepthbuf_pars_vertex}\n\nvarying vec3 vPosition;\nvarying vec3 vWorldPosition;\nvarying vec3 vNormal;\nvarying vec2 vUv;\nvarying vec3 vColor;\nvarying float vDistance;\n\nvoid main() {\n\tvec4 worldPos = modelMatrix * vec4(position, 1);\n\tvec4 viewPos = viewMatrix * worldPos;\n\t\n\tvPosition = position;\n\tvWorldPosition = worldPos.xyz;\n\tvNormal = normal;\n\tvUv = uv;\n\tvColor = color;\n\tvDistance = -viewPos.z;\n\t\n\tgl_Position = projectionMatrix * viewPos;\n\t\t\n\t${ShaderChunk.logdepthbuf_vertex}\n}\n`;\n","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the 'Software'), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport { ShaderChunk } from 'three';\n\nexport const LOWRES_FRAGMENT_SHADER = `\n${ShaderChunk.logdepthbuf_pars_fragment}\n\n#ifndef texture\n\t#define texture texture2D\n#endif\n\nstruct TileMap {\n\tsampler2D map;\n\tfloat size;\n\tvec2 scale;\n\tvec2 translate;\n\tvec2 pos; \n};\n\nuniform float sunlightStrength;\nuniform float ambientLight;\nuniform TileMap hiresTileMap;\n\nvarying vec3 vPosition;\nvarying vec3 vWorldPosition;\nvarying vec3 vNormal;\nvarying vec2 vUv;\nvarying vec3 vColor;\nvarying float vDistance;\n\nvoid main() {\n\t//discard if hires tile is loaded at that position\n\tif (vDistance < 1900.0 && texture(hiresTileMap.map, ((vWorldPosition.xz - hiresTileMap.translate) / hiresTileMap.scale - hiresTileMap.pos) / hiresTileMap.size + 0.5).r >= 1.0) discard;\n\t\n\tvec4 color = vec4(vColor, 1.0);\n\n\tfloat diff = max(dot(vNormal, vec3(0.3637, 0.7274, 0.5819)), 0.0) * 0.3 + 0.7;\n\tcolor *= diff;\n\n\tcolor *= mix(sunlightStrength, 1.0, ambientLight);\n\n\tgl_FragColor = color;\n\t\n\t${ShaderChunk.logdepthbuf_fragment}\n}\n`;\n","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport {MathUtils, Matrix4, PerspectiveCamera} from \"three\";\n\nexport class CombinedCamera extends PerspectiveCamera {\n\n    /**\n     * @param fov {number}\n     * @param aspect {number}\n     * @param near {number}\n     * @param far {number}\n     * @param ortho {number}\n     */\n    constructor(fov, aspect, near, far, ortho) {\n        super(fov, aspect, near, far);\n\n        this.data = {\n            fov: this.fov,\n            aspect: this.aspect,\n            near: this.near,\n            far: this.far,\n            zoom: this.zoom,\n            ortho: ortho,\n            distance: 1,\n        };\n\n        // redirect parent properties\n        Object.defineProperty(this, \"fov\", {\n            get() { return this.data.fov },\n            set(value) { this.data.fov = value }\n        });\n        Object.defineProperty(this, \"aspect\", {\n            get() { return this.data.aspect },\n            set(value) { this.data.aspect = value }\n        });\n        Object.defineProperty(this, \"near\", {\n            get() { return this.data.near },\n            set(value) { this.data.near = value }\n        });\n        Object.defineProperty(this, \"far\", {\n            get() { return this.data.far },\n            set(value) { this.data.far = value }\n        });\n        Object.defineProperty(this, \"zoom\", {\n            get() { return this.data.zoom },\n            set(value) { this.data.zoom = value }\n        });\n\n        this.updateProjectionMatrix();\n    }\n\n    updateProjectionMatrix() {\n        if (!this.ortographicProjection)\n            this.ortographicProjection = new Matrix4();\n\n        if (!this.perspectiveProjection)\n            this.perspectiveProjection = new Matrix4();\n\n        if (!this.data)\n            this.data = {};\n\n        //copied from PerspectiveCamera\n        const near = this.near;\n        let top = near * Math.tan( MathUtils.DEG2RAD * 0.5 * this.fov ) / this.zoom;\n        let height = 2 * top;\n        let width = this.aspect * height;\n        let left = - 0.5 * width;\n        const view = this.view;\n\n        if ( this.view !== null && this.view.enabled ) {\n\n            const fullWidth = view.fullWidth,\n                fullHeight = view.fullHeight;\n\n            left += view.offsetX * width / fullWidth;\n            top -= view.offsetY * height / fullHeight;\n            width *= view.width / fullWidth;\n            height *= view.height / fullHeight;\n\n        }\n\n        const skew = this.filmOffset;\n        if ( skew !== 0 ) left += near * skew / this.getFilmWidth();\n\n        // this part different to PerspectiveCamera\n        let normalizedOrtho = -Math.pow(this.ortho - 1, 6) + 1;\n        let orthoTop = Math.max(this.distance, 0.0001) * Math.tan( MathUtils.DEG2RAD * 0.5 * this.fov ) / this.zoom;\n        let orthoHeight = 2 * orthoTop;\n        let orthoWidth = this.aspect * orthoHeight;\n        let orthoLeft = - 0.5 * orthoWidth;\n\n        this.perspectiveProjection.makePerspective( left, left + width, top, top - height, near, this.far );\n        this.ortographicProjection.makeOrthographic( orthoLeft, orthoLeft + orthoWidth, orthoTop, orthoTop - orthoHeight, near, this.far );\n\n        for (let i = 0; i < 16; i++){\n            this.projectionMatrix.elements[i] = (this.perspectiveProjection.elements[i] * (1 - normalizedOrtho)) + (this.ortographicProjection.elements[i] * normalizedOrtho);\n        }\n        // to here\n\n        this.projectionMatrixInverse.copy( this.projectionMatrix ).invert();\n\n    }\n\n    /**\n     * @returns {boolean}\n     */\n    get isPerspectiveCamera() {\n        return this.ortho < 1;\n    }\n\n    /**\n     * @returns {boolean}\n     */\n    get isOrthographicCamera() {\n        return !this.isPerspectiveCamera;\n    }\n\n    /**\n     * @returns {string}\n     */\n    get type() {\n        return this.isPerspectiveCamera ? 'PerspectiveCamera' : 'OrthographicCamera';\n    }\n\n    /**\n     * @param type {string}\n     */\n    set type(type) {\n        //ignore\n    }\n\n    /**\n     * @returns {number}\n     */\n    get ortho() {\n        return this.data.ortho;\n    }\n\n    /**\n     * @param value {number}\n     */\n    set ortho(value) {\n        this.data.ortho = value;\n    }\n\n    /**\n     * @returns {number}\n     */\n    get distance() {\n        return this.data.distance;\n    }\n\n    /**\n     * @param value {number}\n     */\n    set distance(value) {\n        this.data.distance = value;\n    }\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport {Color, PerspectiveCamera, Raycaster, Scene, Vector2, Vector3, WebGLRenderer} from \"three\";\nimport {Map} from \"./map/Map\";\nimport {SkyboxScene} from \"./skybox/SkyboxScene\";\nimport {ControlsManager} from \"./controls/ControlsManager\";\nimport Stats from \"./util/Stats\";\nimport {alert, dispatchEvent, elementOffset, generateCacheHash, htmlToElement} from \"./util/Utils\";\nimport {TileManager} from \"./map/TileManager\";\nimport {HIRES_VERTEX_SHADER} from \"./map/hires/HiresVertexShader\";\nimport {HIRES_FRAGMENT_SHADER} from \"./map/hires/HiresFragmentShader\";\nimport {LOWRES_VERTEX_SHADER} from \"./map/lowres/LowresVertexShader\";\nimport {LOWRES_FRAGMENT_SHADER} from \"./map/lowres/LowresFragmentShader\";\nimport {CombinedCamera} from \"./util/CombinedCamera\";\nimport {CSS2DRenderer} from \"./util/CSS2DRenderer\";\nimport {MarkerSet} from \"./markers/MarkerSet\";\n\nexport class MapViewer {\n\n\t/**\n\t * @param element {Element}\n\t * @param events {EventTarget}\n\t */\n\tconstructor(element, events = element) {\n\t\tObject.defineProperty( this, 'isMapViewer', { value: true } );\n\n\t\tthis.rootElement = element;\n\t\tthis.events = events;\n\n\t\tthis.data = {\n\t\t\tmap: null,\n\t\t\tcamera: null,\n\t\t\tcontrolsManager: null,\n\t\t\tuniforms: {\n\t\t\t\tsunlightStrength: { value: 1 },\n\t\t\t\tambientLight: { value: 0 },\n\t\t\t\tskyColor: { value: new Color(0.5, 0.5, 1) },\n\t\t\t\thiresTileMap: {\n\t\t\t\t\tvalue: {\n\t\t\t\t\t\tmap: null,\n\t\t\t\t\t\tsize: TileManager.tileMapSize,\n\t\t\t\t\t\tscale: new Vector2(1, 1),\n\t\t\t\t\t\ttranslate: new Vector2(),\n\t\t\t\t\t\tpos: new Vector2(),\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tsuperSampling: 1,\n\t\t\tloadedCenter: new Vector2(0, 0),\n\t\t\tloadedHiresViewDistance: 200,\n\t\t\tloadedLowresViewDistance: 2000,\n\t\t}\n\n\t\tthis.tileCacheHash = generateCacheHash();\n\n\t\tthis.stats = new Stats();\n\t\tthis.stats.hide();\n\n\t\t// renderer\n\t\tthis.renderer = new WebGLRenderer({\n\t\t\tantialias: true,\n\t\t\tsortObjects: true,\n\t\t\tpreserveDrawingBuffer: true,\n\t\t\tlogarithmicDepthBuffer: true,\n\t\t});\n\t\tthis.renderer.autoClear = false;\n\t\tthis.renderer.uniforms = this.data.uniforms;\n\n\t\t// CSS2D renderer\n\t\tthis.css2dRenderer = new CSS2DRenderer(this.events);\n\n\t\tthis.skyboxScene = new SkyboxScene(this.data.uniforms);\n\n\t\tthis.camera = new CombinedCamera(75, 1, 0.1, 10000, 0);\n\t\tthis.skyboxCamera = new PerspectiveCamera(75, 1, 0.1, 10000);\n\n\t\tthis.controlsManager = new ControlsManager(this, this.camera);\n\n\t\tthis.raycaster = new Raycaster();\n\t\tthis.raycaster.layers.enableAll();\n\t\tthis.raycaster.params.Line2 = {threshold: 20}\n\n\t\t/** @type {Map} */\n\t\tthis.map = null;\n\n\t\tthis.markers = new MarkerSet(\"bm-root\");\n\n\t\tthis.lastFrame = 0;\n\n\t\t// initialize\n\t\tthis.initializeRootElement();\n\n\t\t// handle window resizes\n\t\twindow.addEventListener(\"resize\", this.handleContainerResize);\n\n\t\t// start render-loop\n\t\trequestAnimationFrame(this.renderLoop);\n\t}\n\n\t/**\n\t * Initializes the root-element\n\t */\n\tinitializeRootElement() {\n\t\tthis.rootElement.innerHTML = \"\";\n\n\t\tlet outerDiv = htmlToElement(`<div style=\"position: relative; width: 100%; height: 100%; overflow: hidden;\"></div>`);\n\t\tthis.rootElement.appendChild(outerDiv);\n\n\t\t// 3d-canvas\n\t\touterDiv.appendChild(this.renderer.domElement);\n\n\t\t// html-markers\n\t\tthis.css2dRenderer.domElement.style.position = 'absolute';\n\t\tthis.css2dRenderer.domElement.style.top = '0';\n\t\tthis.css2dRenderer.domElement.style.left = '0';\n\t\tthis.css2dRenderer.domElement.style.pointerEvents = 'none';\n\t\touterDiv.appendChild(this.css2dRenderer.domElement);\n\n\t\t// performance monitor\n\t\touterDiv.appendChild(this.stats.dom);\n\n\t\tthis.handleContainerResize();\n\t}\n\n\t/**\n\t * Updates the render-resolution and aspect ratio based on the size of the root-element\n\t */\n\thandleContainerResize = () => {\n\t\tthis.renderer.setSize(this.rootElement.clientWidth, this.rootElement.clientHeight);\n\t\tthis.renderer.setPixelRatio(window.devicePixelRatio * this.superSampling);\n\n\t\tthis.css2dRenderer.setSize(this.rootElement.clientWidth, this.rootElement.clientHeight);\n\n\t\tthis.camera.aspect = this.rootElement.clientWidth / this.rootElement.clientHeight;\n\t\tthis.camera.updateProjectionMatrix();\n\t};\n\n\t/**\n\t * Triggers an interaction on the screen (map), e.g. a mouse-click.\n\t *\n\t * This will first attempt to invoke the onClick() method on the Object3D (e.g. Markers) that has been clicked.\n\t * And if none of those consumed the event, it will fire a <code>bluemapMapInteraction</code> event.\n\t *\n\t * @param screenPosition {Vector2} - Clicked position on the screen (usually event.x, event.y)\n\t * @param data {object} - Custom event data that will be added to the interaction-event\n\t */\n\thandleMapInteraction(screenPosition, data = {}) {\n\t\tlet rootOffset = elementOffset(this.rootElement);\n\t\tlet normalizedScreenPos = new Vector2(\n\t\t\t((screenPosition.x - rootOffset.top) / this.rootElement.clientWidth) * 2 - 1,\n\t\t\t-((screenPosition.y - rootOffset.left) / this.rootElement.clientHeight) * 2 + 1\n\t\t);\n\n\t\tif (this.map && this.map.isLoaded){\n\t\t\tthis.raycaster.setFromCamera(normalizedScreenPos, this.camera);\n\n\t\t\t// check Object3D interactions\n\t\t\tlet intersects = this.raycaster.intersectObjects([this.map.hiresTileManager.scene, this.map.lowresTileManager.scene, this.markers], true);\n\t\t\tlet hit = null;\n\t\t\tlet lowresHit = null;\n\t\t\tlet hiresHit = null;\n\t\t\tlet covered = false;\n\t\t\tfor (let i = 0; i < intersects.length; i++) {\n\t\t\t\tif (intersects[i].object){\n\t\t\t\t\tlet object = intersects[i].object;\n\n\t\t\t\t\t// check if deeply-visible\n\t\t\t\t\tlet parent = object;\n\t\t\t\t\tlet visible = parent.visible;\n\t\t\t\t\twhile (visible && parent.parent){\n\t\t\t\t\t\tparent = parent.parent;\n\t\t\t\t\t\tvisible = parent.visible;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (visible) {\n\t\t\t\t\t\tif (!hit) hit = intersects[i];\n\n\t\t\t\t\t\t// find root-scene\n\t\t\t\t\t\tlet parentRoot = object;\n\t\t\t\t\t\twhile(parentRoot.parent) parentRoot = parentRoot.parent;\n\n\t\t\t\t\t\tif (parentRoot === this.map.lowresTileManager.scene) {\n\t\t\t\t\t\t\tif (!lowresHit) lowresHit = intersects[i];\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (parentRoot === this.map.hiresTileManager.scene) {\n\t\t\t\t\t\t\tif (!hiresHit) hiresHit = intersects[i];\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (!covered || (object.material && !object.material.depthTest)) {\n\t\t\t\t\t\t\tif (object.onClick && object.onClick({\n\t\t\t\t\t\t\t\tdata: data,\n\t\t\t\t\t\t\t\tintersection: intersects[i]\n\t\t\t\t\t\t\t})) return;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (parentRoot !== this.map.lowresTileManager.scene) {\n\t\t\t\t\t\t\tcovered = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// fire event\n\t\t\tdispatchEvent(this.events, \"bluemapMapInteraction\", {\n\t\t\t\tdata: data,\n\t\t\t\thit: hit,\n\t\t\t\thiresHit: hiresHit,\n\t\t\t\tlowresHit: lowresHit,\n\t\t\t\tintersections: intersects,\n\t\t\t\tray: this.raycaster.ray\n\t\t\t});\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t * The render-loop to update and possibly render a new frame.\n\t * @param now {number} the current time in milliseconds\n\t */\n\trenderLoop = (now) => {\n\t\trequestAnimationFrame(this.renderLoop);\n\n\t\t// calculate delta time\n\t\tif (this.lastFrame <= 0) this.lastFrame = now;\n\t\tlet delta = now - this.lastFrame;\n\t\tthis.lastFrame = now;\n\n\t\t// update stats\n\t\tthis.stats.begin();\n\n\t\t// update controls\n\t\tif (this.map != null) {\n\t\t\tthis.controlsManager.update(delta, this.map);\n\t\t}\n\n\t\t// render\n\t\tthis.render(delta);\n\n\t\t// update stats\n\t\tthis.stats.update();\n\t};\n\n\t/**\n\t * @private\n\t * Renders a frame\n\t * @param delta {number}\n\t */\n\trender(delta) {\n\t\tdispatchEvent(this.events, \"bluemapRenderFrame\", {\n\t\t\tdelta: delta,\n\t\t});\n\n\t\t//prepare camera\n\t\tthis.camera.updateProjectionMatrix();\n\t\tthis.skyboxCamera.rotation.copy(this.camera.rotation);\n\t\tthis.skyboxCamera.updateProjectionMatrix();\n\n\t\t//render\n\t\tthis.renderer.clear();\n\n\t\tthis.renderer.render(this.skyboxScene, this.skyboxCamera);\n\t\tthis.renderer.clearDepth();\n\n\t\tif (this.map && this.map.isLoaded) {\n\t\t\t//update uniforms\n\t\t\tthis.data.uniforms.hiresTileMap.value.pos.copy(this.map.hiresTileManager.centerTile);\n\n\t\t\tthis.renderer.render(this.map.lowresTileManager.scene, this.camera);\n\t\t\tthis.renderer.clearDepth();\n\n\t\t\tif (this.controlsManager.distance < 2000) {\n\t\t\t\tthis.renderer.render(this.map.hiresTileManager.scene, this.camera);\n\t\t\t}\n\t\t}\n\n\t\t// render markers\n\t\tthis.renderer.render(this.markers, this.camera);\n\t\tthis.css2dRenderer.render(this.markers, this.camera);\n\t}\n\n\t/**\n\t * Changes / Sets the map that will be loaded and displayed\n\t * @param map {Map}\n\t * @returns Promise<void>\n\t */\n\tswitchMap(map = null) {\n\t\tif (this.map && this.map.isMap) this.map.unload();\n\n\t\tthis.map = map;\n\n\t\tif (this.map && this.map.isMap) {\n\t\t\treturn map.load(HIRES_VERTEX_SHADER, HIRES_FRAGMENT_SHADER, LOWRES_VERTEX_SHADER, LOWRES_FRAGMENT_SHADER, this.data.uniforms, this.tileCacheHash)\n\t\t\t\t.then(() => {\n\t\t\t\t\tfor (let texture of this.map.loadedTextures){\n\t\t\t\t\t\tthis.renderer.initTexture(texture);\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.data.uniforms.skyColor.value = map.data.skyColor;\n\t\t\t\t\tthis.data.uniforms.ambientLight.value = map.data.ambientLight;\n\t\t\t\t\tthis.data.uniforms.hiresTileMap.value.map = map.hiresTileManager.tileMap.texture;\n\t\t\t\t\tthis.data.uniforms.hiresTileMap.value.scale.set(map.data.hires.tileSize.x, map.data.hires.tileSize.z);\n\t\t\t\t\tthis.data.uniforms.hiresTileMap.value.translate.set(map.data.hires.translate.x, map.data.hires.translate.z);\n\n\t\t\t\t\tsetTimeout(this.updateLoadedMapArea);\n\n\t\t\t\t\tdispatchEvent(this.events, \"bluemapMapChanged\", {\n\t\t\t\t\t\tmap: map\n\t\t\t\t\t});\n\t\t\t\t})\n\t\t\t\t.catch(error => {\n\t\t\t\t\talert(this.events, error, \"error\");\n\t\t\t\t});\n\t\t} else {\n\t\t\treturn Promise.resolve();\n\t\t}\n\t}\n\n\t/**\n\t * Loads the given area on the map (and unloads everything outside that area)\n\t * @param centerX {number}\n\t * @param centerZ {number}\n\t * @param hiresViewDistance {number?}\n\t * @param lowresViewDistance {number?}\n\t */\n\tloadMapArea(centerX, centerZ, hiresViewDistance = -1, lowresViewDistance = -1) {\n\t\tthis.data.loadedCenter.set(centerX, centerZ);\n\t\tif (hiresViewDistance >= 0) this.data.loadedHiresViewDistance = hiresViewDistance;\n\t\tif (lowresViewDistance >= 0) this.data.loadedLowresViewDistance = lowresViewDistance;\n\n\t\tthis.updateLoadedMapArea();\n\t}\n\n\tupdateLoadedMapArea = () => {\n\t\tif (!this.map) return;\n\t\tthis.map.loadMapArea(this.data.loadedCenter.x, this.data.loadedCenter.y, this.data.loadedHiresViewDistance, this.data.loadedLowresViewDistance);\n\t}\n\n\tclearTileCache(newTileCacheHash) {\n\t\tif (!newTileCacheHash) newTileCacheHash = generateCacheHash();\n\n\t\tthis.tileCacheHash = newTileCacheHash;\n\t\tif (this.map) {\n\t\t\tthis.map.lowresTileManager.tileLoader.tileCacheHash = this.tileCacheHash;\n\t\t\tthis.map.hiresTileManager.tileLoader.tileCacheHash = this.tileCacheHash;\n\t\t}\n\t}\n\n\t/**\n\t * @returns {number}\n\t */\n\tget superSampling() {\n\t\treturn this.data.superSampling;\n\t}\n\n\t/**\n\t * @param value {number}\n\t */\n\tset superSampling(value) {\n\t\tthis.data.superSampling = value;\n\t\tthis.handleContainerResize();\n\t}\n\n\t/**\n\t * @returns {CombinedCamera}\n\t */\n\tget camera() {\n\t\treturn this._camera;\n\t}\n\n\t/**\n\t * @param value {CombinedCamera}\n\t */\n\tset camera(value) {\n\t\tthis._camera = value;\n\t\tthis.data.camera = value.data;\n\t}\n\n\t/**\n\t * @returns {ControlsManager}\n\t */\n\tget controlsManager() {\n\t\treturn this._controlsManager;\n\t}\n\n\t/**\n\t * @param value {ControlsManager}\n\t */\n\tset controlsManager(value) {\n\t\tthis._controlsManager = value;\n\t\tthis.data.controlsManager = value.data;\n\t}\n\n\t/**\n\t * @returns {Map}\n\t */\n\tget map() {\n\t\treturn this._map;\n\t}\n\n\t/**\n\t * @param value {Map}\n\t */\n\tset map(value) {\n\t\tthis._map = value;\n\t\tif (value) this.data.map = value.data;\n\t}\n\n}\n","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\nimport {MathUtils, Vector2} from \"three\";\nimport {VEC2_ZERO} from \"../../../util/Utils\";\n\nexport class MouseMoveControls {\n\n    static tempVec2_1 = new Vector2();\n\n    /**\n     * @param target {Element}\n     * @param speed {number}\n     * @param stiffness {number}\n     */\n    constructor(target, speed, stiffness) {\n        this.target = target;\n        this.manager = null;\n\n        this.moving = false;\n        this.lastPosition = new Vector2();\n        this.deltaPosition = new Vector2();\n\n        this.speed = speed;\n        this.stiffness = stiffness;\n\n        this.pixelToSpeedMultiplierX = 0;\n        this.pixelToSpeedMultiplierY = 0;\n        this.updatePixelToSpeedMultiplier();\n    }\n\n    /**\n     * @param manager {ControlsManager}\n     */\n    start(manager) {\n        this.manager = manager;\n\n        this.target.addEventListener(\"mousedown\", this.onMouseDown);\n        window.addEventListener(\"mousemove\", this.onMouseMove);\n        window.addEventListener(\"mouseup\", this.onMouseUp);\n\n        window.addEventListener(\"resize\", this.updatePixelToSpeedMultiplier);\n    }\n\n    stop() {\n        this.target.removeEventListener(\"mousedown\", this.onMouseDown);\n        window.removeEventListener(\"mousemove\", this.onMouseMove);\n        window.removeEventListener(\"mouseup\", this.onMouseUp);\n\n        window.removeEventListener(\"resize\", this.updatePixelToSpeedMultiplier);\n    }\n\n    /**\n     * @param delta {number}\n     * @param map {Map}\n     */\n    update(delta, map) {\n        if (this.deltaPosition.x === 0 && this.deltaPosition.y === 0) return;\n\n        let smoothing = this.stiffness / (16.666 / delta);\n        smoothing = MathUtils.clamp(smoothing, 0, 1);\n\n        let directionDelta = MouseMoveControls.tempVec2_1.copy(this.deltaPosition);\n        directionDelta.rotateAround(VEC2_ZERO, this.manager.rotation);\n\n        this.manager.position.x += directionDelta.x * smoothing * this.manager.distance * this.speed * this.pixelToSpeedMultiplierX;\n        this.manager.position.z += directionDelta.y * smoothing * this.manager.distance * this.speed * this.pixelToSpeedMultiplierY;\n\n        this.deltaPosition.multiplyScalar(1 - smoothing);\n        if (this.deltaPosition.lengthSq() < 0.0001) {\n            this.deltaPosition.set(0, 0);\n        }\n    }\n\n    reset() {\n        this.deltaPosition.set(0, 0);\n    }\n\n    /**\n     * @private\n     * @param evt {MouseEvent}\n     */\n    onMouseDown = evt => {\n        if ((evt.buttons !== undefined ? evt.buttons === 1 : evt.button === 0) && !evt.altKey) {\n            this.moving = true;\n            this.deltaPosition.set(0, 0);\n            this.lastPosition.set(evt.x, evt.y);\n        }\n    }\n\n    /**\n     * @private\n     * @param evt {MouseEvent}\n     */\n    onMouseMove = evt => {\n        let position = MouseMoveControls.tempVec2_1.set(evt.x, evt.y);\n\n        if(this.moving){\n            this.deltaPosition.sub(position).add(this.lastPosition);\n        }\n\n        this.lastPosition.copy(position);\n    }\n\n    /**\n     * @private\n     * @param evt {MouseEvent}\n     */\n    onMouseUp = evt => {\n        if (evt.button === 0) this.moving = false;\n    }\n\n    updatePixelToSpeedMultiplier = () => {\n        this.pixelToSpeedMultiplierX = (1 / this.target.clientWidth) * (this.target.clientWidth / this.target.clientHeight);\n        this.pixelToSpeedMultiplierY = 1 / this.target.clientHeight;\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\nimport {MathUtils} from \"three\";\n\nexport class MouseZoomControls {\n\n    /**\n     * @param target {EventTarget}\n     * @param speed {number}\n     * @param stiffness {number}\n     */\n    constructor(target, speed, stiffness) {\n        this.target = target;\n        this.manager = null;\n\n        this.stiffness = stiffness;\n        this.speed = speed;\n\n        this.deltaZoom = 0;\n    }\n\n    /**\n     * @param manager {ControlsManager}\n     */\n    start(manager) {\n        this.manager = manager;\n\n        this.target.addEventListener(\"wheel\", this.onMouseWheel, {passive: true});\n    }\n\n    stop() {\n        this.target.removeEventListener(\"wheel\", this.onMouseWheel);\n    }\n\n    /**\n     * @param delta {number}\n     * @param map {Map}\n     */\n    update(delta, map) {\n        if (this.deltaZoom === 0) return;\n\n        let smoothing = this.stiffness / (16.666 / delta);\n        smoothing = MathUtils.clamp(smoothing, 0, 1);\n\n        this.manager.distance *= Math.pow(1.5, this.deltaZoom * smoothing * this.speed);\n\n        this.deltaZoom *= 1 - smoothing;\n        if (Math.abs(this.deltaZoom) < 0.0001) {\n            this.deltaZoom = 0;\n        }\n    }\n\n    reset() {\n        this.deltaZoom = 0;\n    }\n\n    /**\n     * @private\n     * @param evt {WheelEvent}\n     */\n    onMouseWheel = evt => {\n        let delta = evt.deltaY;\n        if (evt.deltaMode === WheelEvent.DOM_DELTA_PIXEL) delta *= 0.01;\n        if (evt.deltaMode === WheelEvent.DOM_DELTA_LINE) delta *= 0.33;\n\n        this.deltaZoom += delta;\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\nimport {MathUtils} from \"three\";\n\nexport class MouseRotateControls {\n\n    /**\n     * @param target {EventTarget}\n     * @param speed {number}\n     * @param stiffness {number}\n     */\n    constructor(target, speed, stiffness) {\n        this.target = target;\n        this.manager = null;\n\n        this.moving = false;\n        this.lastX = 0;\n        this.deltaRotation = 0;\n\n        this.speed = speed;\n        this.stiffness = stiffness;\n\n        this.pixelToSpeedMultiplierX = 0;\n        this.updatePixelToSpeedMultiplier();\n    }\n\n    /**\n     * @param manager {ControlsManager}\n     */\n    start(manager) {\n        this.manager = manager;\n\n        this.target.addEventListener(\"mousedown\", this.onMouseDown);\n        window.addEventListener(\"mousemove\", this.onMouseMove);\n        window.addEventListener(\"mouseup\", this.onMouseUp);\n\n        window.addEventListener(\"resize\", this.updatePixelToSpeedMultiplier);\n    }\n\n    stop() {\n        this.target.removeEventListener(\"mousedown\", this.onMouseDown);\n        window.removeEventListener(\"mousemove\", this.onMouseMove);\n        window.removeEventListener(\"mouseup\", this.onMouseUp);\n\n        window.removeEventListener(\"resize\", this.updatePixelToSpeedMultiplier);\n    }\n\n    /**\n     * @param delta {number}\n     * @param map {Map}\n     */\n    update(delta, map) {\n        if (this.deltaRotation === 0) return;\n\n        let smoothing = this.stiffness / (16.666 / delta);\n        smoothing = MathUtils.clamp(smoothing, 0, 1);\n\n        this.manager.rotation += this.deltaRotation * smoothing * this.speed * this.pixelToSpeedMultiplierX;\n\n        this.deltaRotation *= 1 - smoothing;\n        if (Math.abs(this.deltaRotation) < 0.0001) {\n            this.deltaRotation = 0;\n        }\n    }\n\n    reset() {\n        this.deltaRotation = 0;\n    }\n\n    /**\n     * @private\n     * @param evt {MouseEvent}\n     */\n    onMouseDown = evt => {\n        if ((evt.buttons !== undefined ? evt.buttons === 2 : evt.button === 2) ||\n            ((evt.altKey || evt.ctrlKey) && (evt.buttons !== undefined ? evt.buttons === 1 : evt.button === 0))) {\n            this.moving = true;\n            this.deltaRotation = 0;\n            this.lastX = evt.x;\n        }\n    }\n\n    /**\n     * @private\n     * @param evt {MouseEvent}\n     */\n    onMouseMove = evt => {\n        if(this.moving){\n            this.deltaRotation += evt.x - this.lastX;\n        }\n\n        this.lastX = evt.x;\n    }\n\n    /**\n     * @private\n     * @param evt {MouseEvent}\n     */\n    onMouseUp = evt => {\n        this.moving = false;\n    }\n\n    updatePixelToSpeedMultiplier = () => {\n        this.pixelToSpeedMultiplierX = (1 / this.target.clientWidth); //* (this.target.clientWidth / this.target.clientHeight);\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\nimport {MathUtils} from \"three\";\n\nexport class MouseAngleControls {\n\n    /**\n     * @param target {EventTarget}\n     * @param speed {number}\n     * @param stiffness {number}\n     */\n    constructor(target, speed, stiffness) {\n        this.target = target;\n        this.manager = null;\n\n        this.moving = false;\n        this.lastY = 0;\n        this.deltaAngle = 0;\n\n        this.speed = speed;\n        this.stiffness = stiffness;\n\n        this.pixelToSpeedMultiplierY = 0;\n        this.updatePixelToSpeedMultiplier();\n    }\n\n    /**\n     * @param manager {ControlsManager}\n     */\n    start(manager) {\n        this.manager = manager;\n\n        this.target.addEventListener(\"mousedown\", this.onMouseDown);\n        window.addEventListener(\"mousemove\", this.onMouseMove);\n        window.addEventListener(\"mouseup\", this.onMouseUp);\n\n        window.addEventListener(\"resize\", this.updatePixelToSpeedMultiplier);\n    }\n\n    stop() {\n        this.target.removeEventListener(\"mousedown\", this.onMouseDown);\n        window.removeEventListener(\"mousemove\", this.onMouseMove);\n        window.removeEventListener(\"mouseup\", this.onMouseUp);\n\n        window.removeEventListener(\"resize\", this.updatePixelToSpeedMultiplier);\n    }\n\n    /**\n     * @param delta {number}\n     * @param map {Map}\n     */\n    update(delta, map) {\n        if (this.deltaAngle === 0) return;\n\n        let smoothing = this.stiffness / (16.666 / delta);\n        smoothing = MathUtils.clamp(smoothing, 0, 1);\n\n        this.manager.angle += this.deltaAngle * smoothing * this.speed * this.pixelToSpeedMultiplierY;\n\n        this.deltaAngle *= 1 - smoothing;\n        if (Math.abs(this.deltaAngle) < 0.0001) {\n            this.deltaAngle = 0;\n        }\n    }\n\n    reset() {\n        this.deltaAngle = 0;\n    }\n\n    /**\n     * @private\n     * @param evt {MouseEvent}\n     */\n    onMouseDown = evt => {\n        if ((evt.buttons !== undefined ? evt.buttons === 2 : evt.button === 2) ||\n            ((evt.altKey || evt.ctrlKey) && (evt.buttons !== undefined ? evt.buttons === 1 : evt.button === 0))) {\n            this.moving = true;\n            this.deltaAngle = 0;\n            this.lastY = evt.y;\n        }\n    }\n\n    /**\n     * @private\n     * @param evt {MouseEvent}\n     */\n    onMouseMove = evt => {\n        if(this.moving){\n            this.deltaAngle -= evt.y - this.lastY;\n        }\n\n        this.lastY = evt.y;\n    }\n\n    /**\n     * @private\n     * @param evt {MouseEvent}\n     */\n    onMouseUp = evt => {\n        this.moving = false;\n    }\n\n    updatePixelToSpeedMultiplier = () => {\n        this.pixelToSpeedMultiplierY = 1 / this.target.clientHeight;\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\nimport {MathUtils, Vector2} from \"three\";\n\nexport class MapHeightControls {\n\n    /**\n     * @param cameraHeightStiffness {number}\n     * @param targetHeightStiffness {number}\n     */\n    constructor(cameraHeightStiffness, targetHeightStiffness) {\n        this.manager = null;\n\n        this.cameraHeightStiffness = cameraHeightStiffness;\n        this.targetHeightStiffness = targetHeightStiffness;\n        this.maxAngle = Math.PI / 2;\n\n        this.targetHeight = 0;\n        this.cameraHeight = 0;\n\n        this.minCameraHeight = 0;\n        this.distanceTagretHeight = 0;\n    }\n\n    /**\n     * @param manager {ControlsManager}\n     */\n    start(manager) {\n        this.manager = manager;\n    }\n\n    stop() {}\n\n    /**\n     * @param delta {number}\n     * @param map {Map}\n     */\n    update(delta, map) {\n\n        // adjust target height\n        this.updateHeights(delta, map);\n        this.manager.position.y = Math.max(this.manager.position.y, this.getSuggestedHeight());\n    }\n\n    updateHeights(delta, map) {\n        //target height\n        let targetSmoothing = this.targetHeightStiffness / (16.666 / delta);\n        targetSmoothing = MathUtils.clamp(targetSmoothing, 0, 1);\n\n        let targetTerrainHeight = map.terrainHeightAt(this.manager.position.x, this.manager.position.z) + 3 || 0;\n\n        let targetDelta = targetTerrainHeight - this.targetHeight;\n        this.targetHeight += targetDelta * targetSmoothing;\n        if (Math.abs(targetDelta) < 0.001) this.targetHeight = targetTerrainHeight;\n\n        // camera height\n        this.minCameraHeight = 0;\n        if (this.maxAngle >= 0.1) {\n            let cameraSmoothing = this.cameraHeightStiffness / (16.666 / delta);\n            cameraSmoothing = MathUtils.clamp(cameraSmoothing, 0, 1);\n\n            let cameraTerrainHeight = map.terrainHeightAt(this.manager.camera.position.x, this.manager.camera.position.z) || 0;\n\n            let cameraDelta = cameraTerrainHeight - this.cameraHeight;\n            this.cameraHeight += cameraDelta * cameraSmoothing;\n            if (Math.abs(cameraDelta) < 0.001) this.cameraHeight = cameraTerrainHeight;\n\n            let maxAngleHeight = Math.cos(this.maxAngle) * this.manager.distance;\n            this.minCameraHeight = this.cameraHeight - maxAngleHeight + 1;\n        }\n\n        // adjust targetHeight by distance\n        this.distanceTagretHeight = Math.max(MathUtils.lerp(this.targetHeight, 0, this.manager.distance / 500), 0);\n    }\n\n    getSuggestedHeight() {\n        return Math.max(this.distanceTagretHeight, this.minCameraHeight);\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\nexport class KeyCombination {\n\n    static CTRL = 0;\n    static SHIFT = 1;\n    static ALT = 2;\n\n    /**\n     * @param code {string}\n     * @param modifiers {...number}\n     */\n    constructor(code, ...modifiers) {\n\n        this.code = code;\n        this.ctrl = modifiers.includes(KeyCombination.CTRL) || this.code === \"CtrlLeft\" || this.code === \"CtrlRight\";\n        this.shift = modifiers.includes(KeyCombination.SHIFT) || this.code === \"ShiftLeft\" || this.code === \"ShiftRight\";\n        this.alt = modifiers.includes(KeyCombination.ALT) || this.code === \"AltLeft\" || this.code === \"AltRight\";\n\n    }\n\n    /**\n     * @param evt {KeyboardEvent}\n     * @returns {boolean}\n     */\n    testDown(evt) {\n        return this.code === evt.code &&\n            this.ctrl === evt.ctrlKey &&\n            this.shift === evt.shiftKey &&\n            this.alt === evt.altKey;\n    }\n\n    /**\n     * @param evt {KeyboardEvent}\n     * @returns {boolean}\n     */\n    testUp(evt) {\n        return this.code === evt.code;\n    }\n\n    static oneDown(evt, ...combinations) {\n        for (let combination of combinations){\n            if (combination.testDown(evt)) return true;\n        }\n        return false;\n    }\n\n    static oneUp(evt, ...combinations) {\n        for (let combination of combinations){\n            if (combination.testUp(evt)) return true;\n        }\n        return false;\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\nimport {MathUtils, Vector2} from \"three\";\nimport {VEC2_ZERO} from \"../../../util/Utils\";\nimport {KeyCombination} from \"../../KeyCombination\";\n\nexport class KeyMoveControls {\n\n    static KEYS = {\n        LEFT: [\n            new KeyCombination(\"ArrowLeft\"),\n            new KeyCombination(\"KeyA\")\n        ],\n        UP: [\n            new KeyCombination(\"ArrowUp\"),\n            new KeyCombination(\"KeyW\")\n        ],\n        RIGHT: [\n            new KeyCombination(\"ArrowRight\"),\n            new KeyCombination(\"KeyD\")\n        ],\n        DOWN: [\n            new KeyCombination(\"ArrowDown\"),\n            new KeyCombination(\"KeyS\")\n        ],\n    }\n\n    static temp_v2 = new Vector2();\n\n    /**\n     * @param target {EventTarget}\n     * @param speed {number}\n     * @param stiffness {number}\n     */\n    constructor(target, speed, stiffness) {\n        this.target = target;\n        this.manager = null;\n\n        this.deltaPosition = new Vector2();\n\n        this.up = false;\n        this.down = false;\n        this.left = false;\n        this.right = false;\n\n        this.speed = speed;\n        this.stiffness = stiffness;\n    }\n\n    /**\n     * @param manager {ControlsManager}\n     */\n    start(manager) {\n        this.manager = manager;\n\n        window.addEventListener(\"keydown\", this.onKeyDown);\n        window.addEventListener(\"keyup\", this.onKeyUp);\n    }\n\n    stop() {\n        window.removeEventListener(\"keydown\", this.onKeyDown);\n        window.removeEventListener(\"keyup\", this.onKeyUp);\n    }\n\n    /**\n     * @param delta {number}\n     * @param map {Map}\n     */\n    update(delta, map) {\n        if (this.up) this.deltaPosition.y -= 1;\n        if (this.down) this.deltaPosition.y += 1;\n        if (this.left) this.deltaPosition.x -= 1;\n        if (this.right) this.deltaPosition.x += 1;\n\n        if (this.deltaPosition.x === 0 && this.deltaPosition.y === 0) return;\n\n        let smoothing = this.stiffness / (16.666 / delta);\n        smoothing = MathUtils.clamp(smoothing, 0, 1);\n\n        let rotatedDelta = KeyMoveControls.temp_v2.copy(this.deltaPosition);\n        rotatedDelta.rotateAround(VEC2_ZERO, this.manager.rotation);\n\n        this.manager.position.x += rotatedDelta.x * smoothing * this.manager.distance * this.speed * delta * 0.06;\n        this.manager.position.z += rotatedDelta.y * smoothing * this.manager.distance * this.speed * delta * 0.06;\n\n        this.deltaPosition.multiplyScalar(1 - smoothing);\n        if (this.deltaPosition.lengthSq() < 0.0001) {\n            this.deltaPosition.set(0, 0);\n        }\n    }\n\n    /**\n     * @param evt {KeyboardEvent}\n     */\n    onKeyDown = evt => {\n        if (KeyCombination.oneDown(evt, ...KeyMoveControls.KEYS.UP)){\n            this.up = true;\n            evt.preventDefault();\n        }\n        if (KeyCombination.oneDown(evt, ...KeyMoveControls.KEYS.DOWN)){\n            this.down = true;\n            evt.preventDefault();\n        }\n        if (KeyCombination.oneDown(evt, ...KeyMoveControls.KEYS.LEFT)){\n            this.left = true;\n            evt.preventDefault();\n        }\n        if (KeyCombination.oneDown(evt, ...KeyMoveControls.KEYS.RIGHT)){\n            this.right = true;\n            evt.preventDefault();\n        }\n    }\n\n    /**\n     * @param evt {KeyboardEvent}\n     */\n    onKeyUp = evt => {\n        if (KeyCombination.oneUp(evt, ...KeyMoveControls.KEYS.UP)){\n            this.up = false;\n        }\n        if (KeyCombination.oneUp(evt, ...KeyMoveControls.KEYS.DOWN)){\n            this.down = false;\n        }\n        if (KeyCombination.oneUp(evt, ...KeyMoveControls.KEYS.LEFT)){\n            this.left = false;\n        }\n        if (KeyCombination.oneUp(evt, ...KeyMoveControls.KEYS.RIGHT)){\n            this.right = false;\n        }\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\nimport {MathUtils} from \"three\";\nimport {KeyCombination} from \"../../KeyCombination\";\n\nexport class KeyAngleControls {\n\n    static KEYS = {\n        UP: [\n            new KeyCombination(\"ArrowUp\", KeyCombination.ALT),\n            new KeyCombination(\"KeyW\", KeyCombination.ALT),\n            new KeyCombination(\"PageUp\")\n        ],\n        DOWN: [\n            new KeyCombination(\"ArrowDown\", KeyCombination.ALT),\n            new KeyCombination(\"KeyS\", KeyCombination.ALT),\n            new KeyCombination(\"PageDown\")\n        ],\n    }\n\n    /**\n     * @param target {EventTarget}\n     * @param speed {number}\n     * @param stiffness {number}\n     */\n    constructor(target, speed, stiffness) {\n        this.target = target;\n        this.manager = null;\n\n        this.deltaAngle = 0;\n\n        this.up = false;\n        this.down = false;\n\n        this.speed = speed;\n        this.stiffness = stiffness;\n    }\n\n    /**\n     * @param manager {ControlsManager}\n     */\n    start(manager) {\n        this.manager = manager;\n\n        window.addEventListener(\"keydown\", this.onKeyDown);\n        window.addEventListener(\"keyup\", this.onKeyUp);\n    }\n\n    stop() {\n        window.removeEventListener(\"keydown\", this.onKeyDown);\n        window.removeEventListener(\"keyup\", this.onKeyUp);\n    }\n\n    /**\n     * @param delta {number}\n     * @param map {Map}\n     */\n    update(delta, map) {\n        if (this.up) this.deltaAngle -= 1;\n        if (this.down) this.deltaAngle += 1;\n\n        if (this.deltaAngle === 0) return;\n\n        let smoothing = this.stiffness / (16.666 / delta);\n        smoothing = MathUtils.clamp(smoothing, 0, 1);\n\n        this.manager.angle += this.deltaAngle * smoothing * this.speed * delta * 0.06;\n\n        this.deltaAngle *= 1 - smoothing;\n        if (Math.abs(this.deltaAngle) < 0.0001) {\n            this.deltaAngle = 0;\n        }\n    }\n\n    /**\n     * @param evt {KeyboardEvent}\n     */\n    onKeyDown = evt => {\n        if (KeyCombination.oneDown(evt, ...KeyAngleControls.KEYS.UP)){\n            this.up = true;\n            evt.preventDefault();\n        }\n        if (KeyCombination.oneDown(evt, ...KeyAngleControls.KEYS.DOWN)){\n            this.down = true;\n            evt.preventDefault();\n        }\n    }\n\n    /**\n     * @param evt {KeyboardEvent}\n     */\n    onKeyUp = evt => {\n        if (KeyCombination.oneUp(evt, ...KeyAngleControls.KEYS.UP)){\n            this.up = false;\n        }\n        if (KeyCombination.oneUp(evt, ...KeyAngleControls.KEYS.DOWN)){\n            this.down = false;\n        }\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\nimport {MathUtils} from \"three\";\nimport {KeyCombination} from \"../../KeyCombination\";\n\nexport class KeyRotateControls {\n\n    static KEYS = {\n        LEFT: [\n            new KeyCombination(\"ArrowLeft\", KeyCombination.ALT),\n            new KeyCombination(\"KeyA\", KeyCombination.ALT),\n            new KeyCombination(\"Delete\"),\n        ],\n        RIGHT: [\n            new KeyCombination(\"ArrowRight\", KeyCombination.ALT),\n            new KeyCombination(\"KeyD\", KeyCombination.ALT),\n            new KeyCombination(\"End\"),\n        ],\n    }\n\n    /**\n     * @param target {EventTarget}\n     * @param speed {number}\n     * @param stiffness {number}\n     */\n    constructor(target, speed, stiffness) {\n        this.target = target;\n        this.manager = null;\n\n        this.deltaRotation = 0;\n\n        this.left = false;\n        this.right = false;\n\n        this.speed = speed;\n        this.stiffness = stiffness;\n    }\n\n    /**\n     * @param manager {ControlsManager}\n     */\n    start(manager) {\n        this.manager = manager;\n\n        window.addEventListener(\"keydown\", this.onKeyDown);\n        window.addEventListener(\"keyup\", this.onKeyUp);\n    }\n\n    stop() {\n        window.removeEventListener(\"keydown\", this.onKeyDown);\n        window.removeEventListener(\"keyup\", this.onKeyUp);\n    }\n\n    /**\n     * @param delta {number}\n     * @param map {Map}\n     */\n    update(delta, map) {\n        if (this.left) this.deltaRotation += 1;\n        if (this.right) this.deltaRotation -= 1;\n\n        if (this.deltaRotation === 0) return;\n\n        let smoothing = this.stiffness / (16.666 / delta);\n        smoothing = MathUtils.clamp(smoothing, 0, 1);\n\n        this.manager.rotation += this.deltaRotation * smoothing * this.speed * delta * 0.06;\n\n        this.deltaRotation *= 1 - smoothing;\n        if (Math.abs(this.deltaRotation) < 0.0001) {\n            this.deltaRotation = 0;\n        }\n    }\n\n    /**\n     * @param evt {KeyboardEvent}\n     */\n    onKeyDown = evt => {\n        if (KeyCombination.oneDown(evt, ...KeyRotateControls.KEYS.LEFT)){\n            this.left = true;\n            evt.preventDefault();\n        }\n        if (KeyCombination.oneDown(evt, ...KeyRotateControls.KEYS.RIGHT)){\n            this.right = true;\n            evt.preventDefault();\n        }\n    }\n\n    /**\n     * @param evt {KeyboardEvent}\n     */\n    onKeyUp = evt => {\n        if (KeyCombination.oneUp(evt, ...KeyRotateControls.KEYS.LEFT)){\n            this.left = false;\n        }\n        if (KeyCombination.oneUp(evt, ...KeyRotateControls.KEYS.RIGHT)){\n            this.right = false;\n        }\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\nimport {MathUtils} from \"three\";\nimport {KeyCombination} from \"../../KeyCombination\";\n\nexport class KeyZoomControls {\n\n    static KEYS = {\n        IN: [\n            new KeyCombination(\"NumpadAdd\"),\n            new KeyCombination(\"Insert\"),\n        ],\n        OUT: [\n            new KeyCombination(\"NumpadSubtract\"),\n            new KeyCombination(\"Home\"),\n        ],\n    }\n\n    /**\n     * @param target {EventTarget}\n     * @param speed {number}\n     * @param stiffness {number}\n     */\n    constructor(target, speed, stiffness) {\n        this.target = target;\n        this.manager = null;\n\n        this.deltaZoom = 0;\n\n        this.in = false;\n        this.out = false;\n\n        this.speed = speed;\n        this.stiffness = stiffness;\n    }\n\n    /**\n     * @param manager {ControlsManager}\n     */\n    start(manager) {\n        this.manager = manager;\n\n        window.addEventListener(\"keydown\", this.onKeyDown);\n        window.addEventListener(\"keyup\", this.onKeyUp);\n    }\n\n    stop() {\n        window.removeEventListener(\"keydown\", this.onKeyDown);\n        window.removeEventListener(\"keyup\", this.onKeyUp);\n    }\n\n    /**\n     * @param delta {number}\n     * @param map {Map}\n     */\n    update(delta, map) {\n        if (this.in) this.deltaZoom -= 1;\n        if (this.out) this.deltaZoom += 1;\n\n        if (this.deltaZoom === 0) return;\n\n        let smoothing = this.stiffness / (16.666 / delta);\n        smoothing = MathUtils.clamp(smoothing, 0, 1);\n\n        this.manager.distance *= Math.pow(1.5, this.deltaZoom * smoothing * this.speed * delta * 0.06);\n\n        this.deltaZoom *= 1 - smoothing;\n        if (Math.abs(this.deltaZoom) < 0.0001) {\n            this.deltaZoom = 0;\n        }\n    }\n\n    /**\n     * @param evt {KeyboardEvent}\n     */\n    onKeyDown = evt => {\n        if (KeyCombination.oneDown(evt, ...KeyZoomControls.KEYS.IN)){\n            this.in = true;\n            evt.preventDefault();\n        }\n        if (KeyCombination.oneDown(evt, ...KeyZoomControls.KEYS.OUT)){\n            this.out = true;\n            evt.preventDefault();\n        }\n    }\n\n    /**\n     * @param evt {KeyboardEvent}\n     */\n    onKeyUp = evt => {\n        if (KeyCombination.oneUp(evt, ...KeyZoomControls.KEYS.IN)){\n            this.in = false;\n        }\n        if (KeyCombination.oneUp(evt, ...KeyZoomControls.KEYS.OUT)){\n            this.out = false;\n        }\n    }\n\n}","import {MathUtils, Vector2} from \"three\";\n/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\nimport {VEC2_ZERO} from \"../../../util/Utils\";\n\nexport class TouchMoveControls {\n\n    static tempVec2_1 = new Vector2();\n\n    /**\n     * @param target {Element}\n     * @param hammer {Manager}\n     * @param speed {number}\n     * @param stiffness {number}\n     */\n    constructor(target, hammer, speed, stiffness) {\n        this.target = target;\n        this.hammer = hammer;\n        this.manager = null;\n\n        this.moving = false;\n        this.lastPosition = new Vector2();\n        this.deltaPosition = new Vector2();\n\n        this.speed = speed;\n        this.stiffness = stiffness;\n\n        this.pixelToSpeedMultiplierX = 0;\n        this.pixelToSpeedMultiplierY = 0;\n        this.updatePixelToSpeedMultiplier();\n    }\n\n    /**\n     * @param manager {ControlsManager}\n     */\n    start(manager) {\n        this.manager = manager;\n\n        this.hammer.on(\"movestart\", this.onTouchDown);\n        this.hammer.on(\"movemove\", this.onTouchMove);\n        this.hammer.on(\"moveend\", this.onTouchUp);\n        this.hammer.on(\"movecancel\", this.onTouchUp);\n\n        window.addEventListener(\"resize\", this.updatePixelToSpeedMultiplier);\n    }\n\n    stop() {\n        this.hammer.off(\"movestart\", this.onTouchDown);\n        this.hammer.off(\"movemove\", this.onTouchMove);\n        this.hammer.off(\"moveend\", this.onTouchUp);\n        this.hammer.off(\"movecancel\", this.onTouchUp);\n\n        window.removeEventListener(\"resize\", this.updatePixelToSpeedMultiplier);\n    }\n\n    /**\n     * @param delta {number}\n     * @param map {Map}\n     */\n    update(delta, map) {\n        if (this.deltaPosition.x === 0 && this.deltaPosition.y === 0) return;\n\n        let smoothing = this.stiffness / (16.666 / delta);\n        smoothing = MathUtils.clamp(smoothing, 0, 1);\n\n        let directionDelta = TouchMoveControls.tempVec2_1.copy(this.deltaPosition);\n        directionDelta.rotateAround(VEC2_ZERO, this.manager.rotation);\n\n        this.manager.position.x += directionDelta.x * smoothing * this.manager.distance * this.speed * this.pixelToSpeedMultiplierX;\n        this.manager.position.z += directionDelta.y * smoothing * this.manager.distance * this.speed * this.pixelToSpeedMultiplierY;\n\n        this.deltaPosition.multiplyScalar(1 - smoothing);\n        if (this.deltaPosition.lengthSq() < 0.0001) {\n            this.deltaPosition.set(0, 0);\n        }\n    }\n\n    reset() {\n        this.deltaPosition.set(0, 0);\n    }\n\n    /**\n     * @private\n     * @param evt {object}\n     */\n    onTouchDown = evt => {\n        if (evt.pointerType === \"mouse\") return;\n\n        this.moving = true;\n        this.deltaPosition.set(0, 0);\n        this.lastPosition.set(evt.center.x, evt.center.y);\n    }\n\n    /**\n     * @private\n     * @param evt {object}\n     */\n    onTouchMove = evt => {\n        if (evt.pointerType === \"mouse\") return;\n\n        let position = TouchMoveControls.tempVec2_1.set(evt.center.x, evt.center.y);\n\n        if(this.moving){\n            this.deltaPosition.sub(position).add(this.lastPosition);\n        }\n\n        this.lastPosition.copy(position);\n    }\n\n    /**\n     * @private\n     * @param evt {object}\n     */\n    onTouchUp = evt => {\n        if (evt.pointerType === \"mouse\") return;\n\n        this.moving = false;\n    }\n\n    updatePixelToSpeedMultiplier = () => {\n        this.pixelToSpeedMultiplierX = (1 / this.target.clientWidth) * (this.target.clientWidth / this.target.clientHeight);\n        this.pixelToSpeedMultiplierY = 1 / this.target.clientHeight;\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\nimport {MathUtils} from \"three\";\n\nexport class TouchRotateControls {\n\n    /**\n     * @param hammer {Manager}\n     * @param speed {number}\n     * @param stiffness {number}\n     */\n    constructor(hammer, speed, stiffness) {\n        this.hammer = hammer;\n        this.manager = null;\n\n        this.moving = false;\n        this.lastRotation = 0;\n        this.deltaRotation = 0;\n\n        this.speed = speed;\n        this.stiffness = stiffness;\n    }\n\n    /**\n     * @param manager {ControlsManager}\n     */\n    start(manager) {\n        this.manager = manager;\n\n        this.hammer.on(\"rotatestart\", this.onTouchDown);\n        this.hammer.on(\"rotatemove\", this.onTouchMove);\n        this.hammer.on(\"rotateend\", this.onTouchUp);\n        this.hammer.on(\"rotatecancel\", this.onTouchUp);\n    }\n\n    stop() {\n        this.hammer.off(\"rotatestart\", this.onTouchDown);\n        this.hammer.off(\"rotatemove\", this.onTouchMove);\n        this.hammer.off(\"rotateend\", this.onTouchUp);\n        this.hammer.off(\"rotatecancel\", this.onTouchUp);\n    }\n\n    /**\n     * @param delta {number}\n     * @param map {Map}\n     */\n    update(delta, map) {\n        if (this.deltaRotation === 0) return;\n\n        let smoothing = this.stiffness / (16.666 / delta);\n        smoothing = MathUtils.clamp(smoothing, 0, 1);\n\n        this.manager.rotation += this.deltaRotation * smoothing * this.speed;\n\n        this.deltaRotation *= 1 - smoothing;\n        if (Math.abs(this.deltaRotation) < 0.0001) {\n            this.deltaRotation = 0;\n        }\n    }\n\n    reset() {\n        this.deltaRotation = 0;\n    }\n\n    /**\n     * @private\n     * @param evt {object}\n     */\n    onTouchDown = evt => {\n        this.moving = true;\n        this.deltaRotation = 0;\n        this.lastRotation = evt.rotation;\n    }\n\n    /**\n     * @private\n     * @param evt {object}\n     */\n    onTouchMove = evt => {\n        if(this.moving){\n            let delta = evt.rotation - this.lastRotation;\n            if (delta > 180) delta -= 360;\n            if (delta < -180) delta += 360;\n\n            this.deltaRotation -= delta;\n        }\n\n        this.lastRotation = evt.rotation;\n    }\n\n    /**\n     * @private\n     * @param evt {object}\n     */\n    onTouchUp = evt => {\n        this.moving = false;\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\nimport {MathUtils} from \"three\";\n\nexport class TouchAngleControls {\n\n    /**\n     * @param target {Element}\n     * @param hammer {Manager}\n     * @param speed {number}\n     * @param stiffness {number}\n     */\n    constructor(target, hammer, speed, stiffness) {\n        this.target = target;\n        this.hammer = hammer;\n        this.manager = null;\n\n        this.moving = false;\n        this.lastY = 0;\n        this.deltaAngle = 0;\n\n        this.speed = speed;\n        this.stiffness = stiffness;\n\n        this.pixelToSpeedMultiplierY = 0;\n        this.updatePixelToSpeedMultiplier();\n    }\n\n    /**\n     * @param manager {ControlsManager}\n     */\n    start(manager) {\n        this.manager = manager;\n\n        this.hammer.on(\"tiltstart\", this.onTouchDown);\n        this.hammer.on(\"tiltmove\", this.onTouchMove);\n        this.hammer.on(\"tiltend\", this.onTouchUp);\n        this.hammer.on(\"tiltcancel\", this.onTouchUp);\n\n        window.addEventListener(\"resize\", this.updatePixelToSpeedMultiplier);\n    }\n\n    stop() {\n        this.hammer.off(\"tiltstart\", this.onTouchDown);\n        this.hammer.off(\"tiltmove\", this.onTouchMove);\n        this.hammer.off(\"tiltend\", this.onTouchUp);\n        this.hammer.off(\"tiltcancel\", this.onTouchUp);\n\n        window.removeEventListener(\"resize\", this.updatePixelToSpeedMultiplier);\n    }\n\n    /**\n     * @param delta {number}\n     * @param map {Map}\n     */\n    update(delta, map) {\n        if (this.deltaAngle === 0) return;\n\n        let smoothing = this.stiffness / (16.666 / delta);\n        smoothing = MathUtils.clamp(smoothing, 0, 1);\n\n        this.manager.angle += this.deltaAngle * smoothing * this.speed * this.pixelToSpeedMultiplierY;\n\n        this.deltaAngle *= 1 - smoothing;\n        if (Math.abs(this.deltaAngle) < 0.0001) {\n            this.deltaAngle = 0;\n        }\n    }\n\n    reset() {\n        this.deltaAngle = 0;\n    }\n\n    /**\n     * @private\n     * @param evt {object}\n     */\n    onTouchDown = evt => {\n        this.moving = true;\n        this.deltaAngle = 0;\n        this.lastY = evt.center.y;\n    }\n\n    /**\n     * @private\n     * @param evt {object}\n     */\n    onTouchMove = evt => {\n        if(this.moving){\n            this.deltaAngle -= evt.center.y - this.lastY;\n        }\n\n        this.lastY = evt.center.y;\n    }\n\n    /**\n     * @private\n     * @param evt {object}\n     */\n    onTouchUp = evt => {\n        this.moving = false;\n    }\n\n    updatePixelToSpeedMultiplier = () => {\n        this.pixelToSpeedMultiplierY = 1 / this.target.clientHeight;\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\nexport class TouchZoomControls {\n\n    /**\n     * @param hammer {Manager}\n     */\n    constructor(hammer) {\n        this.hammer = hammer;\n        this.manager = null;\n\n        this.moving = false;\n        this.deltaZoom = 1;\n        this.lastZoom = 1;\n    }\n\n    /**\n     * @param manager {ControlsManager}\n     */\n    start(manager) {\n        this.manager = manager;\n\n        this.hammer.on(\"zoomstart\", this.onTouchDown);\n        this.hammer.on(\"zoommove\", this.onTouchMove);\n        this.hammer.on(\"zoomend\", this.onTouchUp);\n        this.hammer.on(\"zoomcancel\", this.onTouchUp);\n    }\n\n    stop() {\n        this.hammer.off(\"zoomstart\", this.onTouchDown);\n        this.hammer.off(\"zoommove\", this.onTouchMove);\n        this.hammer.off(\"zoomend\", this.onTouchUp);\n        this.hammer.off(\"zoomcancel\", this.onTouchUp);\n    }\n\n    /**\n     * @param delta {number}\n     * @param map {Map}\n     */\n    update(delta, map) {\n        if (this.deltaZoom === 1) return;\n\n        this.manager.distance /= this.deltaZoom;\n        this.deltaZoom = 1;\n    }\n\n    reset() {\n        this.deltaZoom = 1;\n    }\n\n    /**\n     * @private\n     * @param evt {object}\n     */\n    onTouchDown = evt => {\n        this.moving = true;\n        this.lastZoom = 1;\n    }\n\n    /**\n     * @private\n     * @param evt {object}\n     */\n    onTouchMove = evt => {\n        if(this.moving){\n            this.deltaZoom *= evt.scale / this.lastZoom;\n        }\n\n        this.lastZoom = evt.scale;\n    }\n\n    /**\n     * @private\n     * @param evt {object}\n     */\n    onTouchUp = evt => {\n        this.moving = false;\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\nimport {MouseMoveControls} from \"./mouse/MouseMoveControls\";\nimport {MouseZoomControls} from \"./mouse/MouseZoomControls\";\nimport {MouseRotateControls} from \"./mouse/MouseRotateControls\";\nimport {MouseAngleControls} from \"./mouse/MouseAngleControls\";\nimport {MathUtils, Vector2, Vector3} from \"three\";\nimport {Manager, Pan, Pinch, Rotate, Tap, DIRECTION_ALL, DIRECTION_VERTICAL} from \"hammerjs\";\nimport {softClamp} from \"../../util/Utils\";\nimport {MapHeightControls} from \"./MapHeightControls\";\nimport {KeyMoveControls} from \"./keyboard/KeyMoveControls\";\nimport {KeyAngleControls} from \"./keyboard/KeyAngleControls\";\nimport {KeyRotateControls} from \"./keyboard/KeyRotateControls\";\nimport {KeyZoomControls} from \"./keyboard/KeyZoomControls\";\nimport {TouchMoveControls} from \"./touch/TouchMoveControls\";\nimport {TouchRotateControls} from \"./touch/TouchRotateControls\";\nimport {TouchAngleControls} from \"./touch/TouchAngleControls\";\nimport {TouchZoomControls} from \"./touch/TouchZoomControls\";\nimport {PlayerMarker} from \"../../markers/PlayerMarker\";\n\nconst HALF_PI = Math.PI * 0.5;\n\nexport class MapControls {\n\n    static _beforeMoveTemp = new Vector3();\n\n    /**\n     * @param rootElement {Element}\n     */\n    constructor(rootElement) {\n        this.rootElement = rootElement;\n\n        this.data = {\n            followingPlayer: null\n        };\n\n        /** @type {ControlsManager} */\n        this.manager = null;\n\n        this.hammer = new Manager(this.rootElement);\n        this.initializeHammer();\n\n        //controls\n        this.mouseMove = new MouseMoveControls(this.rootElement, 1.5,0.3);\n        this.mouseRotate = new MouseRotateControls(this.rootElement, 6, 0.3);\n        this.mouseAngle = new MouseAngleControls(this.rootElement, 3, 0.3);\n        this.mouseZoom = new MouseZoomControls(this.rootElement, 1, 0.2);\n\n        this.keyMove = new KeyMoveControls(this.rootElement, 0.025, 0.2);\n        this.keyRotate = new KeyRotateControls(this.rootElement, 0.06, 0.15);\n        this.keyAngle = new KeyAngleControls(this.rootElement, 0.04, 0.15);\n        this.keyZoom = new KeyZoomControls(this.rootElement, 0.2, 0.15);\n\n        this.touchMove = new TouchMoveControls(this.rootElement, this.hammer, 1.5,0.3);\n        this.touchRotate = new TouchRotateControls(this.hammer, 0.0174533, 0.3);\n        this.touchAngle = new TouchAngleControls(this.rootElement, this.hammer, 3, 0.3);\n        this.touchZoom = new TouchZoomControls(this.hammer);\n\n        this.mapHeight = new MapHeightControls(0.2, 0.1);\n\n        this.lastTap = -1;\n        this.lastTapCenter = null;\n    }\n\n    /**\n     * @param manager {ControlsManager}\n     */\n    start(manager) {\n        this.manager = manager;\n\n        this.rootElement.addEventListener(\"contextmenu\", this.onContextMenu);\n        this.hammer.on(\"tap\", this.onTap);\n\n        this.mouseMove.start(manager);\n        this.mouseRotate.start(manager);\n        this.mouseAngle.start(manager);\n        this.mouseZoom.start(manager);\n\n        this.keyMove.start(manager);\n        this.keyRotate.start(manager);\n        this.keyAngle.start(manager);\n        this.keyZoom.start(manager);\n\n        this.touchMove.start(manager);\n        this.touchRotate.start(manager);\n        this.touchAngle.start(manager);\n        this.touchZoom.start(manager);\n\n        this.mapHeight.start(manager);\n    }\n\n    stop() {\n        this.stopFollowingPlayerMarker();\n\n        this.rootElement.removeEventListener(\"contextmenu\", this.onContextMenu);\n        this.hammer.off(\"tap\", this.onTap);\n\n        this.mouseMove.stop();\n        this.mouseRotate.stop();\n        this.mouseAngle.stop();\n        this.mouseZoom.stop();\n\n        this.keyMove.stop();\n        this.keyRotate.stop();\n        this.keyAngle.stop();\n        this.keyZoom.stop();\n\n        this.touchMove.stop();\n        this.touchRotate.stop();\n        this.touchAngle.stop();\n        this.touchZoom.stop();\n\n        this.mapHeight.stop();\n    }\n\n    /**\n     * @param delta {number}\n     * @param map {Map}\n     */\n    update(delta, map) {\n        this.manager.position.y = 0; // reset target y position\n\n        // move\n        MapControls._beforeMoveTemp.copy(this.manager.position);\n        this.mouseMove.update(delta, map);\n        this.keyMove.update(delta, map);\n        this.touchMove.update(delta, map);\n\n        // if moved, stop following the marker and give back control\n        if (this.data.followingPlayer && !MapControls._beforeMoveTemp.equals(this.manager.position)) {\n            this.stopFollowingPlayerMarker();\n        }\n\n        // follow player marker\n        if (this.data.followingPlayer) {\n            this.manager.position.copy(this.data.followingPlayer.position);\n        }\n\n        // zoom\n        this.mouseZoom.update(delta, map);\n        this.keyZoom.update(delta, map);\n        this.touchZoom.update(delta, map);\n\n        this.manager.distance = softClamp(this.manager.distance, 5, 10000, 0.8);\n\n        // max angle for current distance\n        let maxAngleForZoom = this.getMaxPerspectiveAngleForDistance(this.manager.distance);\n\n        // rotation\n        if (this.manager.ortho === 0) {\n            this.mouseRotate.update(delta, map);\n            this.keyRotate.update(delta, map);\n            this.touchRotate.update(delta, map);\n        }\n\n        // tilt\n        if (this.manager.ortho === 0) {\n            this.mouseAngle.update(delta, map);\n            this.keyAngle.update(delta, map);\n            this.touchAngle.update(delta, map);\n            this.manager.angle = softClamp(this.manager.angle, 0, maxAngleForZoom, 0.8);\n        }\n\n        // target height\n        if (this.manager.ortho === 0 || this.manager.angle === 0) {\n            this.mapHeight.maxAngle = maxAngleForZoom;\n            this.mapHeight.update(delta, map);\n        }\n    }\n\n    reset() {\n        this.mouseMove.reset();\n        this.mouseRotate.reset();\n        this.mouseAngle.reset();\n        this.mouseZoom.reset();\n\n        this.touchMove.reset();\n        this.touchRotate.reset();\n        this.touchAngle.reset();\n        this.touchZoom.reset();\n    }\n\n    getMaxPerspectiveAngleForDistance(distance) {\n        return MathUtils.clamp((1 - Math.pow(Math.max(distance - 5, 0.001) / 500, 0.5)) * HALF_PI,0, HALF_PI)\n    }\n\n    initializeHammer() {\n        let touchTap = new Tap({ event: 'tap', pointers: 1, taps: 1, threshold: 5 });\n        let touchMove = new Pan({ event: 'move', pointers: 1, direction: DIRECTION_ALL, threshold: 0 });\n        let touchTilt =  new Pan({ event: 'tilt', pointers: 2, direction: DIRECTION_VERTICAL, threshold: 0 });\n        let touchRotate = new Rotate({ event: 'rotate', pointers: 2, threshold: 0 });\n        let touchZoom = new Pinch({ event: 'zoom', pointers: 2, threshold: 0 });\n\n        touchMove.recognizeWith(touchRotate);\n        touchMove.recognizeWith(touchTilt);\n        touchMove.recognizeWith(touchZoom);\n        touchTilt.recognizeWith(touchRotate);\n        touchTilt.recognizeWith(touchZoom);\n        touchRotate.recognizeWith(touchZoom);\n\n        this.hammer.add(touchTap);\n        this.hammer.add(touchTilt);\n        this.hammer.add(touchMove);\n        this.hammer.add(touchRotate);\n        this.hammer.add(touchZoom);\n    }\n\n    /**\n     * @param marker {object}\n     */\n    followPlayerMarker(marker) {\n        if (marker.isPlayerMarker) marker = marker.data;\n        this.data.followingPlayer = marker;\n    }\n\n    stopFollowingPlayerMarker() {\n        this.data.followingPlayer = null;\n    }\n\n    onContextMenu = evt => {\n        evt.preventDefault();\n    }\n\n    onTap = evt => {\n        let doubleTap = false;\n        let center = new Vector2(evt.center.x, evt.center.y);\n\n        let now = Date.now();\n        if (this.lastTap > 0 && this.lastTapCenter && now - this.lastTap < 500 && this.lastTapCenter.distanceTo(center) < 5){\n            doubleTap = true;\n            this.lastTap = -1;\n        } else {\n            this.lastTap = now;\n            this.lastTapCenter = center;\n        }\n\n        this.manager.handleMapInteraction(new Vector2(evt.center.x, evt.center.y), {doubleTap: doubleTap});\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\nimport {MathUtils, Vector2} from \"three\";\nimport {VEC2_ZERO} from \"../../../util/Utils\";\nimport {KeyCombination} from \"../../KeyCombination\";\n\nexport class KeyMoveControls {\n\n    static KEYS = {\n        LEFT: [\n            new KeyCombination(\"ArrowLeft\"),\n            new KeyCombination(\"KeyA\")\n        ],\n        UP: [\n            new KeyCombination(\"ArrowUp\"),\n            new KeyCombination(\"KeyW\")\n        ],\n        RIGHT: [\n            new KeyCombination(\"ArrowRight\"),\n            new KeyCombination(\"KeyD\")\n        ],\n        DOWN: [\n            new KeyCombination(\"ArrowDown\"),\n            new KeyCombination(\"KeyS\")\n        ],\n    }\n\n    static temp_v2 = new Vector2();\n\n    /**\n     * @param target {EventTarget}\n     * @param speed {number}\n     * @param stiffness {number}\n     */\n    constructor(target, speed, stiffness) {\n        this.target = target;\n        this.manager = null;\n\n        this.deltaPosition = new Vector2();\n\n        this.up = false;\n        this.down = false;\n        this.left = false;\n        this.right = false;\n\n        this.speed = speed;\n        this.stiffness = stiffness;\n    }\n\n    /**\n     * @param manager {ControlsManager}\n     */\n    start(manager) {\n        this.manager = manager;\n\n        window.addEventListener(\"keydown\", this.onKeyDown);\n        window.addEventListener(\"keyup\", this.onKeyUp);\n    }\n\n    stop() {\n        window.removeEventListener(\"keydown\", this.onKeyDown);\n        window.removeEventListener(\"keyup\", this.onKeyUp);\n    }\n\n    /**\n     * @param delta {number}\n     * @param map {Map}\n     */\n    update(delta, map) {\n        if (this.up) this.deltaPosition.y -= 1;\n        if (this.down) this.deltaPosition.y += 1;\n        if (this.left) this.deltaPosition.x -= 1;\n        if (this.right) this.deltaPosition.x += 1;\n\n        if (this.deltaPosition.x === 0 && this.deltaPosition.y === 0) return;\n\n        let smoothing = this.stiffness / (16.666 / delta);\n        smoothing = MathUtils.clamp(smoothing, 0, 1);\n\n        let rotatedDelta = KeyMoveControls.temp_v2.copy(this.deltaPosition);\n        rotatedDelta.rotateAround(VEC2_ZERO, this.manager.rotation);\n\n        this.manager.position.x += rotatedDelta.x * smoothing * this.speed * delta * 0.06;\n        this.manager.position.z += rotatedDelta.y * smoothing * this.speed * delta * 0.06;\n\n        this.deltaPosition.multiplyScalar(1 - smoothing);\n        if (this.deltaPosition.lengthSq() < 0.0001) {\n            this.deltaPosition.set(0, 0);\n        }\n    }\n\n    /**\n     * @param evt {KeyboardEvent}\n     */\n    onKeyDown = evt => {\n        if (KeyCombination.oneUp(evt, ...KeyMoveControls.KEYS.UP)){\n            this.up = true;\n            evt.preventDefault();\n        }\n        if (KeyCombination.oneUp(evt, ...KeyMoveControls.KEYS.DOWN)){\n            this.down = true;\n            evt.preventDefault();\n        }\n        if (KeyCombination.oneUp(evt, ...KeyMoveControls.KEYS.LEFT)){\n            this.left = true;\n            evt.preventDefault();\n        }\n        if (KeyCombination.oneUp(evt, ...KeyMoveControls.KEYS.RIGHT)){\n            this.right = true;\n            evt.preventDefault();\n        }\n    }\n\n    /**\n     * @param evt {KeyboardEvent}\n     */\n    onKeyUp = evt => {\n        if (KeyCombination.oneUp(evt, ...KeyMoveControls.KEYS.UP)){\n            this.up = false;\n        }\n        if (KeyCombination.oneUp(evt, ...KeyMoveControls.KEYS.DOWN)){\n            this.down = false;\n        }\n        if (KeyCombination.oneUp(evt, ...KeyMoveControls.KEYS.LEFT)){\n            this.left = false;\n        }\n        if (KeyCombination.oneUp(evt, ...KeyMoveControls.KEYS.RIGHT)){\n            this.right = false;\n        }\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\nimport {MathUtils} from \"three\";\n\nexport class MouseRotateControls {\n\n    /**\n     * @param target {Element}\n     * @param speedLeft {number}\n     * @param speedRight {number}\n     * @param speedCapture {number}\n     * @param stiffness {number}\n     */\n    constructor(target, speedLeft, speedRight, speedCapture, stiffness) {\n        this.target = target;\n        this.manager = null;\n\n        this.moving = false;\n        this.lastX = 0;\n        this.deltaRotation = 0;\n\n        this.speedLeft = speedLeft;\n        this.speedRight = speedRight;\n        this.speedCapture = speedCapture;\n        this.stiffness = stiffness;\n\n        this.pixelToSpeedMultiplier = 0;\n        this.updatePixelToSpeedMultiplier();\n    }\n\n    /**\n     * @param manager {ControlsManager}\n     */\n    start(manager) {\n        this.manager = manager;\n\n        this.target.addEventListener(\"mousedown\", this.onMouseDown);\n        window.addEventListener(\"mousemove\", this.onMouseMove);\n        window.addEventListener(\"mouseup\", this.onMouseUp);\n\n        window.addEventListener(\"resize\", this.updatePixelToSpeedMultiplier);\n    }\n\n    stop() {\n        this.target.removeEventListener(\"mousedown\", this.onMouseDown);\n        window.removeEventListener(\"mousemove\", this.onMouseMove);\n        window.removeEventListener(\"mouseup\", this.onMouseUp);\n\n        window.removeEventListener(\"resize\", this.updatePixelToSpeedMultiplier);\n    }\n\n    /**\n     * @param delta {number}\n     * @param map {Map}\n     */\n    update(delta, map) {\n        if (this.deltaRotation === 0) return;\n\n        let smoothing = this.stiffness / (16.666 / delta);\n        smoothing = MathUtils.clamp(smoothing, 0, 1);\n\n        this.manager.rotation += this.deltaRotation * smoothing;\n\n        this.deltaRotation *= 1 - smoothing;\n        if (Math.abs(this.deltaRotation) < 0.0001) {\n            this.deltaRotation = 0;\n        }\n    }\n\n    reset() {\n        this.deltaRotation = 0;\n    }\n\n    /**\n     * @private\n     * @param evt {MouseEvent}\n     */\n    onMouseDown = evt => {\n        this.moving = true;\n        this.deltaRotation = 0;\n        this.lastX = evt.x;\n    }\n\n    /**\n     * @private\n     * @param evt {MouseEvent}\n     */\n    onMouseMove = evt => {\n        if (document.pointerLockElement) {\n            this.deltaRotation -= evt.movementX * this.speedCapture * this.pixelToSpeedMultiplier;\n        }\n\n        else if(this.moving){\n            if (evt.buttons === 1) {\n                this.deltaRotation -= (evt.x - this.lastX) * this.speedLeft * this.pixelToSpeedMultiplier;\n            } else {\n                this.deltaRotation -= (evt.x - this.lastX) * this.speedRight * this.pixelToSpeedMultiplier;\n            }\n        }\n\n        this.lastX = evt.x;\n    }\n\n    /**\n     * @private\n     * @param evt {MouseEvent}\n     */\n    onMouseUp = evt => {\n        this.moving = false;\n    }\n\n    updatePixelToSpeedMultiplier = () => {\n        this.pixelToSpeedMultiplier = (1 / this.target.clientWidth) * (this.target.clientWidth / this.target.clientHeight);\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\nimport {MathUtils} from \"three\";\n\nexport class MouseAngleControls {\n\n    /**\n     * @param target {EventTarget}\n     * @param speedLeft {number}\n     * @param speedRight {number}\n     * @param speedCapture {number}\n     * @param stiffness {number}\n     */\n    constructor(target, speedLeft, speedRight, speedCapture, stiffness) {\n        this.target = target;\n        this.manager = null;\n\n        this.moving = false;\n        this.lastY = 0;\n        this.deltaAngle = 0;\n\n        this.speedLeft = speedLeft;\n        this.speedRight = speedRight;\n        this.speedCapture = speedCapture;\n        this.stiffness = stiffness;\n\n        this.pixelToSpeedMultiplier = 0;\n        this.updatePixelToSpeedMultiplier();\n    }\n\n    /**\n     * @param manager {ControlsManager}\n     */\n    start(manager) {\n        this.manager = manager;\n\n        this.target.addEventListener(\"mousedown\", this.onMouseDown);\n        window.addEventListener(\"mousemove\", this.onMouseMove);\n        window.addEventListener(\"mouseup\", this.onMouseUp);\n\n        window.addEventListener(\"resize\", this.updatePixelToSpeedMultiplier);\n    }\n\n    stop() {\n        this.target.removeEventListener(\"mousedown\", this.onMouseDown);\n        window.removeEventListener(\"mousemove\", this.onMouseMove);\n        window.removeEventListener(\"mouseup\", this.onMouseUp);\n\n        window.removeEventListener(\"resize\", this.updatePixelToSpeedMultiplier);\n    }\n\n    /**\n     * @param delta {number}\n     * @param map {Map}\n     */\n    update(delta, map) {\n        if (this.deltaAngle === 0) return;\n\n        let smoothing = this.stiffness / (16.666 / delta);\n        smoothing = MathUtils.clamp(smoothing, 0, 1);\n\n        this.manager.angle += this.deltaAngle * smoothing;\n\n        this.deltaAngle *= 1 - smoothing;\n        if (Math.abs(this.deltaAngle) < 0.0001) {\n            this.deltaAngle = 0;\n        }\n    }\n\n    reset() {\n        this.deltaAngle = 0;\n    }\n\n    /**\n     * @private\n     * @param evt {MouseEvent}\n     */\n    onMouseDown = evt => {\n        this.moving = true;\n        this.deltaAngle = 0;\n        this.lastY = evt.y;\n    }\n\n    /**\n     * @private\n     * @param evt {MouseEvent}\n     */\n    onMouseMove = evt => {\n        if (document.pointerLockElement) {\n            this.deltaAngle += evt.movementY * this.speedCapture * this.pixelToSpeedMultiplier;\n        }\n\n        else if(this.moving){\n            if (evt.buttons === 1) {\n                this.deltaAngle += (evt.y - this.lastY) * this.speedLeft * this.pixelToSpeedMultiplier;\n            } else {\n                this.deltaAngle += (evt.y - this.lastY) * this.speedRight * this.pixelToSpeedMultiplier;\n            }\n        }\n\n        this.lastY = evt.y;\n    }\n\n    /**\n     * @private\n     * @param evt {MouseEvent}\n     */\n    onMouseUp = evt => {\n        this.moving = false;\n    }\n\n    updatePixelToSpeedMultiplier = () => {\n        this.pixelToSpeedMultiplier = 1 / this.target.clientHeight;\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\nimport {MathUtils} from \"three\";\nimport {KeyCombination} from \"../../KeyCombination\";\n\nexport class KeyHeightControls {\n\n    static KEYS = {\n        UP: [\n            new KeyCombination(\"Space\"),\n            new KeyCombination(\"PageUp\")\n        ],\n        DOWN: [\n            new KeyCombination(\"ShiftLeft\"),\n            new KeyCombination(\"ShiftRight\"),\n            new KeyCombination(\"PageDown\")\n        ],\n    }\n\n    /**\n     * @param target {EventTarget}\n     * @param speed {number}\n     * @param stiffness {number}\n     */\n    constructor(target, speed, stiffness) {\n        this.target = target;\n        this.manager = null;\n\n        this.deltaY = 0;\n\n        this.up = false;\n        this.down = false;\n\n        this.speed = speed;\n        this.stiffness = stiffness;\n    }\n\n    /**\n     * @param manager {ControlsManager}\n     */\n    start(manager) {\n        this.manager = manager;\n\n        window.addEventListener(\"keydown\", this.onKeyDown);\n        window.addEventListener(\"keyup\", this.onKeyUp);\n    }\n\n    stop() {\n        window.removeEventListener(\"keydown\", this.onKeyDown);\n        window.removeEventListener(\"keyup\", this.onKeyUp);\n    }\n\n    /**\n     * @param delta {number}\n     * @param map {Map}\n     */\n    update(delta, map) {\n        if (this.up) this.deltaY += 1;\n        if (this.down) this.deltaY -= 1;\n\n        if (this.deltaY === 0) return;\n\n        let smoothing = this.stiffness / (16.666 / delta);\n        smoothing = MathUtils.clamp(smoothing, 0, 1);\n\n        this.manager.position.y += this.deltaY * smoothing * this.speed * delta * 0.06;\n\n        this.deltaY *= 1 - smoothing;\n        if (Math.abs(this.deltaY) < 0.0001) {\n            this.deltaY = 0;\n        }\n    }\n\n    /**\n     * @param evt {KeyboardEvent}\n     */\n    onKeyDown = evt => {\n        if (KeyCombination.oneUp(evt, ...KeyHeightControls.KEYS.UP)){\n            this.up = true;\n            evt.preventDefault();\n        }\n        else if (KeyCombination.oneUp(evt, ...KeyHeightControls.KEYS.DOWN)){\n            this.down = true;\n            evt.preventDefault();\n        }\n    }\n\n    /**\n     * @param evt {KeyboardEvent}\n     */\n    onKeyUp = evt => {\n        if (KeyCombination.oneUp(evt, ...KeyHeightControls.KEYS.UP)){\n            this.up = false;\n        }\n        if (KeyCombination.oneUp(evt, ...KeyHeightControls.KEYS.DOWN)){\n            this.down = false;\n        }\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\nimport {MathUtils, Vector2} from \"three\";\n\nexport class TouchPanControls {\n\n    static tempVec2_1 = new Vector2();\n\n    /**\n     * @param target {Element}\n     * @param hammer {Manager}\n     * @param speed {number}\n     * @param stiffness {number}\n     */\n    constructor(target, hammer, speed, stiffness) {\n        this.target = target;\n        this.hammer = hammer;\n        this.manager = null;\n\n        this.moving = false;\n        this.lastPosition = new Vector2();\n        this.deltaPosition = new Vector2();\n\n        this.speed = speed;\n        this.stiffness = stiffness;\n\n        this.pixelToSpeedMultiplierX = 0;\n        this.pixelToSpeedMultiplierY = 0;\n        this.updatePixelToSpeedMultiplier();\n    }\n\n    /**\n     * @param manager {ControlsManager}\n     */\n    start(manager) {\n        this.manager = manager;\n\n        this.hammer.on(\"movestart\", this.onTouchDown);\n        this.hammer.on(\"movemove\", this.onTouchMove);\n        this.hammer.on(\"moveend\", this.onTouchUp);\n        this.hammer.on(\"movecancel\", this.onTouchUp);\n\n        window.addEventListener(\"resize\", this.updatePixelToSpeedMultiplier);\n    }\n\n    stop() {\n        this.hammer.off(\"movestart\", this.onTouchDown);\n        this.hammer.off(\"movemove\", this.onTouchMove);\n        this.hammer.off(\"moveend\", this.onTouchUp);\n        this.hammer.off(\"movecancel\", this.onTouchUp);\n\n        window.removeEventListener(\"resize\", this.updatePixelToSpeedMultiplier);\n    }\n\n    /**\n     * @param delta {number}\n     * @param map {Map}\n     */\n    update(delta, map) {\n        if (this.deltaPosition.x === 0 && this.deltaPosition.y === 0) return;\n\n        let smoothing = this.stiffness / (16.666 / delta);\n        smoothing = MathUtils.clamp(smoothing, 0, 1);\n\n        this.manager.rotation += this.deltaPosition.x * this.speed * this.pixelToSpeedMultiplierX * this.stiffness;\n        this.manager.angle -= this.deltaPosition.y * this.speed * this.pixelToSpeedMultiplierY * this.stiffness;\n\n        this.deltaPosition.multiplyScalar(1 - smoothing);\n        if (this.deltaPosition.lengthSq() < 0.0001) {\n            this.deltaPosition.set(0, 0);\n        }\n    }\n\n    reset() {\n        this.deltaPosition.set(0, 0);\n    }\n\n    /**\n     * @private\n     * @param evt {object}\n     */\n    onTouchDown = evt => {\n        if (evt.pointerType === \"mouse\") return;\n\n        this.moving = true;\n        this.deltaPosition.set(0, 0);\n        this.lastPosition.set(evt.center.x, evt.center.y);\n    }\n\n    /**\n     * @private\n     * @param evt {object}\n     */\n    onTouchMove = evt => {\n        if (evt.pointerType === \"mouse\") return;\n\n        let position = TouchPanControls.tempVec2_1.set(evt.center.x, evt.center.y);\n\n        if(this.moving){\n            this.deltaPosition.sub(position).add(this.lastPosition);\n        }\n\n        this.lastPosition.copy(position);\n    }\n\n    /**\n     * @private\n     * @param evt {object}\n     */\n    onTouchUp = evt => {\n        if (evt.pointerType === \"mouse\") return;\n\n        this.moving = false;\n    }\n\n    updatePixelToSpeedMultiplier = () => {\n        this.pixelToSpeedMultiplierX = (1 / this.target.clientWidth) * (this.target.clientWidth / this.target.clientHeight);\n        this.pixelToSpeedMultiplierY = 1 / this.target.clientHeight;\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\nimport {MathUtils, Vector2} from \"three\";\nimport {Manager, Pan, DIRECTION_ALL} from \"hammerjs\";\nimport {animate, EasingFunctions} from \"../../util/Utils\";\nimport {KeyMoveControls} from \"./keyboard/KeyMoveControls\";\nimport {MouseRotateControls} from \"./mouse/MouseRotateControls\";\nimport {MouseAngleControls} from \"./mouse/MouseAngleControls\";\nimport {KeyHeightControls} from \"./keyboard/KeyHeightControls\";\nimport {TouchPanControls} from \"./touch/TouchPanControls\";\n\nexport class FreeFlightControls {\n\n    /**\n     * @param target {Element}\n     */\n    constructor(target) {\n        this.target = target;\n        this.manager = null;\n\n        this.data = {\n\n        };\n\n        this.hammer = new Manager(this.target);\n        this.initializeHammer();\n\n        this.keyMove = new KeyMoveControls(this.target, 0.5, 0.1);\n        this.keyHeight = new KeyHeightControls(this.target, 0.5, 0.2);\n        this.mouseRotate = new MouseRotateControls(this.target, 1.5, -2, -1.5, 0.5);\n        this.mouseAngle = new MouseAngleControls(this.target, 1.5, -2, -1.5, 0.5);\n        this.touchPan = new TouchPanControls(this.target, this.hammer, 5, 0.15);\n\n        this.started = false;\n\n        this.clickStart = new Vector2();\n        this.moveSpeed = 0.5;\n\n        this.animationTargetHeight = 0;\n    }\n\n    /**\n     * @param manager {ControlsManager}\n     */\n    start(manager) {\n        this.manager = manager;\n\n        this.keyMove.start(manager);\n        this.keyHeight.start(manager);\n        this.mouseRotate.start(manager);\n        this.mouseAngle.start(manager);\n        this.touchPan.start(manager);\n\n        this.target.addEventListener(\"contextmenu\", this.onContextMenu);\n        this.target.addEventListener(\"mousedown\", this.onMouseDown);\n        this.target.addEventListener(\"mouseup\", this.onMouseUp);\n        window.addEventListener(\"wheel\", this.onWheel, {passive: true});\n    }\n\n    stop() {\n        this.keyMove.stop();\n        this.keyHeight.stop();\n        this.mouseRotate.stop();\n        this.mouseAngle.stop();\n        this.touchPan.stop();\n\n        this.target.removeEventListener(\"contextmenu\", this.onContextMenu);\n        this.target.removeEventListener(\"mousedown\", this.onMouseDown);\n        this.target.removeEventListener(\"mouseup\", this.onMouseUp);\n        window.removeEventListener(\"wheel\", this.onWheel);\n    }\n\n    /**\n     * @param delta {number}\n     * @param map {Map}\n     */\n    update(delta, map) {\n        this.keyMove.update(delta, map);\n        this.keyHeight.update(delta, map);\n        this.mouseRotate.update(delta, map);\n        this.mouseAngle.update(delta, map);\n        this.touchPan.update(delta, map);\n\n        this.manager.angle = MathUtils.clamp(this.manager.angle, 0, Math.PI);\n        this.manager.distance = 0;\n        this.manager.ortho = 0;\n    }\n\n    initializeHammer() {\n        let touchMove = new Pan({ event: 'move', pointers: 1, direction: DIRECTION_ALL, threshold: 0 });\n        this.hammer.add(touchMove);\n    }\n\n    onContextMenu = evt => {\n        evt.preventDefault();\n    }\n\n    onMouseDown = evt => {\n        this.clickStart.set(evt.x, evt.y);\n    }\n\n    onMouseUp = evt => {\n        if (Math.abs(this.clickStart.x - evt.x) > 5) return;\n        if (Math.abs(this.clickStart.y - evt.y) > 5) return;\n\n        document.body.requestFullscreen()\n            .finally(() => {\n                this.target.requestPointerLock();\n            });\n    }\n\n    onWheel = evt => {\n        let delta = evt.deltaY;\n        if (evt.deltaMode === WheelEvent.DOM_DELTA_PIXEL) delta *= 0.01;\n        if (evt.deltaMode === WheelEvent.DOM_DELTA_LINE) delta *= 0.33;\n\n        this.moveSpeed *= Math.pow(1.5, -delta * 0.25);\n        this.moveSpeed = MathUtils.clamp(this.moveSpeed, 0.05, 5);\n\n        this.keyMove.speed = this.moveSpeed;\n        this.keyHeight.speed = this.moveSpeed;\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport {Object3D} from \"three\";\n\nexport * from \"./MapViewer\";\n\nexport * from \"./map/Map\";\nexport * from \"./map/Tile\";\nexport * from \"./map/TileLoader\";\nexport * from \"./map/TileManager\";\nexport * from \"./map/TileMap\";\n\nexport * from \"./markers/ExtrudeMarker\";\nexport * from \"./markers/HtmlMarker\";\nexport * from \"./markers/LineMarker\";\nexport * from \"./markers/Marker\";\nexport * from \"./markers/MarkerFileManager\";\nexport * from \"./markers/MarkerManager\";\nexport * from \"./markers/MarkerSet\";\nexport * from \"./markers/ObjectMarker\";\nexport * from \"./markers/PlayerMarker\";\nexport * from \"./markers/PlayerMarkerManager\";\nexport * from \"./markers/PoiMarker\";\nexport * from \"./markers/ShapeMarker\";\n\nexport * from \"./controls/map/MapControls\";\nexport * from \"./controls/freeflight/FreeFlightControls\";\n\nexport * from \"./util/CombinedCamera\";\nexport * from \"./util/Utils\";\n\n/**\n * @param event {object}\n * @return {boolean} - whether the event has been consumed (true) or not (false)\n */\nObject3D.prototype.onClick = function(event) {\n\n    if (this.parent){\n        if (!Array.isArray(event.eventStack)) event.eventStack = [];\n        event.eventStack.push(this);\n\n        return this.parent.onClick(event);\n    }\n\n    return false;\n};\n","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport {Marker} from \"bluemap/src/markers/Marker\";\nimport {CSS2DObject} from \"bluemap/src/util/CSS2DRenderer\";\nimport {animate, htmlToElement} from \"bluemap/src/util/Utils\";\nimport {BoxGeometry, MeshBasicMaterial, Mesh, Vector2} from \"three\";\nimport i18n from \"../i18n\";\n\nexport class PopupMarker extends Marker {\n\n    constructor(id, appState, events) {\n        super(id);\n\n        this.data.type = \"popup\";\n        this.data.label = \"Last Map Interaction\";\n\n        this.appState = appState;\n        this.events = events;\n        this.visible = false;\n\n        this.elementObject = new CSS2DObject(htmlToElement(`<div id=\"bm-marker-${this.data.id}\" class=\"bm-marker-${this.data.type}\">Test</div>`));\n        this.elementObject.position.set(0.5, 1, 0.5);\n        this.addEventListener( 'removed', () => {\n            if (this.element.parentNode) this.element.parentNode.removeChild(this.element);\n        });\n\n        let cubeGeo = new BoxGeometry(1.01, 1.01, 1.01).translate(0.5, 0.5, 0.5);\n        let cubeMaterial = new MeshBasicMaterial( {color: 0xffffff, opacity: 0.5, transparent: true} );\n        this.cube = new Mesh(cubeGeo, cubeMaterial);\n        this.cube.onClick = evt => this.onClick(evt);\n\n        this.add(this.elementObject);\n        this.add(this.cube);\n\n        this.animation = null;\n\n        this.events.addEventListener('bluemapMapInteraction', this.onMapInteraction);\n\n        window.addEventListener(\"mousedown\", this.removeHandler);\n        window.addEventListener(\"touchstart\", this.removeHandler);\n        window.addEventListener(\"keydown\", this.removeHandler);\n        window.addEventListener(\"mousewheel\", this.removeHandler);\n    }\n\n    onClick(event) {\n        return true;\n    }\n\n    onMapInteraction = evt => {\n        let isHires = true;\n        let int = evt.detail.hiresHit;\n\n        if (!int) {\n            isHires = false;\n            int = evt.detail.lowresHit;\n        }\n\n        if (!int) return;\n\n        this.position\n            .copy(int.pointOnLine || int.point)\n            .add(evt.detail.ray.direction.clone().multiplyScalar(0.05))\n            .floor();\n\n        //this.elementObject.position\n            //.copy(evt.detail.intersection.pointOnLine || evt.detail.intersection.point)\n            //.sub(this.position);\n\n        if (isHires) {\n            this.element.innerHTML = `\n                <div class=\"group\">\n                    <div class=\"label\">${i18n.t(\"blockTooltip.block\")}:</div>\n                    <div class=\"content\">\n                        <div class=\"entry\"><span class=\"label\">x: </span><span class=\"value\">${this.position.x}</span></div>\n                        <div class=\"entry\"><span class=\"label\">y: </span><span class=\"value\">${this.position.y}</span></div>\n                        <div class=\"entry\"><span class=\"label\">z: </span><span class=\"value\">${this.position.z}</span></div>\n                    </div>\n                </div>\n            `;\n        } else {\n            this.element.innerHTML = `\n                <div class=\"group\">\n                    <div class=\"label\">${i18n.t(\"blockTooltip.position\")}:</div>\n                    <div class=\"content\">\n                        <div class=\"entry\"><span class=\"label\">x: </span><span class=\"value\">${this.position.x}</span></div>\n                        <div class=\"entry\"><span class=\"label\">z: </span><span class=\"value\">${this.position.z}</span></div>\n                    </div>\n                </div>\n            `;\n        }\n\n        if (this.appState.debug) {\n            let chunkCoords = this.position.clone().divideScalar(16).floor();\n            let regionCoords = new Vector2(this.position.x, this.position.z).divideScalar(512).floor();\n            let regionFile = `r.${regionCoords.x}.${regionCoords.y}.mca`;\n\n            this.element.innerHTML += `\n                <hr>\n                <div class=\"group\">\n                    <div class=\"label\">${i18n.t(\"blockTooltip.chunk\")}:</div>\n                    <div class=\"content\">\n                        <div class=\"entry\"><span class=\"label\">x: </span><span class=\"value\">${chunkCoords.x}</span></div>\n                        <div class=\"entry\"><span class=\"label\">y: </span><span class=\"value\">${chunkCoords.y}</span></div>\n                        <div class=\"entry\"><span class=\"label\">z: </span><span class=\"value\">${chunkCoords.z}</span></div>\n                    </div>\n                </div>\n                <hr>\n                <div class=\"group\">\n                    <div class=\"label\">${i18n.t(\"blockTooltip.region.region\")}:</div>\n                    <div class=\"content\">\n                        <div class=\"entry\"><span class=\"label\">x: </span><span class=\"value\">${regionCoords.x}</span></div>\n                        <div class=\"entry\"><span class=\"label\">z: </span><span class=\"value\">${regionCoords.y}</span></div>\n                    </div>\n                    <div class=\"content\">\n                        <div class=\"entry\"><span class=\"label\">${i18n.t(\"blockTooltip.region.file\")}: </span><span class=\"value\">${regionFile}</span></div>\n                    </div>\n                </div>\n            `;\n        }\n\n        if (this.appState.debug) {\n            let faceIndex = int.faceIndex;\n            let attributes = int.object.geometry.attributes;\n            if (attributes.sunlight && attributes.blocklight) {\n                let sunlight = attributes.sunlight.array[faceIndex * 3];\n                let blocklight = attributes.blocklight.array[faceIndex * 3];\n\n                this.element.innerHTML += `\n                    <hr>\n                    <div class=\"group\">\n                        <div class=\"label\">${i18n.t(\"blockTooltip.light.light\")}:</div>\n                        <div class=\"content\">\n                            <div class=\"entry\"><span class=\"label\">${i18n.t(\"blockTooltip.light.sun\")}: </span><span class=\"value\">${sunlight}</span></div>\n                            <div class=\"entry\"><span class=\"label\">${i18n.t(\"blockTooltip.light.block\")}: </span><span class=\"value\">${blocklight}</span></div>\n                        </div>\n                    </div>\n                `;\n            }\n        }\n\n        if (this.appState.debug) {\n            let info = \"\";\n\n            if (isHires) {\n                let hrPath = evt.detail.hiresHit.object.userData.tileUrl;\n                info += `<div>${hrPath}</div>`;\n            }\n\n            let lrPath = evt.detail.lowresHit.object.userData.tileUrl;\n            info += `<div>${lrPath}</div>`;\n\n            this.element.innerHTML += `\n                <hr>\n                <div class=\"files\">\n                    ${info}\n                </div>\n            `;\n        }\n\n        if (this.appState.debug){\n            console.debug(\"Clicked Position Data:\", evt.detail);\n        }\n\n        this.open();\n    };\n\n    open() {\n        if (this.animation) this.animation.cancel();\n\n        this.visible = true;\n        this.cube.visible = true;\n\n        let targetOpacity = 1;\n\n        this.element.style.opacity = \"0\";\n        this.animation = animate(progress => {\n            this.element.style.opacity = (progress * targetOpacity).toString();\n        }, 300);\n    }\n\n    removeHandler = evt => {\n        if (evt.composedPath().includes(this.element)) return;\n        this.close();\n    }\n\n    close() {\n        if (this.animation) this.animation.cancel();\n\n        this.cube.visible = false;\n\n        let startOpacity = parseFloat(this.element.style.opacity);\n        this.animation = animate(progress => {\n            this.element.style.opacity = (startOpacity - progress * startOpacity).toString();\n        }, 300, finished => {\n            if (finished) this.visible = false;\n        });\n    }\n\n    /**\n     * @returns {Element}\n     */\n    get element() {\n        return this.elementObject.element.getElementsByTagName(\"div\")[0];\n    }\n\n    dispose() {\n        super.dispose();\n\n        if (this.element.parentNode) this.element.parentNode.removeChild(this.element);\n    }\n\n}","/**\n * Converts a given value to JSON and writes it to the given key in\n * localStorage.\n */\nexport const setLocalStorage = (key, value) => {\n    localStorage.setItem(key, JSON.stringify(value));\n};\n\n/**\n * Fetches the value from a given key from localStorage. If the stored value is\n * in JSON format, the parsed value will be returned.\n */\nexport const getLocalStorage = key => {\n    const value = localStorage.getItem(key);\n\n    // return undefined for not defined values\n    // because \"null\" might be ambiguous if there is actually \"null\" stored for that key\n    if (value == null) return undefined;\n\n    try {\n        return JSON.parse(value);\n    } catch(e) {\n        return value;\n    }\n};\n\nexport const round = (value, precision) => {\n    let f = Math.pow(10, precision);\n    return Math.round(value * f) / f;\n}\n","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport \"bluemap/src/BlueMap\";\nimport {MapViewer} from \"bluemap/src/MapViewer\";\nimport {MapControls} from \"bluemap/src/controls/map/MapControls\";\nimport {FreeFlightControls} from \"bluemap/src/controls/freeflight/FreeFlightControls\";\nimport {FileLoader, MathUtils, Vector3} from \"three\";\nimport {Map as BlueMapMap} from \"bluemap/src/map/Map\";\nimport {alert, animate, EasingFunctions, generateCacheHash} from \"bluemap/src/util/Utils\";\nimport {PlayerMarkerManager} from \"bluemap/src/markers/PlayerMarkerManager\";\nimport {MarkerFileManager} from \"bluemap/src/markers/MarkerFileManager\";\nimport {MainMenu} from \"@/js/MainMenu\";\nimport {PopupMarker} from \"@/js/PopupMarker\";\nimport {MarkerSet} from \"bluemap/src/markers/MarkerSet\";\nimport {getLocalStorage, round, setLocalStorage} from \"@/js/Utils\";\nimport i18n from \"../i18n\";\n\nexport class BlueMapApp {\n\n    /**\n     * @param rootElement {Element}\n     */\n    constructor(rootElement) {\n        this.events = rootElement;\n\n        this.mapViewer = new MapViewer(rootElement, this.events);\n\n        this.mapControls = new MapControls(this.mapViewer.renderer.domElement);\n        this.freeFlightControls = new FreeFlightControls(this.mapViewer.renderer.domElement);\n\n        /** @type {PlayerMarkerManager} */\n        this.playerMarkerManager = null;\n        /** @type {MarkerFileManager} */\n        this.markerFileManager = null;\n\n        /** @type {{useCookies: boolean, freeFlightEnabled: boolean, maps: []}} */\n        this.settings = null;\n        this.savedUserSettings = new Map();\n\n        /** @type BlueMapMap[] */\n        this.maps = [];\n        /** @type Map<BlueMapMap> */\n        this.mapsMap = new Map();\n\n        this.dataUrl = \"data/\";\n\n        this.mainMenu = new MainMenu();\n\n        this.appState = {\n            controls: {\n                state: \"perspective\",\n                mouseSensitivity: 1,\n                invertMouse: false,\n                freeFlightEnabled: false,\n            },\n            menu: this.mainMenu,\n            maps: [],\n            theme: null,\n            debug: false\n        };\n\n        // init\n        this.updateControlsSettings();\n        this.initGeneralEvents();\n\n        // popup on click\n        this.popupMarkerSet = new MarkerSet(\"bm-popup-set\");\n        this.popupMarker = new PopupMarker(\"bm-popup\", this.appState, this.events);\n        this.popupMarkerSet.add(this.popupMarker);\n        this.mapViewer.markers.add(this.popupMarkerSet);\n\n        this.updateLoop = null;\n\n        this.hashUpdateTimeout = null;\n        this.viewAnimation = null;\n    }\n\n\n    /**\n     * @returns {Promise<void|never>}\n     */\n    async load() {\n        let oldMaps = this.maps;\n        this.maps = [];\n        this.appState.maps.splice(0, this.appState.maps.length);\n        this.mapsMap.clear();\n\n        // load settings\n        await this.getSettings();\n        this.appState.controls.freeFlightEnabled = this.settings.freeFlightEnabled;\n\n        // unload loaded maps\n        await this.mapViewer.switchMap(null);\n        oldMaps.forEach(map => map.dispose());\n\n        // load maps\n        this.maps = this.loadMaps();\n        for (let map of this.maps) {\n            this.mapsMap.set(map.data.id, map);\n            this.appState.maps.push(map.data);\n        }\n\n        // switch to map\n        if (!await this.loadPageAddress()) {\n            if (this.maps.length > 0) await this.switchMap(this.maps[0].data.id);\n            this.resetCamera();\n        }\n\n        // map position address\n        window.addEventListener(\"hashchange\", this.loadPageAddress);\n        this.events.addEventListener(\"bluemapCameraMoved\", this.cameraMoved);\n        this.events.addEventListener(\"bluemapMapInteraction\", this.mapInteraction);\n\n        // start app update loop\n        if(this.updateLoop) clearTimeout(this.updateLoop);\n        this.updateLoop = setTimeout(this.update, 1000);\n\n        // load user settings\n        await this.loadUserSettings();\n\n        // save user settings\n        this.saveUserSettings();\n    }\n\n    update = async () => {\n        await this.followPlayerMarkerWorld();\n        this.updateLoop = setTimeout(this.update, 1000);\n    }\n\n    async followPlayerMarkerWorld() {\n        let player = this.mapViewer.controlsManager.controls ?\n            this.mapViewer.controlsManager.controls.data.followingPlayer :\n            false;\n\n        if (this.mapViewer.map && player) {\n            if (player.world !== this.mapViewer.map.data.world){\n\n                /** @type BlueMapMap */\n                let matchingMap = null;\n                for (let map of this.maps) {\n                    if (map.data.world === player.world) {\n                        matchingMap = map;\n                        break;\n                    }\n                }\n\n                if (!matchingMap) {\n                    if (this.mapViewer.controlsManager.controls.stopFollowingPlayerMarker)\n                        this.mapViewer.controlsManager.controls.stopFollowingPlayerMarker();\n                    return;\n                }\n\n                await this.switchMap(matchingMap.data.id);\n            }\n        }\n    }\n\n    /**\n     * @param mapId {String}\n     * @param resetCameraIfNewWorld {boolean}\n     * @returns {Promise<void>}\n     */\n    switchMap(mapId, resetCameraIfNewWorld = false) {\n        let map = this.mapsMap.get(mapId);\n        if (!map) return Promise.reject(`There is no map with the id \"${mapId}\" loaded!`);\n\n        let oldWorld = this.mapViewer.map ? this.mapViewer.map.data.world : null;\n        return this.mapViewer.switchMap(map).then(() => {\n            if (map) {\n                this.initPlayerMarkerManager();\n                this.initMarkerFileManager();\n\n                if (resetCameraIfNewWorld && map.data.world !== oldWorld) {\n                    this.resetCamera();\n                }\n            }\n\n            this.updatePageAddress();\n        });\n    }\n\n    resetCamera() {\n        let map = this.mapViewer.map;\n        let controls = this.mapViewer.controlsManager;\n\n        if (map) {\n            controls.position.set(map.data.startPos.x, 0, map.data.startPos.z);\n            controls.distance = 500;\n            controls.angle = 0;\n            controls.rotation = 0;\n            controls.tilt = 0;\n            controls.ortho = 0;\n        }\n\n        controls.controls = this.mapControls;\n        this.appState.controls.state = \"perspective\";\n        this.updatePageAddress();\n    }\n\n    /**\n     * @returns BlueMapMap[]\n     */\n    loadMaps() {\n        let settings = this.settings;\n        let maps = [];\n\n        // create maps\n        if (settings.maps !== undefined){\n            for (let mapId in settings.maps) {\n                if (!Object.prototype.hasOwnProperty.call(settings.maps, mapId)) continue;\n\n                let mapSettings = settings.maps[mapId];\n                if (mapSettings.enabled) {\n                    let map = new BlueMapMap(mapId, this.dataUrl + mapId + \"/\", this.dataUrl + \"settings.json\", this.dataUrl + \"textures.json\", this.mapViewer.events);\n                    maps.push(map);\n\n                    map.loadSettings()\n                        .catch(error => {\n                            alert(this.events, `Failed to load settings for map '${map.data.id}':` + error, \"warning\");\n                        });\n                }\n            }\n        }\n\n        // sort maps\n        maps.sort((map1, map2) => {\n            let sort = settings.maps[map1.data.id].ordinal - settings.maps[map2.data.id].ordinal;\n            if (isNaN(sort)) return 0;\n            return sort;\n        });\n\n        return maps;\n    }\n\n    async getSettings() {\n        if (!this.settings){\n            this.settings = await this.loadSettings();\n        }\n\n        return this.settings;\n    }\n\n    /**\n     * @returns {Promise<Object>}\n     */\n    loadSettings() {\n        return new Promise((resolve, reject) => {\n            let loader = new FileLoader();\n            loader.setResponseType(\"json\");\n            loader.load(this.dataUrl + \"settings.json?\" + generateCacheHash(),\n                resolve,\n                () => {},\n                () => reject(\"Failed to load the settings.json!\")\n            );\n        });\n    }\n\n    initPlayerMarkerManager() {\n        if (!this.mapViewer.map) return;\n\n        if (this.playerMarkerManager) {\n            this.playerMarkerManager.worldId = this.mapViewer.map.data.world;\n        } else {\n            this.playerMarkerManager = new PlayerMarkerManager(this.mapViewer.markers, \"live/players\", this.mapViewer.map.data.world, this.events);\n        }\n\n        this.playerMarkerManager.setAutoUpdateInterval(0);\n        this.playerMarkerManager.update()\n            .then(() => {\n                this.playerMarkerManager.setAutoUpdateInterval(1000);\n            })\n            .catch(e => {\n                alert(this.events, e, \"warning\");\n                this.playerMarkerManager.clear();\n                this.playerMarkerManager.dispose();\n            });\n    }\n\n    initMarkerFileManager() {\n        if (this.markerFileManager) {\n            this.markerFileManager.clear();\n            this.markerFileManager.dispose();\n        }\n\n        if (!this.mapViewer.map) return;\n\n        this.markerFileManager = new MarkerFileManager(this.mapViewer.markers, \"data/markers.json\", this.mapViewer.map.data.id, this.events);\n        this.markerFileManager.update()\n            .then(() => {\n                this.markerFileManager.setAutoUpdateInterval(1000 * 10);\n            })\n            .catch(e => {\n                alert(this.events, e, \"warning\");\n                this.markerFileManager.clear();\n                this.markerFileManager.dispose();\n            });\n    }\n\n    updateControlsSettings() {\n        let mouseInvert = this.appState.controls.invertMouse ? -1 : 1;\n\n        this.freeFlightControls.mouseRotate.speedCapture = -1.5 * this.appState.controls.mouseSensitivity;\n        this.freeFlightControls.mouseAngle.speedCapture = -1.5 * this.appState.controls.mouseSensitivity * mouseInvert;\n        this.freeFlightControls.mouseRotate.speedRight = -2 * this.appState.controls.mouseSensitivity;\n        this.freeFlightControls.mouseAngle.speedRight = -2 * this.appState.controls.mouseSensitivity * mouseInvert;\n    }\n\n    initGeneralEvents() {\n        //close menu on fullscreen\n        document.addEventListener(\"fullscreenchange\", evt => {\n            if (document.fullscreen) {\n                this.mainMenu.closeAll();\n            }\n        });\n    }\n\n    setPerspectiveView(transition = 0, minDistance = 5) {\n        if (!this.mapViewer.map) return;\n        if (this.viewAnimation) this.viewAnimation.cancel();\n\n        let cm = this.mapViewer.controlsManager;\n        cm.controls = null;\n\n        let startDistance = cm.distance;\n        let targetDistance = Math.max(5, minDistance, startDistance);\n\n        let startY = cm.position.y;\n        let targetY = MathUtils.lerp(this.mapViewer.map.terrainHeightAt(cm.position.x, cm.position.z) + 3, 0, targetDistance / 500);\n\n        let startAngle = cm.angle;\n        let targetAngle = Math.min(Math.PI / 2, startAngle, this.mapControls.getMaxPerspectiveAngleForDistance(targetDistance));\n\n        let startOrtho = cm.ortho;\n        let startTilt = cm.tilt;\n\n        this.viewAnimation = animate(p => {\n            let ep = EasingFunctions.easeInOutQuad(p);\n            cm.position.y = MathUtils.lerp(startY, targetY, ep);\n            cm.distance = MathUtils.lerp(startDistance, targetDistance, ep);\n            cm.angle = MathUtils.lerp(startAngle, targetAngle, ep);\n            cm.ortho = MathUtils.lerp(startOrtho, 0, p);\n            cm.tilt = MathUtils.lerp(startTilt, 0, ep);\n        }, transition, finished => {\n            this.mapControls.reset();\n            if (finished){\n                cm.controls = this.mapControls;\n                this.updatePageAddress();\n            }\n        });\n\n        this.appState.controls.state = \"perspective\";\n    }\n\n    setFlatView(transition = 0, minDistance = 5) {\n        if (!this.mapViewer.map) return;\n        if (this.viewAnimation) this.viewAnimation.cancel();\n\n        let cm = this.mapViewer.controlsManager;\n        cm.controls = null;\n\n        let startDistance = cm.distance;\n        let targetDistance = Math.max(5, minDistance, startDistance);\n\n        let startRotation = cm.rotation;\n        let startAngle = cm.angle;\n        let startOrtho = cm.ortho;\n        let startTilt = cm.tilt;\n\n        this.viewAnimation = animate(p => {\n            let ep = EasingFunctions.easeInOutQuad(p);\n            cm.distance = MathUtils.lerp(startDistance, targetDistance, ep);\n            cm.rotation = MathUtils.lerp(startRotation, 0, ep);\n            cm.angle = MathUtils.lerp(startAngle, 0, ep);\n            cm.ortho = MathUtils.lerp(startOrtho, 1, p);\n            cm.tilt = MathUtils.lerp(startTilt, 0, ep);\n        }, transition, finished => {\n            this.mapControls.reset();\n            if (finished){\n                cm.controls = this.mapControls;\n                this.updatePageAddress();\n            }\n        });\n\n        this.appState.controls.state = \"flat\";\n    }\n\n    setFreeFlight(transition = 0, targetY = undefined) {\n        if (!this.mapViewer.map) return;\n        if (!this.settings.freeFlightEnabled) return this.setPerspectiveView(transition);\n        if (this.viewAnimation) this.viewAnimation.cancel();\n\n        let cm = this.mapViewer.controlsManager;\n        cm.controls = null;\n\n        let startDistance = cm.distance;\n\n        let startY = cm.position.y;\n        if (!targetY) targetY = this.mapViewer.map.terrainHeightAt(cm.position.x, cm.position.z) + 3;\n\n        let startAngle = cm.angle;\n        let targetAngle = Math.PI / 2;\n\n        let startOrtho = cm.ortho;\n        let startTilt = cm.tilt;\n\n        this.viewAnimation = animate(p => {\n            let ep = EasingFunctions.easeInOutQuad(p);\n            cm.position.y = MathUtils.lerp(startY, targetY, ep);\n            cm.distance = MathUtils.lerp(startDistance, 0, ep);\n            cm.angle = MathUtils.lerp(startAngle, targetAngle, ep);\n            cm.ortho = MathUtils.lerp(startOrtho, 0, Math.min(p * 2, 1));\n            cm.tilt = MathUtils.lerp(startTilt, 0, ep);\n        }, transition, finished => {\n            if (finished){\n                cm.controls = this.freeFlightControls;\n                this.updatePageAddress();\n            }\n        });\n\n        this.appState.controls.state = \"free\";\n    }\n\n    setDebug(debug) {\n        this.appState.debug = debug;\n\n        if (debug){\n            this.mapViewer.stats.showPanel(0);\n        } else {\n            this.mapViewer.stats.showPanel(-1);\n        }\n    }\n\n    setTheme(theme) {\n        this.appState.theme = theme;\n\n        if (theme === \"light\") {\n            this.mapViewer.rootElement.classList.remove(\"theme-dark\");\n            this.mapViewer.rootElement.classList.add(\"theme-light\");\n        }\n        else if (theme === \"dark\") {\n            this.mapViewer.rootElement.classList.remove(\"theme-light\");\n            this.mapViewer.rootElement.classList.add(\"theme-dark\");\n        }\n        else {\n            this.mapViewer.rootElement.classList.remove(\"theme-light\");\n            this.mapViewer.rootElement.classList.remove(\"theme-dark\");\n        }\n    }\n\n    async updateMap() {\n        try {\n            this.mapViewer.clearTileCache();\n            if (this.mapViewer.map) {\n                await this.switchMap(this.mapViewer.map.data.id);\n            }\n            this.saveUserSettings();\n        } catch (e) {\n            alert(this.events, e, \"error\");\n        }\n    }\n\n    resetSettings() {\n        this.saveUserSetting(\"resetSettings\", true);\n        location.reload();\n    }\n\n    async loadUserSettings(){\n        if (!this.settings.useCookies) return;\n\n        if (this.loadUserSetting(\"resetSettings\", false)) {\n            alert(this.events, \"Settings reset!\", \"info\");\n            this.saveUserSettings();\n            return;\n        }\n\n        this.mapViewer.clearTileCache(this.loadUserSetting(\"tileCacheHash\", this.mapViewer.tileCacheHash));\n\n        this.mapViewer.superSampling = this.loadUserSetting(\"superSampling\", this.mapViewer.data.superSampling);\n        this.mapViewer.data.loadedHiresViewDistance = this.loadUserSetting(\"hiresViewDistance\", this.mapViewer.data.loadedHiresViewDistance);\n        this.mapViewer.data.loadedLowresViewDistance = this.loadUserSetting(\"lowresViewDistance\", this.mapViewer.data.loadedLowresViewDistance);\n        this.mapViewer.updateLoadedMapArea();\n        this.appState.controls.mouseSensitivity = this.loadUserSetting(\"mouseSensitivity\", this.appState.controls.mouseSensitivity);\n        this.appState.controls.invertMouse = this.loadUserSetting(\"invertMouse\", this.appState.controls.invertMouse);\n        this.updateControlsSettings();\n        this.setTheme(this.loadUserSetting(\"theme\", this.appState.theme));\n        await i18n.setLanguage(this.loadUserSetting(\"lang\", i18n.locale));\n        this.setDebug(this.loadUserSetting(\"debug\", this.appState.debug));\n\n        alert(this.events, \"Settings loaded!\", \"info\");\n    }\n\n    saveUserSettings() {\n        if (!this.settings.useCookies) return;\n\n        this.saveUserSetting(\"resetSettings\", false);\n        this.saveUserSetting(\"tileCacheHash\", this.mapViewer.tileCacheHash);\n\n        this.saveUserSetting(\"superSampling\", this.mapViewer.data.superSampling);\n        this.saveUserSetting(\"hiresViewDistance\", this.mapViewer.data.loadedHiresViewDistance);\n        this.saveUserSetting(\"lowresViewDistance\", this.mapViewer.data.loadedLowresViewDistance);\n        this.saveUserSetting(\"mouseSensitivity\", this.appState.controls.mouseSensitivity);\n        this.saveUserSetting(\"invertMouse\", this.appState.controls.invertMouse);\n        this.saveUserSetting(\"theme\", this.appState.theme);\n        this.saveUserSetting(\"lang\", i18n.locale);\n        this.saveUserSetting(\"debug\", this.appState.debug);\n\n        alert(this.events, \"Settings saved!\", \"info\");\n    }\n\n    loadUserSetting(key, defaultValue){\n        let value = getLocalStorage(\"bluemap-\" + key);\n\n        if (value === undefined) return defaultValue;\n        return value;\n    }\n\n    saveUserSetting(key, value){\n        if (this.savedUserSettings.get(key) !== value){\n            this.savedUserSettings.set(key, value);\n            setLocalStorage(\"bluemap-\" + key, value);\n        }\n    }\n\n    cameraMoved = () => {\n        if (this.hashUpdateTimeout) clearTimeout(this.hashUpdateTimeout);\n        this.hashUpdateTimeout = setTimeout(this.updatePageAddress, 1500);\n    }\n\n    updatePageAddress = () => {\n        let hash = \"#\";\n\n        if (this.mapViewer.map) {\n            hash += this.mapViewer.map.data.id;\n\n            let controls = this.mapViewer.controlsManager;\n            hash += \":\" + round(controls.position.x, 0);\n            hash += \":\" + round(controls.position.y, 0);\n            hash += \":\" + round(controls.position.z, 0);\n            hash += \":\" + round(controls.distance, 0);\n            hash += \":\" + round(controls.rotation, 2);\n            hash += \":\" + round(controls.angle, 2);\n            hash += \":\" + round(controls.tilt, 2);\n            hash += \":\" + round(controls.ortho, 0);\n            hash += \":\" + this.appState.controls.state;\n        }\n\n        history.replaceState(undefined, undefined, hash);\n\n        document.title = i18n.t(\"pageTitle\", {\n            map: this.mapViewer.map ? this.mapViewer.map.data.name : \"?\"\n        });\n    }\n\n    loadPageAddress = async () => {\n        let hash = window.location.hash.substr(1);\n        let values = hash.split(\":\");\n\n        if (values.length !== 10) return false;\n\n        let controls = this.mapViewer.controlsManager;\n        controls.controls = null;\n\n        if (!this.mapViewer.map || this.mapViewer.map.data.id !== values[0]) {\n            try {\n                await this.switchMap(values[0]);\n            } catch (e) {\n                return false;\n            }\n        }\n\n        controls.position.x = parseFloat(values[1]);\n        controls.position.y = parseFloat(values[2]);\n        controls.position.z = parseFloat(values[3]);\n        controls.distance = parseFloat(values[4]);\n        controls.rotation = parseFloat(values[5]);\n        controls.angle = parseFloat(values[6]);\n        controls.tilt = parseFloat(values[7]);\n        controls.ortho = parseFloat(values[8]);\n\n        switch (values[9]) {\n            case \"flat\" : this.setFlatView(0); break;\n            case \"free\" : this.setFreeFlight(0, controls.position.y); break;\n            default : this.setPerspectiveView(0); break;\n        }\n\n        return true;\n    }\n\n    mapInteraction = event => {\n        if (event.detail.data.doubleTap) {\n            let cm = this.mapViewer.controlsManager;\n            let pos = (event.detail.hit ? event.detail.hit.point : false) || event.detail.object.getWorldPosition(new Vector3());\n\n            let startDistance = cm.distance;\n            let targetDistance = Math.max(startDistance * 0.25, 5);\n\n            let startX = cm.position.x;\n            let targetX = pos.x;\n\n            let startZ = cm.position.z;\n            let targetZ = pos.z;\n\n            this.viewAnimation = animate(p => {\n                let ep = EasingFunctions.easeInOutQuad(p);\n                cm.distance = MathUtils.lerp(startDistance, targetDistance, ep);\n                cm.position.x = MathUtils.lerp(startX, targetX, ep);\n                cm.position.z = MathUtils.lerp(startZ, targetZ, ep);\n            }, 500);\n        }\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\nimport Vue from 'vue'\nimport App from './App.vue'\nimport {BlueMapApp} from \"@/js/BlueMapApp\";\nimport i18n from './i18n';\n\n// utils\nString.prototype.includesCI = function (val) {\n  return this.toLowerCase().includes(val.toLowerCase());\n}\n\n// bluemap app\nconst bluemap = new BlueMapApp(document.getElementById(\"map-container\"));\nwindow.bluemap = bluemap;\n\n// init vue\nVue.config.productionTip = false;\nObject.defineProperty(Vue.prototype, '$bluemap', {\n  get() { return bluemap; }\n});\n\nconst vue = new Vue({\n  i18n,\n  render: h => h(App)\n}).$mount('#app');\n\n// load languages\ni18n.loadLanguageSettings().catch(error => console.error(error));\n\n// load bluemap next tick (to let the assets load first)\nvue.$nextTick(() => {\n  bluemap.load().catch(error => console.error(error));\n});\n","export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=scss&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SwitchButton.vue?vue&type=style&index=0&lang=scss&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ControlBar.vue?vue&type=style&index=0&lang=scss&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PositionInput.vue?vue&type=style&index=0&lang=scss&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SimpleButton.vue?vue&type=style&index=0&lang=scss&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MarkerSet.vue?vue&type=style&index=0&lang=scss&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Slider.vue?vue&type=style&index=0&lang=scss&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MainMenu.vue?vue&type=style&index=0&lang=scss&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SwitchHandle.vue?vue&type=style&index=0&lang=scss&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Group.vue?vue&type=style&index=0&lang=scss&\""],"sourceRoot":""}